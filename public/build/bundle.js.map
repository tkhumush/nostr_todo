{"version":3,"file":"bundle.js","sources":["../../node_modules/svelte/internal/index.mjs","../../node_modules/svelte-routing/src/contexts.js","../../node_modules/svelte-routing/src/utils.js","../../node_modules/svelte-routing/src/Route.svelte","../../node_modules/svelte/store/index.mjs","../../node_modules/svelte-routing/src/history.js","../../node_modules/svelte-routing/src/Router.svelte","../../src/utils/eventsStore.js","../../src/routes/TodoPage.svelte","../../src/App.svelte","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/_assert.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/crypto.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/utils.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/_sha2.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/sha256.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/utils.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/modular.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/curve.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/abstract/weierstrass.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/hmac.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/_shortw_utils.js","../../node_modules/nostr-tools/node_modules/@noble/curves/esm/secp256k1.js","../../node_modules/nostr-tools/node_modules/@scure/base/lib/esm/index.js","../../node_modules/@scure/bip39/esm/wordlists/english.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/_assert.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/crypto.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/utils.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/hmac.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/pbkdf2.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/_sha2.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/sha256.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/_u64.js","../../node_modules/@scure/bip39/node_modules/@noble/hashes/esm/sha512.js","../../node_modules/@scure/base/lib/esm/index.js","../../node_modules/@scure/bip39/esm/index.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/_assert.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/utils.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/hmac.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/_sha2.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/ripemd160.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/sha256.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/_u64.js","../../node_modules/@scure/bip32/node_modules/@noble/hashes/esm/sha512.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/_assert.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/crypto.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/utils.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/_sha2.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/sha256.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/abstract/utils.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/abstract/modular.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/abstract/curve.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/abstract/weierstrass.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/node_modules/@noble/hashes/esm/hmac.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/_shortw_utils.js","../../node_modules/@scure/bip32/node_modules/@noble/curves/esm/secp256k1.js","../../node_modules/@scure/bip32/lib/esm/index.js","../../node_modules/@noble/ciphers/esm/utils.js","../../node_modules/@noble/ciphers/esm/_assert.js","../../node_modules/@noble/ciphers/esm/_poly1305.js","../../node_modules/@noble/ciphers/esm/_salsa.js","../../node_modules/@noble/ciphers/esm/chacha.js","../../node_modules/nostr-tools/node_modules/@noble/hashes/esm/hkdf.js","../../node_modules/nostr-tools/lib/esm/index.js","../../node_modules/tseep/lib/types.js","../../node_modules/tseep/lib/task-collection/bake-collection.js","../../node_modules/tseep/lib/task-collection/task-collection.js","../../node_modules/tseep/lib/task-collection/index.js","../../node_modules/tseep/lib/utils.js","../../node_modules/tseep/lib/ee.js","../../node_modules/tseep/lib/index.js","../../node_modules/ms/index.js","../../node_modules/debug/src/common.js","../../node_modules/debug/src/browser.js","../../node_modules/@noble/hashes/esm/_assert.js","../../node_modules/@noble/hashes/esm/crypto.js","../../node_modules/@noble/hashes/esm/utils.js","../../node_modules/@noble/hashes/esm/_md.js","../../node_modules/@noble/hashes/esm/sha256.js","../../node_modules/@noble/curves/esm/abstract/utils.js","../../node_modules/@noble/curves/esm/abstract/modular.js","../../node_modules/@noble/curves/esm/abstract/curve.js","../../node_modules/@noble/curves/esm/abstract/weierstrass.js","../../node_modules/@noble/hashes/esm/hmac.js","../../node_modules/@noble/curves/esm/_shortw_utils.js","../../node_modules/@noble/curves/esm/secp256k1.js","../../node_modules/typescript-lru-cache/dist/LRUCacheNode.js","../../node_modules/typescript-lru-cache/dist/LRUCache.js","../../node_modules/typescript-lru-cache/dist/index.js","../../node_modules/light-bolt11-decoder/node_modules/@scure/base/lib/index.js","../../node_modules/light-bolt11-decoder/bolt11.js","../../node_modules/@nostr-dev-kit/ndk/dist/index.mjs","../../src/Login.svelte","../../src/main.js"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\nfunction is_promise(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function') && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nlet src_url_equal_anchor;\nfunction src_url_equal(element_src, url) {\n    if (!src_url_equal_anchor) {\n        src_url_equal_anchor = document.createElement('a');\n    }\n    src_url_equal_anchor.href = url;\n    return element_src === src_url_equal_anchor.href;\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn) {\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    update_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\nfunction get_all_dirty_from_scope($$scope) {\n    if ($$scope.ctx.length > 32) {\n        const dirty = [];\n        const length = $$scope.ctx.length / 32;\n        for (let i = 0; i < length; i++) {\n            dirty[i] = -1;\n        }\n        return dirty;\n    }\n    return -1;\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\nfunction split_css_unit(value) {\n    const split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n    return split ? [parseFloat(split[1]), split[2] || 'px'] : [value, 'px'];\n}\nconst contenteditable_truthy_values = ['', true, 1, 'true', 'contenteditable'];\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\n/**\n * Resize observer singleton.\n * One listener per element only!\n * https://groups.google.com/a/chromium.org/g/blink-dev/c/z6ienONUb5A/m/F5-VcUZtBAAJ\n */\nclass ResizeObserverSingleton {\n    constructor(options) {\n        this.options = options;\n        this._listeners = 'WeakMap' in globals ? new WeakMap() : undefined;\n    }\n    observe(element, listener) {\n        this._listeners.set(element, listener);\n        this._getObserver().observe(element, this.options);\n        return () => {\n            this._listeners.delete(element);\n            this._observer.unobserve(element); // this line can probably be removed\n        };\n    }\n    _getObserver() {\n        var _a;\n        return (_a = this._observer) !== null && _a !== void 0 ? _a : (this._observer = new ResizeObserver((entries) => {\n            var _a;\n            for (const entry of entries) {\n                ResizeObserverSingleton.entries.set(entry.target, entry);\n                (_a = this._listeners.get(entry.target)) === null || _a === void 0 ? void 0 : _a(entry);\n            }\n        }));\n    }\n}\n// Needs to be written like this to pass the tree-shake-test\nResizeObserverSingleton.entries = 'WeakMap' in globals ? new WeakMap() : undefined;\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\nfunction start_hydrating() {\n    is_hydrating = true;\n}\nfunction end_hydrating() {\n    is_hydrating = false;\n}\nfunction upper_bound(low, high, key, value) {\n    // Return first index of value larger than input value in the range [low, high)\n    while (low < high) {\n        const mid = low + ((high - low) >> 1);\n        if (key(mid) <= value) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction init_hydrate(target) {\n    if (target.hydrate_init)\n        return;\n    target.hydrate_init = true;\n    // We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n    let children = target.childNodes;\n    // If target is <head>, there may be children without claim_order\n    if (target.nodeName === 'HEAD') {\n        const myChildren = [];\n        for (let i = 0; i < children.length; i++) {\n            const node = children[i];\n            if (node.claim_order !== undefined) {\n                myChildren.push(node);\n            }\n        }\n        children = myChildren;\n    }\n    /*\n    * Reorder claimed children optimally.\n    * We can reorder claimed children optimally by finding the longest subsequence of\n    * nodes that are already claimed in order and only moving the rest. The longest\n    * subsequence of nodes that are claimed in order can be found by\n    * computing the longest increasing subsequence of .claim_order values.\n    *\n    * This algorithm is optimal in generating the least amount of reorder operations\n    * possible.\n    *\n    * Proof:\n    * We know that, given a set of reordering operations, the nodes that do not move\n    * always form an increasing subsequence, since they do not move among each other\n    * meaning that they must be already ordered among each other. Thus, the maximal\n    * set of nodes that do not move form a longest increasing subsequence.\n    */\n    // Compute longest increasing subsequence\n    // m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n    const m = new Int32Array(children.length + 1);\n    // Predecessor indices + 1\n    const p = new Int32Array(children.length);\n    m[0] = -1;\n    let longest = 0;\n    for (let i = 0; i < children.length; i++) {\n        const current = children[i].claim_order;\n        // Find the largest subsequence length such that it ends in a value less than our current value\n        // upper_bound returns first greater value, so we subtract one\n        // with fast path for when we are on the current longest subsequence\n        const seqLen = ((longest > 0 && children[m[longest]].claim_order <= current) ? longest + 1 : upper_bound(1, longest, idx => children[m[idx]].claim_order, current)) - 1;\n        p[i] = m[seqLen] + 1;\n        const newLen = seqLen + 1;\n        // We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n        m[newLen] = i;\n        longest = Math.max(newLen, longest);\n    }\n    // The longest increasing subsequence of nodes (initially reversed)\n    const lis = [];\n    // The rest of the nodes, nodes that will be moved\n    const toMove = [];\n    let last = children.length - 1;\n    for (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n        lis.push(children[cur - 1]);\n        for (; last >= cur; last--) {\n            toMove.push(children[last]);\n        }\n        last--;\n    }\n    for (; last >= 0; last--) {\n        toMove.push(children[last]);\n    }\n    lis.reverse();\n    // We sort the nodes being moved to guarantee that their insertion order matches the claim order\n    toMove.sort((a, b) => a.claim_order - b.claim_order);\n    // Finally, we move the nodes\n    for (let i = 0, j = 0; i < toMove.length; i++) {\n        while (j < lis.length && toMove[i].claim_order >= lis[j].claim_order) {\n            j++;\n        }\n        const anchor = j < lis.length ? lis[j] : null;\n        target.insertBefore(toMove[i], anchor);\n    }\n}\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction append_styles(target, style_sheet_id, styles) {\n    const append_styles_to = get_root_for_style(target);\n    if (!append_styles_to.getElementById(style_sheet_id)) {\n        const style = element('style');\n        style.id = style_sheet_id;\n        style.textContent = styles;\n        append_stylesheet(append_styles_to, style);\n    }\n}\nfunction get_root_for_style(node) {\n    if (!node)\n        return document;\n    const root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n    if (root && root.host) {\n        return root;\n    }\n    return node.ownerDocument;\n}\nfunction append_empty_stylesheet(node) {\n    const style_element = element('style');\n    append_stylesheet(get_root_for_style(node), style_element);\n    return style_element.sheet;\n}\nfunction append_stylesheet(node, style) {\n    append(node.head || node, style);\n    return style.sheet;\n}\nfunction append_hydration(target, node) {\n    if (is_hydrating) {\n        init_hydrate(target);\n        if ((target.actual_end_child === undefined) || ((target.actual_end_child !== null) && (target.actual_end_child.parentNode !== target))) {\n            target.actual_end_child = target.firstChild;\n        }\n        // Skip nodes of undefined ordering\n        while ((target.actual_end_child !== null) && (target.actual_end_child.claim_order === undefined)) {\n            target.actual_end_child = target.actual_end_child.nextSibling;\n        }\n        if (node !== target.actual_end_child) {\n            // We only insert if the ordering of this node should be modified or the parent node is not target\n            if (node.claim_order !== undefined || node.parentNode !== target) {\n                target.insertBefore(node, target.actual_end_child);\n            }\n        }\n        else {\n            target.actual_end_child = node.nextSibling;\n        }\n    }\n    else if (node.parentNode !== target || node.nextSibling !== null) {\n        target.appendChild(node);\n    }\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction insert_hydration(target, node, anchor) {\n    if (is_hydrating && !anchor) {\n        append_hydration(target, node);\n    }\n    else if (node.parentNode !== target || node.nextSibling != anchor) {\n        target.insertBefore(node, anchor || null);\n    }\n}\nfunction detach(node) {\n    if (node.parentNode) {\n        node.parentNode.removeChild(node);\n    }\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction comment(content) {\n    return document.createComment(content);\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_immediate_propagation(fn) {\n    return function (event) {\n        event.stopImmediatePropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction trusted(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.isTrusted)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\n/**\n * List of attributes that should always be set through the attr method,\n * because updating them through the property setter doesn't work reliably.\n * In the example of `width`/`height`, the problem is that the setter only\n * accepts numeric values, but the attribute can also be set to a string like `50%`.\n * If this list becomes too big, rethink this approach.\n */\nconst always_set_through_set_attribute = ['width', 'height'];\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set && always_set_through_set_attribute.indexOf(key) === -1) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data_map(node, data_map) {\n    Object.keys(data_map).forEach((key) => {\n        set_custom_element_data(node, key, data_map[key]);\n    });\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction set_dynamic_element_data(tag) {\n    return (/-/.test(tag)) ? set_custom_element_data_map : set_attributes;\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction init_binding_group(group) {\n    let _inputs;\n    return {\n        /* push */ p(...inputs) {\n            _inputs = inputs;\n            _inputs.forEach(input => group.push(input));\n        },\n        /* remove */ r() {\n            _inputs.forEach(input => group.splice(group.indexOf(input), 1));\n        }\n    };\n}\nfunction init_binding_group_dynamic(group, indexes) {\n    let _group = get_binding_group(group);\n    let _inputs;\n    function get_binding_group(group) {\n        for (let i = 0; i < indexes.length; i++) {\n            group = group[indexes[i]] = group[indexes[i]] || [];\n        }\n        return group;\n    }\n    function push() {\n        _inputs.forEach(input => _group.push(input));\n    }\n    function remove() {\n        _inputs.forEach(input => _group.splice(_group.indexOf(input), 1));\n    }\n    return {\n        /* update */ u(new_indexes) {\n            indexes = new_indexes;\n            const new_group = get_binding_group(group);\n            if (new_group !== _group) {\n                remove();\n                _group = new_group;\n                push();\n            }\n        },\n        /* push */ p(...inputs) {\n            _inputs = inputs;\n            push();\n        },\n        /* remove */ r: remove\n    };\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction init_claim_info(nodes) {\n    if (nodes.claim_info === undefined) {\n        nodes.claim_info = { last_index: 0, total_claimed: 0 };\n    }\n}\nfunction claim_node(nodes, predicate, processNode, createNode, dontUpdateLastIndex = false) {\n    // Try to find nodes in an order such that we lengthen the longest increasing subsequence\n    init_claim_info(nodes);\n    const resultNode = (() => {\n        // We first try to find an element after the previous one\n        for (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                return node;\n            }\n        }\n        // Otherwise, we try to find one before\n        // We iterate in reverse so that we don't go too far back\n        for (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n            const node = nodes[i];\n            if (predicate(node)) {\n                const replacement = processNode(node);\n                if (replacement === undefined) {\n                    nodes.splice(i, 1);\n                }\n                else {\n                    nodes[i] = replacement;\n                }\n                if (!dontUpdateLastIndex) {\n                    nodes.claim_info.last_index = i;\n                }\n                else if (replacement === undefined) {\n                    // Since we spliced before the last_index, we decrease it\n                    nodes.claim_info.last_index--;\n                }\n                return node;\n            }\n        }\n        // If we can't find any matching node, we create a new one\n        return createNode();\n    })();\n    resultNode.claim_order = nodes.claim_info.total_claimed;\n    nodes.claim_info.total_claimed += 1;\n    return resultNode;\n}\nfunction claim_element_base(nodes, name, attributes, create_element) {\n    return claim_node(nodes, (node) => node.nodeName === name, (node) => {\n        const remove = [];\n        for (let j = 0; j < node.attributes.length; j++) {\n            const attribute = node.attributes[j];\n            if (!attributes[attribute.name]) {\n                remove.push(attribute.name);\n            }\n        }\n        remove.forEach(v => node.removeAttribute(v));\n        return undefined;\n    }, () => create_element(name));\n}\nfunction claim_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, element);\n}\nfunction claim_svg_element(nodes, name, attributes) {\n    return claim_element_base(nodes, name, attributes, svg_element);\n}\nfunction claim_text(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 3, (node) => {\n        const dataStr = '' + data;\n        if (node.data.startsWith(dataStr)) {\n            if (node.data.length !== dataStr.length) {\n                return node.splitText(dataStr.length);\n            }\n        }\n        else {\n            node.data = dataStr;\n        }\n    }, () => text(data), true // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n    );\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction claim_comment(nodes, data) {\n    return claim_node(nodes, (node) => node.nodeType === 8, (node) => {\n        node.data = '' + data;\n        return undefined;\n    }, () => comment(data), true);\n}\nfunction find_comment(nodes, text, start) {\n    for (let i = start; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n            return i;\n        }\n    }\n    return nodes.length;\n}\nfunction claim_html_tag(nodes, is_svg) {\n    // find html opening tag\n    const start_index = find_comment(nodes, 'HTML_TAG_START', 0);\n    const end_index = find_comment(nodes, 'HTML_TAG_END', start_index);\n    if (start_index === end_index) {\n        return new HtmlTagHydration(undefined, is_svg);\n    }\n    init_claim_info(nodes);\n    const html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n    detach(html_tag_nodes[0]);\n    detach(html_tag_nodes[html_tag_nodes.length - 1]);\n    const claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n    for (const n of claimed_nodes) {\n        n.claim_order = nodes.claim_info.total_claimed;\n        nodes.claim_info.total_claimed += 1;\n    }\n    return new HtmlTagHydration(claimed_nodes, is_svg);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.data === data)\n        return;\n    text.data = data;\n}\nfunction set_data_contenteditable(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    text.data = data;\n}\nfunction set_data_maybe_contenteditable(text, data, attr_value) {\n    if (~contenteditable_truthy_values.indexOf(attr_value)) {\n        set_data_contenteditable(text, data);\n    }\n    else {\n        set_data(text, data);\n    }\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    if (value == null) {\n        node.style.removeProperty(key);\n    }\n    else {\n        node.style.setProperty(key, value, important ? 'important' : '');\n    }\n}\nfunction select_option(select, value, mounting) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n    if (!mounting || value !== undefined) {\n        select.selectedIndex = -1; // no option should be selected\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked');\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_iframe_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n        'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n            // make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n            // see https://github.com/sveltejs/svelte/issues/4233\n            fn();\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nconst resize_observer_content_box = /* @__PURE__ */ new ResizeObserverSingleton({ box: 'content-box' });\nconst resize_observer_border_box = /* @__PURE__ */ new ResizeObserverSingleton({ box: 'border-box' });\nconst resize_observer_device_pixel_content_box = /* @__PURE__ */ new ResizeObserverSingleton({ box: 'device-pixel-content-box' });\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, bubbles, cancelable, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nfunction head_selector(nodeId, head) {\n    const result = [];\n    let started = 0;\n    for (const node of head.childNodes) {\n        if (node.nodeType === 8 /* comment node */) {\n            const comment = node.textContent.trim();\n            if (comment === `HEAD_${nodeId}_END`) {\n                started -= 1;\n                result.push(node);\n            }\n            else if (comment === `HEAD_${nodeId}_START`) {\n                started += 1;\n                result.push(node);\n            }\n        }\n        else if (started > 0) {\n            result.push(node);\n        }\n    }\n    return result;\n}\nclass HtmlTag {\n    constructor(is_svg = false) {\n        this.is_svg = false;\n        this.is_svg = is_svg;\n        this.e = this.n = null;\n    }\n    c(html) {\n        this.h(html);\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            if (this.is_svg)\n                this.e = svg_element(target.nodeName);\n            /** #7364  target for <template> may be provided as #document-fragment(11) */\n            else\n                this.e = element((target.nodeType === 11 ? 'TEMPLATE' : target.nodeName));\n            this.t = target.tagName !== 'TEMPLATE' ? target : target.content;\n            this.c(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\nclass HtmlTagHydration extends HtmlTag {\n    constructor(claimed_nodes, is_svg = false) {\n        super(is_svg);\n        this.e = this.n = null;\n        this.l = claimed_nodes;\n    }\n    c(html) {\n        if (this.l) {\n            this.n = this.l;\n        }\n        else {\n            super.c(html);\n        }\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert_hydration(this.t, this.n[i], anchor);\n        }\n    }\n}\nfunction attribute_to_object(attributes) {\n    const result = {};\n    for (const attribute of attributes) {\n        result[attribute.name] = attribute.value;\n    }\n    return result;\n}\nfunction get_custom_elements_slots(element) {\n    const result = {};\n    element.childNodes.forEach((node) => {\n        result[node.slot || 'default'] = true;\n    });\n    return result;\n}\nfunction construct_svelte_component(component, props) {\n    return new component(props);\n}\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\nconst managed_styles = new Map();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_style_information(doc, node) {\n    const info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n    managed_styles.set(doc, info);\n    return info;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = get_root_for_style(node);\n    const { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n    if (!rules[name]) {\n        rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        managed_styles.forEach(info => {\n            const { ownerNode } = info.stylesheet;\n            // there is no ownerNode if it runs on jsdom.\n            if (ownerNode)\n                detach(ownerNode);\n        });\n        managed_styles.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs#run-time-svelte-beforeupdate\n */\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * `onMount` does not run inside a [server-side component](/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs#run-time-svelte-onmount\n */\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n */\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs#run-time-svelte-ondestroy\n */\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * https://svelte.dev/docs#run-time-svelte-createeventdispatcher\n */\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail, { cancelable = false } = {}) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail, { cancelable });\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n            return !event.defaultPrevented;\n        }\n        return true;\n    };\n}\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-setcontext\n */\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n    return context;\n}\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-getcontext\n */\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs#run-time-svelte-getallcontexts\n */\nfunction getAllContexts() {\n    return get_current_component().$$.context;\n}\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs#run-time-svelte-hascontext\n */\nfunction hasContext(key) {\n    return get_current_component().$$.context.has(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        // @ts-ignore\n        callbacks.slice().forEach(fn => fn.call(this, event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nlet render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\nlet flushidx = 0; // Do *not* move this inside the flush() function\nfunction flush() {\n    // Do not reenter flush while dirty components are updated, as this can\n    // result in an infinite loop. Instead, let the inner flush handle it.\n    // Reentrancy is ok afterwards for bindings etc.\n    if (flushidx !== 0) {\n        return;\n    }\n    const saved_component = current_component;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        try {\n            while (flushidx < dirty_components.length) {\n                const component = dirty_components[flushidx];\n                flushidx++;\n                set_current_component(component);\n                update(component.$$);\n            }\n        }\n        catch (e) {\n            // reset dirty state to not end up in a deadlocked state and then rethrow\n            dirty_components.length = 0;\n            flushidx = 0;\n            throw e;\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        flushidx = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    seen_callbacks.clear();\n    set_current_component(saved_component);\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n */\nfunction flush_render_callbacks(fns) {\n    const filtered = [];\n    const targets = [];\n    render_callbacks.forEach((c) => fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c));\n    targets.forEach((c) => c());\n    render_callbacks = filtered;\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n    else if (callback) {\n        callback();\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    const options = { direction: 'in' };\n    let config = fn(node, params, options);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            started = true;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config(options);\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    const options = { direction: 'out' };\n    let config = fn(node, params, options);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config(options);\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    const options = { direction: 'both' };\n    let config = fn(node, params, options);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = (program.b - t);\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config(options);\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            if (info.blocks[i] === block) {\n                                info.blocks[i] = null;\n                            }\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\nfunction update_await_block_branch(info, ctx, dirty) {\n    const child_ctx = ctx.slice();\n    const { resolved } = info;\n    if (info.current === info.then) {\n        child_ctx[info.value] = resolved;\n    }\n    if (info.current === info.catch) {\n        child_ctx[info.error] = resolved;\n    }\n    info.block.p(child_ctx, dirty);\n}\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    const updates = [];\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            // defer updates until all the DOM shuffling is done\n            updates.push(() => block.p(child_ctx, dirty));\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    run_all(updates);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error('Cannot have duplicate keys in a keyed each');\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\nconst _boolean_attributes = [\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'inert',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n];\n/**\n * List of HTML boolean attributes (e.g. `<input disabled>`).\n * Source: https://html.spec.whatwg.org/multipage/indices.html\n */\nconst boolean_attributes = new Set([..._boolean_attributes]);\n\n/** regex of all html void element names */\nconst void_element_names = /^(?:area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track|wbr)$/;\nfunction is_void(name) {\n    return void_element_names.test(name) || name.toLowerCase() === '!doctype';\n}\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, attrs_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (attrs_to_add) {\n        const classes_to_add = attrs_to_add.classes;\n        const styles_to_add = attrs_to_add.styles;\n        if (classes_to_add) {\n            if (attributes.class == null) {\n                attributes.class = classes_to_add;\n            }\n            else {\n                attributes.class += ' ' + classes_to_add;\n            }\n        }\n        if (styles_to_add) {\n            if (attributes.style == null) {\n                attributes.style = style_object_to_string(styles_to_add);\n            }\n            else {\n                attributes.style = style_object_to_string(merge_ssr_styles(attributes.style, styles_to_add));\n            }\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += ' ' + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += ' ' + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${value}\"`;\n        }\n    });\n    return str;\n}\nfunction merge_ssr_styles(style_attribute, style_directive) {\n    const style_object = {};\n    for (const individual_style of style_attribute.split(';')) {\n        const colon_index = individual_style.indexOf(':');\n        const name = individual_style.slice(0, colon_index).trim();\n        const value = individual_style.slice(colon_index + 1).trim();\n        if (!name)\n            continue;\n        style_object[name] = value;\n    }\n    for (const name in style_directive) {\n        const value = style_directive[name];\n        if (value) {\n            style_object[name] = value;\n        }\n        else {\n            delete style_object[name];\n        }\n    }\n    return style_object;\n}\nconst ATTR_REGEX = /[&\"]/g;\nconst CONTENT_REGEX = /[&<]/g;\n/**\n * Note: this method is performance sensitive and has been optimized\n * https://github.com/sveltejs/svelte/pull/5701\n */\nfunction escape(value, is_attr = false) {\n    const str = String(value);\n    const pattern = is_attr ? ATTR_REGEX : CONTENT_REGEX;\n    pattern.lastIndex = 0;\n    let escaped = '';\n    let last = 0;\n    while (pattern.test(str)) {\n        const i = pattern.lastIndex - 1;\n        const ch = str[i];\n        escaped += str.substring(last, i) + (ch === '&' ? '&amp;' : (ch === '\"' ? '&quot;' : '&lt;'));\n        last = i + 1;\n    }\n    return escaped + str.substring(last);\n}\nfunction escape_attribute_value(value) {\n    // keep booleans, null, and undefined for the sake of `spread`\n    const should_escape = typeof value === 'string' || (value && typeof value === 'object');\n    return should_escape ? escape(value, true) : value;\n}\nfunction escape_object(obj) {\n    const result = {};\n    for (const key in obj) {\n        result[key] = escape_attribute_value(obj[key]);\n    }\n    return result;\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules. Otherwise you may need to fix a <${name}>.`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots, context) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(context || (parent_component ? parent_component.$$.context : [])),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, { $$slots = {}, context = new Map() } = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, $$slots, context);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    const assignment = (boolean && value === true) ? '' : `=\"${escape(value, true)}\"`;\n    return ` ${name}${assignment}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : '';\n}\nfunction style_object_to_string(style_object) {\n    return Object.keys(style_object)\n        .filter(key => style_object[key])\n        .map(key => `${key}: ${escape_attribute_value(style_object[key])};`)\n        .join(' ');\n}\nfunction add_styles(style_object) {\n    const styles = style_object_to_string(style_object);\n    return styles ? ` style=\"${styles}\"` : '';\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor, customElement) {\n    const { fragment, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    if (!customElement) {\n        // onMount happens before the initial afterUpdate\n        add_render_callback(() => {\n            const new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n            // if the component was destroyed immediately\n            // it will update the `$$.on_destroy` reference to `null`.\n            // the destructured on_destroy may still reference to the old array\n            if (component.$$.on_destroy) {\n                component.$$.on_destroy.push(...new_on_destroy);\n            }\n            else {\n                // Edge case - component was destroyed immediately,\n                // most likely as a result of a binding initialising\n                run_all(new_on_destroy);\n            }\n            component.$$.on_mount = [];\n        });\n    }\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        flush_render_callbacks($$.after_update);\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, append_styles, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: [],\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        on_disconnect: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false,\n        root: options.target || parent_component.$$.root\n    };\n    append_styles && append_styles($$.root);\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, options.props || {}, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            start_hydrating();\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor, options.customElement);\n        end_hydrating();\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            const { on_mount } = this.$$;\n            this.$$.on_disconnect = on_mount.map(run).filter(is_function);\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        disconnectedCallback() {\n            run_all(this.$$.on_disconnect);\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            if (!is_function(callback)) {\n                return noop;\n            }\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\n/**\n * Base class for Svelte components. Used when dev=false.\n */\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        if (!is_function(callback)) {\n            return noop;\n        }\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.59.2' }, detail), { bubbles: true }));\n}\nfunction append_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append(target, node);\n}\nfunction append_hydration_dev(target, node) {\n    dispatch_dev('SvelteDOMInsert', { target, node });\n    append_hydration(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction insert_hydration_dev(target, node, anchor) {\n    dispatch_dev('SvelteDOMInsert', { target, node, anchor });\n    insert_hydration(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev('SvelteDOMRemove', { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation, has_stop_immediate_propagation) {\n    const modifiers = options === true ? ['capture'] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    if (has_stop_immediate_propagation)\n        modifiers.push('stopImmediatePropagation');\n    dispatch_dev('SvelteDOMAddEventListener', { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev('SvelteDOMRemoveEventListener', { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev('SvelteDOMRemoveAttribute', { node, attribute });\n    else\n        dispatch_dev('SvelteDOMSetAttribute', { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev('SvelteDOMSetProperty', { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev('SvelteDOMSetDataset', { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.data === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction set_data_contenteditable_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev('SvelteDOMSetData', { node: text, data });\n    text.data = data;\n}\nfunction set_data_maybe_contenteditable_dev(text, data, attr_value) {\n    if (~contenteditable_truthy_values.indexOf(attr_value)) {\n        set_data_contenteditable_dev(text, data);\n    }\n    else {\n        set_data_dev(text, data);\n    }\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\nfunction validate_dynamic_element(tag) {\n    const is_string = typeof tag === 'string';\n    if (tag && !is_string) {\n        throw new Error('<svelte:element> expects \"this\" attribute to be a string.');\n    }\n}\nfunction validate_void_dynamic_element(tag) {\n    if (tag && is_void(tag)) {\n        console.warn(`<svelte:element this=\"${tag}\"> is self-closing and cannot have content.`);\n    }\n}\nfunction construct_svelte_component_dev(component, props) {\n    const error_message = 'this={...} of <svelte:component> should specify a Svelte component.';\n    try {\n        const instance = new component(props);\n        if (!instance.$$ || !instance.$set || !instance.$on || !instance.$destroy) {\n            throw new Error(error_message);\n        }\n        return instance;\n    }\n    catch (err) {\n        const { message } = err;\n        if (typeof message === 'string' && message.indexOf('is not a constructor') !== -1) {\n            throw new Error(error_message);\n        }\n        else {\n            throw err;\n        }\n    }\n}\n/**\n * Base class for Svelte components with some minor dev-enhancements. Used when dev=true.\n */\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(\"'target' is a required option\");\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn('Component was already destroyed'); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\n/**\n * Base class to create strongly typed Svelte components.\n * This only exists for typing purposes and should be used in `.d.ts` files.\n *\n * ### Example:\n *\n * You have component library on npm called `component-library`, from which\n * you export a component called `MyComponent`. For Svelte+TypeScript users,\n * you want to provide typings. Therefore you create a `index.d.ts`:\n * ```ts\n * import { SvelteComponentTyped } from \"svelte\";\n * export class MyComponent extends SvelteComponentTyped<{foo: string}> {}\n * ```\n * Typing this makes it possible for IDEs like VS Code with the Svelte extension\n * to provide intellisense and to use the component like this in a Svelte file\n * with TypeScript:\n * ```svelte\n * <script lang=\"ts\">\n * \timport { MyComponent } from \"component-library\";\n * </script>\n * <MyComponent foo={'bar'} />\n * ```\n *\n * #### Why not make this part of `SvelteComponent(Dev)`?\n * Because\n * ```ts\n * class ASubclassOfSvelteComponent extends SvelteComponent<{foo: string}> {}\n * const component: typeof SvelteComponent = ASubclassOfSvelteComponent;\n * ```\n * will throw a type error, so we need to separate the more strictly typed class.\n */\nclass SvelteComponentTyped extends SvelteComponentDev {\n    constructor(options) {\n        super(options);\n    }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error('Infinite loop detected');\n        }\n    };\n}\n\nexport { HtmlTag, HtmlTagHydration, ResizeObserverSingleton, SvelteComponent, SvelteComponentDev, SvelteComponentTyped, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_iframe_resize_listener, add_location, add_render_callback, add_styles, add_transform, afterUpdate, append, append_dev, append_empty_stylesheet, append_hydration, append_hydration_dev, append_styles, assign, attr, attr_dev, attribute_to_object, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_comment, claim_component, claim_element, claim_html_tag, claim_space, claim_svg_element, claim_text, clear_loops, comment, component_subscribe, compute_rest_props, compute_slots, construct_svelte_component, construct_svelte_component_dev, contenteditable_truthy_values, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, end_hydrating, escape, escape_attribute_value, escape_object, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, flush_render_callbacks, getAllContexts, getContext, get_all_dirty_from_scope, get_binding_group_value, get_current_component, get_custom_elements_slots, get_root_for_style, get_slot_changes, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, hasContext, has_prop, head_selector, identity, init, init_binding_group, init_binding_group_dynamic, insert, insert_dev, insert_hydration, insert_hydration_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, is_void, listen, listen_dev, loop, loop_guard, merge_ssr_styles, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, resize_observer_border_box, resize_observer_content_box, resize_observer_device_pixel_content_box, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_custom_element_data_map, set_data, set_data_contenteditable, set_data_contenteditable_dev, set_data_dev, set_data_maybe_contenteditable, set_data_maybe_contenteditable_dev, set_dynamic_element_data, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, split_css_unit, spread, src_url_equal, start_hydrating, stop_immediate_propagation, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, trusted, update_await_block_branch, update_keyed_each, update_slot, update_slot_base, validate_component, validate_dynamic_element, validate_each_argument, validate_each_keys, validate_slots, validate_store, validate_void_dynamic_element, xlink_attr };\n","import { getContext } from \"svelte\";\n\nexport const LOCATION = {};\nexport const ROUTER = {};\nexport const HISTORY = {};\n\nexport const useLocation = () => getContext(LOCATION);\nexport const useRouter = () => getContext(ROUTER);\nexport const useHistory = () => getContext(HISTORY);\n","/**\n * Adapted from https://github.com/reach/router/blob/b60e6dd781d5d3a4bdaaf4de665649c0f6a7e78d/src/lib/utils.js\n * https://github.com/reach/router/blob/master/LICENSE\n */\n\nconst PARAM = /^:(.+)/;\nconst SEGMENT_POINTS = 4;\nconst STATIC_POINTS = 3;\nconst DYNAMIC_POINTS = 2;\nconst SPLAT_PENALTY = 1;\nconst ROOT_POINTS = 1;\n\n/**\n * Split up the URI into segments delimited by `/`\n * Strip starting/ending `/`\n * @param {string} uri\n * @return {string[]}\n */\nconst segmentize = (uri) => uri.replace(/(^\\/+|\\/+$)/g, \"\").split(\"/\");\n/**\n * Strip `str` of potential start and end `/`\n * @param {string} string\n * @return {string}\n */\nconst stripSlashes = (string) => string.replace(/(^\\/+|\\/+$)/g, \"\");\n/**\n * Score a route depending on how its individual segments look\n * @param {object} route\n * @param {number} index\n * @return {object}\n */\nconst rankRoute = (route, index) => {\n    const score = route.default\n        ? 0\n        : segmentize(route.path).reduce((score, segment) => {\n              score += SEGMENT_POINTS;\n\n              if (segment === \"\") {\n                  score += ROOT_POINTS;\n              } else if (PARAM.test(segment)) {\n                  score += DYNAMIC_POINTS;\n              } else if (segment[0] === \"*\") {\n                  score -= SEGMENT_POINTS + SPLAT_PENALTY;\n              } else {\n                  score += STATIC_POINTS;\n              }\n\n              return score;\n          }, 0);\n\n    return { route, score, index };\n};\n/**\n * Give a score to all routes and sort them on that\n * If two routes have the exact same score, we go by index instead\n * @param {object[]} routes\n * @return {object[]}\n */\nconst rankRoutes = (routes) =>\n    routes\n        .map(rankRoute)\n        .sort((a, b) =>\n            a.score < b.score ? 1 : a.score > b.score ? -1 : a.index - b.index\n        );\n/**\n * Ranks and picks the best route to match. Each segment gets the highest\n * amount of points, then the type of segment gets an additional amount of\n * points where\n *\n *  static > dynamic > splat > root\n *\n * This way we don't have to worry about the order of our routes, let the\n * computers do it.\n *\n * A route looks like this\n *\n *  { path, default, value }\n *\n * And a returned match looks like:\n *\n *  { route, params, uri }\n *\n * @param {object[]} routes\n * @param {string} uri\n * @return {?object}\n */\nconst pick = (routes, uri) => {\n    let match;\n    let default_;\n\n    const [uriPathname] = uri.split(\"?\");\n    const uriSegments = segmentize(uriPathname);\n    const isRootUri = uriSegments[0] === \"\";\n    const ranked = rankRoutes(routes);\n\n    for (let i = 0, l = ranked.length; i < l; i++) {\n        const route = ranked[i].route;\n        let missed = false;\n\n        if (route.default) {\n            default_ = {\n                route,\n                params: {},\n                uri,\n            };\n            continue;\n        }\n\n        const routeSegments = segmentize(route.path);\n        const params = {};\n        const max = Math.max(uriSegments.length, routeSegments.length);\n        let index = 0;\n\n        for (; index < max; index++) {\n            const routeSegment = routeSegments[index];\n            const uriSegment = uriSegments[index];\n\n            if (routeSegment && routeSegment[0] === \"*\") {\n                // Hit a splat, just grab the rest, and return a match\n                // uri:   /files/documents/work\n                // route: /files/* or /files/*splatname\n                const splatName =\n                    routeSegment === \"*\" ? \"*\" : routeSegment.slice(1);\n\n                params[splatName] = uriSegments\n                    .slice(index)\n                    .map(decodeURIComponent)\n                    .join(\"/\");\n                break;\n            }\n\n            if (typeof uriSegment === \"undefined\") {\n                // URI is shorter than the route, no match\n                // uri:   /users\n                // route: /users/:userId\n                missed = true;\n                break;\n            }\n\n            const dynamicMatch = PARAM.exec(routeSegment);\n\n            if (dynamicMatch && !isRootUri) {\n                const value = decodeURIComponent(uriSegment);\n                params[dynamicMatch[1]] = value;\n            } else if (routeSegment !== uriSegment) {\n                // Current segments don't match, not dynamic, not splat, so no match\n                // uri:   /users/123/settings\n                // route: /users/:id/profile\n                missed = true;\n                break;\n            }\n        }\n\n        if (!missed) {\n            match = {\n                route,\n                params,\n                uri: \"/\" + uriSegments.slice(0, index).join(\"/\"),\n            };\n            break;\n        }\n    }\n\n    return match || default_ || null;\n};\n/**\n * Add the query to the pathname if a query is given\n * @param {string} pathname\n * @param {string} [query]\n * @return {string}\n */\nconst addQuery = (pathname, query) => pathname + (query ? `?${query}` : \"\");\n/**\n * Resolve URIs as though every path is a directory, no files. Relative URIs\n * in the browser can feel awkward because not only can you be \"in a directory\",\n * you can be \"at a file\", too. For example:\n *\n *  browserSpecResolve('foo', '/bar/') => /bar/foo\n *  browserSpecResolve('foo', '/bar') => /foo\n *\n * But on the command line of a file system, it's not as complicated. You can't\n * `cd` from a file, only directories. This way, links have to know less about\n * their current path. To go deeper you can do this:\n *\n *  <Link to=\"deeper\"/>\n *  // instead of\n *  <Link to=`{${props.uri}/deeper}`/>\n *\n * Just like `cd`, if you want to go deeper from the command line, you do this:\n *\n *  cd deeper\n *  # not\n *  cd $(pwd)/deeper\n *\n * By treating every path as a directory, linking to relative paths should\n * require less contextual information and (fingers crossed) be more intuitive.\n * @param {string} to\n * @param {string} base\n * @return {string}\n */\nconst resolve = (to, base) => {\n    // /foo/bar, /baz/qux => /foo/bar\n    if (to.startsWith(\"/\")) return to;\n\n    const [toPathname, toQuery] = to.split(\"?\");\n    const [basePathname] = base.split(\"?\");\n    const toSegments = segmentize(toPathname);\n    const baseSegments = segmentize(basePathname);\n\n    // ?a=b, /users?b=c => /users?a=b\n    if (toSegments[0] === \"\") return addQuery(basePathname, toQuery);\n\n    // profile, /users/789 => /users/789/profile\n\n    if (!toSegments[0].startsWith(\".\")) {\n        const pathname = baseSegments.concat(toSegments).join(\"/\");\n        return addQuery((basePathname === \"/\" ? \"\" : \"/\") + pathname, toQuery);\n    }\n\n    // ./       , /users/123 => /users/123\n    // ../      , /users/123 => /users\n    // ../..    , /users/123 => /\n    // ../../one, /a/b/c/d   => /a/b/one\n    // .././one , /a/b/c/d   => /a/b/c/one\n    const allSegments = baseSegments.concat(toSegments);\n    const segments = [];\n\n    allSegments.forEach((segment) => {\n        if (segment === \"..\") segments.pop();\n        else if (segment !== \".\") segments.push(segment);\n    });\n\n    return addQuery(\"/\" + segments.join(\"/\"), toQuery);\n};\n/**\n * Combines the `basepath` and the `path` into one path.\n * @param {string} basepath\n * @param {string} path\n */\nconst combinePaths = (basepath, path) =>\n    `${stripSlashes(\n        path === \"/\"\n            ? basepath\n            : `${stripSlashes(basepath)}/${stripSlashes(path)}`\n    )}/`;\n/**\n * Decides whether a given `event` should result in a navigation or not.\n * @param {object} event\n */\nconst shouldNavigate = (event) =>\n    !event.defaultPrevented &&\n    event.button === 0 &&\n    !(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n\n// svelte seems to kill anchor.host value in ie11, so fall back to checking href\nconst hostMatches = (anchor) => {\n    const host = location.host;\n    return (\n        anchor.host === host ||\n        anchor.href.indexOf(`https://${host}`) === 0 ||\n        anchor.href.indexOf(`http://${host}`) === 0\n    );\n};\n\nconst canUseDOM = () =>\n    typeof window !== \"undefined\" &&\n    \"document\" in window &&\n    \"location\" in window;\n\nexport {\n    stripSlashes,\n    pick,\n    resolve,\n    combinePaths,\n    shouldNavigate,\n    hostMatches,\n    canUseDOM,\n};\n","<script>\n    import { getContext, onDestroy } from \"svelte\";\n    import { ROUTER } from \"./contexts.js\";\n    import { canUseDOM } from \"./utils.js\";\n\n    export let path = \"\";\n    export let component = null;\n\n    let routeParams = {};\n    let routeProps = {};\n\n    const { registerRoute, unregisterRoute, activeRoute } = getContext(ROUTER);\n\n    const route = {\n        path,\n        // If no path prop is given, this Route will act as the default Route\n        // that is rendered if no other Route in the Router is a match.\n        default: path === \"\",\n    };\n\n    $: if ($activeRoute && $activeRoute.route === route) {\n        routeParams = $activeRoute.params;\n\n        const { component: c, path, ...rest } = $$props;\n        routeProps = rest;\n\n        if (c) {\n            if (c.toString().startsWith(\"class \")) component = c;\n            else component = c();\n        }\n\n        canUseDOM() && !$activeRoute.preserveScroll && window?.scrollTo(0, 0);\n    }\n\n    registerRoute(route);\n\n    onDestroy(() => {\n        unregisterRoute(route);\n    });\n</script>\n\n{#if $activeRoute && $activeRoute.route === route}\n    {#if component}\n        {#await component then resolvedComponent}\n            <svelte:component\n                this={resolvedComponent?.default || resolvedComponent}\n                {...routeParams}\n                {...routeProps}\n            />\n        {/await}\n    {:else}\n        <slot params={routeParams} />\n    {/if}\n{/if}\n","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal/index.mjs';\nexport { get_store_value as get } from '../internal/index.mjs';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier} [start]\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=} start\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = new Set();\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (const subscriber of subscribers) {\n                    subscriber[1]();\n                    subscriber_queue.push(subscriber, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.add(subscriber);\n        if (subscribers.size === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            subscribers.delete(subscriber);\n            if (subscribers.size === 0 && stop) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let started = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (started) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        started = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n            // We need to set this to false because callbacks can still happen despite having unsubscribed:\n            // Callbacks might already be placed in the queue which doesn't know it should no longer\n            // invoke this derived store.\n            started = false;\n        };\n    });\n}\n/**\n * Takes a store and returns a new one derived from the old one that is readable.\n *\n * @param store - store to make readonly\n */\nfunction readonly(store) {\n    return {\n        subscribe: store.subscribe.bind(store)\n    };\n}\n\nexport { derived, readable, readonly, writable };\n","/**\n * Adapted from https://github.com/reach/router/blob/b60e6dd781d5d3a4bdaaf4de665649c0f6a7e78d/src/lib/history.js\n * https://github.com/reach/router/blob/master/LICENSE\n */\nimport { canUseDOM } from \"./utils\";\n\nconst getLocation = (source) => {\n    return {\n        ...source.location,\n        state: source.history.state,\n        key: (source.history.state && source.history.state.key) || \"initial\",\n    };\n};\nconst createHistory = (source) => {\n    const listeners = [];\n    let location = getLocation(source);\n\n    return {\n        get location() {\n            return location;\n        },\n\n        listen(listener) {\n            listeners.push(listener);\n\n            const popstateListener = () => {\n                location = getLocation(source);\n                listener({ location, action: \"POP\" });\n            };\n\n            source.addEventListener(\"popstate\", popstateListener);\n\n            return () => {\n                source.removeEventListener(\"popstate\", popstateListener);\n                const index = listeners.indexOf(listener);\n                listeners.splice(index, 1);\n            };\n        },\n\n        navigate(to, { state, replace = false, preserveScroll = false, blurActiveElement = true } = {}) {\n            state = { ...state, key: Date.now() + \"\" };\n            // try...catch iOS Safari limits to 100 pushState calls\n            try {\n                if (replace) source.history.replaceState(state, \"\", to);\n                else source.history.pushState(state, \"\", to);\n            } catch (e) {\n                source.location[replace ? \"replace\" : \"assign\"](to);\n            }\n            location = getLocation(source);\n            listeners.forEach((listener) =>\n                listener({ location, action: \"PUSH\", preserveScroll })\n            );\n            if(blurActiveElement) document.activeElement.blur();\n        },\n    };\n};\n// Stores history entries in memory for testing or other platforms like Native\nconst createMemorySource = (initialPathname = \"/\") => {\n    let index = 0;\n    const stack = [{ pathname: initialPathname, search: \"\" }];\n    const states = [];\n\n    return {\n        get location() {\n            return stack[index];\n        },\n        addEventListener(name, fn) {},\n        removeEventListener(name, fn) {},\n        history: {\n            get entries() {\n                return stack;\n            },\n            get index() {\n                return index;\n            },\n            get state() {\n                return states[index];\n            },\n            pushState(state, _, uri) {\n                const [pathname, search = \"\"] = uri.split(\"?\");\n                index++;\n                stack.push({ pathname, search });\n                states.push(state);\n            },\n            replaceState(state, _, uri) {\n                const [pathname, search = \"\"] = uri.split(\"?\");\n                stack[index] = { pathname, search };\n                states[index] = state;\n            },\n        },\n    };\n};\n// Global history uses window.history as the source if available,\n// otherwise a memory history\nconst globalHistory = createHistory(\n    canUseDOM() ? window : createMemorySource()\n);\nconst { navigate } = globalHistory;\n\nexport { globalHistory, navigate, createHistory, createMemorySource };\n","<script>\n    import { getContext, onMount, setContext } from \"svelte\";\n    import { derived, writable } from \"svelte/store\";\n    import { HISTORY, LOCATION, ROUTER } from \"./contexts.js\";\n    import { globalHistory } from \"./history.js\";\n    import { combinePaths, pick } from \"./utils.js\";\n\n    export let basepath = \"/\";\n    export let url = null;\n    export let viewtransition = null;\n    export let history = globalHistory;\n\n    const viewtransitionFn = (node, _, direction) => {\n        const vt = viewtransition(direction);\n        if (typeof vt?.fn === \"function\") return vt.fn(node, vt);\n        else return vt;\n    };\n\n    setContext(HISTORY, history);\n\n    const locationContext = getContext(LOCATION);\n    const routerContext = getContext(ROUTER);\n\n    const routes = writable([]);\n    const activeRoute = writable(null);\n    let hasActiveRoute = false; // Used in SSR to synchronously set that a Route is active.\n\n    // If locationContext is not set, this is the topmost Router in the tree.\n    // If the `url` prop is given we force the location to it.\n    const location =\n        locationContext || writable(url ? { pathname: url } : history.location);\n\n    // If routerContext is set, the routerBase of the parent Router\n    // will be the base for this Router's descendants.\n    // If routerContext is not set, the path and resolved uri will both\n    // have the value of the basepath prop.\n    const base = routerContext\n        ? routerContext.routerBase\n        : writable({\n              path: basepath,\n              uri: basepath,\n          });\n\n    const routerBase = derived([base, activeRoute], ([base, activeRoute]) => {\n        // If there is no activeRoute, the routerBase will be identical to the base.\n        if (!activeRoute) return base;\n\n        const { path: basepath } = base;\n        const { route, uri } = activeRoute;\n        // Remove the potential /* or /*splatname from\n        // the end of the child Routes relative paths.\n        const path = route.default ? basepath : route.path.replace(/\\*.*$/, \"\");\n        return { path, uri };\n    });\n\n    const registerRoute = (route) => {\n        const { path: basepath } = $base;\n        let { path } = route;\n\n        // We store the original path in the _path property so we can reuse\n        // it when the basepath changes. The only thing that matters is that\n        // the route reference is intact, so mutation is fine.\n        route._path = path;\n        route.path = combinePaths(basepath, path);\n\n        if (typeof window === \"undefined\") {\n            // In SSR we should set the activeRoute immediately if it is a match.\n            // If there are more Routes being registered after a match is found,\n            // we just skip them.\n            if (hasActiveRoute) return;\n\n            const matchingRoute = pick([route], $location.pathname);\n\n            if (matchingRoute) {\n                activeRoute.set(matchingRoute);\n                hasActiveRoute = true;\n            }\n        } else {\n            routes.update((rs) => [...rs, route]);\n        }\n    };\n\n    const unregisterRoute = (route) => {\n        routes.update((rs) => rs.filter((r) => r !== route));\n    };\n\n    let preserveScroll = false;\n\n    // This reactive statement will update all the Routes' path when\n    // the basepath changes.\n    $: {\n        const { path: basepath } = $base;\n        routes.update((rs) =>\n            rs.map((r) =>\n                Object.assign(r, { path: combinePaths(basepath, r._path) })\n            )\n        );\n    }\n    // This reactive statement will be run when the Router is created\n    // when there are no Routes and then again the following tick, so it\n    // will not find an active Route in SSR and in the browser it will only\n    // pick an active Route after all Routes have been registered.\n    $: {\n        const bestMatch = pick($routes, $location.pathname);\n        activeRoute.set(\n            bestMatch ? { ...bestMatch, preserveScroll } : bestMatch\n        );\n    }\n\n    if (!locationContext) {\n        // The topmost Router in the tree is responsible for updating\n        // the location store and supplying it through context.\n        onMount(() => {\n            const unlisten = history.listen((event) => {\n                preserveScroll = event.preserveScroll || false;\n                location.set(event.location);\n            });\n\n            return unlisten;\n        });\n\n        setContext(LOCATION, location);\n    }\n\n    setContext(ROUTER, {\n        activeRoute,\n        base,\n        routerBase,\n        registerRoute,\n        unregisterRoute,\n    });\n</script>\n\n{#if viewtransition}\n    {#key $location.pathname}\n        <div in:viewtransitionFn out:viewtransitionFn>\n            <slot\n                route={$activeRoute && $activeRoute.uri}\n                location={$location}\n            />\n        </div>\n    {/key}\n{:else}\n    <slot route={$activeRoute && $activeRoute.uri} location={$location} />\n{/if}\n","// eventsStore.js\r\n\r\nimport { writable } from 'svelte/store';\r\n\r\n// Define and export the eventsStore\r\nexport const eventsStore = writable([]);\r\n\r\n// Export a function to access the events data\r\nexport function getEvents() {\r\n    return eventsStore;\r\n}\r\n","<script>\r\n\r\n import { getEvents } from '../utils/eventsStore';\r\n\r\n const eventsStore = getEvents();\r\n\r\n let profilePicture;\r\n\r\n\r\n\r\n let unsubscribe = eventsStore.subscribe(value => {if (value.length > 0) {\r\n\r\n            const content = JSON.parse(value[0].content);\r\n\r\n            profilePicture = content.picture;\r\n        }\r\n\r\n });\r\n\r\n </script>\r\n\r\n<html>\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, user-scalable=no\">\r\n    <title>ZAPLAN</title>\r\n    <!-- Roboto font embed -->\r\n    <link href=\"https://fonts.googleapis.com/css?family=Roboto:400,500,700\" rel=\"stylesheet\">\r\n    <!-- Stylesheets -->\r\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"/css/reset.min.css\">\r\n    <link rel=\"stylesheet\" type=\"text/css\" href=\"/css/style.css\">\r\n</head>\r\n<body>\r\n    <header>\r\n        <div class=\"header\">\r\n            <div>\r\n                <img class=\"js-profile-element\" id=\"pPicture\" src={profilePicture}>\r\n            </div>\r\n            <div>\r\n                <input type=\"text\" placeholder=\"Enter an activity..\" id=\"item\">\r\n            </div>\r\n            <div>\r\n                <button id=\"add\" class=\"add-todo-button\">\r\n                    <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\" viewBox=\"0 0 16 16\" style=\"enable-background:new 0 0 16 16;\" xml:space=\"preserve\">\r\n                        <g>\r\n                            <path class=\"fill\" d=\"M16,8c0,0.5-0.5,1-1,1H9v6c0,0.5-0.5,1-1,1s-1-0.5-1-1V9H1C0.5,9,0,8.5,0,8s0.5-1,1-1h6V1c0-0.5,0.5-1,1-1s1,0.5,1,1v6h6C15.5,7,16,7.5,16,8z\"/>\r\n                        </g>\r\n                    </svg>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </header>\r\n\r\n    <div class=\"container\">\r\n        <!-- Uncompleted tasks -->\r\n        <ul class=\"todo\" id=\"todo\"></ul>\r\n        <!-- Completed tasks -->\r\n        <ul class=\"todo\" id=\"completed\"></ul>\r\n    </div>\r\n\r\n    <!-- JavaScripts -->\r\n    <script type=\"module\" src=\"/js/main.js\"></script>\r\n</body>\r\n</html>\r\n","<script>\r\n  // Import the necessary components\r\n  import { Router, Route } from 'svelte-routing';\r\n  import TodoPage from './routes/TodoPage.svelte'\r\n\r\n\r\n  // Define the Login component\r\n  export let Login;\r\n</script>\r\n\r\n<Router>\r\n  <!-- Wrap your entire application with the Router -->\r\n  <main>\r\n    <!-- Define your routes -->\r\n    <Route path=\"/\" component={Login} />\r\n    <Route path=\"/todoPage\" component={TodoPage} />\r\n  </main>\r\n</Router>\r\n\r\n<style>\r\n  /* Your styles here */\r\n</style>\r\n","export function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nexport function bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\nexport function bytes(b, ...lengths) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nexport function hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nexport function exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nexport function output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nconst assert = {\n    number,\n    bool,\n    bytes,\n    hash,\n    exists,\n    output,\n};\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated, we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\n// Check if object doens't have custom constructor (like Uint8Array/Array)\nconst isPlainObject = (obj) => Object.prototype.toString.call(obj) === '[object Object]' && obj.constructor === Object;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && (typeof opts !== 'object' || !isPlainObject(opts)))\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import assert from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        assert.exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = wrapConstructor(() => new SHA256());\nexport const sha224 = wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// 100 lines of code in the file are duplicated from noble-hashes (utils).\n// This is OK: `abstract` directory does not use noble-hashes.\n// User may opt-in into using different hashing library. This way, noble-hashes\n// won't be included into their bundle.\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst u8a = (a) => a instanceof Uint8Array;\nconst hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\nexport function numberToHexUnpadded(num) {\n    const hex = num.toString(16);\n    return hex.length & 1 ? `0${hex}` : hex;\n}\nexport function hexToNumber(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // Big Endian\n    return BigInt(hex === '' ? '0' : `0x${hex}`);\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nexport function bytesToNumberLE(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    return hexToNumber(bytesToHex(Uint8Array.from(bytes).reverse()));\n}\nexport function numberToBytesBE(n, len) {\n    return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\nexport function numberToBytesLE(n, len) {\n    return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nexport function numberToVarBytesBE(n) {\n    return hexToBytes(numberToHexUnpadded(n));\n}\n/**\n * Takes hex string or Uint8Array, converts to Uint8Array.\n * Validates output length.\n * Will throw error for other types.\n * @param title descriptive title for an error e.g. 'private key'\n * @param hex hex string or Uint8Array\n * @param expectedLength optional, will compare to result array's length\n * @returns\n */\nexport function ensureBytes(title, hex, expectedLength) {\n    let res;\n    if (typeof hex === 'string') {\n        try {\n            res = hexToBytes(hex);\n        }\n        catch (e) {\n            throw new Error(`${title} must be valid hex string, got \"${hex}\". Cause: ${e}`);\n        }\n    }\n    else if (u8a(hex)) {\n        // Uint8Array.from() instead of hash.slice() because node.js Buffer\n        // is instance of Uint8Array, and its slice() creates **mutable** copy\n        res = Uint8Array.from(hex);\n    }\n    else {\n        throw new Error(`${title} must be hex string or Uint8Array`);\n    }\n    const len = res.length;\n    if (typeof expectedLength === 'number' && len !== expectedLength)\n        throw new Error(`${title} expected ${expectedLength} bytes, got ${len}`);\n    return res;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\nexport function equalBytes(b1, b2) {\n    // We don't care about timing attacks here\n    if (b1.length !== b2.length)\n        return false;\n    for (let i = 0; i < b1.length; i++)\n        if (b1[i] !== b2[i])\n            return false;\n    return true;\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n// Bit operations\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n */\nexport function bitLen(n) {\n    let len;\n    for (len = 0; n > _0n; n >>= _1n, len += 1)\n        ;\n    return len;\n}\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nexport function bitGet(n, pos) {\n    return (n >> BigInt(pos)) & _1n;\n}\n/**\n * Sets single bit at position.\n */\nexport const bitSet = (n, pos, value) => {\n    return n | ((value ? _1n : _0n) << BigInt(pos));\n};\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nexport const bitMask = (n) => (_2n << BigInt(n - 1)) - _1n;\n// DRBG\nconst u8n = (data) => new Uint8Array(data); // creates Uint8Array\nconst u8fr = (arr) => Uint8Array.from(arr); // another shortcut\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nexport function createHmacDrbg(hashLen, qByteLen, hmacFn) {\n    if (typeof hashLen !== 'number' || hashLen < 2)\n        throw new Error('hashLen must be a number');\n    if (typeof qByteLen !== 'number' || qByteLen < 2)\n        throw new Error('qByteLen must be a number');\n    if (typeof hmacFn !== 'function')\n        throw new Error('hmacFn must be a function');\n    // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n    let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n    let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n    let i = 0; // Iterations counter, will throw when over 1000\n    const reset = () => {\n        v.fill(1);\n        k.fill(0);\n        i = 0;\n    };\n    const h = (...b) => hmacFn(k, v, ...b); // hmac(k)(v, ...values)\n    const reseed = (seed = u8n()) => {\n        // HMAC-DRBG reseed() function. Steps D-G\n        k = h(u8fr([0x00]), seed); // k = hmac(k || v || 0x00 || seed)\n        v = h(); // v = hmac(k || v)\n        if (seed.length === 0)\n            return;\n        k = h(u8fr([0x01]), seed); // k = hmac(k || v || 0x01 || seed)\n        v = h(); // v = hmac(k || v)\n    };\n    const gen = () => {\n        // HMAC-DRBG generate() function\n        if (i++ >= 1000)\n            throw new Error('drbg: tried 1000 values');\n        let len = 0;\n        const out = [];\n        while (len < qByteLen) {\n            v = h();\n            const sl = v.slice();\n            out.push(sl);\n            len += v.length;\n        }\n        return concatBytes(...out);\n    };\n    const genUntil = (seed, pred) => {\n        reset();\n        reseed(seed); // Steps D-G\n        let res = undefined; // Step H: grind until k is in [1..n-1]\n        while (!(res = pred(gen())))\n            reseed();\n        reset();\n        return res;\n    };\n    return genUntil;\n}\n// Validating curves and fields\nconst validatorFns = {\n    bigint: (val) => typeof val === 'bigint',\n    function: (val) => typeof val === 'function',\n    boolean: (val) => typeof val === 'boolean',\n    string: (val) => typeof val === 'string',\n    isSafeInteger: (val) => Number.isSafeInteger(val),\n    array: (val) => Array.isArray(val),\n    field: (val, object) => object.Fp.isValid(val),\n    hash: (val) => typeof val === 'function' && Number.isSafeInteger(val.outputLen),\n};\n// type Record<K extends string | number | symbol, T> = { [P in K]: T; }\nexport function validateObject(object, validators, optValidators = {}) {\n    const checkField = (fieldName, type, isOptional) => {\n        const checkVal = validatorFns[type];\n        if (typeof checkVal !== 'function')\n            throw new Error(`Invalid validator \"${type}\", expected function`);\n        const val = object[fieldName];\n        if (isOptional && val === undefined)\n            return;\n        if (!checkVal(val, object)) {\n            throw new Error(`Invalid param ${String(fieldName)}=${val} (${typeof val}), expected ${type}`);\n        }\n    };\n    for (const [fieldName, type] of Object.entries(validators))\n        checkField(fieldName, type, false);\n    for (const [fieldName, type] of Object.entries(optValidators))\n        checkField(fieldName, type, true);\n    return object;\n}\n// validate type tests\n// const o: { a: number; b: number; c: number } = { a: 1, b: 5, c: 6 };\n// const z0 = validateObject(o, { a: 'isSafeInteger' }, { c: 'bigint' }); // Ok!\n// // Should fail type-check\n// const z1 = validateObject(o, { a: 'tmp' }, { c: 'zz' });\n// const z2 = validateObject(o, { a: 'isSafeInteger' }, { c: 'zz' });\n// const z3 = validateObject(o, { test: 'boolean', z: 'bug' });\n// const z4 = validateObject(o, { a: 'boolean', z: 'bug' });\n//# sourceMappingURL=utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Utilities for modular arithmetics and finite fields\nimport { bitMask, numberToBytesBE, numberToBytesLE, bytesToNumberBE, bytesToNumberLE, ensureBytes, validateObject, } from './utils.js';\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3);\n// prettier-ignore\nconst _4n = BigInt(4), _5n = BigInt(5), _8n = BigInt(8);\n// prettier-ignore\nconst _9n = BigInt(9), _16n = BigInt(16);\n// Calculates a modulo b\nexport function mod(a, b) {\n    const result = a % b;\n    return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\n// TODO: use field version && remove\nexport function pow(num, power, modulo) {\n    if (modulo <= _0n || power < _0n)\n        throw new Error('Expected power/modulo > 0');\n    if (modulo === _1n)\n        return _0n;\n    let res = _1n;\n    while (power > _0n) {\n        if (power & _1n)\n            res = (res * num) % modulo;\n        num = (num * num) % modulo;\n        power >>= _1n;\n    }\n    return res;\n}\n// Does x ^ (2 ^ power) mod p. pow2(30, 4) == 30 ^ (2 ^ 4)\nexport function pow2(x, power, modulo) {\n    let res = x;\n    while (power-- > _0n) {\n        res *= res;\n        res %= modulo;\n    }\n    return res;\n}\n// Inverses number over modulo\nexport function invert(number, modulo) {\n    if (number === _0n || modulo <= _0n) {\n        throw new Error(`invert: expected positive integers, got n=${number} mod=${modulo}`);\n    }\n    // Euclidean GCD https://brilliant.org/wiki/extended-euclidean-algorithm/\n    // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n    let a = mod(number, modulo);\n    let b = modulo;\n    // prettier-ignore\n    let x = _0n, y = _1n, u = _1n, v = _0n;\n    while (a !== _0n) {\n        // JIT applies optimization if those two lines follow each other\n        const q = b / a;\n        const r = b % a;\n        const m = x - u * q;\n        const n = y - v * q;\n        // prettier-ignore\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    const gcd = b;\n    if (gcd !== _1n)\n        throw new Error('invert: does not exist');\n    return mod(x, modulo);\n}\n// Tonelli-Shanks algorithm\n// Paper 1: https://eprint.iacr.org/2012/685.pdf (page 12)\n// Paper 2: Square Roots from 1; 24, 51, 10 to Dan Shanks\nexport function tonelliShanks(P) {\n    // Legendre constant: used to calculate Legendre symbol (a | p),\n    // which denotes the value of a^((p-1)/2) (mod p).\n    // (a | p) ≡ 1    if a is a square (mod p)\n    // (a | p) ≡ -1   if a is not a square (mod p)\n    // (a | p) ≡ 0    if a ≡ 0 (mod p)\n    const legendreC = (P - _1n) / _2n;\n    let Q, S, Z;\n    // Step 1: By factoring out powers of 2 from p - 1,\n    // find q and s such that p - 1 = q*(2^s) with q odd\n    for (Q = P - _1n, S = 0; Q % _2n === _0n; Q /= _2n, S++)\n        ;\n    // Step 2: Select a non-square z such that (z | p) ≡ -1 and set c ≡ zq\n    for (Z = _2n; Z < P && pow(Z, legendreC, P) !== P - _1n; Z++)\n        ;\n    // Fast-path\n    if (S === 1) {\n        const p1div4 = (P + _1n) / _4n;\n        return function tonelliFast(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Slow-path\n    const Q1div2 = (Q + _1n) / _2n;\n    return function tonelliSlow(Fp, n) {\n        // Step 0: Check that n is indeed a square: (n | p) should not be ≡ -1\n        if (Fp.pow(n, legendreC) === Fp.neg(Fp.ONE))\n            throw new Error('Cannot find square root');\n        let r = S;\n        // TODO: will fail at Fp2/etc\n        let g = Fp.pow(Fp.mul(Fp.ONE, Z), Q); // will update both x and b\n        let x = Fp.pow(n, Q1div2); // first guess at the square root\n        let b = Fp.pow(n, Q); // first guess at the fudge factor\n        while (!Fp.eql(b, Fp.ONE)) {\n            if (Fp.eql(b, Fp.ZERO))\n                return Fp.ZERO; // https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm (4. If t = 0, return r = 0)\n            // Find m such b^(2^m)==1\n            let m = 1;\n            for (let t2 = Fp.sqr(b); m < r; m++) {\n                if (Fp.eql(t2, Fp.ONE))\n                    break;\n                t2 = Fp.sqr(t2); // t2 *= t2\n            }\n            // NOTE: r-m-1 can be bigger than 32, need to convert to bigint before shift, otherwise there will be overflow\n            const ge = Fp.pow(g, _1n << BigInt(r - m - 1)); // ge = 2^(r-m-1)\n            g = Fp.sqr(ge); // g = ge * ge\n            x = Fp.mul(x, ge); // x *= ge\n            b = Fp.mul(b, g); // b *= g\n            r = m;\n        }\n        return x;\n    };\n}\nexport function FpSqrt(P) {\n    // NOTE: different algorithms can give different roots, it is up to user to decide which one they want.\n    // For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n    // P ≡ 3 (mod 4)\n    // √n = n^((P+1)/4)\n    if (P % _4n === _3n) {\n        // Not all roots possible!\n        // const ORDER =\n        //   0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn;\n        // const NUM = 72057594037927816n;\n        const p1div4 = (P + _1n) / _4n;\n        return function sqrt3mod4(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            // Throw if root**2 != n\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Atkin algorithm for q ≡ 5 (mod 8), https://eprint.iacr.org/2012/685.pdf (page 10)\n    if (P % _8n === _5n) {\n        const c1 = (P - _5n) / _8n;\n        return function sqrt5mod8(Fp, n) {\n            const n2 = Fp.mul(n, _2n);\n            const v = Fp.pow(n2, c1);\n            const nv = Fp.mul(n, v);\n            const i = Fp.mul(Fp.mul(nv, _2n), v);\n            const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // P ≡ 9 (mod 16)\n    if (P % _16n === _9n) {\n        // NOTE: tonelli is too slow for bls-Fp2 calculations even on start\n        // Means we cannot use sqrt for constants at all!\n        //\n        // const c1 = Fp.sqrt(Fp.negate(Fp.ONE)); //  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n        // const c2 = Fp.sqrt(c1);                //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n        // const c3 = Fp.sqrt(Fp.negate(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n        // const c4 = (P + _7n) / _16n;           //  4. c4 = (q + 7) / 16        # Integer arithmetic\n        // sqrt = (x) => {\n        //   let tv1 = Fp.pow(x, c4);             //  1. tv1 = x^c4\n        //   let tv2 = Fp.mul(c1, tv1);           //  2. tv2 = c1 * tv1\n        //   const tv3 = Fp.mul(c2, tv1);         //  3. tv3 = c2 * tv1\n        //   let tv4 = Fp.mul(c3, tv1);           //  4. tv4 = c3 * tv1\n        //   const e1 = Fp.equals(Fp.square(tv2), x); //  5.  e1 = (tv2^2) == x\n        //   const e2 = Fp.equals(Fp.square(tv3), x); //  6.  e2 = (tv3^2) == x\n        //   tv1 = Fp.cmov(tv1, tv2, e1); //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n        //   tv2 = Fp.cmov(tv4, tv3, e2); //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n        //   const e3 = Fp.equals(Fp.square(tv2), x); //  9.  e3 = (tv2^2) == x\n        //   return Fp.cmov(tv1, tv2, e3); //  10.  z = CMOV(tv1, tv2, e3)  # Select the sqrt from tv1 and tv2\n        // }\n    }\n    // Other cases: Tonelli-Shanks algorithm\n    return tonelliShanks(P);\n}\n// Little-endian check for first LE bit (last BE bit);\nexport const isNegativeLE = (num, modulo) => (mod(num, modulo) & _1n) === _1n;\n// prettier-ignore\nconst FIELD_FIELDS = [\n    'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n    'eql', 'add', 'sub', 'mul', 'pow', 'div',\n    'addN', 'subN', 'mulN', 'sqrN'\n];\nexport function validateField(field) {\n    const initial = {\n        ORDER: 'bigint',\n        MASK: 'bigint',\n        BYTES: 'isSafeInteger',\n        BITS: 'isSafeInteger',\n    };\n    const opts = FIELD_FIELDS.reduce((map, val) => {\n        map[val] = 'function';\n        return map;\n    }, initial);\n    return validateObject(field, opts);\n}\n// Generic field functions\nexport function FpPow(f, num, power) {\n    // Should have same speed as pow for bigints\n    // TODO: benchmark!\n    if (power < _0n)\n        throw new Error('Expected power > 0');\n    if (power === _0n)\n        return f.ONE;\n    if (power === _1n)\n        return num;\n    let p = f.ONE;\n    let d = num;\n    while (power > _0n) {\n        if (power & _1n)\n            p = f.mul(p, d);\n        d = f.sqr(d);\n        power >>= _1n;\n    }\n    return p;\n}\n// 0 is non-invertible: non-batched version will throw on 0\nexport function FpInvertBatch(f, nums) {\n    const tmp = new Array(nums.length);\n    // Walk from first to last, multiply them by each other MOD p\n    const lastMultiplied = nums.reduce((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = acc;\n        return f.mul(acc, num);\n    }, f.ONE);\n    // Invert last element\n    const inverted = f.inv(lastMultiplied);\n    // Walk from last to first, multiply them by inverted each other MOD p\n    nums.reduceRight((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = f.mul(acc, tmp[i]);\n        return f.mul(acc, num);\n    }, inverted);\n    return tmp;\n}\nexport function FpDiv(f, lhs, rhs) {\n    return f.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, f.ORDER) : f.inv(rhs));\n}\n// This function returns True whenever the value x is a square in the field F.\nexport function FpIsSquare(f) {\n    const legendreConst = (f.ORDER - _1n) / _2n; // Integer arithmetic\n    return (x) => {\n        const p = f.pow(x, legendreConst);\n        return f.eql(p, f.ZERO) || f.eql(p, f.ONE);\n    };\n}\n// CURVE.n lengths\nexport function nLength(n, nBitLength) {\n    // Bit size, byte size of CURVE.n\n    const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n    const nByteLength = Math.ceil(_nBitLength / 8);\n    return { nBitLength: _nBitLength, nByteLength };\n}\n/**\n * Initializes a galois field over prime. Non-primes are not supported for now.\n * Do not init in loop: slow. Very fragile: always run a benchmark on change.\n * Major performance gains:\n * a) non-normalized operations like mulN instead of mul\n * b) `Object.freeze`\n * c) Same object shape: never add or remove keys\n * @param ORDER prime positive bigint\n * @param bitLen how many bits the field consumes\n * @param isLE (def: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nexport function Field(ORDER, bitLen, isLE = false, redef = {}) {\n    if (ORDER <= _0n)\n        throw new Error(`Expected Fp ORDER > 0, got ${ORDER}`);\n    const { nBitLength: BITS, nByteLength: BYTES } = nLength(ORDER, bitLen);\n    if (BYTES > 2048)\n        throw new Error('Field lengths over 2048 bytes are not supported');\n    const sqrtP = FpSqrt(ORDER);\n    const f = Object.freeze({\n        ORDER,\n        BITS,\n        BYTES,\n        MASK: bitMask(BITS),\n        ZERO: _0n,\n        ONE: _1n,\n        create: (num) => mod(num, ORDER),\n        isValid: (num) => {\n            if (typeof num !== 'bigint')\n                throw new Error(`Invalid field element: expected bigint, got ${typeof num}`);\n            return _0n <= num && num < ORDER; // 0 is valid element, but it's not invertible\n        },\n        is0: (num) => num === _0n,\n        isOdd: (num) => (num & _1n) === _1n,\n        neg: (num) => mod(-num, ORDER),\n        eql: (lhs, rhs) => lhs === rhs,\n        sqr: (num) => mod(num * num, ORDER),\n        add: (lhs, rhs) => mod(lhs + rhs, ORDER),\n        sub: (lhs, rhs) => mod(lhs - rhs, ORDER),\n        mul: (lhs, rhs) => mod(lhs * rhs, ORDER),\n        pow: (num, power) => FpPow(f, num, power),\n        div: (lhs, rhs) => mod(lhs * invert(rhs, ORDER), ORDER),\n        // Same as above, but doesn't normalize\n        sqrN: (num) => num * num,\n        addN: (lhs, rhs) => lhs + rhs,\n        subN: (lhs, rhs) => lhs - rhs,\n        mulN: (lhs, rhs) => lhs * rhs,\n        inv: (num) => invert(num, ORDER),\n        sqrt: redef.sqrt || ((n) => sqrtP(f, n)),\n        invertBatch: (lst) => FpInvertBatch(f, lst),\n        // TODO: do we really need constant cmov?\n        // We don't have const-time bigints anyway, so probably will be not very useful\n        cmov: (a, b, c) => (c ? b : a),\n        toBytes: (num) => (isLE ? numberToBytesLE(num, BYTES) : numberToBytesBE(num, BYTES)),\n        fromBytes: (bytes) => {\n            if (bytes.length !== BYTES)\n                throw new Error(`Fp.fromBytes: expected ${BYTES}, got ${bytes.length}`);\n            return isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n        },\n    });\n    return Object.freeze(f);\n}\nexport function FpSqrtOdd(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? root : Fp.neg(root);\n}\nexport function FpSqrtEven(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n/**\n * FIPS 186 B.4.1-compliant \"constant-time\" private key generation utility.\n * Can take (n+8) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 40 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. curveFn.CURVE.n)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nexport function hashToPrivateScalar(hash, groupOrder, isLE = false) {\n    hash = ensureBytes('privateHash', hash);\n    const hashLen = hash.length;\n    const minLen = nLength(groupOrder).nByteLength + 8;\n    if (minLen < 24 || hashLen < minLen || hashLen > 1024)\n        throw new Error(`hashToPrivateScalar: expected ${minLen}-1024 bytes of input, got ${hashLen}`);\n    const num = isLE ? bytesToNumberLE(hash) : bytesToNumberBE(hash);\n    return mod(num, groupOrder - _1n) + _1n;\n}\n//# sourceMappingURL=modular.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Abelian group utilities\nimport { validateField, nLength } from './modular.js';\nimport { validateObject } from './utils.js';\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\n// Elliptic curve multiplication of Point by scalar. Fragile.\n// Scalars should always be less than curve order: this should be checked inside of a curve itself.\n// Creates precomputation tables for fast multiplication:\n// - private scalar is split by fixed size windows of W bits\n// - every window point is collected from window's table & added to accumulator\n// - since windows are different, same point inside tables won't be accessed more than once per calc\n// - each multiplication is 'Math.ceil(CURVE_ORDER / 𝑊) + 1' point additions (fixed for any scalar)\n// - +1 window is neccessary for wNAF\n// - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n// TODO: Research returning 2d JS array of windows, instead of a single window. This would allow\n// windows to be in different memory locations\nexport function wNAF(c, bits) {\n    const constTimeNegate = (condition, item) => {\n        const neg = item.negate();\n        return condition ? neg : item;\n    };\n    const opts = (W) => {\n        const windows = Math.ceil(bits / W) + 1; // +1, because\n        const windowSize = 2 ** (W - 1); // -1 because we skip zero\n        return { windows, windowSize };\n    };\n    return {\n        constTimeNegate,\n        // non-const time multiplication ladder\n        unsafeLadder(elm, n) {\n            let p = c.ZERO;\n            let d = elm;\n            while (n > _0n) {\n                if (n & _1n)\n                    p = p.add(d);\n                d = d.double();\n                n >>= _1n;\n            }\n            return p;\n        },\n        /**\n         * Creates a wNAF precomputation window. Used for caching.\n         * Default window size is set by `utils.precompute()` and is equal to 8.\n         * Number of precomputed points depends on the curve size:\n         * 2^(𝑊−1) * (Math.ceil(𝑛 / 𝑊) + 1), where:\n         * - 𝑊 is the window size\n         * - 𝑛 is the bitlength of the curve order.\n         * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n         * @returns precomputed point tables flattened to a single array\n         */\n        precomputeWindow(elm, W) {\n            const { windows, windowSize } = opts(W);\n            const points = [];\n            let p = elm;\n            let base = p;\n            for (let window = 0; window < windows; window++) {\n                base = p;\n                points.push(base);\n                // =1, because we skip zero\n                for (let i = 1; i < windowSize; i++) {\n                    base = base.add(p);\n                    points.push(base);\n                }\n                p = base.double();\n            }\n            return points;\n        },\n        /**\n         * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n         * @param W window size\n         * @param precomputes precomputed tables\n         * @param n scalar (we don't check here, but should be less than curve order)\n         * @returns real and fake (for const-time) points\n         */\n        wNAF(W, precomputes, n) {\n            // TODO: maybe check that scalar is less than group order? wNAF behavious is undefined otherwise\n            // But need to carefully remove other checks before wNAF. ORDER == bits here\n            const { windows, windowSize } = opts(W);\n            let p = c.ZERO;\n            let f = c.BASE;\n            const mask = BigInt(2 ** W - 1); // Create mask with W ones: 0b1111 for W=4 etc.\n            const maxNumber = 2 ** W;\n            const shiftBy = BigInt(W);\n            for (let window = 0; window < windows; window++) {\n                const offset = window * windowSize;\n                // Extract W bits.\n                let wbits = Number(n & mask);\n                // Shift number by W bits.\n                n >>= shiftBy;\n                // If the bits are bigger than max size, we'll split those.\n                // +224 => 256 - 32\n                if (wbits > windowSize) {\n                    wbits -= maxNumber;\n                    n += _1n;\n                }\n                // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n                // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n                // there is negate now: it is possible that negated element from low value\n                // would be the same as high element, which will create carry into next window.\n                // It's not obvious how this can fail, but still worth investigating later.\n                // Check if we're onto Zero point.\n                // Add random point inside current window to f.\n                const offset1 = offset;\n                const offset2 = offset + Math.abs(wbits) - 1; // -1 because we skip zero\n                const cond1 = window % 2 !== 0;\n                const cond2 = wbits < 0;\n                if (wbits === 0) {\n                    // The most important part for const-time getPublicKey\n                    f = f.add(constTimeNegate(cond1, precomputes[offset1]));\n                }\n                else {\n                    p = p.add(constTimeNegate(cond2, precomputes[offset2]));\n                }\n            }\n            // JIT-compiler should not eliminate f here, since it will later be used in normalizeZ()\n            // Even if the variable is still unused, there are some checks which will\n            // throw an exception, so compiler needs to prove they won't happen, which is hard.\n            // At this point there is a way to F be infinity-point even if p is not,\n            // which makes it less const-time: around 1 bigint multiply.\n            return { p, f };\n        },\n        wNAFCached(P, precomputesMap, n, transform) {\n            // @ts-ignore\n            const W = P._WINDOW_SIZE || 1;\n            // Calculate precomputes on a first run, reuse them after\n            let comp = precomputesMap.get(P);\n            if (!comp) {\n                comp = this.precomputeWindow(P, W);\n                if (W !== 1) {\n                    precomputesMap.set(P, transform(comp));\n                }\n            }\n            return this.wNAF(W, comp, n);\n        },\n    };\n}\nexport function validateBasic(curve) {\n    validateField(curve.Fp);\n    validateObject(curve, {\n        n: 'bigint',\n        h: 'bigint',\n        Gx: 'field',\n        Gy: 'field',\n    }, {\n        nBitLength: 'isSafeInteger',\n        nByteLength: 'isSafeInteger',\n    });\n    // Set defaults\n    return Object.freeze({\n        ...nLength(curve.n, curve.nBitLength),\n        ...curve,\n        ...{ p: curve.Fp.ORDER },\n    });\n}\n//# sourceMappingURL=curve.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Short Weierstrass curve. The formula is: y² = x³ + ax + b\nimport * as mod from './modular.js';\nimport * as ut from './utils.js';\nimport { ensureBytes } from './utils.js';\nimport { wNAF, validateBasic } from './curve.js';\nfunction validatePointOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        a: 'field',\n        b: 'field',\n    }, {\n        allowedPrivateKeyLengths: 'array',\n        wrapPrivateKey: 'boolean',\n        isTorsionFree: 'function',\n        clearCofactor: 'function',\n        allowInfinityPoint: 'boolean',\n        fromBytes: 'function',\n        toBytes: 'function',\n    });\n    const { endo, Fp, a } = opts;\n    if (endo) {\n        if (!Fp.eql(a, Fp.ZERO)) {\n            throw new Error('Endomorphism can only be defined for Koblitz curves that have a=0');\n        }\n        if (typeof endo !== 'object' ||\n            typeof endo.beta !== 'bigint' ||\n            typeof endo.splitScalar !== 'function') {\n            throw new Error('Expected endomorphism with beta: bigint and splitScalar: function');\n        }\n    }\n    return Object.freeze({ ...opts });\n}\n// ASN.1 DER encoding utilities\nconst { bytesToNumberBE: b2n, hexToBytes: h2b } = ut;\nexport const DER = {\n    // asn.1 DER encoding utils\n    Err: class DERErr extends Error {\n        constructor(m = '') {\n            super(m);\n        }\n    },\n    _parseInt(data) {\n        const { Err: E } = DER;\n        if (data.length < 2 || data[0] !== 0x02)\n            throw new E('Invalid signature integer tag');\n        const len = data[1];\n        const res = data.subarray(2, len + 2);\n        if (!len || res.length !== len)\n            throw new E('Invalid signature integer: wrong length');\n        // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n        // since we always use positive integers here. It must always be empty:\n        // - add zero byte if exists\n        // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n        if (res[0] & 0b10000000)\n            throw new E('Invalid signature integer: negative');\n        if (res[0] === 0x00 && !(res[1] & 0b10000000))\n            throw new E('Invalid signature integer: unnecessary leading zero');\n        return { d: b2n(res), l: data.subarray(len + 2) }; // d is data, l is left\n    },\n    toSig(hex) {\n        // parse DER signature\n        const { Err: E } = DER;\n        const data = typeof hex === 'string' ? h2b(hex) : hex;\n        if (!(data instanceof Uint8Array))\n            throw new Error('ui8a expected');\n        let l = data.length;\n        if (l < 2 || data[0] != 0x30)\n            throw new E('Invalid signature tag');\n        if (data[1] !== l - 2)\n            throw new E('Invalid signature: incorrect length');\n        const { d: r, l: sBytes } = DER._parseInt(data.subarray(2));\n        const { d: s, l: rBytesLeft } = DER._parseInt(sBytes);\n        if (rBytesLeft.length)\n            throw new E('Invalid signature: left bytes after parsing');\n        return { r, s };\n    },\n    hexFromSig(sig) {\n        // Add leading zero if first byte has negative bit enabled. More details in '_parseInt'\n        const slice = (s) => (Number.parseInt(s[0], 16) & 0b1000 ? '00' + s : s);\n        const h = (num) => {\n            const hex = num.toString(16);\n            return hex.length & 1 ? `0${hex}` : hex;\n        };\n        const s = slice(h(sig.s));\n        const r = slice(h(sig.r));\n        const shl = s.length / 2;\n        const rhl = r.length / 2;\n        const sl = h(shl);\n        const rl = h(rhl);\n        return `30${h(rhl + shl + 4)}02${rl}${r}02${sl}${s}`;\n    },\n};\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = BigInt(4);\nexport function weierstrassPoints(opts) {\n    const CURVE = validatePointOpts(opts);\n    const { Fp } = CURVE; // All curves has same field / group length as for now, but they can differ\n    const toBytes = CURVE.toBytes ||\n        ((c, point, isCompressed) => {\n            const a = point.toAffine();\n            return ut.concatBytes(Uint8Array.from([0x04]), Fp.toBytes(a.x), Fp.toBytes(a.y));\n        });\n    const fromBytes = CURVE.fromBytes ||\n        ((bytes) => {\n            // const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // if (head !== 0x04) throw new Error('Only non-compressed encoding is supported');\n            const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n            const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n            return { x, y };\n        });\n    /**\n     * y² = x³ + ax + b: Short weierstrass curve formula\n     * @returns y²\n     */\n    function weierstrassEquation(x) {\n        const { a, b } = CURVE;\n        const x2 = Fp.sqr(x); // x * x\n        const x3 = Fp.mul(x2, x); // x2 * x\n        return Fp.add(Fp.add(x3, Fp.mul(x, a)), b); // x3 + a * x + b\n    }\n    // Validate whether the passed curve params are valid.\n    // We check if curve equation works for generator point.\n    // `assertValidity()` won't work: `isTorsionFree()` is not available at this point in bls12-381.\n    // ProjectivePoint class has not been initialized yet.\n    if (!Fp.eql(Fp.sqr(CURVE.Gy), weierstrassEquation(CURVE.Gx)))\n        throw new Error('bad generator point: equation left != right');\n    // Valid group elements reside in range 1..n-1\n    function isWithinCurveOrder(num) {\n        return typeof num === 'bigint' && _0n < num && num < CURVE.n;\n    }\n    function assertGE(num) {\n        if (!isWithinCurveOrder(num))\n            throw new Error('Expected valid bigint: 0 < bigint < curve.n');\n    }\n    // Validates if priv key is valid and converts it to bigint.\n    // Supports options allowedPrivateKeyLengths and wrapPrivateKey.\n    function normPrivateKeyToScalar(key) {\n        const { allowedPrivateKeyLengths: lengths, nByteLength, wrapPrivateKey, n } = CURVE;\n        if (lengths && typeof key !== 'bigint') {\n            if (key instanceof Uint8Array)\n                key = ut.bytesToHex(key);\n            // Normalize to hex string, pad. E.g. P521 would norm 130-132 char hex to 132-char bytes\n            if (typeof key !== 'string' || !lengths.includes(key.length))\n                throw new Error('Invalid key');\n            key = key.padStart(nByteLength * 2, '0');\n        }\n        let num;\n        try {\n            num =\n                typeof key === 'bigint'\n                    ? key\n                    : ut.bytesToNumberBE(ensureBytes('private key', key, nByteLength));\n        }\n        catch (error) {\n            throw new Error(`private key must be ${nByteLength} bytes, hex or bigint, not ${typeof key}`);\n        }\n        if (wrapPrivateKey)\n            num = mod.mod(num, n); // disabled by default, enabled for BLS\n        assertGE(num); // num in range [1..N-1]\n        return num;\n    }\n    const pointPrecomputes = new Map();\n    function assertPrjPoint(other) {\n        if (!(other instanceof Point))\n            throw new Error('ProjectivePoint expected');\n    }\n    /**\n     * Projective Point works in 3d / projective (homogeneous) coordinates: (x, y, z) ∋ (x=x/z, y=y/z)\n     * Default Point works in 2d / affine coordinates: (x, y)\n     * We're doing calculations in projective, because its operations don't require costly inversion.\n     */\n    class Point {\n        constructor(px, py, pz) {\n            this.px = px;\n            this.py = py;\n            this.pz = pz;\n            if (px == null || !Fp.isValid(px))\n                throw new Error('x required');\n            if (py == null || !Fp.isValid(py))\n                throw new Error('y required');\n            if (pz == null || !Fp.isValid(pz))\n                throw new Error('z required');\n        }\n        // Does not validate if the point is on-curve.\n        // Use fromHex instead, or call assertValidity() later.\n        static fromAffine(p) {\n            const { x, y } = p || {};\n            if (!p || !Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('invalid affine point');\n            if (p instanceof Point)\n                throw new Error('projective point not allowed');\n            const is0 = (i) => Fp.eql(i, Fp.ZERO);\n            // fromAffine(x:0, y:0) would produce (x:0, y:0, z:1), but we need (x:0, y:1, z:0)\n            if (is0(x) && is0(y))\n                return Point.ZERO;\n            return new Point(x, y, Fp.ONE);\n        }\n        get x() {\n            return this.toAffine().x;\n        }\n        get y() {\n            return this.toAffine().y;\n        }\n        /**\n         * Takes a bunch of Projective Points but executes only one\n         * inversion on all of them. Inversion is very slow operation,\n         * so this improves performance massively.\n         * Optimization: converts a list of projective points to a list of identical points with Z=1.\n         */\n        static normalizeZ(points) {\n            const toInv = Fp.invertBatch(points.map((p) => p.pz));\n            return points.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n        }\n        /**\n         * Converts hash string or Uint8Array to Point.\n         * @param hex short/long ECDSA hex\n         */\n        static fromHex(hex) {\n            const P = Point.fromAffine(fromBytes(ensureBytes('pointHex', hex)));\n            P.assertValidity();\n            return P;\n        }\n        // Multiplies generator point by privateKey.\n        static fromPrivateKey(privateKey) {\n            return Point.BASE.multiply(normPrivateKeyToScalar(privateKey));\n        }\n        // \"Private method\", don't use it directly\n        _setWindowSize(windowSize) {\n            this._WINDOW_SIZE = windowSize;\n            pointPrecomputes.delete(this);\n        }\n        // A point on curve is valid if it conforms to equation.\n        assertValidity() {\n            // Zero is valid point too!\n            if (this.is0()) {\n                if (CURVE.allowInfinityPoint)\n                    return;\n                throw new Error('bad point: ZERO');\n            }\n            // Some 3rd-party test vectors require different wording between here & `fromCompressedHex`\n            const { x, y } = this.toAffine();\n            // Check if x, y are valid field elements\n            if (!Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('bad point: x or y not FE');\n            const left = Fp.sqr(y); // y²\n            const right = weierstrassEquation(x); // x³ + ax + b\n            if (!Fp.eql(left, right))\n                throw new Error('bad point: equation left != right');\n            if (!this.isTorsionFree())\n                throw new Error('bad point: not in prime-order subgroup');\n        }\n        hasEvenY() {\n            const { y } = this.toAffine();\n            if (Fp.isOdd)\n                return !Fp.isOdd(y);\n            throw new Error(\"Field doesn't support isOdd\");\n        }\n        /**\n         * Compare one point to another.\n         */\n        equals(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            const U1 = Fp.eql(Fp.mul(X1, Z2), Fp.mul(X2, Z1));\n            const U2 = Fp.eql(Fp.mul(Y1, Z2), Fp.mul(Y2, Z1));\n            return U1 && U2;\n        }\n        /**\n         * Flips point to one corresponding to (x, -y) in Affine coordinates.\n         */\n        negate() {\n            return new Point(this.px, Fp.neg(this.py), this.pz);\n        }\n        // Renes-Costello-Batina exception-free doubling formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 3\n        // Cost: 8M + 3S + 3*a + 2*b3 + 15add.\n        double() {\n            const { a, b } = CURVE;\n            const b3 = Fp.mul(b, _3n);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            let t0 = Fp.mul(X1, X1); // step 1\n            let t1 = Fp.mul(Y1, Y1);\n            let t2 = Fp.mul(Z1, Z1);\n            let t3 = Fp.mul(X1, Y1);\n            t3 = Fp.add(t3, t3); // step 5\n            Z3 = Fp.mul(X1, Z1);\n            Z3 = Fp.add(Z3, Z3);\n            X3 = Fp.mul(a, Z3);\n            Y3 = Fp.mul(b3, t2);\n            Y3 = Fp.add(X3, Y3); // step 10\n            X3 = Fp.sub(t1, Y3);\n            Y3 = Fp.add(t1, Y3);\n            Y3 = Fp.mul(X3, Y3);\n            X3 = Fp.mul(t3, X3);\n            Z3 = Fp.mul(b3, Z3); // step 15\n            t2 = Fp.mul(a, t2);\n            t3 = Fp.sub(t0, t2);\n            t3 = Fp.mul(a, t3);\n            t3 = Fp.add(t3, Z3);\n            Z3 = Fp.add(t0, t0); // step 20\n            t0 = Fp.add(Z3, t0);\n            t0 = Fp.add(t0, t2);\n            t0 = Fp.mul(t0, t3);\n            Y3 = Fp.add(Y3, t0);\n            t2 = Fp.mul(Y1, Z1); // step 25\n            t2 = Fp.add(t2, t2);\n            t0 = Fp.mul(t2, t3);\n            X3 = Fp.sub(X3, t0);\n            Z3 = Fp.mul(t2, t1);\n            Z3 = Fp.add(Z3, Z3); // step 30\n            Z3 = Fp.add(Z3, Z3);\n            return new Point(X3, Y3, Z3);\n        }\n        // Renes-Costello-Batina exception-free addition formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 1\n        // Cost: 12M + 0S + 3*a + 3*b3 + 23add.\n        add(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            const a = CURVE.a;\n            const b3 = Fp.mul(CURVE.b, _3n);\n            let t0 = Fp.mul(X1, X2); // step 1\n            let t1 = Fp.mul(Y1, Y2);\n            let t2 = Fp.mul(Z1, Z2);\n            let t3 = Fp.add(X1, Y1);\n            let t4 = Fp.add(X2, Y2); // step 5\n            t3 = Fp.mul(t3, t4);\n            t4 = Fp.add(t0, t1);\n            t3 = Fp.sub(t3, t4);\n            t4 = Fp.add(X1, Z1);\n            let t5 = Fp.add(X2, Z2); // step 10\n            t4 = Fp.mul(t4, t5);\n            t5 = Fp.add(t0, t2);\n            t4 = Fp.sub(t4, t5);\n            t5 = Fp.add(Y1, Z1);\n            X3 = Fp.add(Y2, Z2); // step 15\n            t5 = Fp.mul(t5, X3);\n            X3 = Fp.add(t1, t2);\n            t5 = Fp.sub(t5, X3);\n            Z3 = Fp.mul(a, t4);\n            X3 = Fp.mul(b3, t2); // step 20\n            Z3 = Fp.add(X3, Z3);\n            X3 = Fp.sub(t1, Z3);\n            Z3 = Fp.add(t1, Z3);\n            Y3 = Fp.mul(X3, Z3);\n            t1 = Fp.add(t0, t0); // step 25\n            t1 = Fp.add(t1, t0);\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.mul(b3, t4);\n            t1 = Fp.add(t1, t2);\n            t2 = Fp.sub(t0, t2); // step 30\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.add(t4, t2);\n            t0 = Fp.mul(t1, t4);\n            Y3 = Fp.add(Y3, t0);\n            t0 = Fp.mul(t5, t4); // step 35\n            X3 = Fp.mul(t3, X3);\n            X3 = Fp.sub(X3, t0);\n            t0 = Fp.mul(t3, t1);\n            Z3 = Fp.mul(t5, Z3);\n            Z3 = Fp.add(Z3, t0); // step 40\n            return new Point(X3, Y3, Z3);\n        }\n        subtract(other) {\n            return this.add(other.negate());\n        }\n        is0() {\n            return this.equals(Point.ZERO);\n        }\n        wNAF(n) {\n            return wnaf.wNAFCached(this, pointPrecomputes, n, (comp) => {\n                const toInv = Fp.invertBatch(comp.map((p) => p.pz));\n                return comp.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n            });\n        }\n        /**\n         * Non-constant-time multiplication. Uses double-and-add algorithm.\n         * It's faster, but should only be used when you don't care about\n         * an exposed private key e.g. sig verification, which works over *public* keys.\n         */\n        multiplyUnsafe(n) {\n            const I = Point.ZERO;\n            if (n === _0n)\n                return I;\n            assertGE(n); // Will throw on 0\n            if (n === _1n)\n                return this;\n            const { endo } = CURVE;\n            if (!endo)\n                return wnaf.unsafeLadder(this, n);\n            // Apply endomorphism\n            let { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n            let k1p = I;\n            let k2p = I;\n            let d = this;\n            while (k1 > _0n || k2 > _0n) {\n                if (k1 & _1n)\n                    k1p = k1p.add(d);\n                if (k2 & _1n)\n                    k2p = k2p.add(d);\n                d = d.double();\n                k1 >>= _1n;\n                k2 >>= _1n;\n            }\n            if (k1neg)\n                k1p = k1p.negate();\n            if (k2neg)\n                k2p = k2p.negate();\n            k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n            return k1p.add(k2p);\n        }\n        /**\n         * Constant time multiplication.\n         * Uses wNAF method. Windowed method may be 10% faster,\n         * but takes 2x longer to generate and consumes 2x memory.\n         * Uses precomputes when available.\n         * Uses endomorphism for Koblitz curves.\n         * @param scalar by which the point would be multiplied\n         * @returns New point\n         */\n        multiply(scalar) {\n            assertGE(scalar);\n            let n = scalar;\n            let point, fake; // Fake point is used to const-time mult\n            const { endo } = CURVE;\n            if (endo) {\n                const { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n                let { p: k1p, f: f1p } = this.wNAF(k1);\n                let { p: k2p, f: f2p } = this.wNAF(k2);\n                k1p = wnaf.constTimeNegate(k1neg, k1p);\n                k2p = wnaf.constTimeNegate(k2neg, k2p);\n                k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n                point = k1p.add(k2p);\n                fake = f1p.add(f2p);\n            }\n            else {\n                const { p, f } = this.wNAF(n);\n                point = p;\n                fake = f;\n            }\n            // Normalize `z` for both points, but return only real one\n            return Point.normalizeZ([point, fake])[0];\n        }\n        /**\n         * Efficiently calculate `aP + bQ`. Unsafe, can expose private key, if used incorrectly.\n         * Not using Strauss-Shamir trick: precomputation tables are faster.\n         * The trick could be useful if both P and Q are not G (not in our case).\n         * @returns non-zero affine point\n         */\n        multiplyAndAddUnsafe(Q, a, b) {\n            const G = Point.BASE; // No Strauss-Shamir trick: we have 10% faster G precomputes\n            const mul = (P, a // Select faster multiply() method\n            ) => (a === _0n || a === _1n || !P.equals(G) ? P.multiplyUnsafe(a) : P.multiply(a));\n            const sum = mul(this, a).add(mul(Q, b));\n            return sum.is0() ? undefined : sum;\n        }\n        // Converts Projective point to affine (x, y) coordinates.\n        // Can accept precomputed Z^-1 - for example, from invertBatch.\n        // (x, y, z) ∋ (x=x/z, y=y/z)\n        toAffine(iz) {\n            const { px: x, py: y, pz: z } = this;\n            const is0 = this.is0();\n            // If invZ was 0, we return zero point. However we still want to execute\n            // all operations, so we replace invZ with a random number, 1.\n            if (iz == null)\n                iz = is0 ? Fp.ONE : Fp.inv(z);\n            const ax = Fp.mul(x, iz);\n            const ay = Fp.mul(y, iz);\n            const zz = Fp.mul(z, iz);\n            if (is0)\n                return { x: Fp.ZERO, y: Fp.ZERO };\n            if (!Fp.eql(zz, Fp.ONE))\n                throw new Error('invZ was invalid');\n            return { x: ax, y: ay };\n        }\n        isTorsionFree() {\n            const { h: cofactor, isTorsionFree } = CURVE;\n            if (cofactor === _1n)\n                return true; // No subgroups, always torsion-free\n            if (isTorsionFree)\n                return isTorsionFree(Point, this);\n            throw new Error('isTorsionFree() has not been declared for the elliptic curve');\n        }\n        clearCofactor() {\n            const { h: cofactor, clearCofactor } = CURVE;\n            if (cofactor === _1n)\n                return this; // Fast-path\n            if (clearCofactor)\n                return clearCofactor(Point, this);\n            return this.multiplyUnsafe(CURVE.h);\n        }\n        toRawBytes(isCompressed = true) {\n            this.assertValidity();\n            return toBytes(Point, this, isCompressed);\n        }\n        toHex(isCompressed = true) {\n            return ut.bytesToHex(this.toRawBytes(isCompressed));\n        }\n    }\n    Point.BASE = new Point(CURVE.Gx, CURVE.Gy, Fp.ONE);\n    Point.ZERO = new Point(Fp.ZERO, Fp.ONE, Fp.ZERO);\n    const _bits = CURVE.nBitLength;\n    const wnaf = wNAF(Point, CURVE.endo ? Math.ceil(_bits / 2) : _bits);\n    // Validate if generator point is on curve\n    return {\n        CURVE,\n        ProjectivePoint: Point,\n        normPrivateKeyToScalar,\n        weierstrassEquation,\n        isWithinCurveOrder,\n    };\n}\nfunction validateOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        hash: 'hash',\n        hmac: 'function',\n        randomBytes: 'function',\n    }, {\n        bits2int: 'function',\n        bits2int_modN: 'function',\n        lowS: 'boolean',\n    });\n    return Object.freeze({ lowS: true, ...opts });\n}\nexport function weierstrass(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { Fp, n: CURVE_ORDER } = CURVE;\n    const compressedLen = Fp.BYTES + 1; // e.g. 33 for 32\n    const uncompressedLen = 2 * Fp.BYTES + 1; // e.g. 65 for 32\n    function isValidFieldElement(num) {\n        return _0n < num && num < Fp.ORDER; // 0 is banned since it's not invertible FE\n    }\n    function modN(a) {\n        return mod.mod(a, CURVE_ORDER);\n    }\n    function invN(a) {\n        return mod.invert(a, CURVE_ORDER);\n    }\n    const { ProjectivePoint: Point, normPrivateKeyToScalar, weierstrassEquation, isWithinCurveOrder, } = weierstrassPoints({\n        ...CURVE,\n        toBytes(c, point, isCompressed) {\n            const a = point.toAffine();\n            const x = Fp.toBytes(a.x);\n            const cat = ut.concatBytes;\n            if (isCompressed) {\n                return cat(Uint8Array.from([point.hasEvenY() ? 0x02 : 0x03]), x);\n            }\n            else {\n                return cat(Uint8Array.from([0x04]), x, Fp.toBytes(a.y));\n            }\n        },\n        fromBytes(bytes) {\n            const len = bytes.length;\n            const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // this.assertValidity() is done inside of fromHex\n            if (len === compressedLen && (head === 0x02 || head === 0x03)) {\n                const x = ut.bytesToNumberBE(tail);\n                if (!isValidFieldElement(x))\n                    throw new Error('Point is not on curve');\n                const y2 = weierstrassEquation(x); // y² = x³ + ax + b\n                let y = Fp.sqrt(y2); // y = y² ^ (p+1)/4\n                const isYOdd = (y & _1n) === _1n;\n                // ECDSA\n                const isHeadOdd = (head & 1) === 1;\n                if (isHeadOdd !== isYOdd)\n                    y = Fp.neg(y);\n                return { x, y };\n            }\n            else if (len === uncompressedLen && head === 0x04) {\n                const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n                const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n                return { x, y };\n            }\n            else {\n                throw new Error(`Point of length ${len} was invalid. Expected ${compressedLen} compressed bytes or ${uncompressedLen} uncompressed bytes`);\n            }\n        },\n    });\n    const numToNByteStr = (num) => ut.bytesToHex(ut.numberToBytesBE(num, CURVE.nByteLength));\n    function isBiggerThanHalfOrder(number) {\n        const HALF = CURVE_ORDER >> _1n;\n        return number > HALF;\n    }\n    function normalizeS(s) {\n        return isBiggerThanHalfOrder(s) ? modN(-s) : s;\n    }\n    // slice bytes num\n    const slcNum = (b, from, to) => ut.bytesToNumberBE(b.slice(from, to));\n    /**\n     * ECDSA signature with its (r, s) properties. Supports DER & compact representations.\n     */\n    class Signature {\n        constructor(r, s, recovery) {\n            this.r = r;\n            this.s = s;\n            this.recovery = recovery;\n            this.assertValidity();\n        }\n        // pair (bytes of r, bytes of s)\n        static fromCompact(hex) {\n            const l = CURVE.nByteLength;\n            hex = ensureBytes('compactSignature', hex, l * 2);\n            return new Signature(slcNum(hex, 0, l), slcNum(hex, l, 2 * l));\n        }\n        // DER encoded ECDSA signature\n        // https://bitcoin.stackexchange.com/questions/57644/what-are-the-parts-of-a-bitcoin-transaction-input-script\n        static fromDER(hex) {\n            const { r, s } = DER.toSig(ensureBytes('DER', hex));\n            return new Signature(r, s);\n        }\n        assertValidity() {\n            // can use assertGE here\n            if (!isWithinCurveOrder(this.r))\n                throw new Error('r must be 0 < r < CURVE.n');\n            if (!isWithinCurveOrder(this.s))\n                throw new Error('s must be 0 < s < CURVE.n');\n        }\n        addRecoveryBit(recovery) {\n            return new Signature(this.r, this.s, recovery);\n        }\n        recoverPublicKey(msgHash) {\n            const { r, s, recovery: rec } = this;\n            const h = bits2int_modN(ensureBytes('msgHash', msgHash)); // Truncate hash\n            if (rec == null || ![0, 1, 2, 3].includes(rec))\n                throw new Error('recovery id invalid');\n            const radj = rec === 2 || rec === 3 ? r + CURVE.n : r;\n            if (radj >= Fp.ORDER)\n                throw new Error('recovery id 2 or 3 invalid');\n            const prefix = (rec & 1) === 0 ? '02' : '03';\n            const R = Point.fromHex(prefix + numToNByteStr(radj));\n            const ir = invN(radj); // r^-1\n            const u1 = modN(-h * ir); // -hr^-1\n            const u2 = modN(s * ir); // sr^-1\n            const Q = Point.BASE.multiplyAndAddUnsafe(R, u1, u2); // (sr^-1)R-(hr^-1)G = -(hr^-1)G + (sr^-1)\n            if (!Q)\n                throw new Error('point at infinify'); // unsafe is fine: no priv data leaked\n            Q.assertValidity();\n            return Q;\n        }\n        // Signatures should be low-s, to prevent malleability.\n        hasHighS() {\n            return isBiggerThanHalfOrder(this.s);\n        }\n        normalizeS() {\n            return this.hasHighS() ? new Signature(this.r, modN(-this.s), this.recovery) : this;\n        }\n        // DER-encoded\n        toDERRawBytes() {\n            return ut.hexToBytes(this.toDERHex());\n        }\n        toDERHex() {\n            return DER.hexFromSig({ r: this.r, s: this.s });\n        }\n        // padded bytes of r, then padded bytes of s\n        toCompactRawBytes() {\n            return ut.hexToBytes(this.toCompactHex());\n        }\n        toCompactHex() {\n            return numToNByteStr(this.r) + numToNByteStr(this.s);\n        }\n    }\n    const utils = {\n        isValidPrivateKey(privateKey) {\n            try {\n                normPrivateKeyToScalar(privateKey);\n                return true;\n            }\n            catch (error) {\n                return false;\n            }\n        },\n        normPrivateKeyToScalar: normPrivateKeyToScalar,\n        /**\n         * Produces cryptographically secure private key from random of size (nBitLength+64)\n         * as per FIPS 186 B.4.1 with modulo bias being neglible.\n         */\n        randomPrivateKey: () => {\n            const rand = CURVE.randomBytes(Fp.BYTES + 8);\n            const num = mod.hashToPrivateScalar(rand, CURVE_ORDER);\n            return ut.numberToBytesBE(num, CURVE.nByteLength);\n        },\n        /**\n         * Creates precompute table for an arbitrary EC point. Makes point \"cached\".\n         * Allows to massively speed-up `point.multiply(scalar)`.\n         * @returns cached point\n         * @example\n         * const fast = utils.precompute(8, ProjectivePoint.fromHex(someonesPubKey));\n         * fast.multiply(privKey); // much faster ECDH now\n         */\n        precompute(windowSize = 8, point = Point.BASE) {\n            point._setWindowSize(windowSize);\n            point.multiply(BigInt(3)); // 3 is arbitrary, just need any number here\n            return point;\n        },\n    };\n    /**\n     * Computes public key for a private key. Checks for validity of the private key.\n     * @param privateKey private key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns Public key, full when isCompressed=false; short when isCompressed=true\n     */\n    function getPublicKey(privateKey, isCompressed = true) {\n        return Point.fromPrivateKey(privateKey).toRawBytes(isCompressed);\n    }\n    /**\n     * Quick and dirty check for item being public key. Does not validate hex, or being on-curve.\n     */\n    function isProbPub(item) {\n        const arr = item instanceof Uint8Array;\n        const str = typeof item === 'string';\n        const len = (arr || str) && item.length;\n        if (arr)\n            return len === compressedLen || len === uncompressedLen;\n        if (str)\n            return len === 2 * compressedLen || len === 2 * uncompressedLen;\n        if (item instanceof Point)\n            return true;\n        return false;\n    }\n    /**\n     * ECDH (Elliptic Curve Diffie Hellman).\n     * Computes shared public key from private key and public key.\n     * Checks: 1) private key validity 2) shared key is on-curve.\n     * Does NOT hash the result.\n     * @param privateA private key\n     * @param publicB different public key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns shared public key\n     */\n    function getSharedSecret(privateA, publicB, isCompressed = true) {\n        if (isProbPub(privateA))\n            throw new Error('first arg must be private key');\n        if (!isProbPub(publicB))\n            throw new Error('second arg must be public key');\n        const b = Point.fromHex(publicB); // check for being on-curve\n        return b.multiply(normPrivateKeyToScalar(privateA)).toRawBytes(isCompressed);\n    }\n    // RFC6979: ensure ECDSA msg is X bytes and < N. RFC suggests optional truncating via bits2octets.\n    // FIPS 186-4 4.6 suggests the leftmost min(nBitLen, outLen) bits, which matches bits2int.\n    // bits2int can produce res>N, we can do mod(res, N) since the bitLen is the same.\n    // int2octets can't be used; pads small msgs with 0: unacceptatble for trunc as per RFC vectors\n    const bits2int = CURVE.bits2int ||\n        function (bytes) {\n            // For curves with nBitLength % 8 !== 0: bits2octets(bits2octets(m)) !== bits2octets(m)\n            // for some cases, since bytes.length * 8 is not actual bitLength.\n            const num = ut.bytesToNumberBE(bytes); // check for == u8 done here\n            const delta = bytes.length * 8 - CURVE.nBitLength; // truncate to nBitLength leftmost bits\n            return delta > 0 ? num >> BigInt(delta) : num;\n        };\n    const bits2int_modN = CURVE.bits2int_modN ||\n        function (bytes) {\n            return modN(bits2int(bytes)); // can't use bytesToNumberBE here\n        };\n    // NOTE: pads output with zero as per spec\n    const ORDER_MASK = ut.bitMask(CURVE.nBitLength);\n    /**\n     * Converts to bytes. Checks if num in `[0..ORDER_MASK-1]` e.g.: `[0..2^256-1]`.\n     */\n    function int2octets(num) {\n        if (typeof num !== 'bigint')\n            throw new Error('bigint expected');\n        if (!(_0n <= num && num < ORDER_MASK))\n            throw new Error(`bigint expected < 2^${CURVE.nBitLength}`);\n        // works with order, can have different size than numToField!\n        return ut.numberToBytesBE(num, CURVE.nByteLength);\n    }\n    // Steps A, D of RFC6979 3.2\n    // Creates RFC6979 seed; converts msg/privKey to numbers.\n    // Used only in sign, not in verify.\n    // NOTE: we cannot assume here that msgHash has same amount of bytes as curve order, this will be wrong at least for P521.\n    // Also it can be bigger for P224 + SHA256\n    function prepSig(msgHash, privateKey, opts = defaultSigOpts) {\n        if (['recovered', 'canonical'].some((k) => k in opts))\n            throw new Error('sign() legacy options not supported');\n        const { hash, randomBytes } = CURVE;\n        let { lowS, prehash, extraEntropy: ent } = opts; // generates low-s sigs by default\n        if (lowS == null)\n            lowS = true; // RFC6979 3.2: we skip step A, because we already provide hash\n        msgHash = ensureBytes('msgHash', msgHash);\n        if (prehash)\n            msgHash = ensureBytes('prehashed msgHash', hash(msgHash));\n        // We can't later call bits2octets, since nested bits2int is broken for curves\n        // with nBitLength % 8 !== 0. Because of that, we unwrap it here as int2octets call.\n        // const bits2octets = (bits) => int2octets(bits2int_modN(bits))\n        const h1int = bits2int_modN(msgHash);\n        const d = normPrivateKeyToScalar(privateKey); // validate private key, convert to bigint\n        const seedArgs = [int2octets(d), int2octets(h1int)];\n        // extraEntropy. RFC6979 3.6: additional k' (optional).\n        if (ent != null) {\n            // K = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || k')\n            const e = ent === true ? randomBytes(Fp.BYTES) : ent; // generate random bytes OR pass as-is\n            seedArgs.push(ensureBytes('extraEntropy', e, Fp.BYTES)); // check for being of size BYTES\n        }\n        const seed = ut.concatBytes(...seedArgs); // Step D of RFC6979 3.2\n        const m = h1int; // NOTE: no need to call bits2int second time here, it is inside truncateHash!\n        // Converts signature params into point w r/s, checks result for validity.\n        function k2sig(kBytes) {\n            // RFC 6979 Section 3.2, step 3: k = bits2int(T)\n            const k = bits2int(kBytes); // Cannot use fields methods, since it is group element\n            if (!isWithinCurveOrder(k))\n                return; // Important: all mod() calls here must be done over N\n            const ik = invN(k); // k^-1 mod n\n            const q = Point.BASE.multiply(k).toAffine(); // q = Gk\n            const r = modN(q.x); // r = q.x mod n\n            if (r === _0n)\n                return;\n            // Can use scalar blinding b^-1(bm + bdr) where b ∈ [1,q−1] according to\n            // https://tches.iacr.org/index.php/TCHES/article/view/7337/6509. We've decided against it:\n            // a) dependency on CSPRNG b) 15% slowdown c) doesn't really help since bigints are not CT\n            const s = modN(ik * modN(m + r * d)); // Not using blinding here\n            if (s === _0n)\n                return;\n            let recovery = (q.x === r ? 0 : 2) | Number(q.y & _1n); // recovery bit (2 or 3, when q.x > n)\n            let normS = s;\n            if (lowS && isBiggerThanHalfOrder(s)) {\n                normS = normalizeS(s); // if lowS was passed, ensure s is always\n                recovery ^= 1; // // in the bottom half of N\n            }\n            return new Signature(r, normS, recovery); // use normS, not s\n        }\n        return { seed, k2sig };\n    }\n    const defaultSigOpts = { lowS: CURVE.lowS, prehash: false };\n    const defaultVerOpts = { lowS: CURVE.lowS, prehash: false };\n    /**\n     * Signs message hash with a private key.\n     * ```\n     * sign(m, d, k) where\n     *   (x, y) = G × k\n     *   r = x mod n\n     *   s = (m + dr)/k mod n\n     * ```\n     * @param msgHash NOT message. msg needs to be hashed to `msgHash`, or use `prehash`.\n     * @param privKey private key\n     * @param opts lowS for non-malleable sigs. extraEntropy for mixing randomness into k. prehash will hash first arg.\n     * @returns signature with recovery param\n     */\n    function sign(msgHash, privKey, opts = defaultSigOpts) {\n        const { seed, k2sig } = prepSig(msgHash, privKey, opts); // Steps A, D of RFC6979 3.2.\n        const C = CURVE;\n        const drbg = ut.createHmacDrbg(C.hash.outputLen, C.nByteLength, C.hmac);\n        return drbg(seed, k2sig); // Steps B, C, D, E, F, G\n    }\n    // Enable precomputes. Slows down first publicKey computation by 20ms.\n    Point.BASE._setWindowSize(8);\n    // utils.precompute(8, ProjectivePoint.BASE)\n    /**\n     * Verifies a signature against message hash and public key.\n     * Rejects lowS signatures by default: to override,\n     * specify option `{lowS: false}`. Implements section 4.1.4 from https://www.secg.org/sec1-v2.pdf:\n     *\n     * ```\n     * verify(r, s, h, P) where\n     *   U1 = hs^-1 mod n\n     *   U2 = rs^-1 mod n\n     *   R = U1⋅G - U2⋅P\n     *   mod(R.x, n) == r\n     * ```\n     */\n    function verify(signature, msgHash, publicKey, opts = defaultVerOpts) {\n        const sg = signature;\n        msgHash = ensureBytes('msgHash', msgHash);\n        publicKey = ensureBytes('publicKey', publicKey);\n        if ('strict' in opts)\n            throw new Error('options.strict was renamed to lowS');\n        const { lowS, prehash } = opts;\n        let _sig = undefined;\n        let P;\n        try {\n            if (typeof sg === 'string' || sg instanceof Uint8Array) {\n                // Signature can be represented in 2 ways: compact (2*nByteLength) & DER (variable-length).\n                // Since DER can also be 2*nByteLength bytes, we check for it first.\n                try {\n                    _sig = Signature.fromDER(sg);\n                }\n                catch (derError) {\n                    if (!(derError instanceof DER.Err))\n                        throw derError;\n                    _sig = Signature.fromCompact(sg);\n                }\n            }\n            else if (typeof sg === 'object' && typeof sg.r === 'bigint' && typeof sg.s === 'bigint') {\n                const { r, s } = sg;\n                _sig = new Signature(r, s);\n            }\n            else {\n                throw new Error('PARSE');\n            }\n            P = Point.fromHex(publicKey);\n        }\n        catch (error) {\n            if (error.message === 'PARSE')\n                throw new Error(`signature must be Signature instance, Uint8Array or hex string`);\n            return false;\n        }\n        if (lowS && _sig.hasHighS())\n            return false;\n        if (prehash)\n            msgHash = CURVE.hash(msgHash);\n        const { r, s } = _sig;\n        const h = bits2int_modN(msgHash); // Cannot use fields methods, since it is group element\n        const is = invN(s); // s^-1\n        const u1 = modN(h * is); // u1 = hs^-1 mod n\n        const u2 = modN(r * is); // u2 = rs^-1 mod n\n        const R = Point.BASE.multiplyAndAddUnsafe(P, u1, u2)?.toAffine(); // R = u1⋅G + u2⋅P\n        if (!R)\n            return false;\n        const v = modN(R.x);\n        return v === r;\n    }\n    return {\n        CURVE,\n        getPublicKey,\n        getSharedSecret,\n        sign,\n        verify,\n        ProjectivePoint: Point,\n        Signature,\n        utils,\n    };\n}\n/**\n * Implementation of the Shallue and van de Woestijne method for any weierstrass curve.\n * TODO: check if there is a way to merge this with uvRatio in Edwards; move to modular.\n * b = True and y = sqrt(u / v) if (u / v) is square in F, and\n * b = False and y = sqrt(Z * (u / v)) otherwise.\n * @param Fp\n * @param Z\n * @returns\n */\nexport function SWUFpSqrtRatio(Fp, Z) {\n    // Generic implementation\n    const q = Fp.ORDER;\n    let l = _0n;\n    for (let o = q - _1n; o % _2n === _0n; o /= _2n)\n        l += _1n;\n    const c1 = l; // 1. c1, the largest integer such that 2^c1 divides q - 1.\n    // We need 2n ** c1 and 2n ** (c1-1). We can't use **; but we can use <<.\n    // 2n ** c1 == 2n << (c1-1)\n    const _2n_pow_c1_1 = _2n << (c1 - _1n - _1n);\n    const _2n_pow_c1 = _2n_pow_c1_1 * _2n;\n    const c2 = (q - _1n) / _2n_pow_c1; // 2. c2 = (q - 1) / (2^c1)  # Integer arithmetic\n    const c3 = (c2 - _1n) / _2n; // 3. c3 = (c2 - 1) / 2            # Integer arithmetic\n    const c4 = _2n_pow_c1 - _1n; // 4. c4 = 2^c1 - 1                # Integer arithmetic\n    const c5 = _2n_pow_c1_1; // 5. c5 = 2^(c1 - 1)                  # Integer arithmetic\n    const c6 = Fp.pow(Z, c2); // 6. c6 = Z^c2\n    const c7 = Fp.pow(Z, (c2 + _1n) / _2n); // 7. c7 = Z^((c2 + 1) / 2)\n    let sqrtRatio = (u, v) => {\n        let tv1 = c6; // 1. tv1 = c6\n        let tv2 = Fp.pow(v, c4); // 2. tv2 = v^c4\n        let tv3 = Fp.sqr(tv2); // 3. tv3 = tv2^2\n        tv3 = Fp.mul(tv3, v); // 4. tv3 = tv3 * v\n        let tv5 = Fp.mul(u, tv3); // 5. tv5 = u * tv3\n        tv5 = Fp.pow(tv5, c3); // 6. tv5 = tv5^c3\n        tv5 = Fp.mul(tv5, tv2); // 7. tv5 = tv5 * tv2\n        tv2 = Fp.mul(tv5, v); // 8. tv2 = tv5 * v\n        tv3 = Fp.mul(tv5, u); // 9. tv3 = tv5 * u\n        let tv4 = Fp.mul(tv3, tv2); // 10. tv4 = tv3 * tv2\n        tv5 = Fp.pow(tv4, c5); // 11. tv5 = tv4^c5\n        let isQR = Fp.eql(tv5, Fp.ONE); // 12. isQR = tv5 == 1\n        tv2 = Fp.mul(tv3, c7); // 13. tv2 = tv3 * c7\n        tv5 = Fp.mul(tv4, tv1); // 14. tv5 = tv4 * tv1\n        tv3 = Fp.cmov(tv2, tv3, isQR); // 15. tv3 = CMOV(tv2, tv3, isQR)\n        tv4 = Fp.cmov(tv5, tv4, isQR); // 16. tv4 = CMOV(tv5, tv4, isQR)\n        // 17. for i in (c1, c1 - 1, ..., 2):\n        for (let i = c1; i > _1n; i--) {\n            let tv5 = i - _2n; // 18.    tv5 = i - 2\n            tv5 = _2n << (tv5 - _1n); // 19.    tv5 = 2^tv5\n            let tvv5 = Fp.pow(tv4, tv5); // 20.    tv5 = tv4^tv5\n            const e1 = Fp.eql(tvv5, Fp.ONE); // 21.    e1 = tv5 == 1\n            tv2 = Fp.mul(tv3, tv1); // 22.    tv2 = tv3 * tv1\n            tv1 = Fp.mul(tv1, tv1); // 23.    tv1 = tv1 * tv1\n            tvv5 = Fp.mul(tv4, tv1); // 24.    tv5 = tv4 * tv1\n            tv3 = Fp.cmov(tv2, tv3, e1); // 25.    tv3 = CMOV(tv2, tv3, e1)\n            tv4 = Fp.cmov(tvv5, tv4, e1); // 26.    tv4 = CMOV(tv5, tv4, e1)\n        }\n        return { isValid: isQR, value: tv3 };\n    };\n    if (Fp.ORDER % _4n === _3n) {\n        // sqrt_ratio_3mod4(u, v)\n        const c1 = (Fp.ORDER - _3n) / _4n; // 1. c1 = (q - 3) / 4     # Integer arithmetic\n        const c2 = Fp.sqrt(Fp.neg(Z)); // 2. c2 = sqrt(-Z)\n        sqrtRatio = (u, v) => {\n            let tv1 = Fp.sqr(v); // 1. tv1 = v^2\n            const tv2 = Fp.mul(u, v); // 2. tv2 = u * v\n            tv1 = Fp.mul(tv1, tv2); // 3. tv1 = tv1 * tv2\n            let y1 = Fp.pow(tv1, c1); // 4. y1 = tv1^c1\n            y1 = Fp.mul(y1, tv2); // 5. y1 = y1 * tv2\n            const y2 = Fp.mul(y1, c2); // 6. y2 = y1 * c2\n            const tv3 = Fp.mul(Fp.sqr(y1), v); // 7. tv3 = y1^2; 8. tv3 = tv3 * v\n            const isQR = Fp.eql(tv3, u); // 9. isQR = tv3 == u\n            let y = Fp.cmov(y2, y1, isQR); // 10. y = CMOV(y2, y1, isQR)\n            return { isValid: isQR, value: y }; // 11. return (isQR, y) isQR ? y : y*c2\n        };\n    }\n    // No curves uses that\n    // if (Fp.ORDER % _8n === _5n) // sqrt_ratio_5mod8\n    return sqrtRatio;\n}\n/**\n * From draft-irtf-cfrg-hash-to-curve-16\n */\nexport function mapToCurveSimpleSWU(Fp, opts) {\n    mod.validateField(Fp);\n    if (!Fp.isValid(opts.A) || !Fp.isValid(opts.B) || !Fp.isValid(opts.Z))\n        throw new Error('mapToCurveSimpleSWU: invalid opts');\n    const sqrtRatio = SWUFpSqrtRatio(Fp, opts.Z);\n    if (!Fp.isOdd)\n        throw new Error('Fp.isOdd is not implemented!');\n    // Input: u, an element of F.\n    // Output: (x, y), a point on E.\n    return (u) => {\n        // prettier-ignore\n        let tv1, tv2, tv3, tv4, tv5, tv6, x, y;\n        tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n        tv1 = Fp.mul(tv1, opts.Z); // 2.  tv1 = Z * tv1\n        tv2 = Fp.sqr(tv1); // 3.  tv2 = tv1^2\n        tv2 = Fp.add(tv2, tv1); // 4.  tv2 = tv2 + tv1\n        tv3 = Fp.add(tv2, Fp.ONE); // 5.  tv3 = tv2 + 1\n        tv3 = Fp.mul(tv3, opts.B); // 6.  tv3 = B * tv3\n        tv4 = Fp.cmov(opts.Z, Fp.neg(tv2), !Fp.eql(tv2, Fp.ZERO)); // 7.  tv4 = CMOV(Z, -tv2, tv2 != 0)\n        tv4 = Fp.mul(tv4, opts.A); // 8.  tv4 = A * tv4\n        tv2 = Fp.sqr(tv3); // 9.  tv2 = tv3^2\n        tv6 = Fp.sqr(tv4); // 10. tv6 = tv4^2\n        tv5 = Fp.mul(tv6, opts.A); // 11. tv5 = A * tv6\n        tv2 = Fp.add(tv2, tv5); // 12. tv2 = tv2 + tv5\n        tv2 = Fp.mul(tv2, tv3); // 13. tv2 = tv2 * tv3\n        tv6 = Fp.mul(tv6, tv4); // 14. tv6 = tv6 * tv4\n        tv5 = Fp.mul(tv6, opts.B); // 15. tv5 = B * tv6\n        tv2 = Fp.add(tv2, tv5); // 16. tv2 = tv2 + tv5\n        x = Fp.mul(tv1, tv3); // 17.   x = tv1 * tv3\n        const { isValid, value } = sqrtRatio(tv2, tv6); // 18. (is_gx1_square, y1) = sqrt_ratio(tv2, tv6)\n        y = Fp.mul(tv1, u); // 19.   y = tv1 * u  -> Z * u^3 * y1\n        y = Fp.mul(y, value); // 20.   y = y * y1\n        x = Fp.cmov(x, tv3, isValid); // 21.   x = CMOV(x, tv3, is_gx1_square)\n        y = Fp.cmov(y, value, isValid); // 22.   y = CMOV(y, y1, is_gx1_square)\n        const e1 = Fp.isOdd(u) === Fp.isOdd(y); // 23.  e1 = sgn0(u) == sgn0(y)\n        y = Fp.cmov(Fp.neg(y), y, e1); // 24.   y = CMOV(-y, y, e1)\n        x = Fp.div(x, tv4); // 25.   x = x / tv4\n        return { x, y };\n    };\n}\n//# sourceMappingURL=weierstrass.js.map","import assert from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assert.hash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assert.exists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.bytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { hmac } from '@noble/hashes/hmac';\nimport { concatBytes, randomBytes } from '@noble/hashes/utils';\nimport { weierstrass } from './abstract/weierstrass.js';\n// connects noble-curves to noble-hashes\nexport function getHash(hash) {\n    return {\n        hash,\n        hmac: (key, ...msgs) => hmac(hash, key, concatBytes(...msgs)),\n        randomBytes,\n    };\n}\nexport function createCurve(curveDef, defHash) {\n    const create = (hash) => weierstrass({ ...curveDef, ...getHash(hash) });\n    return Object.freeze({ ...create(defHash), create });\n}\n//# sourceMappingURL=_shortw_utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha256 } from '@noble/hashes/sha256';\nimport { randomBytes } from '@noble/hashes/utils';\nimport { Field, mod, pow2 } from './abstract/modular.js';\nimport { mapToCurveSimpleSWU } from './abstract/weierstrass.js';\nimport { bytesToNumberBE, concatBytes, ensureBytes, numberToBytesBE } from './abstract/utils.js';\nimport { createHasher, isogenyMap } from './abstract/hash-to-curve.js';\nimport { createCurve } from './_shortw_utils.js';\nconst secp256k1P = BigInt('0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f');\nconst secp256k1N = BigInt('0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141');\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst divNearest = (a, b) => (a + b / _2n) / b;\n/**\n * √n = n^((p+1)/4) for fields p = 3 mod 4. We unwrap the loop and multiply bit-by-bit.\n * (P+1n/4n).toString(2) would produce bits [223x 1, 0, 22x 1, 4x 0, 11, 00]\n */\nfunction sqrtMod(y) {\n    const P = secp256k1P;\n    // prettier-ignore\n    const _3n = BigInt(3), _6n = BigInt(6), _11n = BigInt(11), _22n = BigInt(22);\n    // prettier-ignore\n    const _23n = BigInt(23), _44n = BigInt(44), _88n = BigInt(88);\n    const b2 = (y * y * y) % P; // x^3, 11\n    const b3 = (b2 * b2 * y) % P; // x^7\n    const b6 = (pow2(b3, _3n, P) * b3) % P;\n    const b9 = (pow2(b6, _3n, P) * b3) % P;\n    const b11 = (pow2(b9, _2n, P) * b2) % P;\n    const b22 = (pow2(b11, _11n, P) * b11) % P;\n    const b44 = (pow2(b22, _22n, P) * b22) % P;\n    const b88 = (pow2(b44, _44n, P) * b44) % P;\n    const b176 = (pow2(b88, _88n, P) * b88) % P;\n    const b220 = (pow2(b176, _44n, P) * b44) % P;\n    const b223 = (pow2(b220, _3n, P) * b3) % P;\n    const t1 = (pow2(b223, _23n, P) * b22) % P;\n    const t2 = (pow2(t1, _6n, P) * b2) % P;\n    const root = pow2(t2, _2n, P);\n    if (!Fp.eql(Fp.sqr(root), y))\n        throw new Error('Cannot find square root');\n    return root;\n}\nconst Fp = Field(secp256k1P, undefined, undefined, { sqrt: sqrtMod });\nexport const secp256k1 = createCurve({\n    a: BigInt(0),\n    b: BigInt(7),\n    Fp,\n    n: secp256k1N,\n    // Base point (x, y) aka generator point\n    Gx: BigInt('55066263022277343669578718895168534326250603453777594175500187360389116729240'),\n    Gy: BigInt('32670510020758816978083085130507043184471273380659243275938904335757337482424'),\n    h: BigInt(1),\n    lowS: true,\n    /**\n     * secp256k1 belongs to Koblitz curves: it has efficiently computable endomorphism.\n     * Endomorphism uses 2x less RAM, speeds up precomputation by 2x and ECDH / key recovery by 20%.\n     * For precomputed wNAF it trades off 1/2 init time & 1/3 ram for 20% perf hit.\n     * Explanation: https://gist.github.com/paulmillr/eb670806793e84df628a7c434a873066\n     */\n    endo: {\n        beta: BigInt('0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee'),\n        splitScalar: (k) => {\n            const n = secp256k1N;\n            const a1 = BigInt('0x3086d221a7d46bcde86c90e49284eb15');\n            const b1 = -_1n * BigInt('0xe4437ed6010e88286f547fa90abfe4c3');\n            const a2 = BigInt('0x114ca50f7a8e2f3f657c1108d9d44cfd8');\n            const b2 = a1;\n            const POW_2_128 = BigInt('0x100000000000000000000000000000000'); // (2n**128n).toString(16)\n            const c1 = divNearest(b2 * k, n);\n            const c2 = divNearest(-b1 * k, n);\n            let k1 = mod(k - c1 * a1 - c2 * a2, n);\n            let k2 = mod(-c1 * b1 - c2 * b2, n);\n            const k1neg = k1 > POW_2_128;\n            const k2neg = k2 > POW_2_128;\n            if (k1neg)\n                k1 = n - k1;\n            if (k2neg)\n                k2 = n - k2;\n            if (k1 > POW_2_128 || k2 > POW_2_128) {\n                throw new Error('splitScalar: Endomorphism failed, k=' + k);\n            }\n            return { k1neg, k1, k2neg, k2 };\n        },\n    },\n}, sha256);\n// Schnorr signatures are superior to ECDSA from above. Below is Schnorr-specific BIP0340 code.\n// https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki\nconst _0n = BigInt(0);\nconst fe = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1P;\nconst ge = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1N;\n/** An object mapping tags to their tagged hash prefix of [SHA256(tag) | SHA256(tag)] */\nconst TAGGED_HASH_PREFIXES = {};\nfunction taggedHash(tag, ...messages) {\n    let tagP = TAGGED_HASH_PREFIXES[tag];\n    if (tagP === undefined) {\n        const tagH = sha256(Uint8Array.from(tag, (c) => c.charCodeAt(0)));\n        tagP = concatBytes(tagH, tagH);\n        TAGGED_HASH_PREFIXES[tag] = tagP;\n    }\n    return sha256(concatBytes(tagP, ...messages));\n}\n// ECDSA compact points are 33-byte. Schnorr is 32: we strip first byte 0x02 or 0x03\nconst pointToBytes = (point) => point.toRawBytes(true).slice(1);\nconst numTo32b = (n) => numberToBytesBE(n, 32);\nconst modP = (x) => mod(x, secp256k1P);\nconst modN = (x) => mod(x, secp256k1N);\nconst Point = secp256k1.ProjectivePoint;\nconst GmulAdd = (Q, a, b) => Point.BASE.multiplyAndAddUnsafe(Q, a, b);\n// Calculate point, scalar and bytes\nfunction schnorrGetExtPubKey(priv) {\n    let d_ = secp256k1.utils.normPrivateKeyToScalar(priv); // same method executed in fromPrivateKey\n    let p = Point.fromPrivateKey(d_); // P = d'⋅G; 0 < d' < n check is done inside\n    const scalar = p.hasEvenY() ? d_ : modN(-d_);\n    return { scalar: scalar, bytes: pointToBytes(p) };\n}\n/**\n * lift_x from BIP340. Convert 32-byte x coordinate to elliptic curve point.\n * @returns valid point checked for being on-curve\n */\nfunction lift_x(x) {\n    if (!fe(x))\n        throw new Error('bad x: need 0 < x < p'); // Fail if x ≥ p.\n    const xx = modP(x * x);\n    const c = modP(xx * x + BigInt(7)); // Let c = x³ + 7 mod p.\n    let y = sqrtMod(c); // Let y = c^(p+1)/4 mod p.\n    if (y % _2n !== _0n)\n        y = modP(-y); // Return the unique point P such that x(P) = x and\n    const p = new Point(x, y, _1n); // y(P) = y if y mod 2 = 0 or y(P) = p-y otherwise.\n    p.assertValidity();\n    return p;\n}\n/**\n * Create tagged hash, convert it to bigint, reduce modulo-n.\n */\nfunction challenge(...args) {\n    return modN(bytesToNumberBE(taggedHash('BIP0340/challenge', ...args)));\n}\n/**\n * Schnorr public key is just `x` coordinate of Point as per BIP340.\n */\nfunction schnorrGetPublicKey(privateKey) {\n    return schnorrGetExtPubKey(privateKey).bytes; // d'=int(sk). Fail if d'=0 or d'≥n. Ret bytes(d'⋅G)\n}\n/**\n * Creates Schnorr signature as per BIP340. Verifies itself before returning anything.\n * auxRand is optional and is not the sole source of k generation: bad CSPRNG won't be dangerous.\n */\nfunction schnorrSign(message, privateKey, auxRand = randomBytes(32)) {\n    const m = ensureBytes('message', message);\n    const { bytes: px, scalar: d } = schnorrGetExtPubKey(privateKey); // checks for isWithinCurveOrder\n    const a = ensureBytes('auxRand', auxRand, 32); // Auxiliary random data a: a 32-byte array\n    const t = numTo32b(d ^ bytesToNumberBE(taggedHash('BIP0340/aux', a))); // Let t be the byte-wise xor of bytes(d) and hash/aux(a)\n    const rand = taggedHash('BIP0340/nonce', t, px, m); // Let rand = hash/nonce(t || bytes(P) || m)\n    const k_ = modN(bytesToNumberBE(rand)); // Let k' = int(rand) mod n\n    if (k_ === _0n)\n        throw new Error('sign failed: k is zero'); // Fail if k' = 0.\n    const { bytes: rx, scalar: k } = schnorrGetExtPubKey(k_); // Let R = k'⋅G.\n    const e = challenge(rx, px, m); // Let e = int(hash/challenge(bytes(R) || bytes(P) || m)) mod n.\n    const sig = new Uint8Array(64); // Let sig = bytes(R) || bytes((k + ed) mod n).\n    sig.set(rx, 0);\n    sig.set(numTo32b(modN(k + e * d)), 32);\n    // If Verify(bytes(P), m, sig) (see below) returns failure, abort\n    if (!schnorrVerify(sig, m, px))\n        throw new Error('sign: Invalid signature produced');\n    return sig;\n}\n/**\n * Verifies Schnorr signature.\n * Will swallow errors & return false except for initial type validation of arguments.\n */\nfunction schnorrVerify(signature, message, publicKey) {\n    const sig = ensureBytes('signature', signature, 64);\n    const m = ensureBytes('message', message);\n    const pub = ensureBytes('publicKey', publicKey, 32);\n    try {\n        const P = lift_x(bytesToNumberBE(pub)); // P = lift_x(int(pk)); fail if that fails\n        const r = bytesToNumberBE(sig.subarray(0, 32)); // Let r = int(sig[0:32]); fail if r ≥ p.\n        if (!fe(r))\n            return false;\n        const s = bytesToNumberBE(sig.subarray(32, 64)); // Let s = int(sig[32:64]); fail if s ≥ n.\n        if (!ge(s))\n            return false;\n        const e = challenge(numTo32b(r), pointToBytes(P), m); // int(challenge(bytes(r)||bytes(P)||m))%n\n        const R = GmulAdd(P, s, modN(-e)); // R = s⋅G - e⋅P\n        if (!R || !R.hasEvenY() || R.toAffine().x !== r)\n            return false; // -eP == (n-e)P\n        return true; // Fail if is_infinite(R) / not has_even_y(R) / x(R) ≠ r.\n    }\n    catch (error) {\n        return false;\n    }\n}\nexport const schnorr = /* @__PURE__ */ (() => ({\n    getPublicKey: schnorrGetPublicKey,\n    sign: schnorrSign,\n    verify: schnorrVerify,\n    utils: {\n        randomPrivateKey: secp256k1.utils.randomPrivateKey,\n        lift_x,\n        pointToBytes,\n        numberToBytesBE,\n        bytesToNumberBE,\n        taggedHash,\n        mod,\n    },\n}))();\nconst isoMap = /* @__PURE__ */ (() => isogenyMap(Fp, [\n    // xNum\n    [\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7',\n        '0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581',\n        '0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262',\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c',\n    ],\n    // xDen\n    [\n        '0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b',\n        '0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n    // yNum\n    [\n        '0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c',\n        '0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3',\n        '0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931',\n        '0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84',\n    ],\n    // yDen\n    [\n        '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b',\n        '0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573',\n        '0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n].map((i) => i.map((j) => BigInt(j)))))();\nconst mapSWU = /* @__PURE__ */ (() => mapToCurveSimpleSWU(Fp, {\n    A: BigInt('0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533'),\n    B: BigInt('1771'),\n    Z: Fp.create(BigInt('-11')),\n}))();\nconst htf = /* @__PURE__ */ (() => createHasher(secp256k1.ProjectivePoint, (scalars) => {\n    const { x, y } = mapSWU(Fp.create(scalars[0]));\n    return isoMap(x, y);\n}, {\n    DST: 'secp256k1_XMD:SHA-256_SSWU_RO_',\n    encodeDST: 'secp256k1_XMD:SHA-256_SSWU_NU_',\n    p: Fp.ORDER,\n    m: 1,\n    k: 128,\n    expand: 'xmd',\n    hash: sha256,\n}))();\nexport const hashToCurve = /* @__PURE__ */ (() => htf.hashToCurve)();\nexport const encodeToCurve = /* @__PURE__ */ (() => htf.encodeToCurve)();\n//# sourceMappingURL=secp256k1.js.map","/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nexport function assertNumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`Wrong integer: ${n}`);\n}\nfunction chain(...args) {\n    const wrap = (a, b) => (c) => a(b(c));\n    const encode = Array.from(args)\n        .reverse()\n        .reduce((acc, i) => (acc ? wrap(acc, i.encode) : i.encode), undefined);\n    const decode = args.reduce((acc, i) => (acc ? wrap(acc, i.decode) : i.decode), undefined);\n    return { encode, decode };\n}\nfunction alphabet(alphabet) {\n    return {\n        encode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('alphabet.encode input should be an array of numbers');\n            return digits.map((i) => {\n                assertNumber(i);\n                if (i < 0 || i >= alphabet.length)\n                    throw new Error(`Digit index outside alphabet: ${i} (alphabet: ${alphabet.length})`);\n                return alphabet[i];\n            });\n        },\n        decode: (input) => {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('alphabet.decode input should be array of strings');\n            return input.map((letter) => {\n                if (typeof letter !== 'string')\n                    throw new Error(`alphabet.decode: not string element=${letter}`);\n                const index = alphabet.indexOf(letter);\n                if (index === -1)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${alphabet}`);\n                return index;\n            });\n        },\n    };\n}\nfunction join(separator = '') {\n    if (typeof separator !== 'string')\n        throw new Error('join separator should be string');\n    return {\n        encode: (from) => {\n            if (!Array.isArray(from) || (from.length && typeof from[0] !== 'string'))\n                throw new Error('join.encode input should be array of strings');\n            for (let i of from)\n                if (typeof i !== 'string')\n                    throw new Error(`join.encode: non-string input=${i}`);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            if (typeof to !== 'string')\n                throw new Error('join.decode input should be string');\n            return to.split(separator);\n        },\n    };\n}\nfunction padding(bits, chr = '=') {\n    assertNumber(bits);\n    if (typeof chr !== 'string')\n        throw new Error('padding chr should be string');\n    return {\n        encode(data) {\n            if (!Array.isArray(data) || (data.length && typeof data[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of data)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.encode: non-string input=${i}`);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of input)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.decode: non-string input=${i}`);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('Invalid padding: string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                if (!(((end - 1) * bits) % 8))\n                    throw new Error('Invalid padding: string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\nfunction normalize(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('normalize fn should be function');\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\nfunction convertRadix(data, from, to) {\n    if (from < 2)\n        throw new Error(`convertRadix: wrong from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: wrong to=${to}, base cannot be less than 2`);\n    if (!Array.isArray(data))\n        throw new Error('convertRadix: data should be array');\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data);\n    digits.forEach((d) => {\n        assertNumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`Wrong integer: ${d}`);\n    });\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < digits.length; i++) {\n            const digit = digits[i];\n            const digitBase = from * carry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                (from * carry) / from !== carry ||\n                digitBase - digit !== from * carry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            carry = digitBase % to;\n            digits[i] = Math.floor(digitBase / to);\n            if (!Number.isSafeInteger(digits[i]) || digits[i] * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!digits[i])\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = (a, b) => (!b ? a : gcd(b, a % b));\nconst radix2carry = (from, to) => from + (to - gcd(from, to));\nfunction convertRadix2(data, from, to, padding) {\n    if (!Array.isArray(data))\n        throw new Error('convertRadix2: data should be array');\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0;\n    const mask = 2 ** to - 1;\n    const res = [];\n    for (const n of data) {\n        assertNumber(n);\n        if (n >= 2 ** from)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        carry &= 2 ** pos - 1;\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\nfunction radix(num) {\n    assertNumber(num);\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), 2 ** 8, num);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix.decode input should be array of strings');\n            return Uint8Array.from(convertRadix(digits, num, 2 ** 8));\n        },\n    };\n}\nfunction radix2(bits, revPadding = false) {\n    assertNumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix2.decode input should be array of strings');\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\nfunction unsafeWrapper(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('unsafeWrapper fn should be function');\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\nfunction checksum(len, fn) {\n    assertNumber(len);\n    if (typeof fn !== 'function')\n        throw new Error('checksum fn should be function');\n    return {\n        encode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const checksum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(checksum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const newChecksum = fn(payload).slice(0, len);\n            const oldChecksum = data.slice(-len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\nexport const utils = { alphabet, chain, checksum, radix, radix2, join, padding };\nexport const base16 = chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\nexport const base32 = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\nexport const base32hex = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\nexport const base32crockford = chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\nexport const base64 = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\nexport const base64url = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\nconst genBase58 = (abc) => chain(radix(58), alphabet(abc), join(''));\nexport const base58 = genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\nexport const base58flickr = genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\nexport const base58xrp = genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\nexport const base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\nexport const base58check = (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), base58);\nconst BECH_ALPHABET = chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % 2 ** 30], 30, 5, false));\n}\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        if (typeof prefix !== 'string')\n            throw new Error(`bech32.encode prefix should be string, not ${typeof prefix}`);\n        if (!Array.isArray(words) || (words.length && typeof words[0] !== 'number'))\n            throw new Error(`bech32.encode words should be array of numbers, not ${typeof words}`);\n        const actualLength = prefix.length + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        prefix = prefix.toLowerCase();\n        return `${prefix}1${BECH_ALPHABET.encode(words)}${bechChecksum(prefix, words, ENCODING_CONST)}`;\n    }\n    function decode(str, limit = 90) {\n        if (typeof str !== 'string')\n            throw new Error(`bech32.decode input should be string, not ${typeof str}`);\n        if (str.length < 8 || (limit !== false && str.length > limit))\n            throw new TypeError(`Wrong string length: ${str.length} (${str}). Expected (8..${limit})`);\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        str = lowered;\n        const sepIndex = str.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = str.slice(0, sepIndex);\n        const _words = str.slice(sepIndex + 1);\n        if (_words.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(_words).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!_words.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    return { encode, decode, decodeToBytes, decodeUnsafe, fromWords, fromWordsUnsafe, toWords };\n}\nexport const bech32 = genBech32('bech32');\nexport const bech32m = genBech32('bech32m');\nexport const utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\nexport const hex = chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n    if (typeof s !== 'string' || s.length % 2)\n        throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n    return s.toLowerCase();\n}));\nconst CODERS = {\n    utf8, hex, base16, base32, base64, base64url, base58, base58xmr\n};\nconst coderTypeError = `Invalid encoding type. Available types: ${Object.keys(CODERS).join(', ')}`;\nexport const bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!(bytes instanceof Uint8Array))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\nexport const str = bytesToString;\nexport const stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\nexport const bytes = stringToBytes;\n","export const wordlist = `abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo`.split('\\n');\n//# sourceMappingURL=english.js.map","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\n// copied from utils\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nfunction bytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\n// Other libraries would silently corrupt the data instead of throwing an error,\n// when they don't support it.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!isBytes(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!isBytes(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        if (!isBytes(a))\n            throw new Error('Uint8Array expected');\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { hash as assertHash, bytes as assertBytes, exists as assertExists } from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assertHash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assertExists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assertExists(this);\n        assertBytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","import { hash as assertHash, number as assertNumber } from './_assert.js';\nimport { hmac } from './hmac.js';\nimport { createView, toBytes, checkOpts, asyncLoop } from './utils.js';\n// Common prologue and epilogue for sync/async functions\nfunction pbkdf2Init(hash, _password, _salt, _opts) {\n    assertHash(hash);\n    const opts = checkOpts({ dkLen: 32, asyncTick: 10 }, _opts);\n    const { c, dkLen, asyncTick } = opts;\n    assertNumber(c);\n    assertNumber(dkLen);\n    assertNumber(asyncTick);\n    if (c < 1)\n        throw new Error('PBKDF2: iterations (c) should be >= 1');\n    const password = toBytes(_password);\n    const salt = toBytes(_salt);\n    // DK = PBKDF2(PRF, Password, Salt, c, dkLen);\n    const DK = new Uint8Array(dkLen);\n    // U1 = PRF(Password, Salt + INT_32_BE(i))\n    const PRF = hmac.create(hash, password);\n    const PRFSalt = PRF._cloneInto().update(salt);\n    return { c, dkLen, asyncTick, DK, PRF, PRFSalt };\n}\nfunction pbkdf2Output(PRF, PRFSalt, DK, prfW, u) {\n    PRF.destroy();\n    PRFSalt.destroy();\n    if (prfW)\n        prfW.destroy();\n    u.fill(0);\n    return DK;\n}\n/**\n * PBKDF2-HMAC: RFC 2898 key derivation function\n * @param hash - hash function that would be used e.g. sha256\n * @param password - password from which a derived key is generated\n * @param salt - cryptographic salt\n * @param opts - {c, dkLen} where c is work factor and dkLen is output message size\n */\nexport function pbkdf2(hash, password, salt, opts) {\n    const { c, dkLen, DK, PRF, PRFSalt } = pbkdf2Init(hash, password, salt, opts);\n    let prfW; // Working copy\n    const arr = new Uint8Array(4);\n    const view = createView(arr);\n    const u = new Uint8Array(PRF.outputLen);\n    // DK = T1 + T2 + ⋯ + Tdklen/hlen\n    for (let ti = 1, pos = 0; pos < dkLen; ti++, pos += PRF.outputLen) {\n        // Ti = F(Password, Salt, c, i)\n        const Ti = DK.subarray(pos, pos + PRF.outputLen);\n        view.setInt32(0, ti, false);\n        // F(Password, Salt, c, i) = U1 ^ U2 ^ ⋯ ^ Uc\n        // U1 = PRF(Password, Salt + INT_32_BE(i))\n        (prfW = PRFSalt._cloneInto(prfW)).update(arr).digestInto(u);\n        Ti.set(u.subarray(0, Ti.length));\n        for (let ui = 1; ui < c; ui++) {\n            // Uc = PRF(Password, Uc−1)\n            PRF._cloneInto(prfW).update(u).digestInto(u);\n            for (let i = 0; i < Ti.length; i++)\n                Ti[i] ^= u[i];\n        }\n    }\n    return pbkdf2Output(PRF, PRFSalt, DK, prfW, u);\n}\nexport async function pbkdf2Async(hash, password, salt, opts) {\n    const { c, dkLen, asyncTick, DK, PRF, PRFSalt } = pbkdf2Init(hash, password, salt, opts);\n    let prfW; // Working copy\n    const arr = new Uint8Array(4);\n    const view = createView(arr);\n    const u = new Uint8Array(PRF.outputLen);\n    // DK = T1 + T2 + ⋯ + Tdklen/hlen\n    for (let ti = 1, pos = 0; pos < dkLen; ti++, pos += PRF.outputLen) {\n        // Ti = F(Password, Salt, c, i)\n        const Ti = DK.subarray(pos, pos + PRF.outputLen);\n        view.setInt32(0, ti, false);\n        // F(Password, Salt, c, i) = U1 ^ U2 ^ ⋯ ^ Uc\n        // U1 = PRF(Password, Salt + INT_32_BE(i))\n        (prfW = PRFSalt._cloneInto(prfW)).update(arr).digestInto(u);\n        Ti.set(u.subarray(0, Ti.length));\n        await asyncLoop(c - 1, asyncTick, () => {\n            // Uc = PRF(Password, Uc−1)\n            PRF._cloneInto(prfW).update(u).digestInto(u);\n            for (let i = 0; i < Ti.length; i++)\n                Ti[i] ^= u[i];\n        });\n    }\n    return pbkdf2Output(PRF, PRFSalt, DK, prfW, u);\n}\n//# sourceMappingURL=pbkdf2.js.map","import { exists, output } from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        exists(this);\n        output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = /* @__PURE__ */ wrapConstructor(() => new SHA256());\nexport const sha224 = /* @__PURE__ */ wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","const U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\n// We are not using BigUint64Array, because they are extremely slow as per 2022\nfunction fromBig(n, le = false) {\n    if (le)\n        return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n    return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\nfunction split(lst, le = false) {\n    let Ah = new Uint32Array(lst.length);\n    let Al = new Uint32Array(lst.length);\n    for (let i = 0; i < lst.length; i++) {\n        const { h, l } = fromBig(lst[i], le);\n        [Ah[i], Al[i]] = [h, l];\n    }\n    return [Ah, Al];\n}\nconst toBig = (h, l) => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h, _l, s) => h >>> s;\nconst shrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h, l, s) => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h, l, s) => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h, l, s) => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h, l) => l;\nconst rotr32L = (h, _l) => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h, l, s) => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h, l, s) => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h, l, s) => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h, l, s) => (h << (s - 32)) | (l >>> (64 - s));\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(Ah, Al, Bh, Bl) {\n    const l = (Al >>> 0) + (Bl >>> 0);\n    return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al, Bl, Cl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low, Ah, Bh, Ch) => (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al, Bl, Cl, Dl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low, Ah, Bh, Ch, Dh) => (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al, Bl, Cl, Dl, El) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low, Ah, Bh, Ch, Dh, Eh) => (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n// prettier-ignore\nexport { fromBig, split, toBig, shrSH, shrSL, rotrSH, rotrSL, rotrBH, rotrBL, rotr32H, rotr32L, rotlSH, rotlSL, rotlBH, rotlBL, add, add3L, add3H, add4L, add4H, add5H, add5L, };\n// prettier-ignore\nconst u64 = {\n    fromBig, split, toBig,\n    shrSH, shrSL,\n    rotrSH, rotrSL, rotrBH, rotrBL,\n    rotr32H, rotr32L,\n    rotlSH, rotlSL, rotlBH, rotlBL,\n    add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\nexport default u64;\n//# sourceMappingURL=_u64.js.map","import { SHA2 } from './_sha2.js';\nimport u64 from './_u64.js';\nimport { wrapConstructor } from './utils.js';\n// Round contants (first 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409):\n// prettier-ignore\nconst [SHA512_Kh, SHA512_Kl] = /* @__PURE__ */ (() => u64.split([\n    '0x428a2f98d728ae22', '0x7137449123ef65cd', '0xb5c0fbcfec4d3b2f', '0xe9b5dba58189dbbc',\n    '0x3956c25bf348b538', '0x59f111f1b605d019', '0x923f82a4af194f9b', '0xab1c5ed5da6d8118',\n    '0xd807aa98a3030242', '0x12835b0145706fbe', '0x243185be4ee4b28c', '0x550c7dc3d5ffb4e2',\n    '0x72be5d74f27b896f', '0x80deb1fe3b1696b1', '0x9bdc06a725c71235', '0xc19bf174cf692694',\n    '0xe49b69c19ef14ad2', '0xefbe4786384f25e3', '0x0fc19dc68b8cd5b5', '0x240ca1cc77ac9c65',\n    '0x2de92c6f592b0275', '0x4a7484aa6ea6e483', '0x5cb0a9dcbd41fbd4', '0x76f988da831153b5',\n    '0x983e5152ee66dfab', '0xa831c66d2db43210', '0xb00327c898fb213f', '0xbf597fc7beef0ee4',\n    '0xc6e00bf33da88fc2', '0xd5a79147930aa725', '0x06ca6351e003826f', '0x142929670a0e6e70',\n    '0x27b70a8546d22ffc', '0x2e1b21385c26c926', '0x4d2c6dfc5ac42aed', '0x53380d139d95b3df',\n    '0x650a73548baf63de', '0x766a0abb3c77b2a8', '0x81c2c92e47edaee6', '0x92722c851482353b',\n    '0xa2bfe8a14cf10364', '0xa81a664bbc423001', '0xc24b8b70d0f89791', '0xc76c51a30654be30',\n    '0xd192e819d6ef5218', '0xd69906245565a910', '0xf40e35855771202a', '0x106aa07032bbd1b8',\n    '0x19a4c116b8d2d0c8', '0x1e376c085141ab53', '0x2748774cdf8eeb99', '0x34b0bcb5e19b48a8',\n    '0x391c0cb3c5c95a63', '0x4ed8aa4ae3418acb', '0x5b9cca4f7763e373', '0x682e6ff3d6b2b8a3',\n    '0x748f82ee5defb2fc', '0x78a5636f43172f60', '0x84c87814a1f0ab72', '0x8cc702081a6439ec',\n    '0x90befffa23631e28', '0xa4506cebde82bde9', '0xbef9a3f7b2c67915', '0xc67178f2e372532b',\n    '0xca273eceea26619c', '0xd186b8c721c0c207', '0xeada7dd6cde0eb1e', '0xf57d4f7fee6ed178',\n    '0x06f067aa72176fba', '0x0a637dc5a2c898a6', '0x113f9804bef90dae', '0x1b710b35131c471b',\n    '0x28db77f523047d84', '0x32caab7b40c72493', '0x3c9ebe0a15c9bebc', '0x431d67c49c100d4c',\n    '0x4cc5d4becb3e42b6', '0x597f299cfc657e2a', '0x5fcb6fab3ad6faec', '0x6c44198c4a475817'\n].map(n => BigInt(n))))();\n// Temporary buffer, not used to store anything between runs\nconst SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);\nconst SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);\nexport class SHA512 extends SHA2 {\n    constructor() {\n        super(128, 64, 16, false);\n        // We cannot use array here since array allows indexing by variable which means optimizer/compiler cannot use registers.\n        // Also looks cleaner and easier to verify with spec.\n        // Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x6a09e667 | 0;\n        this.Al = 0xf3bcc908 | 0;\n        this.Bh = 0xbb67ae85 | 0;\n        this.Bl = 0x84caa73b | 0;\n        this.Ch = 0x3c6ef372 | 0;\n        this.Cl = 0xfe94f82b | 0;\n        this.Dh = 0xa54ff53a | 0;\n        this.Dl = 0x5f1d36f1 | 0;\n        this.Eh = 0x510e527f | 0;\n        this.El = 0xade682d1 | 0;\n        this.Fh = 0x9b05688c | 0;\n        this.Fl = 0x2b3e6c1f | 0;\n        this.Gh = 0x1f83d9ab | 0;\n        this.Gl = 0xfb41bd6b | 0;\n        this.Hh = 0x5be0cd19 | 0;\n        this.Hl = 0x137e2179 | 0;\n    }\n    // prettier-ignore\n    get() {\n        const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        return [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];\n    }\n    // prettier-ignore\n    set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl) {\n        this.Ah = Ah | 0;\n        this.Al = Al | 0;\n        this.Bh = Bh | 0;\n        this.Bl = Bl | 0;\n        this.Ch = Ch | 0;\n        this.Cl = Cl | 0;\n        this.Dh = Dh | 0;\n        this.Dl = Dl | 0;\n        this.Eh = Eh | 0;\n        this.El = El | 0;\n        this.Fh = Fh | 0;\n        this.Fl = Fl | 0;\n        this.Gh = Gh | 0;\n        this.Gl = Gl | 0;\n        this.Hh = Hh | 0;\n        this.Hl = Hl | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4) {\n            SHA512_W_H[i] = view.getUint32(offset);\n            SHA512_W_L[i] = view.getUint32((offset += 4));\n        }\n        for (let i = 16; i < 80; i++) {\n            // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)\n            const W15h = SHA512_W_H[i - 15] | 0;\n            const W15l = SHA512_W_L[i - 15] | 0;\n            const s0h = u64.rotrSH(W15h, W15l, 1) ^ u64.rotrSH(W15h, W15l, 8) ^ u64.shrSH(W15h, W15l, 7);\n            const s0l = u64.rotrSL(W15h, W15l, 1) ^ u64.rotrSL(W15h, W15l, 8) ^ u64.shrSL(W15h, W15l, 7);\n            // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)\n            const W2h = SHA512_W_H[i - 2] | 0;\n            const W2l = SHA512_W_L[i - 2] | 0;\n            const s1h = u64.rotrSH(W2h, W2l, 19) ^ u64.rotrBH(W2h, W2l, 61) ^ u64.shrSH(W2h, W2l, 6);\n            const s1l = u64.rotrSL(W2h, W2l, 19) ^ u64.rotrBL(W2h, W2l, 61) ^ u64.shrSL(W2h, W2l, 6);\n            // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];\n            const SUMl = u64.add4L(s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);\n            const SUMh = u64.add4H(SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);\n            SHA512_W_H[i] = SUMh | 0;\n            SHA512_W_L[i] = SUMl | 0;\n        }\n        let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        // Compression function main loop, 80 rounds\n        for (let i = 0; i < 80; i++) {\n            // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)\n            const sigma1h = u64.rotrSH(Eh, El, 14) ^ u64.rotrSH(Eh, El, 18) ^ u64.rotrBH(Eh, El, 41);\n            const sigma1l = u64.rotrSL(Eh, El, 14) ^ u64.rotrSL(Eh, El, 18) ^ u64.rotrBL(Eh, El, 41);\n            //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const CHIh = (Eh & Fh) ^ (~Eh & Gh);\n            const CHIl = (El & Fl) ^ (~El & Gl);\n            // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]\n            // prettier-ignore\n            const T1ll = u64.add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);\n            const T1h = u64.add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);\n            const T1l = T1ll | 0;\n            // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)\n            const sigma0h = u64.rotrSH(Ah, Al, 28) ^ u64.rotrBH(Ah, Al, 34) ^ u64.rotrBH(Ah, Al, 39);\n            const sigma0l = u64.rotrSL(Ah, Al, 28) ^ u64.rotrBL(Ah, Al, 34) ^ u64.rotrBL(Ah, Al, 39);\n            const MAJh = (Ah & Bh) ^ (Ah & Ch) ^ (Bh & Ch);\n            const MAJl = (Al & Bl) ^ (Al & Cl) ^ (Bl & Cl);\n            Hh = Gh | 0;\n            Hl = Gl | 0;\n            Gh = Fh | 0;\n            Gl = Fl | 0;\n            Fh = Eh | 0;\n            Fl = El | 0;\n            ({ h: Eh, l: El } = u64.add(Dh | 0, Dl | 0, T1h | 0, T1l | 0));\n            Dh = Ch | 0;\n            Dl = Cl | 0;\n            Ch = Bh | 0;\n            Cl = Bl | 0;\n            Bh = Ah | 0;\n            Bl = Al | 0;\n            const All = u64.add3L(T1l, sigma0l, MAJl);\n            Ah = u64.add3H(All, T1h, sigma0h, MAJh);\n            Al = All | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        ({ h: Ah, l: Al } = u64.add(this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));\n        ({ h: Bh, l: Bl } = u64.add(this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));\n        ({ h: Ch, l: Cl } = u64.add(this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));\n        ({ h: Dh, l: Dl } = u64.add(this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));\n        ({ h: Eh, l: El } = u64.add(this.Eh | 0, this.El | 0, Eh | 0, El | 0));\n        ({ h: Fh, l: Fl } = u64.add(this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));\n        ({ h: Gh, l: Gl } = u64.add(this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));\n        ({ h: Hh, l: Hl } = u64.add(this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));\n        this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);\n    }\n    roundClean() {\n        SHA512_W_H.fill(0);\n        SHA512_W_L.fill(0);\n    }\n    destroy() {\n        this.buffer.fill(0);\n        this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n    }\n}\nclass SHA512_224 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x8c3d37c8 | 0;\n        this.Al = 0x19544da2 | 0;\n        this.Bh = 0x73e19966 | 0;\n        this.Bl = 0x89dcd4d6 | 0;\n        this.Ch = 0x1dfab7ae | 0;\n        this.Cl = 0x32ff9c82 | 0;\n        this.Dh = 0x679dd514 | 0;\n        this.Dl = 0x582f9fcf | 0;\n        this.Eh = 0x0f6d2b69 | 0;\n        this.El = 0x7bd44da8 | 0;\n        this.Fh = 0x77e36f73 | 0;\n        this.Fl = 0x04c48942 | 0;\n        this.Gh = 0x3f9d85a8 | 0;\n        this.Gl = 0x6a1d36c8 | 0;\n        this.Hh = 0x1112e6ad | 0;\n        this.Hl = 0x91d692a1 | 0;\n        this.outputLen = 28;\n    }\n}\nclass SHA512_256 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x22312194 | 0;\n        this.Al = 0xfc2bf72c | 0;\n        this.Bh = 0x9f555fa3 | 0;\n        this.Bl = 0xc84c64c2 | 0;\n        this.Ch = 0x2393b86b | 0;\n        this.Cl = 0x6f53b151 | 0;\n        this.Dh = 0x96387719 | 0;\n        this.Dl = 0x5940eabd | 0;\n        this.Eh = 0x96283ee2 | 0;\n        this.El = 0xa88effe3 | 0;\n        this.Fh = 0xbe5e1e25 | 0;\n        this.Fl = 0x53863992 | 0;\n        this.Gh = 0x2b0199fc | 0;\n        this.Gl = 0x2c85b8aa | 0;\n        this.Hh = 0x0eb72ddc | 0;\n        this.Hl = 0x81c52ca2 | 0;\n        this.outputLen = 32;\n    }\n}\nclass SHA384 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0xcbbb9d5d | 0;\n        this.Al = 0xc1059ed8 | 0;\n        this.Bh = 0x629a292a | 0;\n        this.Bl = 0x367cd507 | 0;\n        this.Ch = 0x9159015a | 0;\n        this.Cl = 0x3070dd17 | 0;\n        this.Dh = 0x152fecd8 | 0;\n        this.Dl = 0xf70e5939 | 0;\n        this.Eh = 0x67332667 | 0;\n        this.El = 0xffc00b31 | 0;\n        this.Fh = 0x8eb44a87 | 0;\n        this.Fl = 0x68581511 | 0;\n        this.Gh = 0xdb0c2e0d | 0;\n        this.Gl = 0x64f98fa7 | 0;\n        this.Hh = 0x47b5481d | 0;\n        this.Hl = 0xbefa4fa4 | 0;\n        this.outputLen = 48;\n    }\n}\nexport const sha512 = /* @__PURE__ */ wrapConstructor(() => new SHA512());\nexport const sha512_224 = /* @__PURE__ */ wrapConstructor(() => new SHA512_224());\nexport const sha512_256 = /* @__PURE__ */ wrapConstructor(() => new SHA512_256());\nexport const sha384 = /* @__PURE__ */ wrapConstructor(() => new SHA384());\n//# sourceMappingURL=sha512.js.map","/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Utilities\n/**\n * @__NO_SIDE_EFFECTS__\n */\nexport function assertNumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`Wrong integer: ${n}`);\n}\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction chain(...args) {\n    const id = (a) => a;\n    // Wrap call in closure so JIT can inline calls\n    const wrap = (a, b) => (c) => a(b(c));\n    // Construct chain of args[-1].encode(args[-2].encode([...]))\n    const encode = args.map((x) => x.encode).reduceRight(wrap, id);\n    // Construct chain of args[0].decode(args[1].decode(...))\n    const decode = args.map((x) => x.decode).reduce(wrap, id);\n    return { encode, decode };\n}\n/**\n * Encodes integer radix representation to array of strings using alphabet and back\n * @__NO_SIDE_EFFECTS__\n */\nfunction alphabet(alphabet) {\n    return {\n        encode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('alphabet.encode input should be an array of numbers');\n            return digits.map((i) => {\n                assertNumber(i);\n                if (i < 0 || i >= alphabet.length)\n                    throw new Error(`Digit index outside alphabet: ${i} (alphabet: ${alphabet.length})`);\n                return alphabet[i];\n            });\n        },\n        decode: (input) => {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('alphabet.decode input should be array of strings');\n            return input.map((letter) => {\n                if (typeof letter !== 'string')\n                    throw new Error(`alphabet.decode: not string element=${letter}`);\n                const index = alphabet.indexOf(letter);\n                if (index === -1)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${alphabet}`);\n                return index;\n            });\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction join(separator = '') {\n    if (typeof separator !== 'string')\n        throw new Error('join separator should be string');\n    return {\n        encode: (from) => {\n            if (!Array.isArray(from) || (from.length && typeof from[0] !== 'string'))\n                throw new Error('join.encode input should be array of strings');\n            for (let i of from)\n                if (typeof i !== 'string')\n                    throw new Error(`join.encode: non-string input=${i}`);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            if (typeof to !== 'string')\n                throw new Error('join.decode input should be string');\n            return to.split(separator);\n        },\n    };\n}\n/**\n * Pad strings array so it has integer number of bits\n * @__NO_SIDE_EFFECTS__\n */\nfunction padding(bits, chr = '=') {\n    assertNumber(bits);\n    if (typeof chr !== 'string')\n        throw new Error('padding chr should be string');\n    return {\n        encode(data) {\n            if (!Array.isArray(data) || (data.length && typeof data[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of data)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.encode: non-string input=${i}`);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of input)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.decode: non-string input=${i}`);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('Invalid padding: string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                if (!(((end - 1) * bits) % 8))\n                    throw new Error('Invalid padding: string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction normalize(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('normalize fn should be function');\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\n/**\n * Slow: O(n^2) time complexity\n * @__NO_SIDE_EFFECTS__\n */\nfunction convertRadix(data, from, to) {\n    // base 1 is impossible\n    if (from < 2)\n        throw new Error(`convertRadix: wrong from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: wrong to=${to}, base cannot be less than 2`);\n    if (!Array.isArray(data))\n        throw new Error('convertRadix: data should be array');\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data);\n    digits.forEach((d) => {\n        assertNumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`Wrong integer: ${d}`);\n    });\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < digits.length; i++) {\n            const digit = digits[i];\n            const digitBase = from * carry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                (from * carry) / from !== carry ||\n                digitBase - digit !== from * carry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            carry = digitBase % to;\n            const rounded = Math.floor(digitBase / to);\n            digits[i] = rounded;\n            if (!Number.isSafeInteger(rounded) || rounded * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!rounded)\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = /* @__NO_SIDE_EFFECTS__ */ (a, b) => (!b ? a : gcd(b, a % b));\nconst radix2carry = /*@__NO_SIDE_EFFECTS__ */ (from, to) => from + (to - gcd(from, to));\n/**\n * Implemented with numbers, because BigInt is 5x slower\n * @__NO_SIDE_EFFECTS__\n */\nfunction convertRadix2(data, from, to, padding) {\n    if (!Array.isArray(data))\n        throw new Error('convertRadix2: data should be array');\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0; // bitwise position in current element\n    const mask = 2 ** to - 1;\n    const res = [];\n    for (const n of data) {\n        assertNumber(n);\n        if (n >= 2 ** from)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        carry &= 2 ** pos - 1; // clean carry, otherwise it will cause overflow\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction radix(num) {\n    assertNumber(num);\n    return {\n        encode: (bytes) => {\n            if (!isBytes(bytes))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), 2 ** 8, num);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix.decode input should be array of numbers');\n            return Uint8Array.from(convertRadix(digits, num, 2 ** 8));\n        },\n    };\n}\n/**\n * If both bases are power of same number (like `2**8 <-> 2**64`),\n * there is a linear algorithm. For now we have implementation for power-of-two bases only.\n * @__NO_SIDE_EFFECTS__\n */\nfunction radix2(bits, revPadding = false) {\n    assertNumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!isBytes(bytes))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix2.decode input should be array of numbers');\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction unsafeWrapper(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('unsafeWrapper fn should be function');\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction checksum(len, fn) {\n    assertNumber(len);\n    if (typeof fn !== 'function')\n        throw new Error('checksum fn should be function');\n    return {\n        encode(data) {\n            if (!isBytes(data))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const checksum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(checksum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!isBytes(data))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const newChecksum = fn(payload).slice(0, len);\n            const oldChecksum = data.slice(-len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\n// prettier-ignore\nexport const utils = {\n    alphabet, chain, checksum, convertRadix, convertRadix2, radix, radix2, join, padding,\n};\n// RFC 4648 aka RFC 3548\n// ---------------------\nexport const base16 = /* @__PURE__ */ chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\nexport const base32 = /* @__PURE__ */ chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\nexport const base32hex = /* @__PURE__ */ chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\nexport const base32crockford = /* @__PURE__ */ chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\nexport const base64 = /* @__PURE__ */ chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\nexport const base64nopad = /* @__PURE__ */ chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), join(''));\nexport const base64url = /* @__PURE__ */ chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\nexport const base64urlnopad = /* @__PURE__ */ chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), join(''));\n// base58 code\n// -----------\nconst genBase58 = (abc) => chain(radix(58), alphabet(abc), join(''));\nexport const base58 = /* @__PURE__ */ genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\nexport const base58flickr = /* @__PURE__ */ genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\nexport const base58xrp = /* @__PURE__ */ genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\n// xmr ver is done in 8-byte blocks (which equals 11 chars in decoding). Last (non-full) block padded with '1' to size in XMR_BLOCK_LEN.\n// Block encoding significantly reduces quadratic complexity of base58.\n// Data len (index) -> encoded block len\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\nexport const base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\nexport const createBase58check = /* @__PURE__ */ (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), base58);\n// legacy export, bad name\nexport const base58check = createBase58check;\nconst BECH_ALPHABET = /* @__PURE__ */ chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % 2 ** 30], 30, 5, false));\n}\n/**\n * @__NO_SIDE_EFFECTS__\n */\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        if (typeof prefix !== 'string')\n            throw new Error(`bech32.encode prefix should be string, not ${typeof prefix}`);\n        if (!Array.isArray(words) || (words.length && typeof words[0] !== 'number'))\n            throw new Error(`bech32.encode words should be array of numbers, not ${typeof words}`);\n        if (prefix.length === 0)\n            throw new TypeError(`Invalid prefix length ${prefix.length}`);\n        const actualLength = prefix.length + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        const lowered = prefix.toLowerCase();\n        const sum = bechChecksum(lowered, words, ENCODING_CONST);\n        return `${lowered}1${BECH_ALPHABET.encode(words)}${sum}`;\n    }\n    function decode(str, limit = 90) {\n        if (typeof str !== 'string')\n            throw new Error(`bech32.decode input should be string, not ${typeof str}`);\n        if (str.length < 8 || (limit !== false && str.length > limit))\n            throw new TypeError(`Wrong string length: ${str.length} (${str}). Expected (8..${limit})`);\n        // don't allow mixed case\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        const sepIndex = lowered.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = lowered.slice(0, sepIndex);\n        const data = lowered.slice(sepIndex + 1);\n        if (data.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(data).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!data.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    return { encode, decode, decodeToBytes, decodeUnsafe, fromWords, fromWordsUnsafe, toWords };\n}\nexport const bech32 = /* @__PURE__ */ genBech32('bech32');\nexport const bech32m = /* @__PURE__ */ genBech32('bech32m');\nexport const utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\nexport const hex = /* @__PURE__ */ chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n    if (typeof s !== 'string' || s.length % 2)\n        throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n    return s.toLowerCase();\n}));\n// prettier-ignore\nconst CODERS = {\n    utf8, hex, base16, base32, base64, base64url, base58, base58xmr\n};\nconst coderTypeError = 'Invalid encoding type. Available types: utf8, hex, base16, base32, base64, base64url, base58, base58xmr';\nexport const bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!isBytes(bytes))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\nexport const str = bytesToString; // as in python, but for bytes only\nexport const stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\nexport const bytes = stringToBytes;\n//# sourceMappingURL=index.js.map","import assert from '@noble/hashes/_assert';\nimport { pbkdf2, pbkdf2Async } from '@noble/hashes/pbkdf2';\nimport { sha256 } from '@noble/hashes/sha256';\nimport { sha512 } from '@noble/hashes/sha512';\nimport { randomBytes } from '@noble/hashes/utils';\nimport { utils as baseUtils } from '@scure/base';\nconst isJapanese = (wordlist) => wordlist[0] === '\\u3042\\u3044\\u3053\\u304f\\u3057\\u3093';\nfunction nfkd(str) {\n    if (typeof str !== 'string')\n        throw new TypeError(`Invalid mnemonic type: ${typeof str}`);\n    return str.normalize('NFKD');\n}\nfunction normalize(str) {\n    const norm = nfkd(str);\n    const words = norm.split(' ');\n    if (![12, 15, 18, 21, 24].includes(words.length))\n        throw new Error('Invalid mnemonic');\n    return { nfkd: norm, words };\n}\nfunction assertEntropy(entropy) {\n    assert.bytes(entropy, 16, 20, 24, 28, 32);\n}\nexport function generateMnemonic(wordlist, strength = 128) {\n    assert.number(strength);\n    if (strength % 32 !== 0 || strength > 256)\n        throw new TypeError('Invalid entropy');\n    return entropyToMnemonic(randomBytes(strength / 8), wordlist);\n}\nconst calcChecksum = (entropy) => {\n    const bitsLeft = 8 - entropy.length / 4;\n    return new Uint8Array([(sha256(entropy)[0] >> bitsLeft) << bitsLeft]);\n};\nfunction getCoder(wordlist) {\n    if (!Array.isArray(wordlist) || wordlist.length !== 2048 || typeof wordlist[0] !== 'string')\n        throw new Error('Worlist: expected array of 2048 strings');\n    wordlist.forEach((i) => {\n        if (typeof i !== 'string')\n            throw new Error(`Wordlist: non-string element: ${i}`);\n    });\n    return baseUtils.chain(baseUtils.checksum(1, calcChecksum), baseUtils.radix2(11, true), baseUtils.alphabet(wordlist));\n}\nexport function mnemonicToEntropy(mnemonic, wordlist) {\n    const { words } = normalize(mnemonic);\n    const entropy = getCoder(wordlist).decode(words);\n    assertEntropy(entropy);\n    return entropy;\n}\nexport function entropyToMnemonic(entropy, wordlist) {\n    assertEntropy(entropy);\n    const words = getCoder(wordlist).encode(entropy);\n    return words.join(isJapanese(wordlist) ? '\\u3000' : ' ');\n}\nexport function validateMnemonic(mnemonic, wordlist) {\n    try {\n        mnemonicToEntropy(mnemonic, wordlist);\n    }\n    catch (e) {\n        return false;\n    }\n    return true;\n}\nconst salt = (passphrase) => nfkd(`mnemonic${passphrase}`);\nexport function mnemonicToSeed(mnemonic, passphrase = '') {\n    return pbkdf2Async(sha512, normalize(mnemonic).nfkd, salt(passphrase), { c: 2048, dkLen: 64 });\n}\nexport function mnemonicToSeedSync(mnemonic, passphrase = '') {\n    return pbkdf2(sha512, normalize(mnemonic).nfkd, salt(passphrase), { c: 2048, dkLen: 64 });\n}\n//# sourceMappingURL=index.js.map","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\n// copied from utils\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nfunction bytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\nfunction isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\n// Other libraries would silently corrupt the data instead of throwing an error,\n// when they don't support it.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!isBytes(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!isBytes(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        if (!isBytes(a))\n            throw new Error('Uint8Array expected');\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { hash as assertHash, bytes as assertBytes, exists as assertExists } from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assertHash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assertExists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assertExists(this);\n        assertBytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","import { exists, output } from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        exists(this);\n        output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { wrapConstructor } from './utils.js';\n// https://homes.esat.kuleuven.be/~bosselae/ripemd160.html\n// https://homes.esat.kuleuven.be/~bosselae/ripemd160/pdf/AB-9601/AB-9601.pdf\nconst Rho = /* @__PURE__ */ new Uint8Array([7, 4, 13, 1, 10, 6, 15, 3, 12, 0, 9, 5, 2, 14, 11, 8]);\nconst Id = /* @__PURE__ */ Uint8Array.from({ length: 16 }, (_, i) => i);\nconst Pi = /* @__PURE__ */ Id.map((i) => (9 * i + 5) % 16);\nlet idxL = [Id];\nlet idxR = [Pi];\nfor (let i = 0; i < 4; i++)\n    for (let j of [idxL, idxR])\n        j.push(j[i].map((k) => Rho[k]));\nconst shifts = /* @__PURE__ */ [\n    [11, 14, 15, 12, 5, 8, 7, 9, 11, 13, 14, 15, 6, 7, 9, 8],\n    [12, 13, 11, 15, 6, 9, 9, 7, 12, 15, 11, 13, 7, 8, 7, 7],\n    [13, 15, 14, 11, 7, 7, 6, 8, 13, 14, 13, 12, 5, 5, 6, 9],\n    [14, 11, 12, 14, 8, 6, 5, 5, 15, 12, 15, 14, 9, 9, 8, 6],\n    [15, 12, 13, 13, 9, 5, 8, 6, 14, 11, 12, 11, 8, 6, 5, 5],\n].map((i) => new Uint8Array(i));\nconst shiftsL = /* @__PURE__ */ idxL.map((idx, i) => idx.map((j) => shifts[i][j]));\nconst shiftsR = /* @__PURE__ */ idxR.map((idx, i) => idx.map((j) => shifts[i][j]));\nconst Kl = /* @__PURE__ */ new Uint32Array([\n    0x00000000, 0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xa953fd4e,\n]);\nconst Kr = /* @__PURE__ */ new Uint32Array([\n    0x50a28be6, 0x5c4dd124, 0x6d703ef3, 0x7a6d76e9, 0x00000000,\n]);\n// The rotate left (circular left shift) operation for uint32\nconst rotl = (word, shift) => (word << shift) | (word >>> (32 - shift));\n// It's called f() in spec.\nfunction f(group, x, y, z) {\n    if (group === 0)\n        return x ^ y ^ z;\n    else if (group === 1)\n        return (x & y) | (~x & z);\n    else if (group === 2)\n        return (x | ~y) ^ z;\n    else if (group === 3)\n        return (x & z) | (y & ~z);\n    else\n        return x ^ (y | ~z);\n}\n// Temporary buffer, not used to store anything between runs\nconst BUF = /* @__PURE__ */ new Uint32Array(16);\nexport class RIPEMD160 extends SHA2 {\n    constructor() {\n        super(64, 20, 8, true);\n        this.h0 = 0x67452301 | 0;\n        this.h1 = 0xefcdab89 | 0;\n        this.h2 = 0x98badcfe | 0;\n        this.h3 = 0x10325476 | 0;\n        this.h4 = 0xc3d2e1f0 | 0;\n    }\n    get() {\n        const { h0, h1, h2, h3, h4 } = this;\n        return [h0, h1, h2, h3, h4];\n    }\n    set(h0, h1, h2, h3, h4) {\n        this.h0 = h0 | 0;\n        this.h1 = h1 | 0;\n        this.h2 = h2 | 0;\n        this.h3 = h3 | 0;\n        this.h4 = h4 | 0;\n    }\n    process(view, offset) {\n        for (let i = 0; i < 16; i++, offset += 4)\n            BUF[i] = view.getUint32(offset, true);\n        // prettier-ignore\n        let al = this.h0 | 0, ar = al, bl = this.h1 | 0, br = bl, cl = this.h2 | 0, cr = cl, dl = this.h3 | 0, dr = dl, el = this.h4 | 0, er = el;\n        // Instead of iterating 0 to 80, we split it into 5 groups\n        // And use the groups in constants, functions, etc. Much simpler\n        for (let group = 0; group < 5; group++) {\n            const rGroup = 4 - group;\n            const hbl = Kl[group], hbr = Kr[group]; // prettier-ignore\n            const rl = idxL[group], rr = idxR[group]; // prettier-ignore\n            const sl = shiftsL[group], sr = shiftsR[group]; // prettier-ignore\n            for (let i = 0; i < 16; i++) {\n                const tl = (rotl(al + f(group, bl, cl, dl) + BUF[rl[i]] + hbl, sl[i]) + el) | 0;\n                al = el, el = dl, dl = rotl(cl, 10) | 0, cl = bl, bl = tl; // prettier-ignore\n            }\n            // 2 loops are 10% faster\n            for (let i = 0; i < 16; i++) {\n                const tr = (rotl(ar + f(rGroup, br, cr, dr) + BUF[rr[i]] + hbr, sr[i]) + er) | 0;\n                ar = er, er = dr, dr = rotl(cr, 10) | 0, cr = br, br = tr; // prettier-ignore\n            }\n        }\n        // Add the compressed chunk to the current hash value\n        this.set((this.h1 + cl + dr) | 0, (this.h2 + dl + er) | 0, (this.h3 + el + ar) | 0, (this.h4 + al + br) | 0, (this.h0 + bl + cr) | 0);\n    }\n    roundClean() {\n        BUF.fill(0);\n    }\n    destroy() {\n        this.destroyed = true;\n        this.buffer.fill(0);\n        this.set(0, 0, 0, 0, 0);\n    }\n}\n/**\n * RIPEMD-160 - a hash function from 1990s.\n * @param message - msg that would be hashed\n */\nexport const ripemd160 = /* @__PURE__ */ wrapConstructor(() => new RIPEMD160());\n//# sourceMappingURL=ripemd160.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = /* @__PURE__ */ wrapConstructor(() => new SHA256());\nexport const sha224 = /* @__PURE__ */ wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","const U32_MASK64 = /* @__PURE__ */ BigInt(2 ** 32 - 1);\nconst _32n = /* @__PURE__ */ BigInt(32);\n// We are not using BigUint64Array, because they are extremely slow as per 2022\nfunction fromBig(n, le = false) {\n    if (le)\n        return { h: Number(n & U32_MASK64), l: Number((n >> _32n) & U32_MASK64) };\n    return { h: Number((n >> _32n) & U32_MASK64) | 0, l: Number(n & U32_MASK64) | 0 };\n}\nfunction split(lst, le = false) {\n    let Ah = new Uint32Array(lst.length);\n    let Al = new Uint32Array(lst.length);\n    for (let i = 0; i < lst.length; i++) {\n        const { h, l } = fromBig(lst[i], le);\n        [Ah[i], Al[i]] = [h, l];\n    }\n    return [Ah, Al];\n}\nconst toBig = (h, l) => (BigInt(h >>> 0) << _32n) | BigInt(l >>> 0);\n// for Shift in [0, 32)\nconst shrSH = (h, _l, s) => h >>> s;\nconst shrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in [1, 32)\nconst rotrSH = (h, l, s) => (h >>> s) | (l << (32 - s));\nconst rotrSL = (h, l, s) => (h << (32 - s)) | (l >>> s);\n// Right rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotrBH = (h, l, s) => (h << (64 - s)) | (l >>> (s - 32));\nconst rotrBL = (h, l, s) => (h >>> (s - 32)) | (l << (64 - s));\n// Right rotate for shift===32 (just swaps l&h)\nconst rotr32H = (_h, l) => l;\nconst rotr32L = (h, _l) => h;\n// Left rotate for Shift in [1, 32)\nconst rotlSH = (h, l, s) => (h << s) | (l >>> (32 - s));\nconst rotlSL = (h, l, s) => (l << s) | (h >>> (32 - s));\n// Left rotate for Shift in (32, 64), NOTE: 32 is special case.\nconst rotlBH = (h, l, s) => (l << (s - 32)) | (h >>> (64 - s));\nconst rotlBL = (h, l, s) => (h << (s - 32)) | (l >>> (64 - s));\n// JS uses 32-bit signed integers for bitwise operations which means we cannot\n// simple take carry out of low bit sum by shift, we need to use division.\nfunction add(Ah, Al, Bh, Bl) {\n    const l = (Al >>> 0) + (Bl >>> 0);\n    return { h: (Ah + Bh + ((l / 2 ** 32) | 0)) | 0, l: l | 0 };\n}\n// Addition with more than 2 elements\nconst add3L = (Al, Bl, Cl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0);\nconst add3H = (low, Ah, Bh, Ch) => (Ah + Bh + Ch + ((low / 2 ** 32) | 0)) | 0;\nconst add4L = (Al, Bl, Cl, Dl) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0);\nconst add4H = (low, Ah, Bh, Ch, Dh) => (Ah + Bh + Ch + Dh + ((low / 2 ** 32) | 0)) | 0;\nconst add5L = (Al, Bl, Cl, Dl, El) => (Al >>> 0) + (Bl >>> 0) + (Cl >>> 0) + (Dl >>> 0) + (El >>> 0);\nconst add5H = (low, Ah, Bh, Ch, Dh, Eh) => (Ah + Bh + Ch + Dh + Eh + ((low / 2 ** 32) | 0)) | 0;\n// prettier-ignore\nexport { fromBig, split, toBig, shrSH, shrSL, rotrSH, rotrSL, rotrBH, rotrBL, rotr32H, rotr32L, rotlSH, rotlSL, rotlBH, rotlBL, add, add3L, add3H, add4L, add4H, add5H, add5L, };\n// prettier-ignore\nconst u64 = {\n    fromBig, split, toBig,\n    shrSH, shrSL,\n    rotrSH, rotrSL, rotrBH, rotrBL,\n    rotr32H, rotr32L,\n    rotlSH, rotlSL, rotlBH, rotlBL,\n    add, add3L, add3H, add4L, add4H, add5H, add5L,\n};\nexport default u64;\n//# sourceMappingURL=_u64.js.map","import { SHA2 } from './_sha2.js';\nimport u64 from './_u64.js';\nimport { wrapConstructor } from './utils.js';\n// Round contants (first 32 bits of the fractional parts of the cube roots of the first 80 primes 2..409):\n// prettier-ignore\nconst [SHA512_Kh, SHA512_Kl] = /* @__PURE__ */ (() => u64.split([\n    '0x428a2f98d728ae22', '0x7137449123ef65cd', '0xb5c0fbcfec4d3b2f', '0xe9b5dba58189dbbc',\n    '0x3956c25bf348b538', '0x59f111f1b605d019', '0x923f82a4af194f9b', '0xab1c5ed5da6d8118',\n    '0xd807aa98a3030242', '0x12835b0145706fbe', '0x243185be4ee4b28c', '0x550c7dc3d5ffb4e2',\n    '0x72be5d74f27b896f', '0x80deb1fe3b1696b1', '0x9bdc06a725c71235', '0xc19bf174cf692694',\n    '0xe49b69c19ef14ad2', '0xefbe4786384f25e3', '0x0fc19dc68b8cd5b5', '0x240ca1cc77ac9c65',\n    '0x2de92c6f592b0275', '0x4a7484aa6ea6e483', '0x5cb0a9dcbd41fbd4', '0x76f988da831153b5',\n    '0x983e5152ee66dfab', '0xa831c66d2db43210', '0xb00327c898fb213f', '0xbf597fc7beef0ee4',\n    '0xc6e00bf33da88fc2', '0xd5a79147930aa725', '0x06ca6351e003826f', '0x142929670a0e6e70',\n    '0x27b70a8546d22ffc', '0x2e1b21385c26c926', '0x4d2c6dfc5ac42aed', '0x53380d139d95b3df',\n    '0x650a73548baf63de', '0x766a0abb3c77b2a8', '0x81c2c92e47edaee6', '0x92722c851482353b',\n    '0xa2bfe8a14cf10364', '0xa81a664bbc423001', '0xc24b8b70d0f89791', '0xc76c51a30654be30',\n    '0xd192e819d6ef5218', '0xd69906245565a910', '0xf40e35855771202a', '0x106aa07032bbd1b8',\n    '0x19a4c116b8d2d0c8', '0x1e376c085141ab53', '0x2748774cdf8eeb99', '0x34b0bcb5e19b48a8',\n    '0x391c0cb3c5c95a63', '0x4ed8aa4ae3418acb', '0x5b9cca4f7763e373', '0x682e6ff3d6b2b8a3',\n    '0x748f82ee5defb2fc', '0x78a5636f43172f60', '0x84c87814a1f0ab72', '0x8cc702081a6439ec',\n    '0x90befffa23631e28', '0xa4506cebde82bde9', '0xbef9a3f7b2c67915', '0xc67178f2e372532b',\n    '0xca273eceea26619c', '0xd186b8c721c0c207', '0xeada7dd6cde0eb1e', '0xf57d4f7fee6ed178',\n    '0x06f067aa72176fba', '0x0a637dc5a2c898a6', '0x113f9804bef90dae', '0x1b710b35131c471b',\n    '0x28db77f523047d84', '0x32caab7b40c72493', '0x3c9ebe0a15c9bebc', '0x431d67c49c100d4c',\n    '0x4cc5d4becb3e42b6', '0x597f299cfc657e2a', '0x5fcb6fab3ad6faec', '0x6c44198c4a475817'\n].map(n => BigInt(n))))();\n// Temporary buffer, not used to store anything between runs\nconst SHA512_W_H = /* @__PURE__ */ new Uint32Array(80);\nconst SHA512_W_L = /* @__PURE__ */ new Uint32Array(80);\nexport class SHA512 extends SHA2 {\n    constructor() {\n        super(128, 64, 16, false);\n        // We cannot use array here since array allows indexing by variable which means optimizer/compiler cannot use registers.\n        // Also looks cleaner and easier to verify with spec.\n        // Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x6a09e667 | 0;\n        this.Al = 0xf3bcc908 | 0;\n        this.Bh = 0xbb67ae85 | 0;\n        this.Bl = 0x84caa73b | 0;\n        this.Ch = 0x3c6ef372 | 0;\n        this.Cl = 0xfe94f82b | 0;\n        this.Dh = 0xa54ff53a | 0;\n        this.Dl = 0x5f1d36f1 | 0;\n        this.Eh = 0x510e527f | 0;\n        this.El = 0xade682d1 | 0;\n        this.Fh = 0x9b05688c | 0;\n        this.Fl = 0x2b3e6c1f | 0;\n        this.Gh = 0x1f83d9ab | 0;\n        this.Gl = 0xfb41bd6b | 0;\n        this.Hh = 0x5be0cd19 | 0;\n        this.Hl = 0x137e2179 | 0;\n    }\n    // prettier-ignore\n    get() {\n        const { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        return [Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl];\n    }\n    // prettier-ignore\n    set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl) {\n        this.Ah = Ah | 0;\n        this.Al = Al | 0;\n        this.Bh = Bh | 0;\n        this.Bl = Bl | 0;\n        this.Ch = Ch | 0;\n        this.Cl = Cl | 0;\n        this.Dh = Dh | 0;\n        this.Dl = Dl | 0;\n        this.Eh = Eh | 0;\n        this.El = El | 0;\n        this.Fh = Fh | 0;\n        this.Fl = Fl | 0;\n        this.Gh = Gh | 0;\n        this.Gl = Gl | 0;\n        this.Hh = Hh | 0;\n        this.Hl = Hl | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 64 words w[16..79] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4) {\n            SHA512_W_H[i] = view.getUint32(offset);\n            SHA512_W_L[i] = view.getUint32((offset += 4));\n        }\n        for (let i = 16; i < 80; i++) {\n            // s0 := (w[i-15] rightrotate 1) xor (w[i-15] rightrotate 8) xor (w[i-15] rightshift 7)\n            const W15h = SHA512_W_H[i - 15] | 0;\n            const W15l = SHA512_W_L[i - 15] | 0;\n            const s0h = u64.rotrSH(W15h, W15l, 1) ^ u64.rotrSH(W15h, W15l, 8) ^ u64.shrSH(W15h, W15l, 7);\n            const s0l = u64.rotrSL(W15h, W15l, 1) ^ u64.rotrSL(W15h, W15l, 8) ^ u64.shrSL(W15h, W15l, 7);\n            // s1 := (w[i-2] rightrotate 19) xor (w[i-2] rightrotate 61) xor (w[i-2] rightshift 6)\n            const W2h = SHA512_W_H[i - 2] | 0;\n            const W2l = SHA512_W_L[i - 2] | 0;\n            const s1h = u64.rotrSH(W2h, W2l, 19) ^ u64.rotrBH(W2h, W2l, 61) ^ u64.shrSH(W2h, W2l, 6);\n            const s1l = u64.rotrSL(W2h, W2l, 19) ^ u64.rotrBL(W2h, W2l, 61) ^ u64.shrSL(W2h, W2l, 6);\n            // SHA256_W[i] = s0 + s1 + SHA256_W[i - 7] + SHA256_W[i - 16];\n            const SUMl = u64.add4L(s0l, s1l, SHA512_W_L[i - 7], SHA512_W_L[i - 16]);\n            const SUMh = u64.add4H(SUMl, s0h, s1h, SHA512_W_H[i - 7], SHA512_W_H[i - 16]);\n            SHA512_W_H[i] = SUMh | 0;\n            SHA512_W_L[i] = SUMl | 0;\n        }\n        let { Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl } = this;\n        // Compression function main loop, 80 rounds\n        for (let i = 0; i < 80; i++) {\n            // S1 := (e rightrotate 14) xor (e rightrotate 18) xor (e rightrotate 41)\n            const sigma1h = u64.rotrSH(Eh, El, 14) ^ u64.rotrSH(Eh, El, 18) ^ u64.rotrBH(Eh, El, 41);\n            const sigma1l = u64.rotrSL(Eh, El, 14) ^ u64.rotrSL(Eh, El, 18) ^ u64.rotrBL(Eh, El, 41);\n            //const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const CHIh = (Eh & Fh) ^ (~Eh & Gh);\n            const CHIl = (El & Fl) ^ (~El & Gl);\n            // T1 = H + sigma1 + Chi(E, F, G) + SHA512_K[i] + SHA512_W[i]\n            // prettier-ignore\n            const T1ll = u64.add5L(Hl, sigma1l, CHIl, SHA512_Kl[i], SHA512_W_L[i]);\n            const T1h = u64.add5H(T1ll, Hh, sigma1h, CHIh, SHA512_Kh[i], SHA512_W_H[i]);\n            const T1l = T1ll | 0;\n            // S0 := (a rightrotate 28) xor (a rightrotate 34) xor (a rightrotate 39)\n            const sigma0h = u64.rotrSH(Ah, Al, 28) ^ u64.rotrBH(Ah, Al, 34) ^ u64.rotrBH(Ah, Al, 39);\n            const sigma0l = u64.rotrSL(Ah, Al, 28) ^ u64.rotrBL(Ah, Al, 34) ^ u64.rotrBL(Ah, Al, 39);\n            const MAJh = (Ah & Bh) ^ (Ah & Ch) ^ (Bh & Ch);\n            const MAJl = (Al & Bl) ^ (Al & Cl) ^ (Bl & Cl);\n            Hh = Gh | 0;\n            Hl = Gl | 0;\n            Gh = Fh | 0;\n            Gl = Fl | 0;\n            Fh = Eh | 0;\n            Fl = El | 0;\n            ({ h: Eh, l: El } = u64.add(Dh | 0, Dl | 0, T1h | 0, T1l | 0));\n            Dh = Ch | 0;\n            Dl = Cl | 0;\n            Ch = Bh | 0;\n            Cl = Bl | 0;\n            Bh = Ah | 0;\n            Bl = Al | 0;\n            const All = u64.add3L(T1l, sigma0l, MAJl);\n            Ah = u64.add3H(All, T1h, sigma0h, MAJh);\n            Al = All | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        ({ h: Ah, l: Al } = u64.add(this.Ah | 0, this.Al | 0, Ah | 0, Al | 0));\n        ({ h: Bh, l: Bl } = u64.add(this.Bh | 0, this.Bl | 0, Bh | 0, Bl | 0));\n        ({ h: Ch, l: Cl } = u64.add(this.Ch | 0, this.Cl | 0, Ch | 0, Cl | 0));\n        ({ h: Dh, l: Dl } = u64.add(this.Dh | 0, this.Dl | 0, Dh | 0, Dl | 0));\n        ({ h: Eh, l: El } = u64.add(this.Eh | 0, this.El | 0, Eh | 0, El | 0));\n        ({ h: Fh, l: Fl } = u64.add(this.Fh | 0, this.Fl | 0, Fh | 0, Fl | 0));\n        ({ h: Gh, l: Gl } = u64.add(this.Gh | 0, this.Gl | 0, Gh | 0, Gl | 0));\n        ({ h: Hh, l: Hl } = u64.add(this.Hh | 0, this.Hl | 0, Hh | 0, Hl | 0));\n        this.set(Ah, Al, Bh, Bl, Ch, Cl, Dh, Dl, Eh, El, Fh, Fl, Gh, Gl, Hh, Hl);\n    }\n    roundClean() {\n        SHA512_W_H.fill(0);\n        SHA512_W_L.fill(0);\n    }\n    destroy() {\n        this.buffer.fill(0);\n        this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);\n    }\n}\nclass SHA512_224 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x8c3d37c8 | 0;\n        this.Al = 0x19544da2 | 0;\n        this.Bh = 0x73e19966 | 0;\n        this.Bl = 0x89dcd4d6 | 0;\n        this.Ch = 0x1dfab7ae | 0;\n        this.Cl = 0x32ff9c82 | 0;\n        this.Dh = 0x679dd514 | 0;\n        this.Dl = 0x582f9fcf | 0;\n        this.Eh = 0x0f6d2b69 | 0;\n        this.El = 0x7bd44da8 | 0;\n        this.Fh = 0x77e36f73 | 0;\n        this.Fl = 0x04c48942 | 0;\n        this.Gh = 0x3f9d85a8 | 0;\n        this.Gl = 0x6a1d36c8 | 0;\n        this.Hh = 0x1112e6ad | 0;\n        this.Hl = 0x91d692a1 | 0;\n        this.outputLen = 28;\n    }\n}\nclass SHA512_256 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0x22312194 | 0;\n        this.Al = 0xfc2bf72c | 0;\n        this.Bh = 0x9f555fa3 | 0;\n        this.Bl = 0xc84c64c2 | 0;\n        this.Ch = 0x2393b86b | 0;\n        this.Cl = 0x6f53b151 | 0;\n        this.Dh = 0x96387719 | 0;\n        this.Dl = 0x5940eabd | 0;\n        this.Eh = 0x96283ee2 | 0;\n        this.El = 0xa88effe3 | 0;\n        this.Fh = 0xbe5e1e25 | 0;\n        this.Fl = 0x53863992 | 0;\n        this.Gh = 0x2b0199fc | 0;\n        this.Gl = 0x2c85b8aa | 0;\n        this.Hh = 0x0eb72ddc | 0;\n        this.Hl = 0x81c52ca2 | 0;\n        this.outputLen = 32;\n    }\n}\nclass SHA384 extends SHA512 {\n    constructor() {\n        super();\n        // h -- high 32 bits, l -- low 32 bits\n        this.Ah = 0xcbbb9d5d | 0;\n        this.Al = 0xc1059ed8 | 0;\n        this.Bh = 0x629a292a | 0;\n        this.Bl = 0x367cd507 | 0;\n        this.Ch = 0x9159015a | 0;\n        this.Cl = 0x3070dd17 | 0;\n        this.Dh = 0x152fecd8 | 0;\n        this.Dl = 0xf70e5939 | 0;\n        this.Eh = 0x67332667 | 0;\n        this.El = 0xffc00b31 | 0;\n        this.Fh = 0x8eb44a87 | 0;\n        this.Fl = 0x68581511 | 0;\n        this.Gh = 0xdb0c2e0d | 0;\n        this.Gl = 0x64f98fa7 | 0;\n        this.Hh = 0x47b5481d | 0;\n        this.Hl = 0xbefa4fa4 | 0;\n        this.outputLen = 48;\n    }\n}\nexport const sha512 = /* @__PURE__ */ wrapConstructor(() => new SHA512());\nexport const sha512_224 = /* @__PURE__ */ wrapConstructor(() => new SHA512_224());\nexport const sha512_256 = /* @__PURE__ */ wrapConstructor(() => new SHA512_256());\nexport const sha384 = /* @__PURE__ */ wrapConstructor(() => new SHA384());\n//# sourceMappingURL=sha512.js.map","export function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nexport function bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\nexport function bytes(b, ...lengths) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nexport function hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nexport function exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nexport function output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nconst assert = {\n    number,\n    bool,\n    bytes,\n    hash,\n    exists,\n    output,\n};\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated, we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// big-endian hardware is rare. Just in case someone still decides to run hashes:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\n// Check if object doens't have custom constructor (like Uint8Array/Array)\nconst isPlainObject = (obj) => Object.prototype.toString.call(obj) === '[object Object]' && obj.constructor === Object;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && (typeof opts !== 'object' || !isPlainObject(opts)))\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import assert from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Base SHA2 class (RFC 6234)\nexport class SHA2 extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        assert.exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_sha2.js.map","import { SHA2 } from './_sha2.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// Choice: a ? b : c\nconst Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nconst Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state (first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19):\n// prettier-ignore\nconst IV = new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = new Uint32Array(64);\nclass SHA256 extends SHA2 {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = IV[0] | 0;\n        this.B = IV[1] | 0;\n        this.C = IV[2] | 0;\n        this.D = IV[3] | 0;\n        this.E = IV[4] | 0;\n        this.F = IV[5] | 0;\n        this.G = IV[6] | 0;\n        this.H = IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = wrapConstructor(() => new SHA256());\nexport const sha224 = wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// 100 lines of code in the file are duplicated from noble-hashes (utils).\n// This is OK: `abstract` directory does not use noble-hashes.\n// User may opt-in into using different hashing library. This way, noble-hashes\n// won't be included into their bundle.\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst u8a = (a) => a instanceof Uint8Array;\nconst hexes = Array.from({ length: 256 }, (v, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\nexport function numberToHexUnpadded(num) {\n    const hex = num.toString(16);\n    return hex.length & 1 ? `0${hex}` : hex;\n}\nexport function hexToNumber(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // Big Endian\n    return BigInt(hex === '' ? '0' : `0x${hex}`);\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nexport function bytesToNumberLE(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    return hexToNumber(bytesToHex(Uint8Array.from(bytes).reverse()));\n}\nexport function numberToBytesBE(n, len) {\n    return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\nexport function numberToBytesLE(n, len) {\n    return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nexport function numberToVarBytesBE(n) {\n    return hexToBytes(numberToHexUnpadded(n));\n}\n/**\n * Takes hex string or Uint8Array, converts to Uint8Array.\n * Validates output length.\n * Will throw error for other types.\n * @param title descriptive title for an error e.g. 'private key'\n * @param hex hex string or Uint8Array\n * @param expectedLength optional, will compare to result array's length\n * @returns\n */\nexport function ensureBytes(title, hex, expectedLength) {\n    let res;\n    if (typeof hex === 'string') {\n        try {\n            res = hexToBytes(hex);\n        }\n        catch (e) {\n            throw new Error(`${title} must be valid hex string, got \"${hex}\". Cause: ${e}`);\n        }\n    }\n    else if (u8a(hex)) {\n        // Uint8Array.from() instead of hash.slice() because node.js Buffer\n        // is instance of Uint8Array, and its slice() creates **mutable** copy\n        res = Uint8Array.from(hex);\n    }\n    else {\n        throw new Error(`${title} must be hex string or Uint8Array`);\n    }\n    const len = res.length;\n    if (typeof expectedLength === 'number' && len !== expectedLength)\n        throw new Error(`${title} expected ${expectedLength} bytes, got ${len}`);\n    return res;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\nexport function equalBytes(b1, b2) {\n    // We don't care about timing attacks here\n    if (b1.length !== b2.length)\n        return false;\n    for (let i = 0; i < b1.length; i++)\n        if (b1[i] !== b2[i])\n            return false;\n    return true;\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n// Bit operations\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n */\nexport function bitLen(n) {\n    let len;\n    for (len = 0; n > _0n; n >>= _1n, len += 1)\n        ;\n    return len;\n}\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nexport function bitGet(n, pos) {\n    return (n >> BigInt(pos)) & _1n;\n}\n/**\n * Sets single bit at position.\n */\nexport const bitSet = (n, pos, value) => {\n    return n | ((value ? _1n : _0n) << BigInt(pos));\n};\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nexport const bitMask = (n) => (_2n << BigInt(n - 1)) - _1n;\n// DRBG\nconst u8n = (data) => new Uint8Array(data); // creates Uint8Array\nconst u8fr = (arr) => Uint8Array.from(arr); // another shortcut\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nexport function createHmacDrbg(hashLen, qByteLen, hmacFn) {\n    if (typeof hashLen !== 'number' || hashLen < 2)\n        throw new Error('hashLen must be a number');\n    if (typeof qByteLen !== 'number' || qByteLen < 2)\n        throw new Error('qByteLen must be a number');\n    if (typeof hmacFn !== 'function')\n        throw new Error('hmacFn must be a function');\n    // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n    let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n    let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n    let i = 0; // Iterations counter, will throw when over 1000\n    const reset = () => {\n        v.fill(1);\n        k.fill(0);\n        i = 0;\n    };\n    const h = (...b) => hmacFn(k, v, ...b); // hmac(k)(v, ...values)\n    const reseed = (seed = u8n()) => {\n        // HMAC-DRBG reseed() function. Steps D-G\n        k = h(u8fr([0x00]), seed); // k = hmac(k || v || 0x00 || seed)\n        v = h(); // v = hmac(k || v)\n        if (seed.length === 0)\n            return;\n        k = h(u8fr([0x01]), seed); // k = hmac(k || v || 0x01 || seed)\n        v = h(); // v = hmac(k || v)\n    };\n    const gen = () => {\n        // HMAC-DRBG generate() function\n        if (i++ >= 1000)\n            throw new Error('drbg: tried 1000 values');\n        let len = 0;\n        const out = [];\n        while (len < qByteLen) {\n            v = h();\n            const sl = v.slice();\n            out.push(sl);\n            len += v.length;\n        }\n        return concatBytes(...out);\n    };\n    const genUntil = (seed, pred) => {\n        reset();\n        reseed(seed); // Steps D-G\n        let res = undefined; // Step H: grind until k is in [1..n-1]\n        while (!(res = pred(gen())))\n            reseed();\n        reset();\n        return res;\n    };\n    return genUntil;\n}\n// Validating curves and fields\nconst validatorFns = {\n    bigint: (val) => typeof val === 'bigint',\n    function: (val) => typeof val === 'function',\n    boolean: (val) => typeof val === 'boolean',\n    string: (val) => typeof val === 'string',\n    isSafeInteger: (val) => Number.isSafeInteger(val),\n    array: (val) => Array.isArray(val),\n    field: (val, object) => object.Fp.isValid(val),\n    hash: (val) => typeof val === 'function' && Number.isSafeInteger(val.outputLen),\n};\n// type Record<K extends string | number | symbol, T> = { [P in K]: T; }\nexport function validateObject(object, validators, optValidators = {}) {\n    const checkField = (fieldName, type, isOptional) => {\n        const checkVal = validatorFns[type];\n        if (typeof checkVal !== 'function')\n            throw new Error(`Invalid validator \"${type}\", expected function`);\n        const val = object[fieldName];\n        if (isOptional && val === undefined)\n            return;\n        if (!checkVal(val, object)) {\n            throw new Error(`Invalid param ${String(fieldName)}=${val} (${typeof val}), expected ${type}`);\n        }\n    };\n    for (const [fieldName, type] of Object.entries(validators))\n        checkField(fieldName, type, false);\n    for (const [fieldName, type] of Object.entries(optValidators))\n        checkField(fieldName, type, true);\n    return object;\n}\n// validate type tests\n// const o: { a: number; b: number; c: number } = { a: 1, b: 5, c: 6 };\n// const z0 = validateObject(o, { a: 'isSafeInteger' }, { c: 'bigint' }); // Ok!\n// // Should fail type-check\n// const z1 = validateObject(o, { a: 'tmp' }, { c: 'zz' });\n// const z2 = validateObject(o, { a: 'isSafeInteger' }, { c: 'zz' });\n// const z3 = validateObject(o, { test: 'boolean', z: 'bug' });\n// const z4 = validateObject(o, { a: 'boolean', z: 'bug' });\n//# sourceMappingURL=utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Utilities for modular arithmetics and finite fields\nimport { bitMask, numberToBytesBE, numberToBytesLE, bytesToNumberBE, bytesToNumberLE, ensureBytes, validateObject, } from './utils.js';\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3);\n// prettier-ignore\nconst _4n = BigInt(4), _5n = BigInt(5), _8n = BigInt(8);\n// prettier-ignore\nconst _9n = BigInt(9), _16n = BigInt(16);\n// Calculates a modulo b\nexport function mod(a, b) {\n    const result = a % b;\n    return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\n// TODO: use field version && remove\nexport function pow(num, power, modulo) {\n    if (modulo <= _0n || power < _0n)\n        throw new Error('Expected power/modulo > 0');\n    if (modulo === _1n)\n        return _0n;\n    let res = _1n;\n    while (power > _0n) {\n        if (power & _1n)\n            res = (res * num) % modulo;\n        num = (num * num) % modulo;\n        power >>= _1n;\n    }\n    return res;\n}\n// Does x ^ (2 ^ power) mod p. pow2(30, 4) == 30 ^ (2 ^ 4)\nexport function pow2(x, power, modulo) {\n    let res = x;\n    while (power-- > _0n) {\n        res *= res;\n        res %= modulo;\n    }\n    return res;\n}\n// Inverses number over modulo\nexport function invert(number, modulo) {\n    if (number === _0n || modulo <= _0n) {\n        throw new Error(`invert: expected positive integers, got n=${number} mod=${modulo}`);\n    }\n    // Euclidean GCD https://brilliant.org/wiki/extended-euclidean-algorithm/\n    // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n    let a = mod(number, modulo);\n    let b = modulo;\n    // prettier-ignore\n    let x = _0n, y = _1n, u = _1n, v = _0n;\n    while (a !== _0n) {\n        // JIT applies optimization if those two lines follow each other\n        const q = b / a;\n        const r = b % a;\n        const m = x - u * q;\n        const n = y - v * q;\n        // prettier-ignore\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    const gcd = b;\n    if (gcd !== _1n)\n        throw new Error('invert: does not exist');\n    return mod(x, modulo);\n}\n// Tonelli-Shanks algorithm\n// Paper 1: https://eprint.iacr.org/2012/685.pdf (page 12)\n// Paper 2: Square Roots from 1; 24, 51, 10 to Dan Shanks\nexport function tonelliShanks(P) {\n    // Legendre constant: used to calculate Legendre symbol (a | p),\n    // which denotes the value of a^((p-1)/2) (mod p).\n    // (a | p) ≡ 1    if a is a square (mod p)\n    // (a | p) ≡ -1   if a is not a square (mod p)\n    // (a | p) ≡ 0    if a ≡ 0 (mod p)\n    const legendreC = (P - _1n) / _2n;\n    let Q, S, Z;\n    // Step 1: By factoring out powers of 2 from p - 1,\n    // find q and s such that p - 1 = q*(2^s) with q odd\n    for (Q = P - _1n, S = 0; Q % _2n === _0n; Q /= _2n, S++)\n        ;\n    // Step 2: Select a non-square z such that (z | p) ≡ -1 and set c ≡ zq\n    for (Z = _2n; Z < P && pow(Z, legendreC, P) !== P - _1n; Z++)\n        ;\n    // Fast-path\n    if (S === 1) {\n        const p1div4 = (P + _1n) / _4n;\n        return function tonelliFast(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Slow-path\n    const Q1div2 = (Q + _1n) / _2n;\n    return function tonelliSlow(Fp, n) {\n        // Step 0: Check that n is indeed a square: (n | p) should not be ≡ -1\n        if (Fp.pow(n, legendreC) === Fp.neg(Fp.ONE))\n            throw new Error('Cannot find square root');\n        let r = S;\n        // TODO: will fail at Fp2/etc\n        let g = Fp.pow(Fp.mul(Fp.ONE, Z), Q); // will update both x and b\n        let x = Fp.pow(n, Q1div2); // first guess at the square root\n        let b = Fp.pow(n, Q); // first guess at the fudge factor\n        while (!Fp.eql(b, Fp.ONE)) {\n            if (Fp.eql(b, Fp.ZERO))\n                return Fp.ZERO; // https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm (4. If t = 0, return r = 0)\n            // Find m such b^(2^m)==1\n            let m = 1;\n            for (let t2 = Fp.sqr(b); m < r; m++) {\n                if (Fp.eql(t2, Fp.ONE))\n                    break;\n                t2 = Fp.sqr(t2); // t2 *= t2\n            }\n            // NOTE: r-m-1 can be bigger than 32, need to convert to bigint before shift, otherwise there will be overflow\n            const ge = Fp.pow(g, _1n << BigInt(r - m - 1)); // ge = 2^(r-m-1)\n            g = Fp.sqr(ge); // g = ge * ge\n            x = Fp.mul(x, ge); // x *= ge\n            b = Fp.mul(b, g); // b *= g\n            r = m;\n        }\n        return x;\n    };\n}\nexport function FpSqrt(P) {\n    // NOTE: different algorithms can give different roots, it is up to user to decide which one they want.\n    // For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n    // P ≡ 3 (mod 4)\n    // √n = n^((P+1)/4)\n    if (P % _4n === _3n) {\n        // Not all roots possible!\n        // const ORDER =\n        //   0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn;\n        // const NUM = 72057594037927816n;\n        const p1div4 = (P + _1n) / _4n;\n        return function sqrt3mod4(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            // Throw if root**2 != n\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Atkin algorithm for q ≡ 5 (mod 8), https://eprint.iacr.org/2012/685.pdf (page 10)\n    if (P % _8n === _5n) {\n        const c1 = (P - _5n) / _8n;\n        return function sqrt5mod8(Fp, n) {\n            const n2 = Fp.mul(n, _2n);\n            const v = Fp.pow(n2, c1);\n            const nv = Fp.mul(n, v);\n            const i = Fp.mul(Fp.mul(nv, _2n), v);\n            const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // P ≡ 9 (mod 16)\n    if (P % _16n === _9n) {\n        // NOTE: tonelli is too slow for bls-Fp2 calculations even on start\n        // Means we cannot use sqrt for constants at all!\n        //\n        // const c1 = Fp.sqrt(Fp.negate(Fp.ONE)); //  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n        // const c2 = Fp.sqrt(c1);                //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n        // const c3 = Fp.sqrt(Fp.negate(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n        // const c4 = (P + _7n) / _16n;           //  4. c4 = (q + 7) / 16        # Integer arithmetic\n        // sqrt = (x) => {\n        //   let tv1 = Fp.pow(x, c4);             //  1. tv1 = x^c4\n        //   let tv2 = Fp.mul(c1, tv1);           //  2. tv2 = c1 * tv1\n        //   const tv3 = Fp.mul(c2, tv1);         //  3. tv3 = c2 * tv1\n        //   let tv4 = Fp.mul(c3, tv1);           //  4. tv4 = c3 * tv1\n        //   const e1 = Fp.equals(Fp.square(tv2), x); //  5.  e1 = (tv2^2) == x\n        //   const e2 = Fp.equals(Fp.square(tv3), x); //  6.  e2 = (tv3^2) == x\n        //   tv1 = Fp.cmov(tv1, tv2, e1); //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n        //   tv2 = Fp.cmov(tv4, tv3, e2); //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n        //   const e3 = Fp.equals(Fp.square(tv2), x); //  9.  e3 = (tv2^2) == x\n        //   return Fp.cmov(tv1, tv2, e3); //  10.  z = CMOV(tv1, tv2, e3)  # Select the sqrt from tv1 and tv2\n        // }\n    }\n    // Other cases: Tonelli-Shanks algorithm\n    return tonelliShanks(P);\n}\n// Little-endian check for first LE bit (last BE bit);\nexport const isNegativeLE = (num, modulo) => (mod(num, modulo) & _1n) === _1n;\n// prettier-ignore\nconst FIELD_FIELDS = [\n    'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n    'eql', 'add', 'sub', 'mul', 'pow', 'div',\n    'addN', 'subN', 'mulN', 'sqrN'\n];\nexport function validateField(field) {\n    const initial = {\n        ORDER: 'bigint',\n        MASK: 'bigint',\n        BYTES: 'isSafeInteger',\n        BITS: 'isSafeInteger',\n    };\n    const opts = FIELD_FIELDS.reduce((map, val) => {\n        map[val] = 'function';\n        return map;\n    }, initial);\n    return validateObject(field, opts);\n}\n// Generic field functions\nexport function FpPow(f, num, power) {\n    // Should have same speed as pow for bigints\n    // TODO: benchmark!\n    if (power < _0n)\n        throw new Error('Expected power > 0');\n    if (power === _0n)\n        return f.ONE;\n    if (power === _1n)\n        return num;\n    let p = f.ONE;\n    let d = num;\n    while (power > _0n) {\n        if (power & _1n)\n            p = f.mul(p, d);\n        d = f.sqr(d);\n        power >>= _1n;\n    }\n    return p;\n}\n// 0 is non-invertible: non-batched version will throw on 0\nexport function FpInvertBatch(f, nums) {\n    const tmp = new Array(nums.length);\n    // Walk from first to last, multiply them by each other MOD p\n    const lastMultiplied = nums.reduce((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = acc;\n        return f.mul(acc, num);\n    }, f.ONE);\n    // Invert last element\n    const inverted = f.inv(lastMultiplied);\n    // Walk from last to first, multiply them by inverted each other MOD p\n    nums.reduceRight((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = f.mul(acc, tmp[i]);\n        return f.mul(acc, num);\n    }, inverted);\n    return tmp;\n}\nexport function FpDiv(f, lhs, rhs) {\n    return f.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, f.ORDER) : f.inv(rhs));\n}\n// This function returns True whenever the value x is a square in the field F.\nexport function FpIsSquare(f) {\n    const legendreConst = (f.ORDER - _1n) / _2n; // Integer arithmetic\n    return (x) => {\n        const p = f.pow(x, legendreConst);\n        return f.eql(p, f.ZERO) || f.eql(p, f.ONE);\n    };\n}\n// CURVE.n lengths\nexport function nLength(n, nBitLength) {\n    // Bit size, byte size of CURVE.n\n    const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n    const nByteLength = Math.ceil(_nBitLength / 8);\n    return { nBitLength: _nBitLength, nByteLength };\n}\n/**\n * Initializes a galois field over prime. Non-primes are not supported for now.\n * Do not init in loop: slow. Very fragile: always run a benchmark on change.\n * Major performance gains:\n * a) non-normalized operations like mulN instead of mul\n * b) `Object.freeze`\n * c) Same object shape: never add or remove keys\n * @param ORDER prime positive bigint\n * @param bitLen how many bits the field consumes\n * @param isLE (def: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nexport function Field(ORDER, bitLen, isLE = false, redef = {}) {\n    if (ORDER <= _0n)\n        throw new Error(`Expected Fp ORDER > 0, got ${ORDER}`);\n    const { nBitLength: BITS, nByteLength: BYTES } = nLength(ORDER, bitLen);\n    if (BYTES > 2048)\n        throw new Error('Field lengths over 2048 bytes are not supported');\n    const sqrtP = FpSqrt(ORDER);\n    const f = Object.freeze({\n        ORDER,\n        BITS,\n        BYTES,\n        MASK: bitMask(BITS),\n        ZERO: _0n,\n        ONE: _1n,\n        create: (num) => mod(num, ORDER),\n        isValid: (num) => {\n            if (typeof num !== 'bigint')\n                throw new Error(`Invalid field element: expected bigint, got ${typeof num}`);\n            return _0n <= num && num < ORDER; // 0 is valid element, but it's not invertible\n        },\n        is0: (num) => num === _0n,\n        isOdd: (num) => (num & _1n) === _1n,\n        neg: (num) => mod(-num, ORDER),\n        eql: (lhs, rhs) => lhs === rhs,\n        sqr: (num) => mod(num * num, ORDER),\n        add: (lhs, rhs) => mod(lhs + rhs, ORDER),\n        sub: (lhs, rhs) => mod(lhs - rhs, ORDER),\n        mul: (lhs, rhs) => mod(lhs * rhs, ORDER),\n        pow: (num, power) => FpPow(f, num, power),\n        div: (lhs, rhs) => mod(lhs * invert(rhs, ORDER), ORDER),\n        // Same as above, but doesn't normalize\n        sqrN: (num) => num * num,\n        addN: (lhs, rhs) => lhs + rhs,\n        subN: (lhs, rhs) => lhs - rhs,\n        mulN: (lhs, rhs) => lhs * rhs,\n        inv: (num) => invert(num, ORDER),\n        sqrt: redef.sqrt || ((n) => sqrtP(f, n)),\n        invertBatch: (lst) => FpInvertBatch(f, lst),\n        // TODO: do we really need constant cmov?\n        // We don't have const-time bigints anyway, so probably will be not very useful\n        cmov: (a, b, c) => (c ? b : a),\n        toBytes: (num) => (isLE ? numberToBytesLE(num, BYTES) : numberToBytesBE(num, BYTES)),\n        fromBytes: (bytes) => {\n            if (bytes.length !== BYTES)\n                throw new Error(`Fp.fromBytes: expected ${BYTES}, got ${bytes.length}`);\n            return isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n        },\n    });\n    return Object.freeze(f);\n}\nexport function FpSqrtOdd(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? root : Fp.neg(root);\n}\nexport function FpSqrtEven(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n/**\n * FIPS 186 B.4.1-compliant \"constant-time\" private key generation utility.\n * Can take (n+8) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 40 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. curveFn.CURVE.n)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nexport function hashToPrivateScalar(hash, groupOrder, isLE = false) {\n    hash = ensureBytes('privateHash', hash);\n    const hashLen = hash.length;\n    const minLen = nLength(groupOrder).nByteLength + 8;\n    if (minLen < 24 || hashLen < minLen || hashLen > 1024)\n        throw new Error(`hashToPrivateScalar: expected ${minLen}-1024 bytes of input, got ${hashLen}`);\n    const num = isLE ? bytesToNumberLE(hash) : bytesToNumberBE(hash);\n    return mod(num, groupOrder - _1n) + _1n;\n}\n//# sourceMappingURL=modular.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Abelian group utilities\nimport { validateField, nLength } from './modular.js';\nimport { validateObject } from './utils.js';\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\n// Elliptic curve multiplication of Point by scalar. Fragile.\n// Scalars should always be less than curve order: this should be checked inside of a curve itself.\n// Creates precomputation tables for fast multiplication:\n// - private scalar is split by fixed size windows of W bits\n// - every window point is collected from window's table & added to accumulator\n// - since windows are different, same point inside tables won't be accessed more than once per calc\n// - each multiplication is 'Math.ceil(CURVE_ORDER / 𝑊) + 1' point additions (fixed for any scalar)\n// - +1 window is neccessary for wNAF\n// - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n// TODO: Research returning 2d JS array of windows, instead of a single window. This would allow\n// windows to be in different memory locations\nexport function wNAF(c, bits) {\n    const constTimeNegate = (condition, item) => {\n        const neg = item.negate();\n        return condition ? neg : item;\n    };\n    const opts = (W) => {\n        const windows = Math.ceil(bits / W) + 1; // +1, because\n        const windowSize = 2 ** (W - 1); // -1 because we skip zero\n        return { windows, windowSize };\n    };\n    return {\n        constTimeNegate,\n        // non-const time multiplication ladder\n        unsafeLadder(elm, n) {\n            let p = c.ZERO;\n            let d = elm;\n            while (n > _0n) {\n                if (n & _1n)\n                    p = p.add(d);\n                d = d.double();\n                n >>= _1n;\n            }\n            return p;\n        },\n        /**\n         * Creates a wNAF precomputation window. Used for caching.\n         * Default window size is set by `utils.precompute()` and is equal to 8.\n         * Number of precomputed points depends on the curve size:\n         * 2^(𝑊−1) * (Math.ceil(𝑛 / 𝑊) + 1), where:\n         * - 𝑊 is the window size\n         * - 𝑛 is the bitlength of the curve order.\n         * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n         * @returns precomputed point tables flattened to a single array\n         */\n        precomputeWindow(elm, W) {\n            const { windows, windowSize } = opts(W);\n            const points = [];\n            let p = elm;\n            let base = p;\n            for (let window = 0; window < windows; window++) {\n                base = p;\n                points.push(base);\n                // =1, because we skip zero\n                for (let i = 1; i < windowSize; i++) {\n                    base = base.add(p);\n                    points.push(base);\n                }\n                p = base.double();\n            }\n            return points;\n        },\n        /**\n         * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n         * @param W window size\n         * @param precomputes precomputed tables\n         * @param n scalar (we don't check here, but should be less than curve order)\n         * @returns real and fake (for const-time) points\n         */\n        wNAF(W, precomputes, n) {\n            // TODO: maybe check that scalar is less than group order? wNAF behavious is undefined otherwise\n            // But need to carefully remove other checks before wNAF. ORDER == bits here\n            const { windows, windowSize } = opts(W);\n            let p = c.ZERO;\n            let f = c.BASE;\n            const mask = BigInt(2 ** W - 1); // Create mask with W ones: 0b1111 for W=4 etc.\n            const maxNumber = 2 ** W;\n            const shiftBy = BigInt(W);\n            for (let window = 0; window < windows; window++) {\n                const offset = window * windowSize;\n                // Extract W bits.\n                let wbits = Number(n & mask);\n                // Shift number by W bits.\n                n >>= shiftBy;\n                // If the bits are bigger than max size, we'll split those.\n                // +224 => 256 - 32\n                if (wbits > windowSize) {\n                    wbits -= maxNumber;\n                    n += _1n;\n                }\n                // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n                // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n                // there is negate now: it is possible that negated element from low value\n                // would be the same as high element, which will create carry into next window.\n                // It's not obvious how this can fail, but still worth investigating later.\n                // Check if we're onto Zero point.\n                // Add random point inside current window to f.\n                const offset1 = offset;\n                const offset2 = offset + Math.abs(wbits) - 1; // -1 because we skip zero\n                const cond1 = window % 2 !== 0;\n                const cond2 = wbits < 0;\n                if (wbits === 0) {\n                    // The most important part for const-time getPublicKey\n                    f = f.add(constTimeNegate(cond1, precomputes[offset1]));\n                }\n                else {\n                    p = p.add(constTimeNegate(cond2, precomputes[offset2]));\n                }\n            }\n            // JIT-compiler should not eliminate f here, since it will later be used in normalizeZ()\n            // Even if the variable is still unused, there are some checks which will\n            // throw an exception, so compiler needs to prove they won't happen, which is hard.\n            // At this point there is a way to F be infinity-point even if p is not,\n            // which makes it less const-time: around 1 bigint multiply.\n            return { p, f };\n        },\n        wNAFCached(P, precomputesMap, n, transform) {\n            // @ts-ignore\n            const W = P._WINDOW_SIZE || 1;\n            // Calculate precomputes on a first run, reuse them after\n            let comp = precomputesMap.get(P);\n            if (!comp) {\n                comp = this.precomputeWindow(P, W);\n                if (W !== 1) {\n                    precomputesMap.set(P, transform(comp));\n                }\n            }\n            return this.wNAF(W, comp, n);\n        },\n    };\n}\nexport function validateBasic(curve) {\n    validateField(curve.Fp);\n    validateObject(curve, {\n        n: 'bigint',\n        h: 'bigint',\n        Gx: 'field',\n        Gy: 'field',\n    }, {\n        nBitLength: 'isSafeInteger',\n        nByteLength: 'isSafeInteger',\n    });\n    // Set defaults\n    return Object.freeze({\n        ...nLength(curve.n, curve.nBitLength),\n        ...curve,\n        ...{ p: curve.Fp.ORDER },\n    });\n}\n//# sourceMappingURL=curve.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Short Weierstrass curve. The formula is: y² = x³ + ax + b\nimport * as mod from './modular.js';\nimport * as ut from './utils.js';\nimport { ensureBytes } from './utils.js';\nimport { wNAF, validateBasic } from './curve.js';\nfunction validatePointOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        a: 'field',\n        b: 'field',\n    }, {\n        allowedPrivateKeyLengths: 'array',\n        wrapPrivateKey: 'boolean',\n        isTorsionFree: 'function',\n        clearCofactor: 'function',\n        allowInfinityPoint: 'boolean',\n        fromBytes: 'function',\n        toBytes: 'function',\n    });\n    const { endo, Fp, a } = opts;\n    if (endo) {\n        if (!Fp.eql(a, Fp.ZERO)) {\n            throw new Error('Endomorphism can only be defined for Koblitz curves that have a=0');\n        }\n        if (typeof endo !== 'object' ||\n            typeof endo.beta !== 'bigint' ||\n            typeof endo.splitScalar !== 'function') {\n            throw new Error('Expected endomorphism with beta: bigint and splitScalar: function');\n        }\n    }\n    return Object.freeze({ ...opts });\n}\n// ASN.1 DER encoding utilities\nconst { bytesToNumberBE: b2n, hexToBytes: h2b } = ut;\nexport const DER = {\n    // asn.1 DER encoding utils\n    Err: class DERErr extends Error {\n        constructor(m = '') {\n            super(m);\n        }\n    },\n    _parseInt(data) {\n        const { Err: E } = DER;\n        if (data.length < 2 || data[0] !== 0x02)\n            throw new E('Invalid signature integer tag');\n        const len = data[1];\n        const res = data.subarray(2, len + 2);\n        if (!len || res.length !== len)\n            throw new E('Invalid signature integer: wrong length');\n        // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n        // since we always use positive integers here. It must always be empty:\n        // - add zero byte if exists\n        // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n        if (res[0] & 0b10000000)\n            throw new E('Invalid signature integer: negative');\n        if (res[0] === 0x00 && !(res[1] & 0b10000000))\n            throw new E('Invalid signature integer: unnecessary leading zero');\n        return { d: b2n(res), l: data.subarray(len + 2) }; // d is data, l is left\n    },\n    toSig(hex) {\n        // parse DER signature\n        const { Err: E } = DER;\n        const data = typeof hex === 'string' ? h2b(hex) : hex;\n        if (!(data instanceof Uint8Array))\n            throw new Error('ui8a expected');\n        let l = data.length;\n        if (l < 2 || data[0] != 0x30)\n            throw new E('Invalid signature tag');\n        if (data[1] !== l - 2)\n            throw new E('Invalid signature: incorrect length');\n        const { d: r, l: sBytes } = DER._parseInt(data.subarray(2));\n        const { d: s, l: rBytesLeft } = DER._parseInt(sBytes);\n        if (rBytesLeft.length)\n            throw new E('Invalid signature: left bytes after parsing');\n        return { r, s };\n    },\n    hexFromSig(sig) {\n        // Add leading zero if first byte has negative bit enabled. More details in '_parseInt'\n        const slice = (s) => (Number.parseInt(s[0], 16) & 0b1000 ? '00' + s : s);\n        const h = (num) => {\n            const hex = num.toString(16);\n            return hex.length & 1 ? `0${hex}` : hex;\n        };\n        const s = slice(h(sig.s));\n        const r = slice(h(sig.r));\n        const shl = s.length / 2;\n        const rhl = r.length / 2;\n        const sl = h(shl);\n        const rl = h(rhl);\n        return `30${h(rhl + shl + 4)}02${rl}${r}02${sl}${s}`;\n    },\n};\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = BigInt(4);\nexport function weierstrassPoints(opts) {\n    const CURVE = validatePointOpts(opts);\n    const { Fp } = CURVE; // All curves has same field / group length as for now, but they can differ\n    const toBytes = CURVE.toBytes ||\n        ((c, point, isCompressed) => {\n            const a = point.toAffine();\n            return ut.concatBytes(Uint8Array.from([0x04]), Fp.toBytes(a.x), Fp.toBytes(a.y));\n        });\n    const fromBytes = CURVE.fromBytes ||\n        ((bytes) => {\n            // const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // if (head !== 0x04) throw new Error('Only non-compressed encoding is supported');\n            const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n            const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n            return { x, y };\n        });\n    /**\n     * y² = x³ + ax + b: Short weierstrass curve formula\n     * @returns y²\n     */\n    function weierstrassEquation(x) {\n        const { a, b } = CURVE;\n        const x2 = Fp.sqr(x); // x * x\n        const x3 = Fp.mul(x2, x); // x2 * x\n        return Fp.add(Fp.add(x3, Fp.mul(x, a)), b); // x3 + a * x + b\n    }\n    // Validate whether the passed curve params are valid.\n    // We check if curve equation works for generator point.\n    // `assertValidity()` won't work: `isTorsionFree()` is not available at this point in bls12-381.\n    // ProjectivePoint class has not been initialized yet.\n    if (!Fp.eql(Fp.sqr(CURVE.Gy), weierstrassEquation(CURVE.Gx)))\n        throw new Error('bad generator point: equation left != right');\n    // Valid group elements reside in range 1..n-1\n    function isWithinCurveOrder(num) {\n        return typeof num === 'bigint' && _0n < num && num < CURVE.n;\n    }\n    function assertGE(num) {\n        if (!isWithinCurveOrder(num))\n            throw new Error('Expected valid bigint: 0 < bigint < curve.n');\n    }\n    // Validates if priv key is valid and converts it to bigint.\n    // Supports options allowedPrivateKeyLengths and wrapPrivateKey.\n    function normPrivateKeyToScalar(key) {\n        const { allowedPrivateKeyLengths: lengths, nByteLength, wrapPrivateKey, n } = CURVE;\n        if (lengths && typeof key !== 'bigint') {\n            if (key instanceof Uint8Array)\n                key = ut.bytesToHex(key);\n            // Normalize to hex string, pad. E.g. P521 would norm 130-132 char hex to 132-char bytes\n            if (typeof key !== 'string' || !lengths.includes(key.length))\n                throw new Error('Invalid key');\n            key = key.padStart(nByteLength * 2, '0');\n        }\n        let num;\n        try {\n            num =\n                typeof key === 'bigint'\n                    ? key\n                    : ut.bytesToNumberBE(ensureBytes('private key', key, nByteLength));\n        }\n        catch (error) {\n            throw new Error(`private key must be ${nByteLength} bytes, hex or bigint, not ${typeof key}`);\n        }\n        if (wrapPrivateKey)\n            num = mod.mod(num, n); // disabled by default, enabled for BLS\n        assertGE(num); // num in range [1..N-1]\n        return num;\n    }\n    const pointPrecomputes = new Map();\n    function assertPrjPoint(other) {\n        if (!(other instanceof Point))\n            throw new Error('ProjectivePoint expected');\n    }\n    /**\n     * Projective Point works in 3d / projective (homogeneous) coordinates: (x, y, z) ∋ (x=x/z, y=y/z)\n     * Default Point works in 2d / affine coordinates: (x, y)\n     * We're doing calculations in projective, because its operations don't require costly inversion.\n     */\n    class Point {\n        constructor(px, py, pz) {\n            this.px = px;\n            this.py = py;\n            this.pz = pz;\n            if (px == null || !Fp.isValid(px))\n                throw new Error('x required');\n            if (py == null || !Fp.isValid(py))\n                throw new Error('y required');\n            if (pz == null || !Fp.isValid(pz))\n                throw new Error('z required');\n        }\n        // Does not validate if the point is on-curve.\n        // Use fromHex instead, or call assertValidity() later.\n        static fromAffine(p) {\n            const { x, y } = p || {};\n            if (!p || !Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('invalid affine point');\n            if (p instanceof Point)\n                throw new Error('projective point not allowed');\n            const is0 = (i) => Fp.eql(i, Fp.ZERO);\n            // fromAffine(x:0, y:0) would produce (x:0, y:0, z:1), but we need (x:0, y:1, z:0)\n            if (is0(x) && is0(y))\n                return Point.ZERO;\n            return new Point(x, y, Fp.ONE);\n        }\n        get x() {\n            return this.toAffine().x;\n        }\n        get y() {\n            return this.toAffine().y;\n        }\n        /**\n         * Takes a bunch of Projective Points but executes only one\n         * inversion on all of them. Inversion is very slow operation,\n         * so this improves performance massively.\n         * Optimization: converts a list of projective points to a list of identical points with Z=1.\n         */\n        static normalizeZ(points) {\n            const toInv = Fp.invertBatch(points.map((p) => p.pz));\n            return points.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n        }\n        /**\n         * Converts hash string or Uint8Array to Point.\n         * @param hex short/long ECDSA hex\n         */\n        static fromHex(hex) {\n            const P = Point.fromAffine(fromBytes(ensureBytes('pointHex', hex)));\n            P.assertValidity();\n            return P;\n        }\n        // Multiplies generator point by privateKey.\n        static fromPrivateKey(privateKey) {\n            return Point.BASE.multiply(normPrivateKeyToScalar(privateKey));\n        }\n        // \"Private method\", don't use it directly\n        _setWindowSize(windowSize) {\n            this._WINDOW_SIZE = windowSize;\n            pointPrecomputes.delete(this);\n        }\n        // A point on curve is valid if it conforms to equation.\n        assertValidity() {\n            // Zero is valid point too!\n            if (this.is0()) {\n                if (CURVE.allowInfinityPoint)\n                    return;\n                throw new Error('bad point: ZERO');\n            }\n            // Some 3rd-party test vectors require different wording between here & `fromCompressedHex`\n            const { x, y } = this.toAffine();\n            // Check if x, y are valid field elements\n            if (!Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('bad point: x or y not FE');\n            const left = Fp.sqr(y); // y²\n            const right = weierstrassEquation(x); // x³ + ax + b\n            if (!Fp.eql(left, right))\n                throw new Error('bad point: equation left != right');\n            if (!this.isTorsionFree())\n                throw new Error('bad point: not in prime-order subgroup');\n        }\n        hasEvenY() {\n            const { y } = this.toAffine();\n            if (Fp.isOdd)\n                return !Fp.isOdd(y);\n            throw new Error(\"Field doesn't support isOdd\");\n        }\n        /**\n         * Compare one point to another.\n         */\n        equals(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            const U1 = Fp.eql(Fp.mul(X1, Z2), Fp.mul(X2, Z1));\n            const U2 = Fp.eql(Fp.mul(Y1, Z2), Fp.mul(Y2, Z1));\n            return U1 && U2;\n        }\n        /**\n         * Flips point to one corresponding to (x, -y) in Affine coordinates.\n         */\n        negate() {\n            return new Point(this.px, Fp.neg(this.py), this.pz);\n        }\n        // Renes-Costello-Batina exception-free doubling formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 3\n        // Cost: 8M + 3S + 3*a + 2*b3 + 15add.\n        double() {\n            const { a, b } = CURVE;\n            const b3 = Fp.mul(b, _3n);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            let t0 = Fp.mul(X1, X1); // step 1\n            let t1 = Fp.mul(Y1, Y1);\n            let t2 = Fp.mul(Z1, Z1);\n            let t3 = Fp.mul(X1, Y1);\n            t3 = Fp.add(t3, t3); // step 5\n            Z3 = Fp.mul(X1, Z1);\n            Z3 = Fp.add(Z3, Z3);\n            X3 = Fp.mul(a, Z3);\n            Y3 = Fp.mul(b3, t2);\n            Y3 = Fp.add(X3, Y3); // step 10\n            X3 = Fp.sub(t1, Y3);\n            Y3 = Fp.add(t1, Y3);\n            Y3 = Fp.mul(X3, Y3);\n            X3 = Fp.mul(t3, X3);\n            Z3 = Fp.mul(b3, Z3); // step 15\n            t2 = Fp.mul(a, t2);\n            t3 = Fp.sub(t0, t2);\n            t3 = Fp.mul(a, t3);\n            t3 = Fp.add(t3, Z3);\n            Z3 = Fp.add(t0, t0); // step 20\n            t0 = Fp.add(Z3, t0);\n            t0 = Fp.add(t0, t2);\n            t0 = Fp.mul(t0, t3);\n            Y3 = Fp.add(Y3, t0);\n            t2 = Fp.mul(Y1, Z1); // step 25\n            t2 = Fp.add(t2, t2);\n            t0 = Fp.mul(t2, t3);\n            X3 = Fp.sub(X3, t0);\n            Z3 = Fp.mul(t2, t1);\n            Z3 = Fp.add(Z3, Z3); // step 30\n            Z3 = Fp.add(Z3, Z3);\n            return new Point(X3, Y3, Z3);\n        }\n        // Renes-Costello-Batina exception-free addition formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 1\n        // Cost: 12M + 0S + 3*a + 3*b3 + 23add.\n        add(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            const a = CURVE.a;\n            const b3 = Fp.mul(CURVE.b, _3n);\n            let t0 = Fp.mul(X1, X2); // step 1\n            let t1 = Fp.mul(Y1, Y2);\n            let t2 = Fp.mul(Z1, Z2);\n            let t3 = Fp.add(X1, Y1);\n            let t4 = Fp.add(X2, Y2); // step 5\n            t3 = Fp.mul(t3, t4);\n            t4 = Fp.add(t0, t1);\n            t3 = Fp.sub(t3, t4);\n            t4 = Fp.add(X1, Z1);\n            let t5 = Fp.add(X2, Z2); // step 10\n            t4 = Fp.mul(t4, t5);\n            t5 = Fp.add(t0, t2);\n            t4 = Fp.sub(t4, t5);\n            t5 = Fp.add(Y1, Z1);\n            X3 = Fp.add(Y2, Z2); // step 15\n            t5 = Fp.mul(t5, X3);\n            X3 = Fp.add(t1, t2);\n            t5 = Fp.sub(t5, X3);\n            Z3 = Fp.mul(a, t4);\n            X3 = Fp.mul(b3, t2); // step 20\n            Z3 = Fp.add(X3, Z3);\n            X3 = Fp.sub(t1, Z3);\n            Z3 = Fp.add(t1, Z3);\n            Y3 = Fp.mul(X3, Z3);\n            t1 = Fp.add(t0, t0); // step 25\n            t1 = Fp.add(t1, t0);\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.mul(b3, t4);\n            t1 = Fp.add(t1, t2);\n            t2 = Fp.sub(t0, t2); // step 30\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.add(t4, t2);\n            t0 = Fp.mul(t1, t4);\n            Y3 = Fp.add(Y3, t0);\n            t0 = Fp.mul(t5, t4); // step 35\n            X3 = Fp.mul(t3, X3);\n            X3 = Fp.sub(X3, t0);\n            t0 = Fp.mul(t3, t1);\n            Z3 = Fp.mul(t5, Z3);\n            Z3 = Fp.add(Z3, t0); // step 40\n            return new Point(X3, Y3, Z3);\n        }\n        subtract(other) {\n            return this.add(other.negate());\n        }\n        is0() {\n            return this.equals(Point.ZERO);\n        }\n        wNAF(n) {\n            return wnaf.wNAFCached(this, pointPrecomputes, n, (comp) => {\n                const toInv = Fp.invertBatch(comp.map((p) => p.pz));\n                return comp.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n            });\n        }\n        /**\n         * Non-constant-time multiplication. Uses double-and-add algorithm.\n         * It's faster, but should only be used when you don't care about\n         * an exposed private key e.g. sig verification, which works over *public* keys.\n         */\n        multiplyUnsafe(n) {\n            const I = Point.ZERO;\n            if (n === _0n)\n                return I;\n            assertGE(n); // Will throw on 0\n            if (n === _1n)\n                return this;\n            const { endo } = CURVE;\n            if (!endo)\n                return wnaf.unsafeLadder(this, n);\n            // Apply endomorphism\n            let { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n            let k1p = I;\n            let k2p = I;\n            let d = this;\n            while (k1 > _0n || k2 > _0n) {\n                if (k1 & _1n)\n                    k1p = k1p.add(d);\n                if (k2 & _1n)\n                    k2p = k2p.add(d);\n                d = d.double();\n                k1 >>= _1n;\n                k2 >>= _1n;\n            }\n            if (k1neg)\n                k1p = k1p.negate();\n            if (k2neg)\n                k2p = k2p.negate();\n            k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n            return k1p.add(k2p);\n        }\n        /**\n         * Constant time multiplication.\n         * Uses wNAF method. Windowed method may be 10% faster,\n         * but takes 2x longer to generate and consumes 2x memory.\n         * Uses precomputes when available.\n         * Uses endomorphism for Koblitz curves.\n         * @param scalar by which the point would be multiplied\n         * @returns New point\n         */\n        multiply(scalar) {\n            assertGE(scalar);\n            let n = scalar;\n            let point, fake; // Fake point is used to const-time mult\n            const { endo } = CURVE;\n            if (endo) {\n                const { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n                let { p: k1p, f: f1p } = this.wNAF(k1);\n                let { p: k2p, f: f2p } = this.wNAF(k2);\n                k1p = wnaf.constTimeNegate(k1neg, k1p);\n                k2p = wnaf.constTimeNegate(k2neg, k2p);\n                k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n                point = k1p.add(k2p);\n                fake = f1p.add(f2p);\n            }\n            else {\n                const { p, f } = this.wNAF(n);\n                point = p;\n                fake = f;\n            }\n            // Normalize `z` for both points, but return only real one\n            return Point.normalizeZ([point, fake])[0];\n        }\n        /**\n         * Efficiently calculate `aP + bQ`. Unsafe, can expose private key, if used incorrectly.\n         * Not using Strauss-Shamir trick: precomputation tables are faster.\n         * The trick could be useful if both P and Q are not G (not in our case).\n         * @returns non-zero affine point\n         */\n        multiplyAndAddUnsafe(Q, a, b) {\n            const G = Point.BASE; // No Strauss-Shamir trick: we have 10% faster G precomputes\n            const mul = (P, a // Select faster multiply() method\n            ) => (a === _0n || a === _1n || !P.equals(G) ? P.multiplyUnsafe(a) : P.multiply(a));\n            const sum = mul(this, a).add(mul(Q, b));\n            return sum.is0() ? undefined : sum;\n        }\n        // Converts Projective point to affine (x, y) coordinates.\n        // Can accept precomputed Z^-1 - for example, from invertBatch.\n        // (x, y, z) ∋ (x=x/z, y=y/z)\n        toAffine(iz) {\n            const { px: x, py: y, pz: z } = this;\n            const is0 = this.is0();\n            // If invZ was 0, we return zero point. However we still want to execute\n            // all operations, so we replace invZ with a random number, 1.\n            if (iz == null)\n                iz = is0 ? Fp.ONE : Fp.inv(z);\n            const ax = Fp.mul(x, iz);\n            const ay = Fp.mul(y, iz);\n            const zz = Fp.mul(z, iz);\n            if (is0)\n                return { x: Fp.ZERO, y: Fp.ZERO };\n            if (!Fp.eql(zz, Fp.ONE))\n                throw new Error('invZ was invalid');\n            return { x: ax, y: ay };\n        }\n        isTorsionFree() {\n            const { h: cofactor, isTorsionFree } = CURVE;\n            if (cofactor === _1n)\n                return true; // No subgroups, always torsion-free\n            if (isTorsionFree)\n                return isTorsionFree(Point, this);\n            throw new Error('isTorsionFree() has not been declared for the elliptic curve');\n        }\n        clearCofactor() {\n            const { h: cofactor, clearCofactor } = CURVE;\n            if (cofactor === _1n)\n                return this; // Fast-path\n            if (clearCofactor)\n                return clearCofactor(Point, this);\n            return this.multiplyUnsafe(CURVE.h);\n        }\n        toRawBytes(isCompressed = true) {\n            this.assertValidity();\n            return toBytes(Point, this, isCompressed);\n        }\n        toHex(isCompressed = true) {\n            return ut.bytesToHex(this.toRawBytes(isCompressed));\n        }\n    }\n    Point.BASE = new Point(CURVE.Gx, CURVE.Gy, Fp.ONE);\n    Point.ZERO = new Point(Fp.ZERO, Fp.ONE, Fp.ZERO);\n    const _bits = CURVE.nBitLength;\n    const wnaf = wNAF(Point, CURVE.endo ? Math.ceil(_bits / 2) : _bits);\n    // Validate if generator point is on curve\n    return {\n        CURVE,\n        ProjectivePoint: Point,\n        normPrivateKeyToScalar,\n        weierstrassEquation,\n        isWithinCurveOrder,\n    };\n}\nfunction validateOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        hash: 'hash',\n        hmac: 'function',\n        randomBytes: 'function',\n    }, {\n        bits2int: 'function',\n        bits2int_modN: 'function',\n        lowS: 'boolean',\n    });\n    return Object.freeze({ lowS: true, ...opts });\n}\nexport function weierstrass(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { Fp, n: CURVE_ORDER } = CURVE;\n    const compressedLen = Fp.BYTES + 1; // e.g. 33 for 32\n    const uncompressedLen = 2 * Fp.BYTES + 1; // e.g. 65 for 32\n    function isValidFieldElement(num) {\n        return _0n < num && num < Fp.ORDER; // 0 is banned since it's not invertible FE\n    }\n    function modN(a) {\n        return mod.mod(a, CURVE_ORDER);\n    }\n    function invN(a) {\n        return mod.invert(a, CURVE_ORDER);\n    }\n    const { ProjectivePoint: Point, normPrivateKeyToScalar, weierstrassEquation, isWithinCurveOrder, } = weierstrassPoints({\n        ...CURVE,\n        toBytes(c, point, isCompressed) {\n            const a = point.toAffine();\n            const x = Fp.toBytes(a.x);\n            const cat = ut.concatBytes;\n            if (isCompressed) {\n                return cat(Uint8Array.from([point.hasEvenY() ? 0x02 : 0x03]), x);\n            }\n            else {\n                return cat(Uint8Array.from([0x04]), x, Fp.toBytes(a.y));\n            }\n        },\n        fromBytes(bytes) {\n            const len = bytes.length;\n            const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // this.assertValidity() is done inside of fromHex\n            if (len === compressedLen && (head === 0x02 || head === 0x03)) {\n                const x = ut.bytesToNumberBE(tail);\n                if (!isValidFieldElement(x))\n                    throw new Error('Point is not on curve');\n                const y2 = weierstrassEquation(x); // y² = x³ + ax + b\n                let y = Fp.sqrt(y2); // y = y² ^ (p+1)/4\n                const isYOdd = (y & _1n) === _1n;\n                // ECDSA\n                const isHeadOdd = (head & 1) === 1;\n                if (isHeadOdd !== isYOdd)\n                    y = Fp.neg(y);\n                return { x, y };\n            }\n            else if (len === uncompressedLen && head === 0x04) {\n                const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n                const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n                return { x, y };\n            }\n            else {\n                throw new Error(`Point of length ${len} was invalid. Expected ${compressedLen} compressed bytes or ${uncompressedLen} uncompressed bytes`);\n            }\n        },\n    });\n    const numToNByteStr = (num) => ut.bytesToHex(ut.numberToBytesBE(num, CURVE.nByteLength));\n    function isBiggerThanHalfOrder(number) {\n        const HALF = CURVE_ORDER >> _1n;\n        return number > HALF;\n    }\n    function normalizeS(s) {\n        return isBiggerThanHalfOrder(s) ? modN(-s) : s;\n    }\n    // slice bytes num\n    const slcNum = (b, from, to) => ut.bytesToNumberBE(b.slice(from, to));\n    /**\n     * ECDSA signature with its (r, s) properties. Supports DER & compact representations.\n     */\n    class Signature {\n        constructor(r, s, recovery) {\n            this.r = r;\n            this.s = s;\n            this.recovery = recovery;\n            this.assertValidity();\n        }\n        // pair (bytes of r, bytes of s)\n        static fromCompact(hex) {\n            const l = CURVE.nByteLength;\n            hex = ensureBytes('compactSignature', hex, l * 2);\n            return new Signature(slcNum(hex, 0, l), slcNum(hex, l, 2 * l));\n        }\n        // DER encoded ECDSA signature\n        // https://bitcoin.stackexchange.com/questions/57644/what-are-the-parts-of-a-bitcoin-transaction-input-script\n        static fromDER(hex) {\n            const { r, s } = DER.toSig(ensureBytes('DER', hex));\n            return new Signature(r, s);\n        }\n        assertValidity() {\n            // can use assertGE here\n            if (!isWithinCurveOrder(this.r))\n                throw new Error('r must be 0 < r < CURVE.n');\n            if (!isWithinCurveOrder(this.s))\n                throw new Error('s must be 0 < s < CURVE.n');\n        }\n        addRecoveryBit(recovery) {\n            return new Signature(this.r, this.s, recovery);\n        }\n        recoverPublicKey(msgHash) {\n            const { r, s, recovery: rec } = this;\n            const h = bits2int_modN(ensureBytes('msgHash', msgHash)); // Truncate hash\n            if (rec == null || ![0, 1, 2, 3].includes(rec))\n                throw new Error('recovery id invalid');\n            const radj = rec === 2 || rec === 3 ? r + CURVE.n : r;\n            if (radj >= Fp.ORDER)\n                throw new Error('recovery id 2 or 3 invalid');\n            const prefix = (rec & 1) === 0 ? '02' : '03';\n            const R = Point.fromHex(prefix + numToNByteStr(radj));\n            const ir = invN(radj); // r^-1\n            const u1 = modN(-h * ir); // -hr^-1\n            const u2 = modN(s * ir); // sr^-1\n            const Q = Point.BASE.multiplyAndAddUnsafe(R, u1, u2); // (sr^-1)R-(hr^-1)G = -(hr^-1)G + (sr^-1)\n            if (!Q)\n                throw new Error('point at infinify'); // unsafe is fine: no priv data leaked\n            Q.assertValidity();\n            return Q;\n        }\n        // Signatures should be low-s, to prevent malleability.\n        hasHighS() {\n            return isBiggerThanHalfOrder(this.s);\n        }\n        normalizeS() {\n            return this.hasHighS() ? new Signature(this.r, modN(-this.s), this.recovery) : this;\n        }\n        // DER-encoded\n        toDERRawBytes() {\n            return ut.hexToBytes(this.toDERHex());\n        }\n        toDERHex() {\n            return DER.hexFromSig({ r: this.r, s: this.s });\n        }\n        // padded bytes of r, then padded bytes of s\n        toCompactRawBytes() {\n            return ut.hexToBytes(this.toCompactHex());\n        }\n        toCompactHex() {\n            return numToNByteStr(this.r) + numToNByteStr(this.s);\n        }\n    }\n    const utils = {\n        isValidPrivateKey(privateKey) {\n            try {\n                normPrivateKeyToScalar(privateKey);\n                return true;\n            }\n            catch (error) {\n                return false;\n            }\n        },\n        normPrivateKeyToScalar: normPrivateKeyToScalar,\n        /**\n         * Produces cryptographically secure private key from random of size (nBitLength+64)\n         * as per FIPS 186 B.4.1 with modulo bias being neglible.\n         */\n        randomPrivateKey: () => {\n            const rand = CURVE.randomBytes(Fp.BYTES + 8);\n            const num = mod.hashToPrivateScalar(rand, CURVE_ORDER);\n            return ut.numberToBytesBE(num, CURVE.nByteLength);\n        },\n        /**\n         * Creates precompute table for an arbitrary EC point. Makes point \"cached\".\n         * Allows to massively speed-up `point.multiply(scalar)`.\n         * @returns cached point\n         * @example\n         * const fast = utils.precompute(8, ProjectivePoint.fromHex(someonesPubKey));\n         * fast.multiply(privKey); // much faster ECDH now\n         */\n        precompute(windowSize = 8, point = Point.BASE) {\n            point._setWindowSize(windowSize);\n            point.multiply(BigInt(3)); // 3 is arbitrary, just need any number here\n            return point;\n        },\n    };\n    /**\n     * Computes public key for a private key. Checks for validity of the private key.\n     * @param privateKey private key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns Public key, full when isCompressed=false; short when isCompressed=true\n     */\n    function getPublicKey(privateKey, isCompressed = true) {\n        return Point.fromPrivateKey(privateKey).toRawBytes(isCompressed);\n    }\n    /**\n     * Quick and dirty check for item being public key. Does not validate hex, or being on-curve.\n     */\n    function isProbPub(item) {\n        const arr = item instanceof Uint8Array;\n        const str = typeof item === 'string';\n        const len = (arr || str) && item.length;\n        if (arr)\n            return len === compressedLen || len === uncompressedLen;\n        if (str)\n            return len === 2 * compressedLen || len === 2 * uncompressedLen;\n        if (item instanceof Point)\n            return true;\n        return false;\n    }\n    /**\n     * ECDH (Elliptic Curve Diffie Hellman).\n     * Computes shared public key from private key and public key.\n     * Checks: 1) private key validity 2) shared key is on-curve.\n     * Does NOT hash the result.\n     * @param privateA private key\n     * @param publicB different public key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns shared public key\n     */\n    function getSharedSecret(privateA, publicB, isCompressed = true) {\n        if (isProbPub(privateA))\n            throw new Error('first arg must be private key');\n        if (!isProbPub(publicB))\n            throw new Error('second arg must be public key');\n        const b = Point.fromHex(publicB); // check for being on-curve\n        return b.multiply(normPrivateKeyToScalar(privateA)).toRawBytes(isCompressed);\n    }\n    // RFC6979: ensure ECDSA msg is X bytes and < N. RFC suggests optional truncating via bits2octets.\n    // FIPS 186-4 4.6 suggests the leftmost min(nBitLen, outLen) bits, which matches bits2int.\n    // bits2int can produce res>N, we can do mod(res, N) since the bitLen is the same.\n    // int2octets can't be used; pads small msgs with 0: unacceptatble for trunc as per RFC vectors\n    const bits2int = CURVE.bits2int ||\n        function (bytes) {\n            // For curves with nBitLength % 8 !== 0: bits2octets(bits2octets(m)) !== bits2octets(m)\n            // for some cases, since bytes.length * 8 is not actual bitLength.\n            const num = ut.bytesToNumberBE(bytes); // check for == u8 done here\n            const delta = bytes.length * 8 - CURVE.nBitLength; // truncate to nBitLength leftmost bits\n            return delta > 0 ? num >> BigInt(delta) : num;\n        };\n    const bits2int_modN = CURVE.bits2int_modN ||\n        function (bytes) {\n            return modN(bits2int(bytes)); // can't use bytesToNumberBE here\n        };\n    // NOTE: pads output with zero as per spec\n    const ORDER_MASK = ut.bitMask(CURVE.nBitLength);\n    /**\n     * Converts to bytes. Checks if num in `[0..ORDER_MASK-1]` e.g.: `[0..2^256-1]`.\n     */\n    function int2octets(num) {\n        if (typeof num !== 'bigint')\n            throw new Error('bigint expected');\n        if (!(_0n <= num && num < ORDER_MASK))\n            throw new Error(`bigint expected < 2^${CURVE.nBitLength}`);\n        // works with order, can have different size than numToField!\n        return ut.numberToBytesBE(num, CURVE.nByteLength);\n    }\n    // Steps A, D of RFC6979 3.2\n    // Creates RFC6979 seed; converts msg/privKey to numbers.\n    // Used only in sign, not in verify.\n    // NOTE: we cannot assume here that msgHash has same amount of bytes as curve order, this will be wrong at least for P521.\n    // Also it can be bigger for P224 + SHA256\n    function prepSig(msgHash, privateKey, opts = defaultSigOpts) {\n        if (['recovered', 'canonical'].some((k) => k in opts))\n            throw new Error('sign() legacy options not supported');\n        const { hash, randomBytes } = CURVE;\n        let { lowS, prehash, extraEntropy: ent } = opts; // generates low-s sigs by default\n        if (lowS == null)\n            lowS = true; // RFC6979 3.2: we skip step A, because we already provide hash\n        msgHash = ensureBytes('msgHash', msgHash);\n        if (prehash)\n            msgHash = ensureBytes('prehashed msgHash', hash(msgHash));\n        // We can't later call bits2octets, since nested bits2int is broken for curves\n        // with nBitLength % 8 !== 0. Because of that, we unwrap it here as int2octets call.\n        // const bits2octets = (bits) => int2octets(bits2int_modN(bits))\n        const h1int = bits2int_modN(msgHash);\n        const d = normPrivateKeyToScalar(privateKey); // validate private key, convert to bigint\n        const seedArgs = [int2octets(d), int2octets(h1int)];\n        // extraEntropy. RFC6979 3.6: additional k' (optional).\n        if (ent != null) {\n            // K = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || k')\n            const e = ent === true ? randomBytes(Fp.BYTES) : ent; // generate random bytes OR pass as-is\n            seedArgs.push(ensureBytes('extraEntropy', e, Fp.BYTES)); // check for being of size BYTES\n        }\n        const seed = ut.concatBytes(...seedArgs); // Step D of RFC6979 3.2\n        const m = h1int; // NOTE: no need to call bits2int second time here, it is inside truncateHash!\n        // Converts signature params into point w r/s, checks result for validity.\n        function k2sig(kBytes) {\n            // RFC 6979 Section 3.2, step 3: k = bits2int(T)\n            const k = bits2int(kBytes); // Cannot use fields methods, since it is group element\n            if (!isWithinCurveOrder(k))\n                return; // Important: all mod() calls here must be done over N\n            const ik = invN(k); // k^-1 mod n\n            const q = Point.BASE.multiply(k).toAffine(); // q = Gk\n            const r = modN(q.x); // r = q.x mod n\n            if (r === _0n)\n                return;\n            // Can use scalar blinding b^-1(bm + bdr) where b ∈ [1,q−1] according to\n            // https://tches.iacr.org/index.php/TCHES/article/view/7337/6509. We've decided against it:\n            // a) dependency on CSPRNG b) 15% slowdown c) doesn't really help since bigints are not CT\n            const s = modN(ik * modN(m + r * d)); // Not using blinding here\n            if (s === _0n)\n                return;\n            let recovery = (q.x === r ? 0 : 2) | Number(q.y & _1n); // recovery bit (2 or 3, when q.x > n)\n            let normS = s;\n            if (lowS && isBiggerThanHalfOrder(s)) {\n                normS = normalizeS(s); // if lowS was passed, ensure s is always\n                recovery ^= 1; // // in the bottom half of N\n            }\n            return new Signature(r, normS, recovery); // use normS, not s\n        }\n        return { seed, k2sig };\n    }\n    const defaultSigOpts = { lowS: CURVE.lowS, prehash: false };\n    const defaultVerOpts = { lowS: CURVE.lowS, prehash: false };\n    /**\n     * Signs message hash with a private key.\n     * ```\n     * sign(m, d, k) where\n     *   (x, y) = G × k\n     *   r = x mod n\n     *   s = (m + dr)/k mod n\n     * ```\n     * @param msgHash NOT message. msg needs to be hashed to `msgHash`, or use `prehash`.\n     * @param privKey private key\n     * @param opts lowS for non-malleable sigs. extraEntropy for mixing randomness into k. prehash will hash first arg.\n     * @returns signature with recovery param\n     */\n    function sign(msgHash, privKey, opts = defaultSigOpts) {\n        const { seed, k2sig } = prepSig(msgHash, privKey, opts); // Steps A, D of RFC6979 3.2.\n        const C = CURVE;\n        const drbg = ut.createHmacDrbg(C.hash.outputLen, C.nByteLength, C.hmac);\n        return drbg(seed, k2sig); // Steps B, C, D, E, F, G\n    }\n    // Enable precomputes. Slows down first publicKey computation by 20ms.\n    Point.BASE._setWindowSize(8);\n    // utils.precompute(8, ProjectivePoint.BASE)\n    /**\n     * Verifies a signature against message hash and public key.\n     * Rejects lowS signatures by default: to override,\n     * specify option `{lowS: false}`. Implements section 4.1.4 from https://www.secg.org/sec1-v2.pdf:\n     *\n     * ```\n     * verify(r, s, h, P) where\n     *   U1 = hs^-1 mod n\n     *   U2 = rs^-1 mod n\n     *   R = U1⋅G - U2⋅P\n     *   mod(R.x, n) == r\n     * ```\n     */\n    function verify(signature, msgHash, publicKey, opts = defaultVerOpts) {\n        const sg = signature;\n        msgHash = ensureBytes('msgHash', msgHash);\n        publicKey = ensureBytes('publicKey', publicKey);\n        if ('strict' in opts)\n            throw new Error('options.strict was renamed to lowS');\n        const { lowS, prehash } = opts;\n        let _sig = undefined;\n        let P;\n        try {\n            if (typeof sg === 'string' || sg instanceof Uint8Array) {\n                // Signature can be represented in 2 ways: compact (2*nByteLength) & DER (variable-length).\n                // Since DER can also be 2*nByteLength bytes, we check for it first.\n                try {\n                    _sig = Signature.fromDER(sg);\n                }\n                catch (derError) {\n                    if (!(derError instanceof DER.Err))\n                        throw derError;\n                    _sig = Signature.fromCompact(sg);\n                }\n            }\n            else if (typeof sg === 'object' && typeof sg.r === 'bigint' && typeof sg.s === 'bigint') {\n                const { r, s } = sg;\n                _sig = new Signature(r, s);\n            }\n            else {\n                throw new Error('PARSE');\n            }\n            P = Point.fromHex(publicKey);\n        }\n        catch (error) {\n            if (error.message === 'PARSE')\n                throw new Error(`signature must be Signature instance, Uint8Array or hex string`);\n            return false;\n        }\n        if (lowS && _sig.hasHighS())\n            return false;\n        if (prehash)\n            msgHash = CURVE.hash(msgHash);\n        const { r, s } = _sig;\n        const h = bits2int_modN(msgHash); // Cannot use fields methods, since it is group element\n        const is = invN(s); // s^-1\n        const u1 = modN(h * is); // u1 = hs^-1 mod n\n        const u2 = modN(r * is); // u2 = rs^-1 mod n\n        const R = Point.BASE.multiplyAndAddUnsafe(P, u1, u2)?.toAffine(); // R = u1⋅G + u2⋅P\n        if (!R)\n            return false;\n        const v = modN(R.x);\n        return v === r;\n    }\n    return {\n        CURVE,\n        getPublicKey,\n        getSharedSecret,\n        sign,\n        verify,\n        ProjectivePoint: Point,\n        Signature,\n        utils,\n    };\n}\n/**\n * Implementation of the Shallue and van de Woestijne method for any weierstrass curve.\n * TODO: check if there is a way to merge this with uvRatio in Edwards; move to modular.\n * b = True and y = sqrt(u / v) if (u / v) is square in F, and\n * b = False and y = sqrt(Z * (u / v)) otherwise.\n * @param Fp\n * @param Z\n * @returns\n */\nexport function SWUFpSqrtRatio(Fp, Z) {\n    // Generic implementation\n    const q = Fp.ORDER;\n    let l = _0n;\n    for (let o = q - _1n; o % _2n === _0n; o /= _2n)\n        l += _1n;\n    const c1 = l; // 1. c1, the largest integer such that 2^c1 divides q - 1.\n    // We need 2n ** c1 and 2n ** (c1-1). We can't use **; but we can use <<.\n    // 2n ** c1 == 2n << (c1-1)\n    const _2n_pow_c1_1 = _2n << (c1 - _1n - _1n);\n    const _2n_pow_c1 = _2n_pow_c1_1 * _2n;\n    const c2 = (q - _1n) / _2n_pow_c1; // 2. c2 = (q - 1) / (2^c1)  # Integer arithmetic\n    const c3 = (c2 - _1n) / _2n; // 3. c3 = (c2 - 1) / 2            # Integer arithmetic\n    const c4 = _2n_pow_c1 - _1n; // 4. c4 = 2^c1 - 1                # Integer arithmetic\n    const c5 = _2n_pow_c1_1; // 5. c5 = 2^(c1 - 1)                  # Integer arithmetic\n    const c6 = Fp.pow(Z, c2); // 6. c6 = Z^c2\n    const c7 = Fp.pow(Z, (c2 + _1n) / _2n); // 7. c7 = Z^((c2 + 1) / 2)\n    let sqrtRatio = (u, v) => {\n        let tv1 = c6; // 1. tv1 = c6\n        let tv2 = Fp.pow(v, c4); // 2. tv2 = v^c4\n        let tv3 = Fp.sqr(tv2); // 3. tv3 = tv2^2\n        tv3 = Fp.mul(tv3, v); // 4. tv3 = tv3 * v\n        let tv5 = Fp.mul(u, tv3); // 5. tv5 = u * tv3\n        tv5 = Fp.pow(tv5, c3); // 6. tv5 = tv5^c3\n        tv5 = Fp.mul(tv5, tv2); // 7. tv5 = tv5 * tv2\n        tv2 = Fp.mul(tv5, v); // 8. tv2 = tv5 * v\n        tv3 = Fp.mul(tv5, u); // 9. tv3 = tv5 * u\n        let tv4 = Fp.mul(tv3, tv2); // 10. tv4 = tv3 * tv2\n        tv5 = Fp.pow(tv4, c5); // 11. tv5 = tv4^c5\n        let isQR = Fp.eql(tv5, Fp.ONE); // 12. isQR = tv5 == 1\n        tv2 = Fp.mul(tv3, c7); // 13. tv2 = tv3 * c7\n        tv5 = Fp.mul(tv4, tv1); // 14. tv5 = tv4 * tv1\n        tv3 = Fp.cmov(tv2, tv3, isQR); // 15. tv3 = CMOV(tv2, tv3, isQR)\n        tv4 = Fp.cmov(tv5, tv4, isQR); // 16. tv4 = CMOV(tv5, tv4, isQR)\n        // 17. for i in (c1, c1 - 1, ..., 2):\n        for (let i = c1; i > _1n; i--) {\n            let tv5 = i - _2n; // 18.    tv5 = i - 2\n            tv5 = _2n << (tv5 - _1n); // 19.    tv5 = 2^tv5\n            let tvv5 = Fp.pow(tv4, tv5); // 20.    tv5 = tv4^tv5\n            const e1 = Fp.eql(tvv5, Fp.ONE); // 21.    e1 = tv5 == 1\n            tv2 = Fp.mul(tv3, tv1); // 22.    tv2 = tv3 * tv1\n            tv1 = Fp.mul(tv1, tv1); // 23.    tv1 = tv1 * tv1\n            tvv5 = Fp.mul(tv4, tv1); // 24.    tv5 = tv4 * tv1\n            tv3 = Fp.cmov(tv2, tv3, e1); // 25.    tv3 = CMOV(tv2, tv3, e1)\n            tv4 = Fp.cmov(tvv5, tv4, e1); // 26.    tv4 = CMOV(tv5, tv4, e1)\n        }\n        return { isValid: isQR, value: tv3 };\n    };\n    if (Fp.ORDER % _4n === _3n) {\n        // sqrt_ratio_3mod4(u, v)\n        const c1 = (Fp.ORDER - _3n) / _4n; // 1. c1 = (q - 3) / 4     # Integer arithmetic\n        const c2 = Fp.sqrt(Fp.neg(Z)); // 2. c2 = sqrt(-Z)\n        sqrtRatio = (u, v) => {\n            let tv1 = Fp.sqr(v); // 1. tv1 = v^2\n            const tv2 = Fp.mul(u, v); // 2. tv2 = u * v\n            tv1 = Fp.mul(tv1, tv2); // 3. tv1 = tv1 * tv2\n            let y1 = Fp.pow(tv1, c1); // 4. y1 = tv1^c1\n            y1 = Fp.mul(y1, tv2); // 5. y1 = y1 * tv2\n            const y2 = Fp.mul(y1, c2); // 6. y2 = y1 * c2\n            const tv3 = Fp.mul(Fp.sqr(y1), v); // 7. tv3 = y1^2; 8. tv3 = tv3 * v\n            const isQR = Fp.eql(tv3, u); // 9. isQR = tv3 == u\n            let y = Fp.cmov(y2, y1, isQR); // 10. y = CMOV(y2, y1, isQR)\n            return { isValid: isQR, value: y }; // 11. return (isQR, y) isQR ? y : y*c2\n        };\n    }\n    // No curves uses that\n    // if (Fp.ORDER % _8n === _5n) // sqrt_ratio_5mod8\n    return sqrtRatio;\n}\n/**\n * From draft-irtf-cfrg-hash-to-curve-16\n */\nexport function mapToCurveSimpleSWU(Fp, opts) {\n    mod.validateField(Fp);\n    if (!Fp.isValid(opts.A) || !Fp.isValid(opts.B) || !Fp.isValid(opts.Z))\n        throw new Error('mapToCurveSimpleSWU: invalid opts');\n    const sqrtRatio = SWUFpSqrtRatio(Fp, opts.Z);\n    if (!Fp.isOdd)\n        throw new Error('Fp.isOdd is not implemented!');\n    // Input: u, an element of F.\n    // Output: (x, y), a point on E.\n    return (u) => {\n        // prettier-ignore\n        let tv1, tv2, tv3, tv4, tv5, tv6, x, y;\n        tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n        tv1 = Fp.mul(tv1, opts.Z); // 2.  tv1 = Z * tv1\n        tv2 = Fp.sqr(tv1); // 3.  tv2 = tv1^2\n        tv2 = Fp.add(tv2, tv1); // 4.  tv2 = tv2 + tv1\n        tv3 = Fp.add(tv2, Fp.ONE); // 5.  tv3 = tv2 + 1\n        tv3 = Fp.mul(tv3, opts.B); // 6.  tv3 = B * tv3\n        tv4 = Fp.cmov(opts.Z, Fp.neg(tv2), !Fp.eql(tv2, Fp.ZERO)); // 7.  tv4 = CMOV(Z, -tv2, tv2 != 0)\n        tv4 = Fp.mul(tv4, opts.A); // 8.  tv4 = A * tv4\n        tv2 = Fp.sqr(tv3); // 9.  tv2 = tv3^2\n        tv6 = Fp.sqr(tv4); // 10. tv6 = tv4^2\n        tv5 = Fp.mul(tv6, opts.A); // 11. tv5 = A * tv6\n        tv2 = Fp.add(tv2, tv5); // 12. tv2 = tv2 + tv5\n        tv2 = Fp.mul(tv2, tv3); // 13. tv2 = tv2 * tv3\n        tv6 = Fp.mul(tv6, tv4); // 14. tv6 = tv6 * tv4\n        tv5 = Fp.mul(tv6, opts.B); // 15. tv5 = B * tv6\n        tv2 = Fp.add(tv2, tv5); // 16. tv2 = tv2 + tv5\n        x = Fp.mul(tv1, tv3); // 17.   x = tv1 * tv3\n        const { isValid, value } = sqrtRatio(tv2, tv6); // 18. (is_gx1_square, y1) = sqrt_ratio(tv2, tv6)\n        y = Fp.mul(tv1, u); // 19.   y = tv1 * u  -> Z * u^3 * y1\n        y = Fp.mul(y, value); // 20.   y = y * y1\n        x = Fp.cmov(x, tv3, isValid); // 21.   x = CMOV(x, tv3, is_gx1_square)\n        y = Fp.cmov(y, value, isValid); // 22.   y = CMOV(y, y1, is_gx1_square)\n        const e1 = Fp.isOdd(u) === Fp.isOdd(y); // 23.  e1 = sgn0(u) == sgn0(y)\n        y = Fp.cmov(Fp.neg(y), y, e1); // 24.   y = CMOV(-y, y, e1)\n        x = Fp.div(x, tv4); // 25.   x = x / tv4\n        return { x, y };\n    };\n}\n//# sourceMappingURL=weierstrass.js.map","import assert from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assert.hash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assert.exists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.bytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { hmac } from '@noble/hashes/hmac';\nimport { concatBytes, randomBytes } from '@noble/hashes/utils';\nimport { weierstrass } from './abstract/weierstrass.js';\n// connects noble-curves to noble-hashes\nexport function getHash(hash) {\n    return {\n        hash,\n        hmac: (key, ...msgs) => hmac(hash, key, concatBytes(...msgs)),\n        randomBytes,\n    };\n}\nexport function createCurve(curveDef, defHash) {\n    const create = (hash) => weierstrass({ ...curveDef, ...getHash(hash) });\n    return Object.freeze({ ...create(defHash), create });\n}\n//# sourceMappingURL=_shortw_utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha256 } from '@noble/hashes/sha256';\nimport { randomBytes } from '@noble/hashes/utils';\nimport { Field, mod, pow2 } from './abstract/modular.js';\nimport { mapToCurveSimpleSWU } from './abstract/weierstrass.js';\nimport { bytesToNumberBE, concatBytes, ensureBytes, numberToBytesBE } from './abstract/utils.js';\nimport { createHasher, isogenyMap } from './abstract/hash-to-curve.js';\nimport { createCurve } from './_shortw_utils.js';\nconst secp256k1P = BigInt('0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f');\nconst secp256k1N = BigInt('0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141');\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst divNearest = (a, b) => (a + b / _2n) / b;\n/**\n * √n = n^((p+1)/4) for fields p = 3 mod 4. We unwrap the loop and multiply bit-by-bit.\n * (P+1n/4n).toString(2) would produce bits [223x 1, 0, 22x 1, 4x 0, 11, 00]\n */\nfunction sqrtMod(y) {\n    const P = secp256k1P;\n    // prettier-ignore\n    const _3n = BigInt(3), _6n = BigInt(6), _11n = BigInt(11), _22n = BigInt(22);\n    // prettier-ignore\n    const _23n = BigInt(23), _44n = BigInt(44), _88n = BigInt(88);\n    const b2 = (y * y * y) % P; // x^3, 11\n    const b3 = (b2 * b2 * y) % P; // x^7\n    const b6 = (pow2(b3, _3n, P) * b3) % P;\n    const b9 = (pow2(b6, _3n, P) * b3) % P;\n    const b11 = (pow2(b9, _2n, P) * b2) % P;\n    const b22 = (pow2(b11, _11n, P) * b11) % P;\n    const b44 = (pow2(b22, _22n, P) * b22) % P;\n    const b88 = (pow2(b44, _44n, P) * b44) % P;\n    const b176 = (pow2(b88, _88n, P) * b88) % P;\n    const b220 = (pow2(b176, _44n, P) * b44) % P;\n    const b223 = (pow2(b220, _3n, P) * b3) % P;\n    const t1 = (pow2(b223, _23n, P) * b22) % P;\n    const t2 = (pow2(t1, _6n, P) * b2) % P;\n    const root = pow2(t2, _2n, P);\n    if (!Fp.eql(Fp.sqr(root), y))\n        throw new Error('Cannot find square root');\n    return root;\n}\nconst Fp = Field(secp256k1P, undefined, undefined, { sqrt: sqrtMod });\nexport const secp256k1 = createCurve({\n    a: BigInt(0),\n    b: BigInt(7),\n    Fp,\n    n: secp256k1N,\n    // Base point (x, y) aka generator point\n    Gx: BigInt('55066263022277343669578718895168534326250603453777594175500187360389116729240'),\n    Gy: BigInt('32670510020758816978083085130507043184471273380659243275938904335757337482424'),\n    h: BigInt(1),\n    lowS: true,\n    /**\n     * secp256k1 belongs to Koblitz curves: it has efficiently computable endomorphism.\n     * Endomorphism uses 2x less RAM, speeds up precomputation by 2x and ECDH / key recovery by 20%.\n     * For precomputed wNAF it trades off 1/2 init time & 1/3 ram for 20% perf hit.\n     * Explanation: https://gist.github.com/paulmillr/eb670806793e84df628a7c434a873066\n     */\n    endo: {\n        beta: BigInt('0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee'),\n        splitScalar: (k) => {\n            const n = secp256k1N;\n            const a1 = BigInt('0x3086d221a7d46bcde86c90e49284eb15');\n            const b1 = -_1n * BigInt('0xe4437ed6010e88286f547fa90abfe4c3');\n            const a2 = BigInt('0x114ca50f7a8e2f3f657c1108d9d44cfd8');\n            const b2 = a1;\n            const POW_2_128 = BigInt('0x100000000000000000000000000000000'); // (2n**128n).toString(16)\n            const c1 = divNearest(b2 * k, n);\n            const c2 = divNearest(-b1 * k, n);\n            let k1 = mod(k - c1 * a1 - c2 * a2, n);\n            let k2 = mod(-c1 * b1 - c2 * b2, n);\n            const k1neg = k1 > POW_2_128;\n            const k2neg = k2 > POW_2_128;\n            if (k1neg)\n                k1 = n - k1;\n            if (k2neg)\n                k2 = n - k2;\n            if (k1 > POW_2_128 || k2 > POW_2_128) {\n                throw new Error('splitScalar: Endomorphism failed, k=' + k);\n            }\n            return { k1neg, k1, k2neg, k2 };\n        },\n    },\n}, sha256);\n// Schnorr signatures are superior to ECDSA from above. Below is Schnorr-specific BIP0340 code.\n// https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki\nconst _0n = BigInt(0);\nconst fe = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1P;\nconst ge = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1N;\n/** An object mapping tags to their tagged hash prefix of [SHA256(tag) | SHA256(tag)] */\nconst TAGGED_HASH_PREFIXES = {};\nfunction taggedHash(tag, ...messages) {\n    let tagP = TAGGED_HASH_PREFIXES[tag];\n    if (tagP === undefined) {\n        const tagH = sha256(Uint8Array.from(tag, (c) => c.charCodeAt(0)));\n        tagP = concatBytes(tagH, tagH);\n        TAGGED_HASH_PREFIXES[tag] = tagP;\n    }\n    return sha256(concatBytes(tagP, ...messages));\n}\n// ECDSA compact points are 33-byte. Schnorr is 32: we strip first byte 0x02 or 0x03\nconst pointToBytes = (point) => point.toRawBytes(true).slice(1);\nconst numTo32b = (n) => numberToBytesBE(n, 32);\nconst modP = (x) => mod(x, secp256k1P);\nconst modN = (x) => mod(x, secp256k1N);\nconst Point = secp256k1.ProjectivePoint;\nconst GmulAdd = (Q, a, b) => Point.BASE.multiplyAndAddUnsafe(Q, a, b);\n// Calculate point, scalar and bytes\nfunction schnorrGetExtPubKey(priv) {\n    let d_ = secp256k1.utils.normPrivateKeyToScalar(priv); // same method executed in fromPrivateKey\n    let p = Point.fromPrivateKey(d_); // P = d'⋅G; 0 < d' < n check is done inside\n    const scalar = p.hasEvenY() ? d_ : modN(-d_);\n    return { scalar: scalar, bytes: pointToBytes(p) };\n}\n/**\n * lift_x from BIP340. Convert 32-byte x coordinate to elliptic curve point.\n * @returns valid point checked for being on-curve\n */\nfunction lift_x(x) {\n    if (!fe(x))\n        throw new Error('bad x: need 0 < x < p'); // Fail if x ≥ p.\n    const xx = modP(x * x);\n    const c = modP(xx * x + BigInt(7)); // Let c = x³ + 7 mod p.\n    let y = sqrtMod(c); // Let y = c^(p+1)/4 mod p.\n    if (y % _2n !== _0n)\n        y = modP(-y); // Return the unique point P such that x(P) = x and\n    const p = new Point(x, y, _1n); // y(P) = y if y mod 2 = 0 or y(P) = p-y otherwise.\n    p.assertValidity();\n    return p;\n}\n/**\n * Create tagged hash, convert it to bigint, reduce modulo-n.\n */\nfunction challenge(...args) {\n    return modN(bytesToNumberBE(taggedHash('BIP0340/challenge', ...args)));\n}\n/**\n * Schnorr public key is just `x` coordinate of Point as per BIP340.\n */\nfunction schnorrGetPublicKey(privateKey) {\n    return schnorrGetExtPubKey(privateKey).bytes; // d'=int(sk). Fail if d'=0 or d'≥n. Ret bytes(d'⋅G)\n}\n/**\n * Creates Schnorr signature as per BIP340. Verifies itself before returning anything.\n * auxRand is optional and is not the sole source of k generation: bad CSPRNG won't be dangerous.\n */\nfunction schnorrSign(message, privateKey, auxRand = randomBytes(32)) {\n    const m = ensureBytes('message', message);\n    const { bytes: px, scalar: d } = schnorrGetExtPubKey(privateKey); // checks for isWithinCurveOrder\n    const a = ensureBytes('auxRand', auxRand, 32); // Auxiliary random data a: a 32-byte array\n    const t = numTo32b(d ^ bytesToNumberBE(taggedHash('BIP0340/aux', a))); // Let t be the byte-wise xor of bytes(d) and hash/aux(a)\n    const rand = taggedHash('BIP0340/nonce', t, px, m); // Let rand = hash/nonce(t || bytes(P) || m)\n    const k_ = modN(bytesToNumberBE(rand)); // Let k' = int(rand) mod n\n    if (k_ === _0n)\n        throw new Error('sign failed: k is zero'); // Fail if k' = 0.\n    const { bytes: rx, scalar: k } = schnorrGetExtPubKey(k_); // Let R = k'⋅G.\n    const e = challenge(rx, px, m); // Let e = int(hash/challenge(bytes(R) || bytes(P) || m)) mod n.\n    const sig = new Uint8Array(64); // Let sig = bytes(R) || bytes((k + ed) mod n).\n    sig.set(rx, 0);\n    sig.set(numTo32b(modN(k + e * d)), 32);\n    // If Verify(bytes(P), m, sig) (see below) returns failure, abort\n    if (!schnorrVerify(sig, m, px))\n        throw new Error('sign: Invalid signature produced');\n    return sig;\n}\n/**\n * Verifies Schnorr signature.\n * Will swallow errors & return false except for initial type validation of arguments.\n */\nfunction schnorrVerify(signature, message, publicKey) {\n    const sig = ensureBytes('signature', signature, 64);\n    const m = ensureBytes('message', message);\n    const pub = ensureBytes('publicKey', publicKey, 32);\n    try {\n        const P = lift_x(bytesToNumberBE(pub)); // P = lift_x(int(pk)); fail if that fails\n        const r = bytesToNumberBE(sig.subarray(0, 32)); // Let r = int(sig[0:32]); fail if r ≥ p.\n        if (!fe(r))\n            return false;\n        const s = bytesToNumberBE(sig.subarray(32, 64)); // Let s = int(sig[32:64]); fail if s ≥ n.\n        if (!ge(s))\n            return false;\n        const e = challenge(numTo32b(r), pointToBytes(P), m); // int(challenge(bytes(r)||bytes(P)||m))%n\n        const R = GmulAdd(P, s, modN(-e)); // R = s⋅G - e⋅P\n        if (!R || !R.hasEvenY() || R.toAffine().x !== r)\n            return false; // -eP == (n-e)P\n        return true; // Fail if is_infinite(R) / not has_even_y(R) / x(R) ≠ r.\n    }\n    catch (error) {\n        return false;\n    }\n}\nexport const schnorr = /* @__PURE__ */ (() => ({\n    getPublicKey: schnorrGetPublicKey,\n    sign: schnorrSign,\n    verify: schnorrVerify,\n    utils: {\n        randomPrivateKey: secp256k1.utils.randomPrivateKey,\n        lift_x,\n        pointToBytes,\n        numberToBytesBE,\n        bytesToNumberBE,\n        taggedHash,\n        mod,\n    },\n}))();\nconst isoMap = /* @__PURE__ */ (() => isogenyMap(Fp, [\n    // xNum\n    [\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7',\n        '0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581',\n        '0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262',\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c',\n    ],\n    // xDen\n    [\n        '0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b',\n        '0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n    // yNum\n    [\n        '0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c',\n        '0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3',\n        '0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931',\n        '0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84',\n    ],\n    // yDen\n    [\n        '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b',\n        '0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573',\n        '0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n].map((i) => i.map((j) => BigInt(j)))))();\nconst mapSWU = /* @__PURE__ */ (() => mapToCurveSimpleSWU(Fp, {\n    A: BigInt('0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533'),\n    B: BigInt('1771'),\n    Z: Fp.create(BigInt('-11')),\n}))();\nconst htf = /* @__PURE__ */ (() => createHasher(secp256k1.ProjectivePoint, (scalars) => {\n    const { x, y } = mapSWU(Fp.create(scalars[0]));\n    return isoMap(x, y);\n}, {\n    DST: 'secp256k1_XMD:SHA-256_SSWU_RO_',\n    encodeDST: 'secp256k1_XMD:SHA-256_SSWU_NU_',\n    p: Fp.ORDER,\n    m: 1,\n    k: 128,\n    expand: 'xmd',\n    hash: sha256,\n}))();\nexport const hashToCurve = /* @__PURE__ */ (() => htf.hashToCurve)();\nexport const encodeToCurve = /* @__PURE__ */ (() => htf.encodeToCurve)();\n//# sourceMappingURL=secp256k1.js.map","import { hmac } from '@noble/hashes/hmac';\nimport { ripemd160 } from '@noble/hashes/ripemd160';\nimport { sha256 } from '@noble/hashes/sha256';\nimport { sha512 } from '@noble/hashes/sha512';\nimport { bytes as assertBytes } from '@noble/hashes/_assert';\nimport { bytesToHex, concatBytes, createView, hexToBytes, utf8ToBytes } from '@noble/hashes/utils';\nimport { secp256k1 as secp } from '@noble/curves/secp256k1';\nimport { mod } from '@noble/curves/abstract/modular';\nimport { base58check as base58checker } from '@scure/base';\nconst Point = secp.ProjectivePoint;\nconst base58check = base58checker(sha256);\nfunction bytesToNumber(bytes) {\n    return BigInt(`0x${bytesToHex(bytes)}`);\n}\nfunction numberToBytes(num) {\n    return hexToBytes(num.toString(16).padStart(64, '0'));\n}\nconst MASTER_SECRET = utf8ToBytes('Bitcoin seed');\nconst BITCOIN_VERSIONS = { private: 0x0488ade4, public: 0x0488b21e };\nexport const HARDENED_OFFSET = 0x80000000;\nconst hash160 = (data) => ripemd160(sha256(data));\nconst fromU32 = (data) => createView(data).getUint32(0, false);\nconst toU32 = (n) => {\n    if (!Number.isSafeInteger(n) || n < 0 || n > 2 ** 32 - 1) {\n        throw new Error(`Invalid number=${n}. Should be from 0 to 2 ** 32 - 1`);\n    }\n    const buf = new Uint8Array(4);\n    createView(buf).setUint32(0, n, false);\n    return buf;\n};\nexport class HDKey {\n    get fingerprint() {\n        if (!this.pubHash) {\n            throw new Error('No publicKey set!');\n        }\n        return fromU32(this.pubHash);\n    }\n    get identifier() {\n        return this.pubHash;\n    }\n    get pubKeyHash() {\n        return this.pubHash;\n    }\n    get privateKey() {\n        return this.privKeyBytes || null;\n    }\n    get publicKey() {\n        return this.pubKey || null;\n    }\n    get privateExtendedKey() {\n        const priv = this.privateKey;\n        if (!priv) {\n            throw new Error('No private key');\n        }\n        return base58check.encode(this.serialize(this.versions.private, concatBytes(new Uint8Array([0]), priv)));\n    }\n    get publicExtendedKey() {\n        if (!this.pubKey) {\n            throw new Error('No public key');\n        }\n        return base58check.encode(this.serialize(this.versions.public, this.pubKey));\n    }\n    static fromMasterSeed(seed, versions = BITCOIN_VERSIONS) {\n        assertBytes(seed);\n        if (8 * seed.length < 128 || 8 * seed.length > 512) {\n            throw new Error(`HDKey: wrong seed length=${seed.length}. Should be between 128 and 512 bits; 256 bits is advised)`);\n        }\n        const I = hmac(sha512, MASTER_SECRET, seed);\n        return new HDKey({\n            versions,\n            chainCode: I.slice(32),\n            privateKey: I.slice(0, 32),\n        });\n    }\n    static fromExtendedKey(base58key, versions = BITCOIN_VERSIONS) {\n        const keyBuffer = base58check.decode(base58key);\n        const keyView = createView(keyBuffer);\n        const version = keyView.getUint32(0, false);\n        const opt = {\n            versions,\n            depth: keyBuffer[4],\n            parentFingerprint: keyView.getUint32(5, false),\n            index: keyView.getUint32(9, false),\n            chainCode: keyBuffer.slice(13, 45),\n        };\n        const key = keyBuffer.slice(45);\n        const isPriv = key[0] === 0;\n        if (version !== versions[isPriv ? 'private' : 'public']) {\n            throw new Error('Version mismatch');\n        }\n        if (isPriv) {\n            return new HDKey({ ...opt, privateKey: key.slice(1) });\n        }\n        else {\n            return new HDKey({ ...opt, publicKey: key });\n        }\n    }\n    static fromJSON(json) {\n        return HDKey.fromExtendedKey(json.xpriv);\n    }\n    constructor(opt) {\n        this.depth = 0;\n        this.index = 0;\n        this.chainCode = null;\n        this.parentFingerprint = 0;\n        if (!opt || typeof opt !== 'object') {\n            throw new Error('HDKey.constructor must not be called directly');\n        }\n        this.versions = opt.versions || BITCOIN_VERSIONS;\n        this.depth = opt.depth || 0;\n        this.chainCode = opt.chainCode;\n        this.index = opt.index || 0;\n        this.parentFingerprint = opt.parentFingerprint || 0;\n        if (!this.depth) {\n            if (this.parentFingerprint || this.index) {\n                throw new Error('HDKey: zero depth with non-zero index/parent fingerprint');\n            }\n        }\n        if (opt.publicKey && opt.privateKey) {\n            throw new Error('HDKey: publicKey and privateKey at same time.');\n        }\n        if (opt.privateKey) {\n            if (!secp.utils.isValidPrivateKey(opt.privateKey)) {\n                throw new Error('Invalid private key');\n            }\n            this.privKey =\n                typeof opt.privateKey === 'bigint' ? opt.privateKey : bytesToNumber(opt.privateKey);\n            this.privKeyBytes = numberToBytes(this.privKey);\n            this.pubKey = secp.getPublicKey(opt.privateKey, true);\n        }\n        else if (opt.publicKey) {\n            this.pubKey = Point.fromHex(opt.publicKey).toRawBytes(true);\n        }\n        else {\n            throw new Error('HDKey: no public or private key provided');\n        }\n        this.pubHash = hash160(this.pubKey);\n    }\n    derive(path) {\n        if (!/^[mM]'?/.test(path)) {\n            throw new Error('Path must start with \"m\" or \"M\"');\n        }\n        if (/^[mM]'?$/.test(path)) {\n            return this;\n        }\n        const parts = path.replace(/^[mM]'?\\//, '').split('/');\n        let child = this;\n        for (const c of parts) {\n            const m = /^(\\d+)('?)$/.exec(c);\n            if (!m || m.length !== 3) {\n                throw new Error(`Invalid child index: ${c}`);\n            }\n            let idx = +m[1];\n            if (!Number.isSafeInteger(idx) || idx >= HARDENED_OFFSET) {\n                throw new Error('Invalid index');\n            }\n            if (m[2] === \"'\") {\n                idx += HARDENED_OFFSET;\n            }\n            child = child.deriveChild(idx);\n        }\n        return child;\n    }\n    deriveChild(index) {\n        if (!this.pubKey || !this.chainCode) {\n            throw new Error('No publicKey or chainCode set');\n        }\n        let data = toU32(index);\n        if (index >= HARDENED_OFFSET) {\n            const priv = this.privateKey;\n            if (!priv) {\n                throw new Error('Could not derive hardened child key');\n            }\n            data = concatBytes(new Uint8Array([0]), priv, data);\n        }\n        else {\n            data = concatBytes(this.pubKey, data);\n        }\n        const I = hmac(sha512, this.chainCode, data);\n        const childTweak = bytesToNumber(I.slice(0, 32));\n        const chainCode = I.slice(32);\n        if (!secp.utils.isValidPrivateKey(childTweak)) {\n            throw new Error('Tweak bigger than curve order');\n        }\n        const opt = {\n            versions: this.versions,\n            chainCode,\n            depth: this.depth + 1,\n            parentFingerprint: this.fingerprint,\n            index,\n        };\n        try {\n            if (this.privateKey) {\n                const added = mod(this.privKey + childTweak, secp.CURVE.n);\n                if (!secp.utils.isValidPrivateKey(added)) {\n                    throw new Error('The tweak was out of range or the resulted private key is invalid');\n                }\n                opt.privateKey = added;\n            }\n            else {\n                const added = Point.fromHex(this.pubKey).add(Point.fromPrivateKey(childTweak));\n                if (added.equals(Point.ZERO)) {\n                    throw new Error('The tweak was equal to negative P, which made the result key invalid');\n                }\n                opt.publicKey = added.toRawBytes(true);\n            }\n            return new HDKey(opt);\n        }\n        catch (err) {\n            return this.deriveChild(index + 1);\n        }\n    }\n    sign(hash) {\n        if (!this.privateKey) {\n            throw new Error('No privateKey set!');\n        }\n        assertBytes(hash, 32);\n        return secp.sign(hash, this.privKey).toCompactRawBytes();\n    }\n    verify(hash, signature) {\n        assertBytes(hash, 32);\n        assertBytes(signature, 64);\n        if (!this.publicKey) {\n            throw new Error('No publicKey set!');\n        }\n        let sig;\n        try {\n            sig = secp.Signature.fromCompact(signature);\n        }\n        catch (error) {\n            return false;\n        }\n        return secp.verify(sig, hash, this.publicKey);\n    }\n    wipePrivateData() {\n        this.privKey = undefined;\n        if (this.privKeyBytes) {\n            this.privKeyBytes.fill(0);\n            this.privKeyBytes = undefined;\n        }\n        return this;\n    }\n    toJSON() {\n        return {\n            xpriv: this.privateExtendedKey,\n            xpub: this.publicExtendedKey,\n        };\n    }\n    serialize(version, key) {\n        if (!this.chainCode) {\n            throw new Error('No chainCode set');\n        }\n        assertBytes(key, 33);\n        return concatBytes(toU32(version), new Uint8Array([this.depth]), toU32(this.parentFingerprint), toU32(this.index), this.chainCode, key);\n    }\n}\n//# sourceMappingURL=index.js.map","/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */\nconst u8a = (a) => a instanceof Uint8Array;\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u16 = (arr) => new Uint16Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 2));\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// big-endian hardware is rare. Just in case someone still decides to run ciphers:\n// early-throw an error because we don't support BE yet.\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\nif (!isLE)\n    throw new Error('Non little-endian hardware is not supported');\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    if (!u8a(bytes))\n        throw new Error('Uint8Array expected');\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const len = hex.length;\n    if (len % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + len);\n    const array = new Uint8Array(len / 2);\n    for (let i = 0; i < array.length; i++) {\n        const j = i * 2;\n        const hexByte = hex.slice(j, j + 2);\n        const byte = Number.parseInt(hexByte, 16);\n        if (Number.isNaN(byte) || byte < 0)\n            throw new Error('Invalid byte sequence');\n        array[i] = byte;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\nexport function bytesToUtf8(bytes) {\n    return new TextDecoder().decode(bytes);\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    if (!u8a(data))\n        throw new Error(`expected Uint8Array, got ${typeof data}`);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    const r = new Uint8Array(arrays.reduce((sum, a) => sum + a.length, 0));\n    let pad = 0; // walk through each item, ensure they have proper type\n    arrays.forEach((a) => {\n        if (!u8a(a))\n            throw new Error('Uint8Array expected');\n        r.set(a, pad);\n        pad += a.length;\n    });\n    return r;\n}\n// Check if object doens't have custom constructor (like Uint8Array/Array)\nconst isPlainObject = (obj) => Object.prototype.toString.call(obj) === '[object Object]' && obj.constructor === Object;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && (typeof opts !== 'object' || !isPlainObject(opts)))\n        throw new Error('options must be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function ensureBytes(b, len) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Uint8Array expected');\n    if (typeof len === 'number')\n        if (b.length !== len)\n            throw new Error(`Uint8Array length ${len} expected`);\n}\n// Constant-time equality\nexport function equalBytes(a, b) {\n    // Should not happen\n    if (a.length !== b.length)\n        throw new Error('equalBytes: Different size of Uint8Arrays');\n    let isSame = true;\n    for (let i = 0; i < a.length; i++)\n        isSame && (isSame = a[i] === b[i]); // Lets hope JIT won't optimize away.\n    return isSame;\n}\n// For runtime check if class implements interface\nexport class Hash {\n}\n// Polyfill for Safari 14\nexport function setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n//# sourceMappingURL=utils.js.map","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`Wrong positive integer: ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`Expected boolean, not ${b}`);\n}\nfunction bytes(b, ...lengths) {\n    if (!(b instanceof Uint8Array))\n        throw new Error('Expected Uint8Array');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Expected Uint8Array of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(hash) {\n    if (typeof hash !== 'function' || typeof hash.create !== 'function')\n        throw new Error('hash must be wrapped by utils.wrapConstructor');\n    number(hash.outputLen);\n    number(hash.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","import { toBytes, ensureBytes } from './utils.js';\nimport assert from './_assert.js';\n// Poly1305 is a fast and parallel secret-key message-authentication code.\n// https://cr.yp.to/mac.html, https://cr.yp.to/mac/poly1305-20050329.pdf\n// https://datatracker.ietf.org/doc/html/rfc8439\n// Based on Public Domain poly1305-donna https://github.com/floodyberry/poly1305-donna\nconst u8to16 = (a, i) => (a[i++] & 0xff) | ((a[i++] & 0xff) << 8);\nclass Poly1305 {\n    constructor(key) {\n        this.blockLen = 16;\n        this.outputLen = 16;\n        this.buffer = new Uint8Array(16);\n        this.r = new Uint16Array(10);\n        this.h = new Uint16Array(10);\n        this.pad = new Uint16Array(8);\n        this.pos = 0;\n        this.finished = false;\n        key = toBytes(key);\n        ensureBytes(key, 32);\n        const t0 = u8to16(key, 0);\n        const t1 = u8to16(key, 2);\n        const t2 = u8to16(key, 4);\n        const t3 = u8to16(key, 6);\n        const t4 = u8to16(key, 8);\n        const t5 = u8to16(key, 10);\n        const t6 = u8to16(key, 12);\n        const t7 = u8to16(key, 14);\n        // https://github.com/floodyberry/poly1305-donna/blob/e6ad6e091d30d7f4ec2d4f978be1fcfcbce72781/poly1305-donna-16.h#L47\n        this.r[0] = t0 & 0x1fff;\n        this.r[1] = ((t0 >>> 13) | (t1 << 3)) & 0x1fff;\n        this.r[2] = ((t1 >>> 10) | (t2 << 6)) & 0x1f03;\n        this.r[3] = ((t2 >>> 7) | (t3 << 9)) & 0x1fff;\n        this.r[4] = ((t3 >>> 4) | (t4 << 12)) & 0x00ff;\n        this.r[5] = (t4 >>> 1) & 0x1ffe;\n        this.r[6] = ((t4 >>> 14) | (t5 << 2)) & 0x1fff;\n        this.r[7] = ((t5 >>> 11) | (t6 << 5)) & 0x1f81;\n        this.r[8] = ((t6 >>> 8) | (t7 << 8)) & 0x1fff;\n        this.r[9] = (t7 >>> 5) & 0x007f;\n        for (let i = 0; i < 8; i++)\n            this.pad[i] = u8to16(key, 16 + 2 * i);\n    }\n    process(data, offset, isLast = false) {\n        const hibit = isLast ? 0 : 1 << 11;\n        const { h, r } = this;\n        const r0 = r[0];\n        const r1 = r[1];\n        const r2 = r[2];\n        const r3 = r[3];\n        const r4 = r[4];\n        const r5 = r[5];\n        const r6 = r[6];\n        const r7 = r[7];\n        const r8 = r[8];\n        const r9 = r[9];\n        const t0 = u8to16(data, offset + 0);\n        const t1 = u8to16(data, offset + 2);\n        const t2 = u8to16(data, offset + 4);\n        const t3 = u8to16(data, offset + 6);\n        const t4 = u8to16(data, offset + 8);\n        const t5 = u8to16(data, offset + 10);\n        const t6 = u8to16(data, offset + 12);\n        const t7 = u8to16(data, offset + 14);\n        let h0 = h[0] + (t0 & 0x1fff);\n        let h1 = h[1] + (((t0 >>> 13) | (t1 << 3)) & 0x1fff);\n        let h2 = h[2] + (((t1 >>> 10) | (t2 << 6)) & 0x1fff);\n        let h3 = h[3] + (((t2 >>> 7) | (t3 << 9)) & 0x1fff);\n        let h4 = h[4] + (((t3 >>> 4) | (t4 << 12)) & 0x1fff);\n        let h5 = h[5] + ((t4 >>> 1) & 0x1fff);\n        let h6 = h[6] + (((t4 >>> 14) | (t5 << 2)) & 0x1fff);\n        let h7 = h[7] + (((t5 >>> 11) | (t6 << 5)) & 0x1fff);\n        let h8 = h[8] + (((t6 >>> 8) | (t7 << 8)) & 0x1fff);\n        let h9 = h[9] + ((t7 >>> 5) | hibit);\n        let c = 0;\n        let d0 = c + h0 * r0 + h1 * (5 * r9) + h2 * (5 * r8) + h3 * (5 * r7) + h4 * (5 * r6);\n        c = d0 >>> 13;\n        d0 &= 0x1fff;\n        d0 += h5 * (5 * r5) + h6 * (5 * r4) + h7 * (5 * r3) + h8 * (5 * r2) + h9 * (5 * r1);\n        c += d0 >>> 13;\n        d0 &= 0x1fff;\n        let d1 = c + h0 * r1 + h1 * r0 + h2 * (5 * r9) + h3 * (5 * r8) + h4 * (5 * r7);\n        c = d1 >>> 13;\n        d1 &= 0x1fff;\n        d1 += h5 * (5 * r6) + h6 * (5 * r5) + h7 * (5 * r4) + h8 * (5 * r3) + h9 * (5 * r2);\n        c += d1 >>> 13;\n        d1 &= 0x1fff;\n        let d2 = c + h0 * r2 + h1 * r1 + h2 * r0 + h3 * (5 * r9) + h4 * (5 * r8);\n        c = d2 >>> 13;\n        d2 &= 0x1fff;\n        d2 += h5 * (5 * r7) + h6 * (5 * r6) + h7 * (5 * r5) + h8 * (5 * r4) + h9 * (5 * r3);\n        c += d2 >>> 13;\n        d2 &= 0x1fff;\n        let d3 = c + h0 * r3 + h1 * r2 + h2 * r1 + h3 * r0 + h4 * (5 * r9);\n        c = d3 >>> 13;\n        d3 &= 0x1fff;\n        d3 += h5 * (5 * r8) + h6 * (5 * r7) + h7 * (5 * r6) + h8 * (5 * r5) + h9 * (5 * r4);\n        c += d3 >>> 13;\n        d3 &= 0x1fff;\n        let d4 = c + h0 * r4 + h1 * r3 + h2 * r2 + h3 * r1 + h4 * r0;\n        c = d4 >>> 13;\n        d4 &= 0x1fff;\n        d4 += h5 * (5 * r9) + h6 * (5 * r8) + h7 * (5 * r7) + h8 * (5 * r6) + h9 * (5 * r5);\n        c += d4 >>> 13;\n        d4 &= 0x1fff;\n        let d5 = c + h0 * r5 + h1 * r4 + h2 * r3 + h3 * r2 + h4 * r1;\n        c = d5 >>> 13;\n        d5 &= 0x1fff;\n        d5 += h5 * r0 + h6 * (5 * r9) + h7 * (5 * r8) + h8 * (5 * r7) + h9 * (5 * r6);\n        c += d5 >>> 13;\n        d5 &= 0x1fff;\n        let d6 = c + h0 * r6 + h1 * r5 + h2 * r4 + h3 * r3 + h4 * r2;\n        c = d6 >>> 13;\n        d6 &= 0x1fff;\n        d6 += h5 * r1 + h6 * r0 + h7 * (5 * r9) + h8 * (5 * r8) + h9 * (5 * r7);\n        c += d6 >>> 13;\n        d6 &= 0x1fff;\n        let d7 = c + h0 * r7 + h1 * r6 + h2 * r5 + h3 * r4 + h4 * r3;\n        c = d7 >>> 13;\n        d7 &= 0x1fff;\n        d7 += h5 * r2 + h6 * r1 + h7 * r0 + h8 * (5 * r9) + h9 * (5 * r8);\n        c += d7 >>> 13;\n        d7 &= 0x1fff;\n        let d8 = c + h0 * r8 + h1 * r7 + h2 * r6 + h3 * r5 + h4 * r4;\n        c = d8 >>> 13;\n        d8 &= 0x1fff;\n        d8 += h5 * r3 + h6 * r2 + h7 * r1 + h8 * r0 + h9 * (5 * r9);\n        c += d8 >>> 13;\n        d8 &= 0x1fff;\n        let d9 = c + h0 * r9 + h1 * r8 + h2 * r7 + h3 * r6 + h4 * r5;\n        c = d9 >>> 13;\n        d9 &= 0x1fff;\n        d9 += h5 * r4 + h6 * r3 + h7 * r2 + h8 * r1 + h9 * r0;\n        c += d9 >>> 13;\n        d9 &= 0x1fff;\n        c = ((c << 2) + c) | 0;\n        c = (c + d0) | 0;\n        d0 = c & 0x1fff;\n        c = c >>> 13;\n        d1 += c;\n        h[0] = d0;\n        h[1] = d1;\n        h[2] = d2;\n        h[3] = d3;\n        h[4] = d4;\n        h[5] = d5;\n        h[6] = d6;\n        h[7] = d7;\n        h[8] = d8;\n        h[9] = d9;\n    }\n    finalize() {\n        const { h, pad } = this;\n        const g = new Uint16Array(10);\n        let c = h[1] >>> 13;\n        h[1] &= 0x1fff;\n        for (let i = 2; i < 10; i++) {\n            h[i] += c;\n            c = h[i] >>> 13;\n            h[i] &= 0x1fff;\n        }\n        h[0] += c * 5;\n        c = h[0] >>> 13;\n        h[0] &= 0x1fff;\n        h[1] += c;\n        c = h[1] >>> 13;\n        h[1] &= 0x1fff;\n        h[2] += c;\n        g[0] = h[0] + 5;\n        c = g[0] >>> 13;\n        g[0] &= 0x1fff;\n        for (let i = 1; i < 10; i++) {\n            g[i] = h[i] + c;\n            c = g[i] >>> 13;\n            g[i] &= 0x1fff;\n        }\n        g[9] -= 1 << 13;\n        let mask = (c ^ 1) - 1;\n        for (let i = 0; i < 10; i++)\n            g[i] &= mask;\n        mask = ~mask;\n        for (let i = 0; i < 10; i++)\n            h[i] = (h[i] & mask) | g[i];\n        h[0] = (h[0] | (h[1] << 13)) & 0xffff;\n        h[1] = ((h[1] >>> 3) | (h[2] << 10)) & 0xffff;\n        h[2] = ((h[2] >>> 6) | (h[3] << 7)) & 0xffff;\n        h[3] = ((h[3] >>> 9) | (h[4] << 4)) & 0xffff;\n        h[4] = ((h[4] >>> 12) | (h[5] << 1) | (h[6] << 14)) & 0xffff;\n        h[5] = ((h[6] >>> 2) | (h[7] << 11)) & 0xffff;\n        h[6] = ((h[7] >>> 5) | (h[8] << 8)) & 0xffff;\n        h[7] = ((h[8] >>> 8) | (h[9] << 5)) & 0xffff;\n        let f = h[0] + pad[0];\n        h[0] = f & 0xffff;\n        for (let i = 1; i < 8; i++) {\n            f = (((h[i] + pad[i]) | 0) + (f >>> 16)) | 0;\n            h[i] = f & 0xffff;\n        }\n    }\n    update(data) {\n        assert.exists(this);\n        const { buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input\n            if (take === blockLen) {\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(data, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(buffer, 0, false);\n                this.pos = 0;\n            }\n        }\n        return this;\n    }\n    destroy() {\n        this.h.fill(0);\n        this.r.fill(0);\n        this.buffer.fill(0);\n        this.pad.fill(0);\n    }\n    digestInto(out) {\n        assert.exists(this);\n        assert.output(out, this);\n        this.finished = true;\n        const { buffer, h } = this;\n        let { pos } = this;\n        if (pos) {\n            buffer[pos++] = 1;\n            // buffer.subarray(pos).fill(0);\n            for (; pos < 16; pos++)\n                buffer[pos] = 0;\n            this.process(buffer, 0, true);\n        }\n        this.finalize();\n        let opos = 0;\n        for (let i = 0; i < 8; i++) {\n            out[opos++] = h[i] >>> 0;\n            out[opos++] = h[i] >>> 8;\n        }\n        return out;\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n}\nexport function wrapConstructorWithKey(hashCons) {\n    const hashC = (msg, key) => hashCons(key).update(toBytes(msg)).digest();\n    const tmp = hashCons(new Uint8Array(32));\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (key) => hashCons(key);\n    return hashC;\n}\nexport const poly1305 = wrapConstructorWithKey((key) => new Poly1305(key));\n//# sourceMappingURL=_poly1305.js.map","// Basic utils for salsa-like ciphers\n// Check out _micro.ts for descriptive documentation.\nimport assert from './_assert.js';\nimport { u32, utf8ToBytes, checkOpts } from './utils.js';\n/*\nRFC8439 requires multi-step cipher stream, where\nauthKey starts with counter: 0, actual msg with counter: 1.\n\nFor this, we need a way to re-use nonce / counter:\n\n    const counter = new Uint8Array(4);\n    chacha(..., counter, ...); // counter is now 1\n    chacha(..., counter, ...); // counter is now 2\n\nThis is complicated:\n\n- Original papers don't allow mutating counters\n- Counter overflow is undefined: https://mailarchive.ietf.org/arch/msg/cfrg/gsOnTJzcbgG6OqD8Sc0GO5aR_tU/\n- 3rd-party library stablelib implementation uses an approach where you can provide\n  nonce and counter instead of just nonce - and it will re-use it\n- We could have did something similar, but ChaCha has different counter position\n  (counter | nonce), which is not composable with XChaCha, because full counter\n  is (nonce16 | counter | nonce16). Stablelib doesn't support in-place counter for XChaCha.\n- We could separate nonce & counter and provide separate API for counter re-use, but\n  there are different counter sizes depending on an algorithm.\n- Salsa & ChaCha also differ in structures of key / sigma:\n\n    salsa:     c0 | k(4) | c1 | nonce(2) | ctr(2) | c2 | k(4) | c4\n    chacha:    c(4) | k(8) | ctr(1) | nonce(3)\n    chachaDJB: c(4) | k(8) | ctr(2) | nonce(2)\n- Creating function such as `setSalsaState(key, nonce, sigma, data)` won't work,\n  because we can't re-use counter array\n- 32-bit nonce is `2 ** 32 * 64` = 256GB with 32-bit counter\n- JS does not allow UintArrays bigger than 4GB, so supporting 64-bit counters doesn't matter\n\nStructure is as following:\n\nkey=16 -> sigma16, k=key|key\nkey=32 -> sigma32, k=key\n\nnonces:\nsalsa20:      8   (8-byte counter)\nchacha20djb:  8   (8-byte counter)\nchacha20tls:  12  (4-byte counter)\nxsalsa:       24  (16 -> hsalsa, 8 -> old nonce)\nxchacha:      24  (16 -> hchacha, 8 -> old nonce)\n\nhttps://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha#appendix-A.2\nUse the subkey and remaining 8 byte nonce with ChaCha20 as normal\n(prefixed by 4 NUL bytes, since [RFC8439] specifies a 12-byte nonce).\n*/\nconst sigma16 = utf8ToBytes('expand 16-byte k');\nconst sigma32 = utf8ToBytes('expand 32-byte k');\nconst sigma16_32 = u32(sigma16);\nconst sigma32_32 = u32(sigma32);\n// Is byte array aligned to 4 byte offset (u32)?\nconst isAligned32 = (b) => !(b.byteOffset % 4);\nexport const salsaBasic = (opts) => {\n    const { core, rounds, counterRight, counterLen, allow128bitKeys, extendNonceFn, blockLen } = checkOpts({ rounds: 20, counterRight: false, counterLen: 8, allow128bitKeys: true, blockLen: 64 }, opts);\n    assert.number(counterLen);\n    assert.number(rounds);\n    assert.number(blockLen);\n    assert.bool(counterRight);\n    assert.bool(allow128bitKeys);\n    const blockLen32 = blockLen / 4;\n    if (blockLen % 4 !== 0)\n        throw new Error('Salsa/ChaCha: blockLen must be aligned to 4 bytes');\n    return (key, nonce, data, output, counter = 0) => {\n        assert.bytes(key);\n        assert.bytes(nonce);\n        assert.bytes(data);\n        if (!output)\n            output = new Uint8Array(data.length);\n        assert.bytes(output);\n        assert.number(counter);\n        // > new Uint32Array([2**32])\n        // Uint32Array(1) [ 0 ]\n        // > new Uint32Array([2**32-1])\n        // Uint32Array(1) [ 4294967295 ]\n        if (counter < 0 || counter >= 2 ** 32 - 1)\n            throw new Error('Salsa/ChaCha: counter overflow');\n        if (output.length < data.length) {\n            throw new Error(`Salsa/ChaCha: output (${output.length}) is shorter than data (${data.length})`);\n        }\n        const toClean = [];\n        let k, sigma;\n        // Handle 128 byte keys\n        if (key.length === 32) {\n            k = key;\n            sigma = sigma32_32;\n        }\n        else if (key.length === 16 && allow128bitKeys) {\n            k = new Uint8Array(32);\n            k.set(key);\n            k.set(key, 16);\n            sigma = sigma16_32;\n            toClean.push(k);\n        }\n        else\n            throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${key.length}`);\n        // Handle extended nonce (HChaCha/HSalsa)\n        if (extendNonceFn) {\n            if (nonce.length <= 16)\n                throw new Error(`Salsa/ChaCha: extended nonce must be bigger than 16 bytes`);\n            k = extendNonceFn(sigma, k, nonce.subarray(0, 16), new Uint8Array(32));\n            toClean.push(k);\n            nonce = nonce.subarray(16);\n        }\n        // Handle nonce counter\n        const nonceLen = 16 - counterLen;\n        if (nonce.length !== nonceLen)\n            throw new Error(`Salsa/ChaCha: nonce must be ${nonceLen} or 16 bytes`);\n        // Pad counter when nonce is 64 bit\n        if (nonceLen !== 12) {\n            const nc = new Uint8Array(12);\n            nc.set(nonce, counterRight ? 0 : 12 - nonce.length);\n            toClean.push((nonce = nc));\n        }\n        // Counter positions\n        const block = new Uint8Array(blockLen);\n        // Cast to Uint32Array for speed\n        const b32 = u32(block);\n        const k32 = u32(k);\n        const n32 = u32(nonce);\n        // Make sure that buffers aligned to 4 bytes\n        const d32 = isAligned32(data) && u32(data);\n        const o32 = isAligned32(output) && u32(output);\n        toClean.push(b32);\n        const len = data.length;\n        for (let pos = 0, ctr = counter; pos < len; ctr++) {\n            core(sigma, k32, n32, b32, ctr, rounds);\n            if (ctr >= 2 ** 32 - 1)\n                throw new Error('Salsa/ChaCha: counter overflow');\n            const take = Math.min(blockLen, len - pos);\n            // full block && aligned to 4 bytes\n            if (take === blockLen && o32 && d32) {\n                const pos32 = pos / 4;\n                if (pos % 4 !== 0)\n                    throw new Error('Salsa/ChaCha: invalid block position');\n                for (let j = 0; j < blockLen32; j++)\n                    o32[pos32 + j] = d32[pos32 + j] ^ b32[j];\n                pos += blockLen;\n                continue;\n            }\n            for (let j = 0; j < take; j++)\n                output[pos + j] = data[pos + j] ^ block[j];\n            pos += take;\n        }\n        for (let i = 0; i < toClean.length; i++)\n            toClean[i].fill(0);\n        return output;\n    };\n};\n//# sourceMappingURL=_salsa.js.map","import { createView, ensureBytes, equalBytes, setBigUint64, u32 } from './utils.js';\nimport { poly1305 } from './_poly1305.js';\nimport { salsaBasic } from './_salsa.js';\n// ChaCha20 stream cipher was released in 2008. ChaCha aims to increase\n// the diffusion per round, but had slightly less cryptanalysis.\n// https://cr.yp.to/chacha.html, http://cr.yp.to/chacha/chacha-20080128.pdf\n// Left rotate for uint32\nconst rotl = (a, b) => (a << b) | (a >>> (32 - b));\n/**\n * ChaCha core function.\n */\n// prettier-ignore\nfunction chachaCore(c, k, n, out, cnt, rounds = 20) {\n    let y00 = c[0], y01 = c[1], y02 = c[2], y03 = c[3]; // \"expa\"   \"nd 3\"  \"2-by\"  \"te k\"\n    let y04 = k[0], y05 = k[1], y06 = k[2], y07 = k[3]; // Key      Key     Key     Key\n    let y08 = k[4], y09 = k[5], y10 = k[6], y11 = k[7]; // Key      Key     Key     Key\n    let y12 = cnt, y13 = n[0], y14 = n[1], y15 = n[2]; // Counter  Counter\tNonce   Nonce\n    // Save state to temporary variables\n    let x00 = y00, x01 = y01, x02 = y02, x03 = y03, x04 = y04, x05 = y05, x06 = y06, x07 = y07, x08 = y08, x09 = y09, x10 = y10, x11 = y11, x12 = y12, x13 = y13, x14 = y14, x15 = y15;\n    // Main loop\n    for (let i = 0; i < rounds; i += 2) {\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 16);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 12);\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 8);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 7);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 16);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 12);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 8);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 7);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 16);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 12);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 8);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 7);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 16);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 12);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 8);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 7);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 16);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 12);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 8);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 7);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 16);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 12);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 8);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 7);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 16);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 12);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 8);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 7);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 16);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 12);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 8);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 7);\n    }\n    // Write output\n    let oi = 0;\n    out[oi++] = (y00 + x00) | 0;\n    out[oi++] = (y01 + x01) | 0;\n    out[oi++] = (y02 + x02) | 0;\n    out[oi++] = (y03 + x03) | 0;\n    out[oi++] = (y04 + x04) | 0;\n    out[oi++] = (y05 + x05) | 0;\n    out[oi++] = (y06 + x06) | 0;\n    out[oi++] = (y07 + x07) | 0;\n    out[oi++] = (y08 + x08) | 0;\n    out[oi++] = (y09 + x09) | 0;\n    out[oi++] = (y10 + x10) | 0;\n    out[oi++] = (y11 + x11) | 0;\n    out[oi++] = (y12 + x12) | 0;\n    out[oi++] = (y13 + x13) | 0;\n    out[oi++] = (y14 + x14) | 0;\n    out[oi++] = (y15 + x15) | 0;\n}\n/**\n * hchacha helper method, used primarily in xchacha, to hash\n * key and nonce into key' and nonce'.\n * Same as chachaCore, but there doesn't seem to be a way to move the block\n * out without 25% performance hit.\n */\n// prettier-ignore\nexport function hchacha(c, key, src, out) {\n    const k32 = u32(key);\n    const i32 = u32(src);\n    const o32 = u32(out);\n    let x00 = c[0], x01 = c[1], x02 = c[2], x03 = c[3];\n    let x04 = k32[0], x05 = k32[1], x06 = k32[2], x07 = k32[3];\n    let x08 = k32[4], x09 = k32[5], x10 = k32[6], x11 = k32[7];\n    let x12 = i32[0], x13 = i32[1], x14 = i32[2], x15 = i32[3];\n    for (let i = 0; i < 20; i += 2) {\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 16);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 12);\n        x00 = (x00 + x04) | 0;\n        x12 = rotl(x12 ^ x00, 8);\n        x08 = (x08 + x12) | 0;\n        x04 = rotl(x04 ^ x08, 7);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 16);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 12);\n        x01 = (x01 + x05) | 0;\n        x13 = rotl(x13 ^ x01, 8);\n        x09 = (x09 + x13) | 0;\n        x05 = rotl(x05 ^ x09, 7);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 16);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 12);\n        x02 = (x02 + x06) | 0;\n        x14 = rotl(x14 ^ x02, 8);\n        x10 = (x10 + x14) | 0;\n        x06 = rotl(x06 ^ x10, 7);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 16);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 12);\n        x03 = (x03 + x07) | 0;\n        x15 = rotl(x15 ^ x03, 8);\n        x11 = (x11 + x15) | 0;\n        x07 = rotl(x07 ^ x11, 7);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 16);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 12);\n        x00 = (x00 + x05) | 0;\n        x15 = rotl(x15 ^ x00, 8);\n        x10 = (x10 + x15) | 0;\n        x05 = rotl(x05 ^ x10, 7);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 16);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 12);\n        x01 = (x01 + x06) | 0;\n        x12 = rotl(x12 ^ x01, 8);\n        x11 = (x11 + x12) | 0;\n        x06 = rotl(x06 ^ x11, 7);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 16);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 12);\n        x02 = (x02 + x07) | 0;\n        x13 = rotl(x13 ^ x02, 8);\n        x08 = (x08 + x13) | 0;\n        x07 = rotl(x07 ^ x08, 7);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 16);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 12);\n        x03 = (x03 + x04) | 0;\n        x14 = rotl(x14 ^ x03, 8);\n        x09 = (x09 + x14) | 0;\n        x04 = rotl(x04 ^ x09, 7);\n    }\n    o32[0] = x00;\n    o32[1] = x01;\n    o32[2] = x02;\n    o32[3] = x03;\n    o32[4] = x12;\n    o32[5] = x13;\n    o32[6] = x14;\n    o32[7] = x15;\n    return out;\n}\n/**\n * Original, non-RFC chacha20 from DJB. 8-byte nonce, 8-byte counter.\n */\nexport const chacha20orig = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 8,\n});\n/**\n * ChaCha stream cipher. Conforms to RFC 8439 (IETF, TLS). 12-byte nonce, 4-byte counter.\n * With 12-byte nonce, it's not safe to use fill it with random (CSPRNG), due to collision chance.\n */\nexport const chacha20 = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 4,\n    allow128bitKeys: false,\n});\n/**\n * XChaCha eXtended-nonce ChaCha. 24-byte nonce.\n * With 24-byte nonce, it's safe to use fill it with random (CSPRNG).\n * https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha\n */\nexport const xchacha20 = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 8,\n    extendNonceFn: hchacha,\n    allow128bitKeys: false,\n});\n/**\n * Reduced 8-round chacha, described in original paper.\n */\nexport const chacha8 = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 4,\n    rounds: 8,\n});\n/**\n * Reduced 12-round chacha, described in original paper.\n */\nexport const chacha12 = /* @__PURE__ */ salsaBasic({\n    core: chachaCore,\n    counterRight: false,\n    counterLen: 4,\n    rounds: 12,\n});\nconst ZERO = /* @__PURE__ */ new Uint8Array(16);\n// Pad to digest size with zeros\nconst updatePadded = (h, msg) => {\n    h.update(msg);\n    const left = msg.length % 16;\n    if (left)\n        h.update(ZERO.subarray(left));\n};\nconst computeTag = (fn, key, nonce, data, AAD) => {\n    const authKey = fn(key, nonce, new Uint8Array(32));\n    const h = poly1305.create(authKey);\n    if (AAD)\n        updatePadded(h, AAD);\n    updatePadded(h, data);\n    const num = new Uint8Array(16);\n    const view = createView(num);\n    setBigUint64(view, 0, BigInt(AAD ? AAD.length : 0), true);\n    setBigUint64(view, 8, BigInt(data.length), true);\n    h.update(num);\n    const res = h.digest();\n    authKey.fill(0);\n    return res;\n};\n/**\n * AEAD algorithm from RFC 8439.\n * Salsa20 and chacha (RFC 8439) use poly1305 differently.\n * We could have composed them similar to:\n * https://github.com/paulmillr/scure-base/blob/b266c73dde977b1dd7ef40ef7a23cc15aab526b3/index.ts#L250\n * But it's hard because of authKey:\n * In salsa20, authKey changes position in salsa stream.\n * In chacha, authKey can't be computed inside computeTag, it modifies the counter.\n */\nexport const _poly1305_aead = (xorStream) => (key, nonce, AAD) => {\n    const tagLength = 16;\n    ensureBytes(key, 32);\n    ensureBytes(nonce);\n    return {\n        tagLength,\n        encrypt: (plaintext, output) => {\n            const plength = plaintext.length;\n            const clength = plength + tagLength;\n            if (output) {\n                ensureBytes(output, clength);\n            }\n            else {\n                output = new Uint8Array(clength);\n            }\n            xorStream(key, nonce, plaintext, output, 1);\n            const tag = computeTag(xorStream, key, nonce, output.subarray(0, -tagLength), AAD);\n            output.set(tag, plength); // append tag\n            return output;\n        },\n        decrypt: (ciphertext, output) => {\n            const clength = ciphertext.length;\n            const plength = clength - tagLength;\n            if (clength < tagLength)\n                throw new Error(`encrypted data must be at least ${tagLength} bytes`);\n            if (output) {\n                ensureBytes(output, plength);\n            }\n            else {\n                output = new Uint8Array(plength);\n            }\n            const data = ciphertext.subarray(0, -tagLength);\n            const passedTag = ciphertext.subarray(-tagLength);\n            const tag = computeTag(xorStream, key, nonce, data, AAD);\n            if (!equalBytes(passedTag, tag))\n                throw new Error('invalid tag');\n            xorStream(key, nonce, data, output, 1);\n            return output;\n        },\n    };\n};\n/**\n * ChaCha20-Poly1305 from RFC 8439.\n * With 12-byte nonce, it's not safe to use fill it with random (CSPRNG), due to collision chance.\n */\nexport const chacha20poly1305 = /* @__PURE__ */ _poly1305_aead(chacha20);\n/**\n * XChaCha20-Poly1305 extended-nonce chacha.\n * https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-xchacha\n * With 24-byte nonce, it's safe to use fill it with random (CSPRNG).\n */\nexport const xchacha20poly1305 = /* @__PURE__ */ _poly1305_aead(xchacha20);\n//# sourceMappingURL=chacha.js.map","import assert from './_assert.js';\nimport { toBytes } from './utils.js';\nimport { hmac } from './hmac.js';\n// HKDF (RFC 5869)\n// https://soatok.blog/2021/11/17/understanding-hkdf/\n/**\n * HKDF-Extract(IKM, salt) -> PRK\n * Arguments position differs from spec (IKM is first one, since it is not optional)\n * @param hash\n * @param ikm\n * @param salt\n * @returns\n */\nexport function extract(hash, ikm, salt) {\n    assert.hash(hash);\n    // NOTE: some libraries treat zero-length array as 'not provided';\n    // we don't, since we have undefined as 'not provided'\n    // https://github.com/RustCrypto/KDFs/issues/15\n    if (salt === undefined)\n        salt = new Uint8Array(hash.outputLen); // if not provided, it is set to a string of HashLen zeros\n    return hmac(hash, toBytes(salt), toBytes(ikm));\n}\n// HKDF-Expand(PRK, info, L) -> OKM\nconst HKDF_COUNTER = new Uint8Array([0]);\nconst EMPTY_BUFFER = new Uint8Array();\n/**\n * HKDF-expand from the spec.\n * @param prk - a pseudorandom key of at least HashLen octets (usually, the output from the extract step)\n * @param info - optional context and application specific information (can be a zero-length string)\n * @param length - length of output keying material in octets\n */\nexport function expand(hash, prk, info, length = 32) {\n    assert.hash(hash);\n    assert.number(length);\n    if (length > 255 * hash.outputLen)\n        throw new Error('Length should be <= 255*HashLen');\n    const blocks = Math.ceil(length / hash.outputLen);\n    if (info === undefined)\n        info = EMPTY_BUFFER;\n    // first L(ength) octets of T\n    const okm = new Uint8Array(blocks * hash.outputLen);\n    // Re-use HMAC instance between blocks\n    const HMAC = hmac.create(hash, prk);\n    const HMACTmp = HMAC._cloneInto();\n    const T = new Uint8Array(HMAC.outputLen);\n    for (let counter = 0; counter < blocks; counter++) {\n        HKDF_COUNTER[0] = counter + 1;\n        // T(0) = empty string (zero length)\n        // T(N) = HMAC-Hash(PRK, T(N-1) | info | N)\n        HMACTmp.update(counter === 0 ? EMPTY_BUFFER : T)\n            .update(info)\n            .update(HKDF_COUNTER)\n            .digestInto(T);\n        okm.set(T, hash.outputLen * counter);\n        HMAC._cloneInto(HMACTmp);\n    }\n    HMAC.destroy();\n    HMACTmp.destroy();\n    T.fill(0);\n    HKDF_COUNTER.fill(0);\n    return okm.slice(0, length);\n}\n/**\n * HKDF (RFC 5869): extract + expand in one step.\n * @param hash - hash function that would be used (e.g. sha256)\n * @param ikm - input keying material, the initial key\n * @param salt - optional salt value (a non-secret random value)\n * @param info - optional context and application specific information\n * @param length - length of output keying material in octets\n */\nexport const hkdf = (hash, ikm, salt, info, length) => expand(hash, extract(hash, ikm, salt), info, length);\n//# sourceMappingURL=hkdf.js.map","var __defProp = Object.defineProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\n\n// keys.ts\nimport { schnorr } from \"@noble/curves/secp256k1\";\nimport { bytesToHex } from \"@noble/hashes/utils\";\nfunction generatePrivateKey() {\n  return bytesToHex(schnorr.utils.randomPrivateKey());\n}\nfunction getPublicKey(privateKey) {\n  return bytesToHex(schnorr.getPublicKey(privateKey));\n}\n\n// event.ts\nimport { schnorr as schnorr2 } from \"@noble/curves/secp256k1\";\nimport { sha256 } from \"@noble/hashes/sha256\";\nimport { bytesToHex as bytesToHex2 } from \"@noble/hashes/utils\";\n\n// utils.ts\nvar utils_exports = {};\n__export(utils_exports, {\n  MessageNode: () => MessageNode,\n  MessageQueue: () => MessageQueue,\n  insertEventIntoAscendingList: () => insertEventIntoAscendingList,\n  insertEventIntoDescendingList: () => insertEventIntoDescendingList,\n  normalizeURL: () => normalizeURL,\n  utf8Decoder: () => utf8Decoder,\n  utf8Encoder: () => utf8Encoder\n});\nvar utf8Decoder = new TextDecoder(\"utf-8\");\nvar utf8Encoder = new TextEncoder();\nfunction normalizeURL(url) {\n  let p = new URL(url);\n  p.pathname = p.pathname.replace(/\\/+/g, \"/\");\n  if (p.pathname.endsWith(\"/\"))\n    p.pathname = p.pathname.slice(0, -1);\n  if (p.port === \"80\" && p.protocol === \"ws:\" || p.port === \"443\" && p.protocol === \"wss:\")\n    p.port = \"\";\n  p.searchParams.sort();\n  p.hash = \"\";\n  return p.toString();\n}\nfunction insertEventIntoDescendingList(sortedArray, event) {\n  let start = 0;\n  let end = sortedArray.length - 1;\n  let midPoint;\n  let position = start;\n  if (end < 0) {\n    position = 0;\n  } else if (event.created_at < sortedArray[end].created_at) {\n    position = end + 1;\n  } else if (event.created_at >= sortedArray[start].created_at) {\n    position = start;\n  } else\n    while (true) {\n      if (end <= start + 1) {\n        position = end;\n        break;\n      }\n      midPoint = Math.floor(start + (end - start) / 2);\n      if (sortedArray[midPoint].created_at > event.created_at) {\n        start = midPoint;\n      } else if (sortedArray[midPoint].created_at < event.created_at) {\n        end = midPoint;\n      } else {\n        position = midPoint;\n        break;\n      }\n    }\n  if (sortedArray[position]?.id !== event.id) {\n    return [...sortedArray.slice(0, position), event, ...sortedArray.slice(position)];\n  }\n  return sortedArray;\n}\nfunction insertEventIntoAscendingList(sortedArray, event) {\n  let start = 0;\n  let end = sortedArray.length - 1;\n  let midPoint;\n  let position = start;\n  if (end < 0) {\n    position = 0;\n  } else if (event.created_at > sortedArray[end].created_at) {\n    position = end + 1;\n  } else if (event.created_at <= sortedArray[start].created_at) {\n    position = start;\n  } else\n    while (true) {\n      if (end <= start + 1) {\n        position = end;\n        break;\n      }\n      midPoint = Math.floor(start + (end - start) / 2);\n      if (sortedArray[midPoint].created_at < event.created_at) {\n        start = midPoint;\n      } else if (sortedArray[midPoint].created_at > event.created_at) {\n        end = midPoint;\n      } else {\n        position = midPoint;\n        break;\n      }\n    }\n  if (sortedArray[position]?.id !== event.id) {\n    return [...sortedArray.slice(0, position), event, ...sortedArray.slice(position)];\n  }\n  return sortedArray;\n}\nvar MessageNode = class {\n  _value;\n  _next;\n  get value() {\n    return this._value;\n  }\n  set value(message) {\n    this._value = message;\n  }\n  get next() {\n    return this._next;\n  }\n  set next(node) {\n    this._next = node;\n  }\n  constructor(message) {\n    this._value = message;\n    this._next = null;\n  }\n};\nvar MessageQueue = class {\n  _first;\n  _last;\n  get first() {\n    return this._first;\n  }\n  set first(messageNode) {\n    this._first = messageNode;\n  }\n  get last() {\n    return this._last;\n  }\n  set last(messageNode) {\n    this._last = messageNode;\n  }\n  _size;\n  get size() {\n    return this._size;\n  }\n  set size(v) {\n    this._size = v;\n  }\n  constructor() {\n    this._first = null;\n    this._last = null;\n    this._size = 0;\n  }\n  enqueue(message) {\n    const newNode = new MessageNode(message);\n    if (this._size === 0 || !this._last) {\n      this._first = newNode;\n      this._last = newNode;\n    } else {\n      this._last.next = newNode;\n      this._last = newNode;\n    }\n    this._size++;\n    return true;\n  }\n  dequeue() {\n    if (this._size === 0 || !this._first)\n      return null;\n    let prev = this._first;\n    this._first = prev.next;\n    prev.next = null;\n    this._size--;\n    return prev.value;\n  }\n};\n\n// event.ts\nvar verifiedSymbol = Symbol(\"verified\");\nvar Kind = /* @__PURE__ */ ((Kind3) => {\n  Kind3[Kind3[\"Metadata\"] = 0] = \"Metadata\";\n  Kind3[Kind3[\"Text\"] = 1] = \"Text\";\n  Kind3[Kind3[\"RecommendRelay\"] = 2] = \"RecommendRelay\";\n  Kind3[Kind3[\"Contacts\"] = 3] = \"Contacts\";\n  Kind3[Kind3[\"EncryptedDirectMessage\"] = 4] = \"EncryptedDirectMessage\";\n  Kind3[Kind3[\"EventDeletion\"] = 5] = \"EventDeletion\";\n  Kind3[Kind3[\"Repost\"] = 6] = \"Repost\";\n  Kind3[Kind3[\"Reaction\"] = 7] = \"Reaction\";\n  Kind3[Kind3[\"BadgeAward\"] = 8] = \"BadgeAward\";\n  Kind3[Kind3[\"ChannelCreation\"] = 40] = \"ChannelCreation\";\n  Kind3[Kind3[\"ChannelMetadata\"] = 41] = \"ChannelMetadata\";\n  Kind3[Kind3[\"ChannelMessage\"] = 42] = \"ChannelMessage\";\n  Kind3[Kind3[\"ChannelHideMessage\"] = 43] = \"ChannelHideMessage\";\n  Kind3[Kind3[\"ChannelMuteUser\"] = 44] = \"ChannelMuteUser\";\n  Kind3[Kind3[\"Blank\"] = 255] = \"Blank\";\n  Kind3[Kind3[\"Report\"] = 1984] = \"Report\";\n  Kind3[Kind3[\"ZapRequest\"] = 9734] = \"ZapRequest\";\n  Kind3[Kind3[\"Zap\"] = 9735] = \"Zap\";\n  Kind3[Kind3[\"RelayList\"] = 10002] = \"RelayList\";\n  Kind3[Kind3[\"ClientAuth\"] = 22242] = \"ClientAuth\";\n  Kind3[Kind3[\"NwcRequest\"] = 23194] = \"NwcRequest\";\n  Kind3[Kind3[\"HttpAuth\"] = 27235] = \"HttpAuth\";\n  Kind3[Kind3[\"ProfileBadge\"] = 30008] = \"ProfileBadge\";\n  Kind3[Kind3[\"BadgeDefinition\"] = 30009] = \"BadgeDefinition\";\n  Kind3[Kind3[\"Article\"] = 30023] = \"Article\";\n  Kind3[Kind3[\"FileMetadata\"] = 1063] = \"FileMetadata\";\n  return Kind3;\n})(Kind || {});\nfunction getBlankEvent(kind = 255 /* Blank */) {\n  return {\n    kind,\n    content: \"\",\n    tags: [],\n    created_at: 0\n  };\n}\nfunction finishEvent(t, privateKey) {\n  const event = t;\n  event.pubkey = getPublicKey(privateKey);\n  event.id = getEventHash(event);\n  event.sig = getSignature(event, privateKey);\n  event[verifiedSymbol] = true;\n  return event;\n}\nfunction serializeEvent(evt) {\n  if (!validateEvent(evt))\n    throw new Error(\"can't serialize event with wrong or missing properties\");\n  return JSON.stringify([0, evt.pubkey, evt.created_at, evt.kind, evt.tags, evt.content]);\n}\nfunction getEventHash(event) {\n  let eventHash = sha256(utf8Encoder.encode(serializeEvent(event)));\n  return bytesToHex2(eventHash);\n}\nvar isRecord = (obj) => obj instanceof Object;\nfunction validateEvent(event) {\n  if (!isRecord(event))\n    return false;\n  if (typeof event.kind !== \"number\")\n    return false;\n  if (typeof event.content !== \"string\")\n    return false;\n  if (typeof event.created_at !== \"number\")\n    return false;\n  if (typeof event.pubkey !== \"string\")\n    return false;\n  if (!event.pubkey.match(/^[a-f0-9]{64}$/))\n    return false;\n  if (!Array.isArray(event.tags))\n    return false;\n  for (let i = 0; i < event.tags.length; i++) {\n    let tag = event.tags[i];\n    if (!Array.isArray(tag))\n      return false;\n    for (let j = 0; j < tag.length; j++) {\n      if (typeof tag[j] === \"object\")\n        return false;\n    }\n  }\n  return true;\n}\nfunction verifySignature(event) {\n  if (typeof event[verifiedSymbol] === \"boolean\")\n    return event[verifiedSymbol];\n  const hash = getEventHash(event);\n  if (hash !== event.id) {\n    return event[verifiedSymbol] = false;\n  }\n  try {\n    return event[verifiedSymbol] = schnorr2.verify(event.sig, hash, event.pubkey);\n  } catch (err) {\n    return event[verifiedSymbol] = false;\n  }\n}\nfunction signEvent(event, key) {\n  console.warn(\n    \"nostr-tools: `signEvent` is deprecated and will be removed or changed in the future. Please use `getSignature` instead.\"\n  );\n  return getSignature(event, key);\n}\nfunction getSignature(event, key) {\n  return bytesToHex2(schnorr2.sign(getEventHash(event), key));\n}\n\n// filter.ts\nfunction matchFilter(filter, event) {\n  if (filter.ids && filter.ids.indexOf(event.id) === -1) {\n    if (!filter.ids.some((prefix) => event.id.startsWith(prefix))) {\n      return false;\n    }\n  }\n  if (filter.kinds && filter.kinds.indexOf(event.kind) === -1)\n    return false;\n  if (filter.authors && filter.authors.indexOf(event.pubkey) === -1) {\n    if (!filter.authors.some((prefix) => event.pubkey.startsWith(prefix))) {\n      return false;\n    }\n  }\n  for (let f in filter) {\n    if (f[0] === \"#\") {\n      let tagName = f.slice(1);\n      let values = filter[`#${tagName}`];\n      if (values && !event.tags.find(([t, v]) => t === f.slice(1) && values.indexOf(v) !== -1))\n        return false;\n    }\n  }\n  if (filter.since && event.created_at < filter.since)\n    return false;\n  if (filter.until && event.created_at > filter.until)\n    return false;\n  return true;\n}\nfunction matchFilters(filters, event) {\n  for (let i = 0; i < filters.length; i++) {\n    if (matchFilter(filters[i], event))\n      return true;\n  }\n  return false;\n}\nfunction mergeFilters(...filters) {\n  let result = {};\n  for (let i = 0; i < filters.length; i++) {\n    let filter = filters[i];\n    Object.entries(filter).forEach(([property, values]) => {\n      if (property === \"kinds\" || property === \"ids\" || property === \"authors\" || property[0] === \"#\") {\n        result[property] = result[property] || [];\n        for (let v = 0; v < values.length; v++) {\n          let value = values[v];\n          if (!result[property].includes(value))\n            result[property].push(value);\n        }\n      }\n    });\n    if (filter.limit && (!result.limit || filter.limit > result.limit))\n      result.limit = filter.limit;\n    if (filter.until && (!result.until || filter.until > result.until))\n      result.until = filter.until;\n    if (filter.since && (!result.since || filter.since < result.since))\n      result.since = filter.since;\n  }\n  return result;\n}\n\n// fakejson.ts\nvar fakejson_exports = {};\n__export(fakejson_exports, {\n  getHex64: () => getHex64,\n  getInt: () => getInt,\n  getSubscriptionId: () => getSubscriptionId,\n  matchEventId: () => matchEventId,\n  matchEventKind: () => matchEventKind,\n  matchEventPubkey: () => matchEventPubkey\n});\nfunction getHex64(json, field) {\n  let len = field.length + 3;\n  let idx = json.indexOf(`\"${field}\":`) + len;\n  let s = json.slice(idx).indexOf(`\"`) + idx + 1;\n  return json.slice(s, s + 64);\n}\nfunction getInt(json, field) {\n  let len = field.length;\n  let idx = json.indexOf(`\"${field}\":`) + len + 3;\n  let sliced = json.slice(idx);\n  let end = Math.min(sliced.indexOf(\",\"), sliced.indexOf(\"}\"));\n  return parseInt(sliced.slice(0, end), 10);\n}\nfunction getSubscriptionId(json) {\n  let idx = json.slice(0, 22).indexOf(`\"EVENT\"`);\n  if (idx === -1)\n    return null;\n  let pstart = json.slice(idx + 7 + 1).indexOf(`\"`);\n  if (pstart === -1)\n    return null;\n  let start = idx + 7 + 1 + pstart;\n  let pend = json.slice(start + 1, 80).indexOf(`\"`);\n  if (pend === -1)\n    return null;\n  let end = start + 1 + pend;\n  return json.slice(start + 1, end);\n}\nfunction matchEventId(json, id) {\n  return id === getHex64(json, \"id\");\n}\nfunction matchEventPubkey(json, pubkey) {\n  return pubkey === getHex64(json, \"pubkey\");\n}\nfunction matchEventKind(json, kind) {\n  return kind === getInt(json, \"kind\");\n}\n\n// relay.ts\nvar newListeners = () => ({\n  connect: [],\n  disconnect: [],\n  error: [],\n  notice: [],\n  auth: []\n});\nfunction relayInit(url, options = {}) {\n  let { listTimeout = 3e3, getTimeout = 3e3, countTimeout = 3e3 } = options;\n  var ws;\n  var openSubs = {};\n  var listeners = newListeners();\n  var subListeners = {};\n  var pubListeners = {};\n  var connectionPromise;\n  async function connectRelay() {\n    if (connectionPromise)\n      return connectionPromise;\n    connectionPromise = new Promise((resolve, reject) => {\n      try {\n        ws = new WebSocket(url);\n      } catch (err) {\n        reject(err);\n      }\n      ws.onopen = () => {\n        listeners.connect.forEach((cb) => cb());\n        resolve();\n      };\n      ws.onerror = () => {\n        connectionPromise = void 0;\n        listeners.error.forEach((cb) => cb());\n        reject();\n      };\n      ws.onclose = async () => {\n        connectionPromise = void 0;\n        listeners.disconnect.forEach((cb) => cb());\n      };\n      let incomingMessageQueue = new MessageQueue();\n      let handleNextInterval;\n      ws.onmessage = (e) => {\n        incomingMessageQueue.enqueue(e.data);\n        if (!handleNextInterval) {\n          handleNextInterval = setInterval(handleNext, 0);\n        }\n      };\n      function handleNext() {\n        if (incomingMessageQueue.size === 0) {\n          clearInterval(handleNextInterval);\n          handleNextInterval = null;\n          return;\n        }\n        var json = incomingMessageQueue.dequeue();\n        if (!json)\n          return;\n        let subid = getSubscriptionId(json);\n        if (subid) {\n          let so = openSubs[subid];\n          if (so && so.alreadyHaveEvent && so.alreadyHaveEvent(getHex64(json, \"id\"), url)) {\n            return;\n          }\n        }\n        try {\n          let data = JSON.parse(json);\n          switch (data[0]) {\n            case \"EVENT\": {\n              let id2 = data[1];\n              let event = data[2];\n              if (validateEvent(event) && openSubs[id2] && (openSubs[id2].skipVerification || verifySignature(event)) && matchFilters(openSubs[id2].filters, event)) {\n                openSubs[id2];\n                (subListeners[id2]?.event || []).forEach((cb) => cb(event));\n              }\n              return;\n            }\n            case \"COUNT\":\n              let id = data[1];\n              let payload = data[2];\n              if (openSubs[id]) {\n                ;\n                (subListeners[id]?.count || []).forEach((cb) => cb(payload));\n              }\n              return;\n            case \"EOSE\": {\n              let id2 = data[1];\n              if (id2 in subListeners) {\n                subListeners[id2].eose.forEach((cb) => cb());\n                subListeners[id2].eose = [];\n              }\n              return;\n            }\n            case \"OK\": {\n              let id2 = data[1];\n              let ok = data[2];\n              let reason = data[3] || \"\";\n              if (id2 in pubListeners) {\n                let { resolve: resolve2, reject: reject2 } = pubListeners[id2];\n                if (ok)\n                  resolve2(null);\n                else\n                  reject2(new Error(reason));\n              }\n              return;\n            }\n            case \"NOTICE\":\n              let notice = data[1];\n              listeners.notice.forEach((cb) => cb(notice));\n              return;\n            case \"AUTH\": {\n              let challenge = data[1];\n              listeners.auth?.forEach((cb) => cb(challenge));\n              return;\n            }\n          }\n        } catch (err) {\n          return;\n        }\n      }\n    });\n    return connectionPromise;\n  }\n  function connected() {\n    return ws?.readyState === 1;\n  }\n  async function connect() {\n    if (connected())\n      return;\n    await connectRelay();\n  }\n  async function trySend(params) {\n    let msg = JSON.stringify(params);\n    if (!connected()) {\n      await new Promise((resolve) => setTimeout(resolve, 1e3));\n      if (!connected()) {\n        return;\n      }\n    }\n    try {\n      ws.send(msg);\n    } catch (err) {\n      console.log(err);\n    }\n  }\n  const sub = (filters, {\n    verb = \"REQ\",\n    skipVerification = false,\n    alreadyHaveEvent = null,\n    id = Math.random().toString().slice(2)\n  } = {}) => {\n    let subid = id;\n    openSubs[subid] = {\n      id: subid,\n      filters,\n      skipVerification,\n      alreadyHaveEvent\n    };\n    trySend([verb, subid, ...filters]);\n    let subscription = {\n      sub: (newFilters, newOpts = {}) => sub(newFilters || filters, {\n        skipVerification: newOpts.skipVerification || skipVerification,\n        alreadyHaveEvent: newOpts.alreadyHaveEvent || alreadyHaveEvent,\n        id: subid\n      }),\n      unsub: () => {\n        delete openSubs[subid];\n        delete subListeners[subid];\n        trySend([\"CLOSE\", subid]);\n      },\n      on: (type, cb) => {\n        subListeners[subid] = subListeners[subid] || {\n          event: [],\n          count: [],\n          eose: []\n        };\n        subListeners[subid][type].push(cb);\n      },\n      off: (type, cb) => {\n        let listeners2 = subListeners[subid];\n        let idx = listeners2[type].indexOf(cb);\n        if (idx >= 0)\n          listeners2[type].splice(idx, 1);\n      },\n      get events() {\n        return eventsGenerator(subscription);\n      }\n    };\n    return subscription;\n  };\n  function _publishEvent(event, type) {\n    return new Promise((resolve, reject) => {\n      if (!event.id) {\n        reject(new Error(`event ${event} has no id`));\n        return;\n      }\n      let id = event.id;\n      trySend([type, event]);\n      pubListeners[id] = { resolve, reject };\n    });\n  }\n  return {\n    url,\n    sub,\n    on: (type, cb) => {\n      listeners[type].push(cb);\n      if (type === \"connect\" && ws?.readyState === 1) {\n        ;\n        cb();\n      }\n    },\n    off: (type, cb) => {\n      let index = listeners[type].indexOf(cb);\n      if (index !== -1)\n        listeners[type].splice(index, 1);\n    },\n    list: (filters, opts) => new Promise((resolve) => {\n      let s = sub(filters, opts);\n      let events = [];\n      let timeout = setTimeout(() => {\n        s.unsub();\n        resolve(events);\n      }, listTimeout);\n      s.on(\"eose\", () => {\n        s.unsub();\n        clearTimeout(timeout);\n        resolve(events);\n      });\n      s.on(\"event\", (event) => {\n        events.push(event);\n      });\n    }),\n    get: (filter, opts) => new Promise((resolve) => {\n      let s = sub([filter], opts);\n      let timeout = setTimeout(() => {\n        s.unsub();\n        resolve(null);\n      }, getTimeout);\n      s.on(\"event\", (event) => {\n        s.unsub();\n        clearTimeout(timeout);\n        resolve(event);\n      });\n    }),\n    count: (filters) => new Promise((resolve) => {\n      let s = sub(filters, { ...sub, verb: \"COUNT\" });\n      let timeout = setTimeout(() => {\n        s.unsub();\n        resolve(null);\n      }, countTimeout);\n      s.on(\"count\", (event) => {\n        s.unsub();\n        clearTimeout(timeout);\n        resolve(event);\n      });\n    }),\n    async publish(event) {\n      await _publishEvent(event, \"EVENT\");\n    },\n    async auth(event) {\n      await _publishEvent(event, \"AUTH\");\n    },\n    connect,\n    close() {\n      listeners = newListeners();\n      subListeners = {};\n      pubListeners = {};\n      if (ws?.readyState === WebSocket.OPEN) {\n        ws.close();\n      }\n    },\n    get status() {\n      return ws?.readyState ?? 3;\n    }\n  };\n}\nasync function* eventsGenerator(sub) {\n  let nextResolve;\n  const eventQueue = [];\n  const pushToQueue = (event) => {\n    if (nextResolve) {\n      nextResolve(event);\n      nextResolve = void 0;\n    } else {\n      eventQueue.push(event);\n    }\n  };\n  sub.on(\"event\", pushToQueue);\n  try {\n    while (true) {\n      if (eventQueue.length > 0) {\n        yield eventQueue.shift();\n      } else {\n        const event = await new Promise((resolve) => {\n          nextResolve = resolve;\n        });\n        yield event;\n      }\n    }\n  } finally {\n    sub.off(\"event\", pushToQueue);\n  }\n}\n\n// pool.ts\nvar SimplePool = class {\n  _conn;\n  _seenOn = {};\n  batchedByKey = {};\n  eoseSubTimeout;\n  getTimeout;\n  seenOnEnabled = true;\n  batchInterval = 100;\n  constructor(options = {}) {\n    this._conn = {};\n    this.eoseSubTimeout = options.eoseSubTimeout || 3400;\n    this.getTimeout = options.getTimeout || 3400;\n    this.seenOnEnabled = options.seenOnEnabled !== false;\n    this.batchInterval = options.batchInterval || 100;\n  }\n  close(relays) {\n    relays.forEach((url) => {\n      let relay = this._conn[normalizeURL(url)];\n      if (relay)\n        relay.close();\n    });\n  }\n  async ensureRelay(url) {\n    const nm = normalizeURL(url);\n    if (!this._conn[nm]) {\n      this._conn[nm] = relayInit(nm, {\n        getTimeout: this.getTimeout * 0.9,\n        listTimeout: this.getTimeout * 0.9\n      });\n    }\n    const relay = this._conn[nm];\n    await relay.connect();\n    return relay;\n  }\n  sub(relays, filters, opts) {\n    let _knownIds = /* @__PURE__ */ new Set();\n    let modifiedOpts = { ...opts || {} };\n    modifiedOpts.alreadyHaveEvent = (id, url) => {\n      if (opts?.alreadyHaveEvent?.(id, url)) {\n        return true;\n      }\n      if (this.seenOnEnabled) {\n        let set = this._seenOn[id] || /* @__PURE__ */ new Set();\n        set.add(url);\n        this._seenOn[id] = set;\n      }\n      return _knownIds.has(id);\n    };\n    let subs = [];\n    let eventListeners = /* @__PURE__ */ new Set();\n    let eoseListeners = /* @__PURE__ */ new Set();\n    let eosesMissing = relays.length;\n    let eoseSent = false;\n    let eoseTimeout = setTimeout(\n      () => {\n        eoseSent = true;\n        for (let cb of eoseListeners.values())\n          cb();\n      },\n      opts?.eoseSubTimeout || this.eoseSubTimeout\n    );\n    relays.filter((r, i, a) => a.indexOf(r) === i).forEach(async (relay) => {\n      let r;\n      try {\n        r = await this.ensureRelay(relay);\n      } catch (err) {\n        handleEose();\n        return;\n      }\n      if (!r)\n        return;\n      let s = r.sub(filters, modifiedOpts);\n      s.on(\"event\", (event) => {\n        _knownIds.add(event.id);\n        for (let cb of eventListeners.values())\n          cb(event);\n      });\n      s.on(\"eose\", () => {\n        if (eoseSent)\n          return;\n        handleEose();\n      });\n      subs.push(s);\n      function handleEose() {\n        eosesMissing--;\n        if (eosesMissing === 0) {\n          clearTimeout(eoseTimeout);\n          for (let cb of eoseListeners.values())\n            cb();\n        }\n      }\n    });\n    let greaterSub = {\n      sub(filters2, opts2) {\n        subs.forEach((sub) => sub.sub(filters2, opts2));\n        return greaterSub;\n      },\n      unsub() {\n        subs.forEach((sub) => sub.unsub());\n      },\n      on(type, cb) {\n        if (type === \"event\") {\n          eventListeners.add(cb);\n        } else if (type === \"eose\") {\n          eoseListeners.add(cb);\n        }\n      },\n      off(type, cb) {\n        if (type === \"event\") {\n          eventListeners.delete(cb);\n        } else if (type === \"eose\")\n          eoseListeners.delete(cb);\n      },\n      get events() {\n        return eventsGenerator(greaterSub);\n      }\n    };\n    return greaterSub;\n  }\n  get(relays, filter, opts) {\n    return new Promise((resolve) => {\n      let sub = this.sub(relays, [filter], opts);\n      let timeout = setTimeout(() => {\n        sub.unsub();\n        resolve(null);\n      }, this.getTimeout);\n      sub.on(\"event\", (event) => {\n        resolve(event);\n        clearTimeout(timeout);\n        sub.unsub();\n      });\n    });\n  }\n  list(relays, filters, opts) {\n    return new Promise((resolve) => {\n      let events = [];\n      let sub = this.sub(relays, filters, opts);\n      sub.on(\"event\", (event) => {\n        events.push(event);\n      });\n      sub.on(\"eose\", () => {\n        sub.unsub();\n        resolve(events);\n      });\n    });\n  }\n  batchedList(batchKey, relays, filters) {\n    return new Promise((resolve) => {\n      if (!this.batchedByKey[batchKey]) {\n        this.batchedByKey[batchKey] = [\n          {\n            filters,\n            relays,\n            resolve,\n            events: []\n          }\n        ];\n        setTimeout(() => {\n          Object.keys(this.batchedByKey).forEach(async (batchKey2) => {\n            const batchedRequests = this.batchedByKey[batchKey2];\n            const filters2 = [];\n            const relays2 = [];\n            batchedRequests.forEach((br) => {\n              filters2.push(...br.filters);\n              relays2.push(...br.relays);\n            });\n            const sub = this.sub(relays2, [mergeFilters(...filters2)]);\n            sub.on(\"event\", (event) => {\n              batchedRequests.forEach((br) => matchFilters(br.filters, event) && br.events.push(event));\n            });\n            sub.on(\"eose\", () => {\n              sub.unsub();\n              batchedRequests.forEach((br) => br.resolve(br.events));\n            });\n            delete this.batchedByKey[batchKey2];\n          });\n        }, this.batchInterval);\n      } else {\n        this.batchedByKey[batchKey].push({\n          filters,\n          relays,\n          resolve,\n          events: []\n        });\n      }\n    });\n  }\n  publish(relays, event) {\n    return relays.map(async (relay) => {\n      let r = await this.ensureRelay(relay);\n      return r.publish(event);\n    });\n  }\n  seenOn(id) {\n    return Array.from(this._seenOn[id]?.values?.() || []);\n  }\n};\n\n// nip19.ts\nvar nip19_exports = {};\n__export(nip19_exports, {\n  BECH32_REGEX: () => BECH32_REGEX,\n  decode: () => decode,\n  naddrEncode: () => naddrEncode,\n  neventEncode: () => neventEncode,\n  noteEncode: () => noteEncode,\n  nprofileEncode: () => nprofileEncode,\n  npubEncode: () => npubEncode,\n  nrelayEncode: () => nrelayEncode,\n  nsecEncode: () => nsecEncode\n});\nimport { bytesToHex as bytesToHex3, concatBytes, hexToBytes } from \"@noble/hashes/utils\";\nimport { bech32 } from \"@scure/base\";\nvar Bech32MaxSize = 5e3;\nvar BECH32_REGEX = /[\\x21-\\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;\nfunction integerToUint8Array(number) {\n  const uint8Array = new Uint8Array(4);\n  uint8Array[0] = number >> 24 & 255;\n  uint8Array[1] = number >> 16 & 255;\n  uint8Array[2] = number >> 8 & 255;\n  uint8Array[3] = number & 255;\n  return uint8Array;\n}\nfunction decode(nip19) {\n  let { prefix, words } = bech32.decode(nip19, Bech32MaxSize);\n  let data = new Uint8Array(bech32.fromWords(words));\n  switch (prefix) {\n    case \"nprofile\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nprofile\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      return {\n        type: \"nprofile\",\n        data: {\n          pubkey: bytesToHex3(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nevent\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nevent\");\n      if (tlv[0][0].length !== 32)\n        throw new Error(\"TLV 0 should be 32 bytes\");\n      if (tlv[2] && tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (tlv[3] && tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"nevent\",\n        data: {\n          id: bytesToHex3(tlv[0][0]),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : [],\n          author: tlv[2]?.[0] ? bytesToHex3(tlv[2][0]) : void 0,\n          kind: tlv[3]?.[0] ? parseInt(bytesToHex3(tlv[3][0]), 16) : void 0\n        }\n      };\n    }\n    case \"naddr\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for naddr\");\n      if (!tlv[2]?.[0])\n        throw new Error(\"missing TLV 2 for naddr\");\n      if (tlv[2][0].length !== 32)\n        throw new Error(\"TLV 2 should be 32 bytes\");\n      if (!tlv[3]?.[0])\n        throw new Error(\"missing TLV 3 for naddr\");\n      if (tlv[3][0].length !== 4)\n        throw new Error(\"TLV 3 should be 4 bytes\");\n      return {\n        type: \"naddr\",\n        data: {\n          identifier: utf8Decoder.decode(tlv[0][0]),\n          pubkey: bytesToHex3(tlv[2][0]),\n          kind: parseInt(bytesToHex3(tlv[3][0]), 16),\n          relays: tlv[1] ? tlv[1].map((d) => utf8Decoder.decode(d)) : []\n        }\n      };\n    }\n    case \"nrelay\": {\n      let tlv = parseTLV(data);\n      if (!tlv[0]?.[0])\n        throw new Error(\"missing TLV 0 for nrelay\");\n      return {\n        type: \"nrelay\",\n        data: utf8Decoder.decode(tlv[0][0])\n      };\n    }\n    case \"nsec\":\n    case \"npub\":\n    case \"note\":\n      return { type: prefix, data: bytesToHex3(data) };\n    default:\n      throw new Error(`unknown prefix ${prefix}`);\n  }\n}\nfunction parseTLV(data) {\n  let result = {};\n  let rest = data;\n  while (rest.length > 0) {\n    let t = rest[0];\n    let l = rest[1];\n    if (!l)\n      throw new Error(`malformed TLV ${t}`);\n    let v = rest.slice(2, 2 + l);\n    rest = rest.slice(2 + l);\n    if (v.length < l)\n      throw new Error(`not enough data to read on TLV ${t}`);\n    result[t] = result[t] || [];\n    result[t].push(v);\n  }\n  return result;\n}\nfunction nsecEncode(hex) {\n  return encodeBytes(\"nsec\", hex);\n}\nfunction npubEncode(hex) {\n  return encodeBytes(\"npub\", hex);\n}\nfunction noteEncode(hex) {\n  return encodeBytes(\"note\", hex);\n}\nfunction encodeBech32(prefix, data) {\n  let words = bech32.toWords(data);\n  return bech32.encode(prefix, words, Bech32MaxSize);\n}\nfunction encodeBytes(prefix, hex) {\n  let data = hexToBytes(hex);\n  return encodeBech32(prefix, data);\n}\nfunction nprofileEncode(profile) {\n  let data = encodeTLV({\n    0: [hexToBytes(profile.pubkey)],\n    1: (profile.relays || []).map((url) => utf8Encoder.encode(url))\n  });\n  return encodeBech32(\"nprofile\", data);\n}\nfunction neventEncode(event) {\n  let kindArray;\n  if (event.kind != void 0) {\n    kindArray = integerToUint8Array(event.kind);\n  }\n  let data = encodeTLV({\n    0: [hexToBytes(event.id)],\n    1: (event.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: event.author ? [hexToBytes(event.author)] : [],\n    3: kindArray ? [new Uint8Array(kindArray)] : []\n  });\n  return encodeBech32(\"nevent\", data);\n}\nfunction naddrEncode(addr) {\n  let kind = new ArrayBuffer(4);\n  new DataView(kind).setUint32(0, addr.kind, false);\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(addr.identifier)],\n    1: (addr.relays || []).map((url) => utf8Encoder.encode(url)),\n    2: [hexToBytes(addr.pubkey)],\n    3: [new Uint8Array(kind)]\n  });\n  return encodeBech32(\"naddr\", data);\n}\nfunction nrelayEncode(url) {\n  let data = encodeTLV({\n    0: [utf8Encoder.encode(url)]\n  });\n  return encodeBech32(\"nrelay\", data);\n}\nfunction encodeTLV(tlv) {\n  let entries = [];\n  Object.entries(tlv).forEach(([t, vs]) => {\n    vs.forEach((v) => {\n      let entry = new Uint8Array(v.length + 2);\n      entry.set([parseInt(t)], 0);\n      entry.set([v.length], 1);\n      entry.set(v, 2);\n      entries.push(entry);\n    });\n  });\n  return concatBytes(...entries);\n}\n\n// references.ts\nvar mentionRegex = /\\bnostr:((note|npub|naddr|nevent|nprofile)1\\w+)\\b|#\\[(\\d+)\\]/g;\nfunction parseReferences(evt) {\n  let references = [];\n  for (let ref of evt.content.matchAll(mentionRegex)) {\n    if (ref[2]) {\n      try {\n        let { type, data } = decode(ref[1]);\n        switch (type) {\n          case \"npub\": {\n            references.push({\n              text: ref[0],\n              profile: { pubkey: data, relays: [] }\n            });\n            break;\n          }\n          case \"nprofile\": {\n            references.push({\n              text: ref[0],\n              profile: data\n            });\n            break;\n          }\n          case \"note\": {\n            references.push({\n              text: ref[0],\n              event: { id: data, relays: [] }\n            });\n            break;\n          }\n          case \"nevent\": {\n            references.push({\n              text: ref[0],\n              event: data\n            });\n            break;\n          }\n          case \"naddr\": {\n            references.push({\n              text: ref[0],\n              address: data\n            });\n            break;\n          }\n        }\n      } catch (err) {\n      }\n    } else if (ref[3]) {\n      let idx = parseInt(ref[3], 10);\n      let tag = evt.tags[idx];\n      if (!tag)\n        continue;\n      switch (tag[0]) {\n        case \"p\": {\n          references.push({\n            text: ref[0],\n            profile: { pubkey: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"e\": {\n          references.push({\n            text: ref[0],\n            event: { id: tag[1], relays: tag[2] ? [tag[2]] : [] }\n          });\n          break;\n        }\n        case \"a\": {\n          try {\n            let [kind, pubkey, identifier] = tag[1].split(\":\");\n            references.push({\n              text: ref[0],\n              address: {\n                identifier,\n                pubkey,\n                kind: parseInt(kind, 10),\n                relays: tag[2] ? [tag[2]] : []\n              }\n            });\n          } catch (err) {\n          }\n          break;\n        }\n      }\n    }\n  }\n  return references;\n}\n\n// nip04.ts\nvar nip04_exports = {};\n__export(nip04_exports, {\n  decrypt: () => decrypt,\n  encrypt: () => encrypt\n});\nimport { randomBytes } from \"@noble/hashes/utils\";\nimport { secp256k1 } from \"@noble/curves/secp256k1\";\nimport { base64 } from \"@scure/base\";\nif (typeof crypto !== \"undefined\" && !crypto.subtle && crypto.webcrypto) {\n  crypto.subtle = crypto.webcrypto.subtle;\n}\nasync function encrypt(privkey, pubkey, text) {\n  const key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  const normalizedKey = getNormalizedX(key);\n  let iv = Uint8Array.from(randomBytes(16));\n  let plaintext = utf8Encoder.encode(text);\n  let cryptoKey = await crypto.subtle.importKey(\"raw\", normalizedKey, { name: \"AES-CBC\" }, false, [\"encrypt\"]);\n  let ciphertext = await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, cryptoKey, plaintext);\n  let ctb64 = base64.encode(new Uint8Array(ciphertext));\n  let ivb64 = base64.encode(new Uint8Array(iv.buffer));\n  return `${ctb64}?iv=${ivb64}`;\n}\nasync function decrypt(privkey, pubkey, data) {\n  let [ctb64, ivb64] = data.split(\"?iv=\");\n  let key = secp256k1.getSharedSecret(privkey, \"02\" + pubkey);\n  let normalizedKey = getNormalizedX(key);\n  let cryptoKey = await crypto.subtle.importKey(\"raw\", normalizedKey, { name: \"AES-CBC\" }, false, [\"decrypt\"]);\n  let ciphertext = base64.decode(ctb64);\n  let iv = base64.decode(ivb64);\n  let plaintext = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, cryptoKey, ciphertext);\n  let text = utf8Decoder.decode(plaintext);\n  return text;\n}\nfunction getNormalizedX(key) {\n  return key.slice(1, 33);\n}\n\n// nip05.ts\nvar nip05_exports = {};\n__export(nip05_exports, {\n  NIP05_REGEX: () => NIP05_REGEX,\n  queryProfile: () => queryProfile,\n  searchDomain: () => searchDomain,\n  useFetchImplementation: () => useFetchImplementation\n});\nvar NIP05_REGEX = /^(?:([\\w.+-]+)@)?([\\w.-]+)$/;\nvar _fetch;\ntry {\n  _fetch = fetch;\n} catch {\n}\nfunction useFetchImplementation(fetchImplementation) {\n  _fetch = fetchImplementation;\n}\nasync function searchDomain(domain, query = \"\") {\n  try {\n    let res = await (await _fetch(`https://${domain}/.well-known/nostr.json?name=${query}`)).json();\n    return res.names;\n  } catch (_) {\n    return {};\n  }\n}\nasync function queryProfile(fullname) {\n  const match = fullname.match(NIP05_REGEX);\n  if (!match)\n    return null;\n  const [_, name = \"_\", domain] = match;\n  try {\n    const res = await _fetch(`https://${domain}/.well-known/nostr.json?name=${name}`);\n    const { names, relays } = parseNIP05Result(await res.json());\n    const pubkey = names[name];\n    return pubkey ? { pubkey, relays: relays?.[pubkey] } : null;\n  } catch (_e) {\n    return null;\n  }\n}\nfunction parseNIP05Result(json) {\n  const result = {\n    names: {}\n  };\n  for (const [name, pubkey] of Object.entries(json.names)) {\n    if (typeof name === \"string\" && typeof pubkey === \"string\") {\n      result.names[name] = pubkey;\n    }\n  }\n  if (json.relays) {\n    result.relays = {};\n    for (const [pubkey, relays] of Object.entries(json.relays)) {\n      if (typeof pubkey === \"string\" && Array.isArray(relays)) {\n        result.relays[pubkey] = relays.filter((relay) => typeof relay === \"string\");\n      }\n    }\n  }\n  return result;\n}\n\n// nip06.ts\nvar nip06_exports = {};\n__export(nip06_exports, {\n  generateSeedWords: () => generateSeedWords,\n  privateKeyFromSeedWords: () => privateKeyFromSeedWords,\n  validateWords: () => validateWords\n});\nimport { bytesToHex as bytesToHex4 } from \"@noble/hashes/utils\";\nimport { wordlist } from \"@scure/bip39/wordlists/english\";\nimport { generateMnemonic, mnemonicToSeedSync, validateMnemonic } from \"@scure/bip39\";\nimport { HDKey } from \"@scure/bip32\";\nfunction privateKeyFromSeedWords(mnemonic, passphrase) {\n  let root = HDKey.fromMasterSeed(mnemonicToSeedSync(mnemonic, passphrase));\n  let privateKey = root.derive(`m/44'/1237'/0'/0/0`).privateKey;\n  if (!privateKey)\n    throw new Error(\"could not derive private key\");\n  return bytesToHex4(privateKey);\n}\nfunction generateSeedWords() {\n  return generateMnemonic(wordlist);\n}\nfunction validateWords(words) {\n  return validateMnemonic(words, wordlist);\n}\n\n// nip10.ts\nvar nip10_exports = {};\n__export(nip10_exports, {\n  parse: () => parse\n});\nfunction parse(event) {\n  const result = {\n    reply: void 0,\n    root: void 0,\n    mentions: [],\n    profiles: []\n  };\n  const eTags = [];\n  for (const tag of event.tags) {\n    if (tag[0] === \"e\" && tag[1]) {\n      eTags.push(tag);\n    }\n    if (tag[0] === \"p\" && tag[1]) {\n      result.profiles.push({\n        pubkey: tag[1],\n        relays: tag[2] ? [tag[2]] : []\n      });\n    }\n  }\n  for (let eTagIndex = 0; eTagIndex < eTags.length; eTagIndex++) {\n    const eTag = eTags[eTagIndex];\n    const [_, eTagEventId, eTagRelayUrl, eTagMarker] = eTag;\n    const eventPointer = {\n      id: eTagEventId,\n      relays: eTagRelayUrl ? [eTagRelayUrl] : []\n    };\n    const isFirstETag = eTagIndex === 0;\n    const isLastETag = eTagIndex === eTags.length - 1;\n    if (eTagMarker === \"root\") {\n      result.root = eventPointer;\n      continue;\n    }\n    if (eTagMarker === \"reply\") {\n      result.reply = eventPointer;\n      continue;\n    }\n    if (eTagMarker === \"mention\") {\n      result.mentions.push(eventPointer);\n      continue;\n    }\n    if (isFirstETag) {\n      result.root = eventPointer;\n      continue;\n    }\n    if (isLastETag) {\n      result.reply = eventPointer;\n      continue;\n    }\n    result.mentions.push(eventPointer);\n  }\n  return result;\n}\n\n// nip13.ts\nvar nip13_exports = {};\n__export(nip13_exports, {\n  getPow: () => getPow,\n  minePow: () => minePow\n});\nfunction getPow(hex) {\n  let count = 0;\n  for (let i = 0; i < hex.length; i++) {\n    const nibble = parseInt(hex[i], 16);\n    if (nibble === 0) {\n      count += 4;\n    } else {\n      count += Math.clz32(nibble) - 28;\n      break;\n    }\n  }\n  return count;\n}\nfunction minePow(unsigned, difficulty) {\n  let count = 0;\n  const event = unsigned;\n  const tag = [\"nonce\", count.toString(), difficulty.toString()];\n  event.tags.push(tag);\n  while (true) {\n    const now = Math.floor(new Date().getTime() / 1e3);\n    if (now !== event.created_at) {\n      count = 0;\n      event.created_at = now;\n    }\n    tag[1] = (++count).toString();\n    event.id = getEventHash(event);\n    if (getPow(event.id) >= difficulty) {\n      break;\n    }\n  }\n  return event;\n}\n\n// nip18.ts\nvar nip18_exports = {};\n__export(nip18_exports, {\n  finishRepostEvent: () => finishRepostEvent,\n  getRepostedEvent: () => getRepostedEvent,\n  getRepostedEventPointer: () => getRepostedEventPointer\n});\nfunction finishRepostEvent(t, reposted, relayUrl, privateKey) {\n  return finishEvent(\n    {\n      kind: 6 /* Repost */,\n      tags: [...t.tags ?? [], [\"e\", reposted.id, relayUrl], [\"p\", reposted.pubkey]],\n      content: t.content === \"\" ? \"\" : JSON.stringify(reposted),\n      created_at: t.created_at\n    },\n    privateKey\n  );\n}\nfunction getRepostedEventPointer(event) {\n  if (event.kind !== 6 /* Repost */) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i = event.tags.length - 1; i >= 0 && (lastETag === void 0 || lastPTag === void 0); i--) {\n    const tag = event.tags[i];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag?.[2]].filter((x) => typeof x === \"string\"),\n    author: lastPTag?.[1]\n  };\n}\nfunction getRepostedEvent(event, { skipVerification } = {}) {\n  const pointer = getRepostedEventPointer(event);\n  if (pointer === void 0 || event.content === \"\") {\n    return void 0;\n  }\n  let repostedEvent;\n  try {\n    repostedEvent = JSON.parse(event.content);\n  } catch (error) {\n    return void 0;\n  }\n  if (repostedEvent.id !== pointer.id) {\n    return void 0;\n  }\n  if (!skipVerification && !verifySignature(repostedEvent)) {\n    return void 0;\n  }\n  return repostedEvent;\n}\n\n// nip21.ts\nvar nip21_exports = {};\n__export(nip21_exports, {\n  NOSTR_URI_REGEX: () => NOSTR_URI_REGEX,\n  parse: () => parse2,\n  test: () => test\n});\nvar NOSTR_URI_REGEX = new RegExp(`nostr:(${BECH32_REGEX.source})`);\nfunction test(value) {\n  return typeof value === \"string\" && new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(value);\n}\nfunction parse2(uri) {\n  const match = uri.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));\n  if (!match)\n    throw new Error(`Invalid Nostr URI: ${uri}`);\n  return {\n    uri: match[0],\n    value: match[1],\n    decoded: decode(match[1])\n  };\n}\n\n// nip25.ts\nvar nip25_exports = {};\n__export(nip25_exports, {\n  finishReactionEvent: () => finishReactionEvent,\n  getReactedEventPointer: () => getReactedEventPointer\n});\nfunction finishReactionEvent(t, reacted, privateKey) {\n  const inheritedTags = reacted.tags.filter((tag) => tag.length >= 2 && (tag[0] === \"e\" || tag[0] === \"p\"));\n  return finishEvent(\n    {\n      ...t,\n      kind: 7 /* Reaction */,\n      tags: [...t.tags ?? [], ...inheritedTags, [\"e\", reacted.id], [\"p\", reacted.pubkey]],\n      content: t.content ?? \"+\"\n    },\n    privateKey\n  );\n}\nfunction getReactedEventPointer(event) {\n  if (event.kind !== 7 /* Reaction */) {\n    return void 0;\n  }\n  let lastETag;\n  let lastPTag;\n  for (let i = event.tags.length - 1; i >= 0 && (lastETag === void 0 || lastPTag === void 0); i--) {\n    const tag = event.tags[i];\n    if (tag.length >= 2) {\n      if (tag[0] === \"e\" && lastETag === void 0) {\n        lastETag = tag;\n      } else if (tag[0] === \"p\" && lastPTag === void 0) {\n        lastPTag = tag;\n      }\n    }\n  }\n  if (lastETag === void 0 || lastPTag === void 0) {\n    return void 0;\n  }\n  return {\n    id: lastETag[1],\n    relays: [lastETag[2], lastPTag[2]].filter((x) => x !== void 0),\n    author: lastPTag[1]\n  };\n}\n\n// nip26.ts\nvar nip26_exports = {};\n__export(nip26_exports, {\n  createDelegation: () => createDelegation,\n  getDelegator: () => getDelegator\n});\nimport { schnorr as schnorr3 } from \"@noble/curves/secp256k1\";\nimport { bytesToHex as bytesToHex5 } from \"@noble/hashes/utils\";\nimport { sha256 as sha2562 } from \"@noble/hashes/sha256\";\nfunction createDelegation(privateKey, parameters) {\n  let conditions = [];\n  if ((parameters.kind || -1) >= 0)\n    conditions.push(`kind=${parameters.kind}`);\n  if (parameters.until)\n    conditions.push(`created_at<${parameters.until}`);\n  if (parameters.since)\n    conditions.push(`created_at>${parameters.since}`);\n  let cond = conditions.join(\"&\");\n  if (cond === \"\")\n    throw new Error(\"refusing to create a delegation without any conditions\");\n  let sighash = sha2562(utf8Encoder.encode(`nostr:delegation:${parameters.pubkey}:${cond}`));\n  let sig = bytesToHex5(schnorr3.sign(sighash, privateKey));\n  return {\n    from: getPublicKey(privateKey),\n    to: parameters.pubkey,\n    cond,\n    sig\n  };\n}\nfunction getDelegator(event) {\n  let tag = event.tags.find((tag2) => tag2[0] === \"delegation\" && tag2.length >= 4);\n  if (!tag)\n    return null;\n  let pubkey = tag[1];\n  let cond = tag[2];\n  let sig = tag[3];\n  let conditions = cond.split(\"&\");\n  for (let i = 0; i < conditions.length; i++) {\n    let [key, operator, value] = conditions[i].split(/\\b/);\n    if (key === \"kind\" && operator === \"=\" && event.kind === parseInt(value))\n      continue;\n    else if (key === \"created_at\" && operator === \"<\" && event.created_at < parseInt(value))\n      continue;\n    else if (key === \"created_at\" && operator === \">\" && event.created_at > parseInt(value))\n      continue;\n    else\n      return null;\n  }\n  let sighash = sha2562(utf8Encoder.encode(`nostr:delegation:${event.pubkey}:${cond}`));\n  if (!schnorr3.verify(sig, sighash, pubkey))\n    return null;\n  return pubkey;\n}\n\n// nip27.ts\nvar nip27_exports = {};\n__export(nip27_exports, {\n  matchAll: () => matchAll,\n  regex: () => regex,\n  replaceAll: () => replaceAll\n});\nvar regex = () => new RegExp(`\\\\b${NOSTR_URI_REGEX.source}\\\\b`, \"g\");\nfunction* matchAll(content) {\n  const matches = content.matchAll(regex());\n  for (const match of matches) {\n    try {\n      const [uri, value] = match;\n      yield {\n        uri,\n        value,\n        decoded: decode(value),\n        start: match.index,\n        end: match.index + uri.length\n      };\n    } catch (_e) {\n    }\n  }\n}\nfunction replaceAll(content, replacer) {\n  return content.replaceAll(regex(), (uri, value) => {\n    return replacer({\n      uri,\n      value,\n      decoded: decode(value)\n    });\n  });\n}\n\n// nip28.ts\nvar nip28_exports = {};\n__export(nip28_exports, {\n  channelCreateEvent: () => channelCreateEvent,\n  channelHideMessageEvent: () => channelHideMessageEvent,\n  channelMessageEvent: () => channelMessageEvent,\n  channelMetadataEvent: () => channelMetadataEvent,\n  channelMuteUserEvent: () => channelMuteUserEvent\n});\nvar channelCreateEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finishEvent(\n    {\n      kind: 40 /* ChannelCreation */,\n      tags: [...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMetadataEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finishEvent(\n    {\n      kind: 41 /* ChannelMetadata */,\n      tags: [[\"e\", t.channel_create_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMessageEvent = (t, privateKey) => {\n  const tags = [[\"e\", t.channel_create_event_id, t.relay_url, \"root\"]];\n  if (t.reply_to_channel_message_event_id) {\n    tags.push([\"e\", t.reply_to_channel_message_event_id, t.relay_url, \"reply\"]);\n  }\n  return finishEvent(\n    {\n      kind: 42 /* ChannelMessage */,\n      tags: [...tags, ...t.tags ?? []],\n      content: t.content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelHideMessageEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finishEvent(\n    {\n      kind: 43 /* ChannelHideMessage */,\n      tags: [[\"e\", t.channel_message_event_id], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\nvar channelMuteUserEvent = (t, privateKey) => {\n  let content;\n  if (typeof t.content === \"object\") {\n    content = JSON.stringify(t.content);\n  } else if (typeof t.content === \"string\") {\n    content = t.content;\n  } else {\n    return void 0;\n  }\n  return finishEvent(\n    {\n      kind: 44 /* ChannelMuteUser */,\n      tags: [[\"p\", t.pubkey_to_mute], ...t.tags ?? []],\n      content,\n      created_at: t.created_at\n    },\n    privateKey\n  );\n};\n\n// nip39.ts\nvar nip39_exports = {};\n__export(nip39_exports, {\n  useFetchImplementation: () => useFetchImplementation2,\n  validateGithub: () => validateGithub\n});\nvar _fetch2;\ntry {\n  _fetch2 = fetch;\n} catch {\n}\nfunction useFetchImplementation2(fetchImplementation) {\n  _fetch2 = fetchImplementation;\n}\nasync function validateGithub(pubkey, username, proof) {\n  try {\n    let res = await (await _fetch2(`https://gist.github.com/${username}/${proof}/raw`)).text();\n    return res === `Verifying that I control the following Nostr public key: ${pubkey}`;\n  } catch (_) {\n    return false;\n  }\n}\n\n// nip42.ts\nvar nip42_exports = {};\n__export(nip42_exports, {\n  authenticate: () => authenticate\n});\nvar authenticate = async ({\n  challenge,\n  relay,\n  sign\n}) => {\n  const e = {\n    kind: 22242 /* ClientAuth */,\n    created_at: Math.floor(Date.now() / 1e3),\n    tags: [\n      [\"relay\", relay.url],\n      [\"challenge\", challenge]\n    ],\n    content: \"\"\n  };\n  return relay.auth(await sign(e));\n};\n\n// nip44.ts\nvar nip44_exports = {};\n__export(nip44_exports, {\n  decrypt: () => decrypt2,\n  encrypt: () => encrypt2,\n  utils: () => utils\n});\nimport { chacha20 } from \"@noble/ciphers/chacha\";\nimport { ensureBytes, equalBytes } from \"@noble/ciphers/utils\";\nimport { secp256k1 as secp256k12 } from \"@noble/curves/secp256k1\";\nimport { hkdf } from \"@noble/hashes/hkdf\";\nimport { hmac } from \"@noble/hashes/hmac\";\nimport { sha256 as sha2563 } from \"@noble/hashes/sha256\";\nimport { concatBytes as concatBytes2, randomBytes as randomBytes2 } from \"@noble/hashes/utils\";\nimport { base64 as base642 } from \"@scure/base\";\nvar utils = {\n  v2: {\n    maxPlaintextSize: 65536 - 128,\n    minCiphertextSize: 100,\n    maxCiphertextSize: 102400,\n    getConversationKey(privkeyA, pubkeyB) {\n      const key = secp256k12.getSharedSecret(privkeyA, \"02\" + pubkeyB);\n      return key.subarray(1, 33);\n    },\n    getMessageKeys(conversationKey, salt) {\n      const keys = hkdf(sha2563, conversationKey, salt, \"nip44-v2\", 76);\n      return {\n        encryption: keys.subarray(0, 32),\n        nonce: keys.subarray(32, 44),\n        auth: keys.subarray(44, 76)\n      };\n    },\n    calcPadding(len) {\n      if (!Number.isSafeInteger(len) || len < 0)\n        throw new Error(\"expected positive integer\");\n      if (len <= 32)\n        return 32;\n      const nextpower = 1 << Math.floor(Math.log2(len - 1)) + 1;\n      const chunk = nextpower <= 256 ? 32 : nextpower / 8;\n      return chunk * (Math.floor((len - 1) / chunk) + 1);\n    },\n    pad(unpadded) {\n      const unpaddedB = utf8Encoder.encode(unpadded);\n      const len = unpaddedB.length;\n      if (len < 1 || len >= utils.v2.maxPlaintextSize)\n        throw new Error(\"invalid plaintext length: must be between 1b and 64KB\");\n      const paddedLen = utils.v2.calcPadding(len);\n      const zeros = new Uint8Array(paddedLen - len);\n      const lenBuf = new Uint8Array(2);\n      new DataView(lenBuf.buffer).setUint16(0, len);\n      return concatBytes2(lenBuf, unpaddedB, zeros);\n    },\n    unpad(padded) {\n      const unpaddedLen = new DataView(padded.buffer).getUint16(0);\n      const unpadded = padded.subarray(2, 2 + unpaddedLen);\n      if (unpaddedLen === 0 || unpadded.length !== unpaddedLen || padded.length !== 2 + utils.v2.calcPadding(unpaddedLen))\n        throw new Error(\"invalid padding\");\n      return utf8Decoder.decode(unpadded);\n    }\n  }\n};\nfunction encrypt2(key, plaintext, options = {}) {\n  const version = options.version ?? 2;\n  if (version !== 2)\n    throw new Error(\"unknown encryption version \" + version);\n  const salt = options.salt ?? randomBytes2(32);\n  ensureBytes(salt, 32);\n  const keys = utils.v2.getMessageKeys(key, salt);\n  const padded = utils.v2.pad(plaintext);\n  const ciphertext = chacha20(keys.encryption, keys.nonce, padded);\n  const mac = hmac(sha2563, keys.auth, ciphertext);\n  return base642.encode(concatBytes2(new Uint8Array([version]), salt, ciphertext, mac));\n}\nfunction decrypt2(key, ciphertext) {\n  const u = utils.v2;\n  ensureBytes(key, 32);\n  const clen = ciphertext.length;\n  if (clen < u.minCiphertextSize || clen >= u.maxCiphertextSize)\n    throw new Error(\"invalid ciphertext length: \" + clen);\n  if (ciphertext[0] === \"#\")\n    throw new Error(\"unknown encryption version\");\n  let data;\n  try {\n    data = base642.decode(ciphertext);\n  } catch (error) {\n    throw new Error(\"invalid base64: \" + error.message);\n  }\n  const vers = data.subarray(0, 1)[0];\n  if (vers !== 2)\n    throw new Error(\"unknown encryption version \" + vers);\n  const salt = data.subarray(1, 33);\n  const ciphertext_ = data.subarray(33, -32);\n  const mac = data.subarray(-32);\n  const keys = u.getMessageKeys(key, salt);\n  const calculatedMac = hmac(sha2563, keys.auth, ciphertext_);\n  if (!equalBytes(calculatedMac, mac))\n    throw new Error(\"invalid MAC\");\n  const padded = chacha20(keys.encryption, keys.nonce, ciphertext_);\n  return u.unpad(padded);\n}\n\n// nip47.ts\nvar nip47_exports = {};\n__export(nip47_exports, {\n  makeNwcRequestEvent: () => makeNwcRequestEvent,\n  parseConnectionString: () => parseConnectionString\n});\nfunction parseConnectionString(connectionString) {\n  const { pathname, searchParams } = new URL(connectionString);\n  const pubkey = pathname;\n  const relay = searchParams.get(\"relay\");\n  const secret = searchParams.get(\"secret\");\n  if (!pubkey || !relay || !secret) {\n    throw new Error(\"invalid connection string\");\n  }\n  return { pubkey, relay, secret };\n}\nasync function makeNwcRequestEvent({\n  pubkey,\n  secret,\n  invoice\n}) {\n  const content = {\n    method: \"pay_invoice\",\n    params: {\n      invoice\n    }\n  };\n  const encryptedContent = await encrypt(secret, pubkey, JSON.stringify(content));\n  const eventTemplate = {\n    kind: 23194 /* NwcRequest */,\n    created_at: Math.round(Date.now() / 1e3),\n    content: encryptedContent,\n    tags: [[\"p\", pubkey]]\n  };\n  return finishEvent(eventTemplate, secret);\n}\n\n// nip57.ts\nvar nip57_exports = {};\n__export(nip57_exports, {\n  getZapEndpoint: () => getZapEndpoint,\n  makeZapReceipt: () => makeZapReceipt,\n  makeZapRequest: () => makeZapRequest,\n  useFetchImplementation: () => useFetchImplementation3,\n  validateZapRequest: () => validateZapRequest\n});\nimport { bech32 as bech322 } from \"@scure/base\";\nvar _fetch3;\ntry {\n  _fetch3 = fetch;\n} catch {\n}\nfunction useFetchImplementation3(fetchImplementation) {\n  _fetch3 = fetchImplementation;\n}\nasync function getZapEndpoint(metadata) {\n  try {\n    let lnurl = \"\";\n    let { lud06, lud16 } = JSON.parse(metadata.content);\n    if (lud06) {\n      let { words } = bech322.decode(lud06, 1e3);\n      let data = bech322.fromWords(words);\n      lnurl = utf8Decoder.decode(data);\n    } else if (lud16) {\n      let [name, domain] = lud16.split(\"@\");\n      lnurl = `https://${domain}/.well-known/lnurlp/${name}`;\n    } else {\n      return null;\n    }\n    let res = await _fetch3(lnurl);\n    let body = await res.json();\n    if (body.allowsNostr && body.nostrPubkey) {\n      return body.callback;\n    }\n  } catch (err) {\n  }\n  return null;\n}\nfunction makeZapRequest({\n  profile,\n  event,\n  amount,\n  relays,\n  comment = \"\"\n}) {\n  if (!amount)\n    throw new Error(\"amount not given\");\n  if (!profile)\n    throw new Error(\"profile not given\");\n  let zr = {\n    kind: 9734,\n    created_at: Math.round(Date.now() / 1e3),\n    content: comment,\n    tags: [\n      [\"p\", profile],\n      [\"amount\", amount.toString()],\n      [\"relays\", ...relays]\n    ]\n  };\n  if (event) {\n    zr.tags.push([\"e\", event]);\n  }\n  return zr;\n}\nfunction validateZapRequest(zapRequestString) {\n  let zapRequest;\n  try {\n    zapRequest = JSON.parse(zapRequestString);\n  } catch (err) {\n    return \"Invalid zap request JSON.\";\n  }\n  if (!validateEvent(zapRequest))\n    return \"Zap request is not a valid Nostr event.\";\n  if (!verifySignature(zapRequest))\n    return \"Invalid signature on zap request.\";\n  let p = zapRequest.tags.find(([t, v]) => t === \"p\" && v);\n  if (!p)\n    return \"Zap request doesn't have a 'p' tag.\";\n  if (!p[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'p' tag is not valid hex.\";\n  let e = zapRequest.tags.find(([t, v]) => t === \"e\" && v);\n  if (e && !e[1].match(/^[a-f0-9]{64}$/))\n    return \"Zap request 'e' tag is not valid hex.\";\n  let relays = zapRequest.tags.find(([t, v]) => t === \"relays\" && v);\n  if (!relays)\n    return \"Zap request doesn't have a 'relays' tag.\";\n  return null;\n}\nfunction makeZapReceipt({\n  zapRequest,\n  preimage,\n  bolt11,\n  paidAt\n}) {\n  let zr = JSON.parse(zapRequest);\n  let tagsFromZapRequest = zr.tags.filter(([t]) => t === \"e\" || t === \"p\" || t === \"a\");\n  let zap = {\n    kind: 9735,\n    created_at: Math.round(paidAt.getTime() / 1e3),\n    content: \"\",\n    tags: [...tagsFromZapRequest, [\"bolt11\", bolt11], [\"description\", zapRequest]]\n  };\n  if (preimage) {\n    zap.tags.push([\"preimage\", preimage]);\n  }\n  return zap;\n}\n\n// nip98.ts\nvar nip98_exports = {};\n__export(nip98_exports, {\n  getToken: () => getToken,\n  unpackEventFromToken: () => unpackEventFromToken,\n  validateEvent: () => validateEvent2,\n  validateToken: () => validateToken\n});\nimport { base64 as base643 } from \"@scure/base\";\nvar _authorizationScheme = \"Nostr \";\nasync function getToken(loginUrl, httpMethod, sign, includeAuthorizationScheme = false) {\n  if (!loginUrl || !httpMethod)\n    throw new Error(\"Missing loginUrl or httpMethod\");\n  const event = getBlankEvent(27235 /* HttpAuth */);\n  event.tags = [\n    [\"u\", loginUrl],\n    [\"method\", httpMethod]\n  ];\n  event.created_at = Math.round(new Date().getTime() / 1e3);\n  const signedEvent = await sign(event);\n  const authorizationScheme = includeAuthorizationScheme ? _authorizationScheme : \"\";\n  return authorizationScheme + base643.encode(utf8Encoder.encode(JSON.stringify(signedEvent)));\n}\nasync function validateToken(token, url, method) {\n  const event = await unpackEventFromToken(token).catch((error) => {\n    throw error;\n  });\n  const valid = await validateEvent2(event, url, method).catch((error) => {\n    throw error;\n  });\n  return valid;\n}\nasync function unpackEventFromToken(token) {\n  if (!token) {\n    throw new Error(\"Missing token\");\n  }\n  token = token.replace(_authorizationScheme, \"\");\n  const eventB64 = utf8Decoder.decode(base643.decode(token));\n  if (!eventB64 || eventB64.length === 0 || !eventB64.startsWith(\"{\")) {\n    throw new Error(\"Invalid token\");\n  }\n  const event = JSON.parse(eventB64);\n  return event;\n}\nasync function validateEvent2(event, url, method) {\n  if (!event) {\n    throw new Error(\"Invalid nostr event\");\n  }\n  if (!verifySignature(event)) {\n    throw new Error(\"Invalid nostr event, signature invalid\");\n  }\n  if (event.kind !== 27235 /* HttpAuth */) {\n    throw new Error(\"Invalid nostr event, kind invalid\");\n  }\n  if (!event.created_at) {\n    throw new Error(\"Invalid nostr event, created_at invalid\");\n  }\n  if (Math.round(new Date().getTime() / 1e3) - event.created_at > 60) {\n    throw new Error(\"Invalid nostr event, expired\");\n  }\n  const urlTag = event.tags.find((t) => t[0] === \"u\");\n  if (urlTag?.length !== 1 && urlTag?.[1] !== url) {\n    throw new Error(\"Invalid nostr event, url tag invalid\");\n  }\n  const methodTag = event.tags.find((t) => t[0] === \"method\");\n  if (methodTag?.length !== 1 && methodTag?.[1].toLowerCase() !== method.toLowerCase()) {\n    throw new Error(\"Invalid nostr event, method tag invalid\");\n  }\n  return true;\n}\nexport {\n  Kind,\n  SimplePool,\n  eventsGenerator,\n  finishEvent,\n  fakejson_exports as fj,\n  generatePrivateKey,\n  getBlankEvent,\n  getEventHash,\n  getPublicKey,\n  getSignature,\n  matchFilter,\n  matchFilters,\n  mergeFilters,\n  nip04_exports as nip04,\n  nip05_exports as nip05,\n  nip06_exports as nip06,\n  nip10_exports as nip10,\n  nip13_exports as nip13,\n  nip18_exports as nip18,\n  nip19_exports as nip19,\n  nip21_exports as nip21,\n  nip25_exports as nip25,\n  nip26_exports as nip26,\n  nip27_exports as nip27,\n  nip28_exports as nip28,\n  nip39_exports as nip39,\n  nip42_exports as nip42,\n  nip44_exports as nip44,\n  nip47_exports as nip47,\n  nip57_exports as nip57,\n  nip98_exports as nip98,\n  parseReferences,\n  relayInit,\n  serializeEvent,\n  signEvent,\n  utils_exports as utils,\n  validateEvent,\n  verifiedSymbol,\n  verifySignature\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=types.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.bakeCollectionVariadic = exports.bakeCollectionAwait = exports.bakeCollection = exports.BAKED_EMPTY_FUNC = void 0;\nexports.BAKED_EMPTY_FUNC = (function () { });\nvar FORLOOP_FALLBACK = 1500;\nfunction generateArgsDefCode(numArgs) {\n    var argsDefCode = '';\n    if (numArgs === 0)\n        return argsDefCode;\n    for (var i = 0; i < numArgs - 1; ++i) {\n        argsDefCode += ('arg' + String(i) + ', ');\n    }\n    argsDefCode += ('arg' + String(numArgs - 1));\n    return argsDefCode;\n}\nfunction generateBodyPartsCode(argsDefCode, collectionLength) {\n    var funcDefCode = '', funcCallCode = '';\n    for (var i = 0; i < collectionLength; ++i) {\n        funcDefCode += \"var f\".concat(i, \" = collection[\").concat(i, \"];\\n\");\n        funcCallCode += \"f\".concat(i, \"(\").concat(argsDefCode, \")\\n\");\n    }\n    return { funcDefCode: funcDefCode, funcCallCode: funcCallCode };\n}\nfunction generateBodyPartsVariadicCode(collectionLength) {\n    var funcDefCode = '', funcCallCode = '';\n    for (var i = 0; i < collectionLength; ++i) {\n        funcDefCode += \"var f\".concat(i, \" = collection[\").concat(i, \"];\\n\");\n        funcCallCode += \"f\".concat(i, \".apply(undefined, arguments)\\n\");\n    }\n    return { funcDefCode: funcDefCode, funcCallCode: funcCallCode };\n}\nfunction bakeCollection(collection, fixedArgsNum) {\n    if (collection.length === 0)\n        return exports.BAKED_EMPTY_FUNC;\n    else if (collection.length === 1)\n        return collection[0];\n    var funcFactoryCode;\n    if (collection.length < FORLOOP_FALLBACK) {\n        var argsDefCode = generateArgsDefCode(fixedArgsNum);\n        var _a = generateBodyPartsCode(argsDefCode, collection.length), funcDefCode = _a.funcDefCode, funcCallCode = _a.funcCallCode;\n        funcFactoryCode = \"(function(collection) {\\n            \".concat(funcDefCode, \"\\n            collection = undefined;\\n            return (function(\").concat(argsDefCode, \") {\\n                \").concat(funcCallCode, \"\\n            });\\n        })\");\n    }\n    else {\n        var argsDefCode = generateArgsDefCode(fixedArgsNum);\n        // loop unroll\n        if (collection.length % 10 === 0) {\n            funcFactoryCode = \"(function(collection) {\\n                return (function(\".concat(argsDefCode, \") {\\n                    for (var i = 0; i < collection.length; i += 10) {\\n                        collection[i](\").concat(argsDefCode, \");\\n                        collection[i+1](\").concat(argsDefCode, \");\\n                        collection[i+2](\").concat(argsDefCode, \");\\n                        collection[i+3](\").concat(argsDefCode, \");\\n                        collection[i+4](\").concat(argsDefCode, \");\\n                        collection[i+5](\").concat(argsDefCode, \");\\n                        collection[i+6](\").concat(argsDefCode, \");\\n                        collection[i+7](\").concat(argsDefCode, \");\\n                        collection[i+8](\").concat(argsDefCode, \");\\n                        collection[i+9](\").concat(argsDefCode, \");\\n                    }\\n                });\\n            })\");\n        }\n        else if (collection.length % 4 === 0) {\n            funcFactoryCode = \"(function(collection) {\\n                return (function(\".concat(argsDefCode, \") {\\n                    for (var i = 0; i < collection.length; i += 4) {\\n                        collection[i](\").concat(argsDefCode, \");\\n                        collection[i+1](\").concat(argsDefCode, \");\\n                        collection[i+2](\").concat(argsDefCode, \");\\n                        collection[i+3](\").concat(argsDefCode, \");\\n                    }\\n                });\\n            })\");\n        }\n        else if (collection.length % 3 === 0) {\n            funcFactoryCode = \"(function(collection) {\\n                return (function(\".concat(argsDefCode, \") {\\n                    for (var i = 0; i < collection.length; i += 3) {\\n                        collection[i](\").concat(argsDefCode, \");\\n                        collection[i+1](\").concat(argsDefCode, \");\\n                        collection[i+2](\").concat(argsDefCode, \");\\n                    }\\n                });\\n            })\");\n        }\n        else {\n            funcFactoryCode = \"(function(collection) {\\n                return (function(\".concat(argsDefCode, \") {\\n                    for (var i = 0; i < collection.length; ++i) {\\n                        collection[i](\").concat(argsDefCode, \");\\n                    }\\n                });\\n            })\");\n        }\n    }\n    {\n        // isolate\n        var bakeCollection_1 = undefined;\n        var fixedArgsNum_1 = undefined;\n        var bakeCollectionVariadic_1 = undefined;\n        var bakeCollectionAwait_1 = undefined;\n        var funcFactory = eval(funcFactoryCode);\n        return funcFactory(collection);\n    }\n}\nexports.bakeCollection = bakeCollection;\nfunction bakeCollectionAwait(collection, fixedArgsNum) {\n    if (collection.length === 0)\n        return exports.BAKED_EMPTY_FUNC;\n    else if (collection.length === 1)\n        return collection[0];\n    var funcFactoryCode;\n    if (collection.length < FORLOOP_FALLBACK) {\n        var argsDefCode = generateArgsDefCode(fixedArgsNum);\n        var _a = generateBodyPartsCode(argsDefCode, collection.length), funcDefCode = _a.funcDefCode, funcCallCode = _a.funcCallCode;\n        funcFactoryCode = \"(function(collection) {\\n            \".concat(funcDefCode, \"\\n            collection = undefined;\\n            return (function(\").concat(argsDefCode, \") {\\n                return Promise.all([ \").concat(funcCallCode, \" ]);\\n            });\\n        })\");\n    }\n    else {\n        var argsDefCode = generateArgsDefCode(fixedArgsNum);\n        funcFactoryCode = \"(function(collection) {\\n            return (function(\".concat(argsDefCode, \") {\\n                var promises = Array(collection.length);\\n                for (var i = 0; i < collection.length; ++i) {\\n                    promises[i] = collection[i](\").concat(argsDefCode, \");\\n                }\\n                return Promise.all(promises);\\n            });\\n        })\");\n    }\n    {\n        // isolate\n        var bakeCollection_2 = undefined;\n        var fixedArgsNum_2 = undefined;\n        var bakeCollectionVariadic_2 = undefined;\n        var bakeCollectionAwait_2 = undefined;\n        var funcFactory = eval(funcFactoryCode);\n        return funcFactory(collection);\n    }\n}\nexports.bakeCollectionAwait = bakeCollectionAwait;\nfunction bakeCollectionVariadic(collection) {\n    if (collection.length === 0)\n        return exports.BAKED_EMPTY_FUNC;\n    else if (collection.length === 1)\n        return collection[0];\n    var funcFactoryCode;\n    if (collection.length < FORLOOP_FALLBACK) {\n        var _a = generateBodyPartsVariadicCode(collection.length), funcDefCode = _a.funcDefCode, funcCallCode = _a.funcCallCode;\n        funcFactoryCode = \"(function(collection) {\\n            \".concat(funcDefCode, \"\\n            collection = undefined;\\n            return (function() {\\n                \").concat(funcCallCode, \"\\n            });\\n        })\");\n    }\n    else {\n        funcFactoryCode = \"(function(collection) {\\n            return (function() {\\n                for (var i = 0; i < collection.length; ++i) {\\n                    collection[i].apply(undefined, arguments);\\n                }\\n            });\\n        })\";\n    }\n    {\n        // isolate\n        var bakeCollection_3 = undefined;\n        var fixedArgsNum = undefined;\n        var bakeCollectionVariadic_3 = undefined;\n        var bakeCollectionAwait_3 = undefined;\n        var funcFactory = eval(funcFactoryCode);\n        return funcFactory(collection);\n    }\n}\nexports.bakeCollectionVariadic = bakeCollectionVariadic;\n//# sourceMappingURL=bake-collection.js.map","\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TaskCollection = exports._fast_remove_single = void 0;\nvar bake_collection_1 = require(\"./bake-collection\");\nfunction push_norebuild(a, b /*, ...func: Func[] */) {\n    var len = this.length;\n    if (len > 1) { // tasks is array\n        if (b) { // if multiple args\n            var _a;\n            (_a = this._tasks).push.apply(_a, arguments);\n            this.length += arguments.length;\n        }\n        else { // if single arg (most often case)\n            this._tasks.push(a);\n            this.length++;\n        }\n    }\n    else { // tasks is (function or null)\n        if (b) { // if multiple args\n            if (len === 1) { // if this._tasks is function\n                var newAr = Array(1 + arguments.length);\n                newAr.push(newAr);\n                newAr.push.apply(newAr, arguments);\n                this._tasks = newAr;\n            }\n            else {\n                var newAr = Array(arguments.length);\n                newAr.push.apply(newAr, arguments);\n                this._tasks = newAr;\n            }\n            this.length += arguments.length;\n        }\n        else { // if single arg (most often case)\n            if (len === 1)\n                this._tasks = [this._tasks, a];\n            else\n                this._tasks = a;\n            this.length++;\n        }\n    }\n}\nfunction push_rebuild(a, b /*, ...func: Func[] */) {\n    var len = this.length;\n    if (len > 1) { // tasks is array\n        if (b) { // if multiple args\n            var _a;\n            (_a = this._tasks).push.apply(_a, arguments);\n            this.length += arguments.length;\n        }\n        else { // if single arg (most often case)\n            this._tasks.push(a);\n            this.length++;\n        }\n    }\n    else { // tasks is (function or null)\n        if (b) { // if multiple args\n            if (len === 1) { // if this._tasks is function\n                var newAr = Array(1 + arguments.length);\n                newAr.push(newAr);\n                newAr.push.apply(newAr, arguments);\n                this._tasks = newAr;\n            }\n            else {\n                var newAr = Array(arguments.length);\n                newAr.push.apply(newAr, arguments);\n                this._tasks = newAr;\n            }\n            this.length += arguments.length;\n        }\n        else { // if single arg (most often case)\n            if (len === 1)\n                this._tasks = [this._tasks, a];\n            else\n                this._tasks = a;\n            this.length++;\n        }\n    }\n    if (this.firstEmitBuildStrategy)\n        this.call = rebuild_on_first_call;\n    else\n        this.rebuild();\n}\nfunction _fast_remove_single(arr, index) {\n    if (index === -1)\n        return;\n    if (index === 0)\n        arr.shift();\n    else if (index === arr.length - 1)\n        arr.length = arr.length - 1;\n    else\n        arr.splice(index, 1);\n}\nexports._fast_remove_single = _fast_remove_single;\nfunction removeLast_norebuild(a) {\n    if (this.length === 0)\n        return;\n    if (this.length === 1) {\n        if (this._tasks === a) {\n            this.length = 0;\n        }\n    }\n    else {\n        _fast_remove_single(this._tasks, this._tasks.lastIndexOf(a));\n        if (this._tasks.length === 1) {\n            this._tasks = this._tasks[0];\n            this.length = 1;\n        }\n        else\n            this.length = this._tasks.length;\n    }\n}\nfunction removeLast_rebuild(a) {\n    if (this.length === 0)\n        return;\n    if (this.length === 1) {\n        if (this._tasks === a) {\n            this.length = 0;\n        }\n        if (this.firstEmitBuildStrategy) {\n            this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n            return;\n        }\n        else {\n            this.rebuild();\n            return;\n        }\n    }\n    else {\n        _fast_remove_single(this._tasks, this._tasks.lastIndexOf(a));\n        if (this._tasks.length === 1) {\n            this._tasks = this._tasks[0];\n            this.length = 1;\n        }\n        else\n            this.length = this._tasks.length;\n    }\n    if (this.firstEmitBuildStrategy)\n        this.call = rebuild_on_first_call;\n    else\n        this.rebuild();\n}\nfunction insert_norebuild(index) {\n    var _b;\n    var func = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        func[_i - 1] = arguments[_i];\n    }\n    if (this.length === 0) {\n        this._tasks = func;\n        this.length = 1;\n    }\n    else if (this.length === 1) {\n        func.unshift(this._tasks);\n        this._tasks = func;\n        this.length = this._tasks.length;\n    }\n    else {\n        (_b = this._tasks).splice.apply(_b, __spreadArray([index, 0], func, false));\n        this.length = this._tasks.length;\n    }\n}\nfunction insert_rebuild(index) {\n    var _b;\n    var func = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        func[_i - 1] = arguments[_i];\n    }\n    if (this.length === 0) {\n        this._tasks = func;\n        this.length = 1;\n    }\n    else if (this.length === 1) {\n        func.unshift(this._tasks);\n        this._tasks = func;\n        this.length = this._tasks.length;\n    }\n    else {\n        (_b = this._tasks).splice.apply(_b, __spreadArray([index, 0], func, false));\n        this.length = this._tasks.length;\n    }\n    if (this.firstEmitBuildStrategy)\n        this.call = rebuild_on_first_call;\n    else\n        this.rebuild();\n}\nfunction rebuild_noawait() {\n    if (this.length === 0)\n        this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n    else if (this.length === 1)\n        this.call = this._tasks;\n    else\n        this.call = (0, bake_collection_1.bakeCollection)(this._tasks, this.argsNum);\n}\nfunction rebuild_await() {\n    if (this.length === 0)\n        this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n    else if (this.length === 1)\n        this.call = this._tasks;\n    else\n        this.call = (0, bake_collection_1.bakeCollectionAwait)(this._tasks, this.argsNum);\n}\nfunction rebuild_on_first_call() {\n    this.rebuild();\n    this.call.apply(undefined, arguments);\n}\nvar TaskCollection = /** @class */ (function () {\n    function TaskCollection(argsNum, autoRebuild, initialTasks, awaitTasks) {\n        if (autoRebuild === void 0) { autoRebuild = true; }\n        if (initialTasks === void 0) { initialTasks = null; }\n        if (awaitTasks === void 0) { awaitTasks = false; }\n        this.awaitTasks = awaitTasks;\n        this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n        this.argsNum = argsNum;\n        this.firstEmitBuildStrategy = true;\n        if (awaitTasks)\n            this.rebuild = rebuild_await.bind(this);\n        else\n            this.rebuild = rebuild_noawait.bind(this);\n        this.setAutoRebuild(autoRebuild);\n        if (initialTasks) {\n            if (typeof initialTasks === 'function') {\n                this._tasks = initialTasks;\n                this.length = 1;\n            }\n            else {\n                this._tasks = initialTasks;\n                this.length = initialTasks.length;\n            }\n        }\n        else {\n            this._tasks = null;\n            this.length = 0;\n        }\n        if (autoRebuild)\n            this.rebuild();\n    }\n    return TaskCollection;\n}());\nexports.TaskCollection = TaskCollection;\nfunction fastClear() {\n    this._tasks = null;\n    this.length = 0;\n    this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n}\nfunction clear() {\n    this._tasks = null;\n    this.length = 0;\n    this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n}\nfunction growArgsNum(argsNum) {\n    if (this.argsNum < argsNum) {\n        this.argsNum = argsNum;\n        if (this.firstEmitBuildStrategy)\n            this.call = rebuild_on_first_call;\n        else\n            this.rebuild();\n    }\n}\nfunction setAutoRebuild(newVal) {\n    if (newVal) {\n        this.push = push_rebuild.bind(this);\n        this.insert = insert_rebuild.bind(this);\n        this.removeLast = removeLast_rebuild.bind(this);\n    }\n    else {\n        this.push = push_norebuild.bind(this);\n        this.insert = insert_norebuild.bind(this);\n        this.removeLast = removeLast_norebuild.bind(this);\n    }\n}\n;\nfunction tasksAsArray() {\n    if (this.length === 0)\n        return [];\n    if (this.length === 1)\n        return [this._tasks];\n    return this._tasks;\n}\nfunction setTasks(tasks) {\n    if (tasks.length === 0) {\n        this.length = 0;\n        this.call = bake_collection_1.BAKED_EMPTY_FUNC;\n    }\n    else if (tasks.length === 1) {\n        this.length = 1;\n        this.call = tasks[0];\n        this._tasks = tasks[0];\n    }\n    else {\n        this.length = tasks.length;\n        this._tasks = tasks;\n        if (this.firstEmitBuildStrategy)\n            this.call = rebuild_on_first_call;\n        else\n            this.rebuild();\n    }\n}\nTaskCollection.prototype.fastClear = fastClear;\nTaskCollection.prototype.clear = clear;\nTaskCollection.prototype.growArgsNum = growArgsNum;\nTaskCollection.prototype.setAutoRebuild = setAutoRebuild;\nTaskCollection.prototype.tasksAsArray = tasksAsArray;\nTaskCollection.prototype.setTasks = setTasks;\n//# sourceMappingURL=task-collection.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./task-collection\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.nullObj = void 0;\nfunction nullObj() {\n    var x = {};\n    x.__proto__ = null;\n    x.prototype = null;\n    return x;\n}\nexports.nullObj = nullObj;\n//# sourceMappingURL=utils.js.map","\"use strict\";\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EventEmitter = void 0;\nvar task_collection_1 = require(\"./task-collection\");\nvar utils_1 = require(\"./utils\");\nfunction emit(event, a, b, c, d, e) {\n    var ev = this.events[event];\n    if (ev) {\n        if (ev.length === 0)\n            return false;\n        if (ev.argsNum < 6) {\n            ev.call(a, b, c, d, e);\n        }\n        else {\n            ev.call.apply(undefined, arguments);\n        }\n        return true;\n    }\n    return false;\n}\nfunction emitHasOnce(event, a, b, c, d, e) {\n    var ev = this.events[event];\n    if (ev) {\n        if (ev.length === 0)\n            return false;\n        if (ev.argsNum < 6) {\n            ev.call(a, b, c, d, e);\n        }\n        else {\n            ev.call.apply(undefined, arguments);\n        }\n    }\n    var oev = this.onceEvents[event];\n    if (oev) {\n        if (typeof oev === 'function') {\n            this.onceEvents[event] = undefined;\n            if (arguments.length < 6) {\n                oev(a, b, c, d, e);\n            }\n            else {\n                oev.apply(undefined, arguments);\n            }\n        }\n        else {\n            var fncs = oev;\n            this.onceEvents[event] = undefined;\n            if (arguments.length < 6) {\n                for (var i = 0; i < fncs.length; ++i)\n                    fncs[i](a, b, c, d, e);\n            }\n            else {\n                for (var i = 0; i < fncs.length; ++i)\n                    fncs[i].apply(undefined, arguments);\n            }\n        }\n        return true;\n    }\n    return !!ev;\n}\n/** Implemented event emitter */\nvar EventEmitter = /** @class */ (function () {\n    function EventEmitter() {\n        this.events = (0, utils_1.nullObj)();\n        this.onceEvents = (0, utils_1.nullObj)();\n        this._symbolKeys = new Set;\n        this.maxListeners = Infinity;\n    }\n    Object.defineProperty(EventEmitter.prototype, \"_eventsCount\", {\n        get: function () {\n            return this.eventNames().length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return EventEmitter;\n}());\nexports.EventEmitter = EventEmitter;\nfunction once(event, listener) {\n    if (this.emit === emit) {\n        this.emit = emitHasOnce;\n    }\n    switch (typeof this.onceEvents[event]) {\n        case 'undefined':\n            this.onceEvents[event] = listener;\n            if (typeof event === 'symbol')\n                this._symbolKeys.add(event);\n            break;\n        case 'function':\n            this.onceEvents[event] = [this.onceEvents[event], listener];\n            break;\n        case 'object':\n            this.onceEvents[event].push(listener);\n    }\n    return this;\n}\nfunction addListener(event, listener, argsNum) {\n    if (argsNum === void 0) { argsNum = listener.length; }\n    if (typeof listener !== 'function')\n        throw new TypeError('The listener must be a function');\n    var evtmap = this.events[event];\n    if (!evtmap) {\n        this.events[event] = new task_collection_1.TaskCollection(argsNum, true, listener, false);\n        if (typeof event === 'symbol')\n            this._symbolKeys.add(event);\n    }\n    else {\n        evtmap.push(listener);\n        evtmap.growArgsNum(argsNum);\n        if (this.maxListeners !== Infinity && this.maxListeners <= evtmap.length)\n            console.warn(\"Maximum event listeners for \\\"\".concat(String(event), \"\\\" event!\"));\n    }\n    return this;\n}\nfunction removeListener(event, listener) {\n    var evt = this.events[event];\n    if (evt) {\n        evt.removeLast(listener);\n    }\n    var evto = this.onceEvents[event];\n    if (evto) {\n        if (typeof evto === 'function') {\n            this.onceEvents[event] = undefined;\n        }\n        else if (typeof evto === 'object') {\n            if (evto.length === 1 && evto[0] === listener) {\n                this.onceEvents[event] = undefined;\n            }\n            else {\n                (0, task_collection_1._fast_remove_single)(evto, evto.lastIndexOf(listener));\n            }\n        }\n    }\n    return this;\n}\nfunction addListenerBound(event, listener, bindTo, argsNum) {\n    if (bindTo === void 0) { bindTo = this; }\n    if (argsNum === void 0) { argsNum = listener.length; }\n    if (!this.boundFuncs)\n        this.boundFuncs = new Map;\n    var bound = listener.bind(bindTo);\n    this.boundFuncs.set(listener, bound);\n    return this.addListener(event, bound, argsNum);\n}\nfunction removeListenerBound(event, listener) {\n    var _a, _b;\n    var bound = (_a = this.boundFuncs) === null || _a === void 0 ? void 0 : _a.get(listener);\n    (_b = this.boundFuncs) === null || _b === void 0 ? void 0 : _b.delete(listener);\n    return this.removeListener(event, bound);\n}\nfunction hasListeners(event) {\n    return this.events[event] && !!this.events[event].length;\n}\nfunction prependListener(event, listener, argsNum) {\n    if (argsNum === void 0) { argsNum = listener.length; }\n    if (typeof listener !== 'function')\n        throw new TypeError('The listener must be a function');\n    var evtmap = this.events[event];\n    if (!evtmap || !(evtmap instanceof task_collection_1.TaskCollection)) {\n        evtmap = this.events[event] = new task_collection_1.TaskCollection(argsNum, true, listener, false);\n        if (typeof event === 'symbol')\n            this._symbolKeys.add(event);\n    }\n    else {\n        evtmap.insert(0, listener);\n        evtmap.growArgsNum(argsNum);\n        if (this.maxListeners !== Infinity && this.maxListeners <= evtmap.length)\n            console.warn(\"Maximum event listeners for \\\"\".concat(String(event), \"\\\" event!\"));\n    }\n    return this;\n}\nfunction prependOnceListener(event, listener) {\n    if (this.emit === emit) {\n        this.emit = emitHasOnce;\n    }\n    var evtmap = this.onceEvents[event];\n    if (!evtmap) {\n        this.onceEvents[event] = [listener];\n        if (typeof event === 'symbol')\n            this._symbolKeys.add(event);\n    }\n    else if (typeof evtmap !== 'object') {\n        this.onceEvents[event] = [listener, evtmap];\n        if (typeof event === 'symbol')\n            this._symbolKeys.add(event);\n    }\n    else {\n        evtmap.unshift(listener);\n        if (this.maxListeners !== Infinity && this.maxListeners <= evtmap.length) {\n            console.warn(\"Maximum event listeners for \\\"\".concat(String(event), \"\\\" once event!\"));\n        }\n    }\n    return this;\n}\nfunction removeAllListeners(event) {\n    if (event === undefined) {\n        this.events = (0, utils_1.nullObj)();\n        this.onceEvents = (0, utils_1.nullObj)();\n        this._symbolKeys = new Set;\n    }\n    else {\n        this.events[event] = undefined;\n        this.onceEvents[event] = undefined;\n        if (typeof event === 'symbol')\n            this._symbolKeys.delete(event);\n    }\n    return this;\n}\nfunction setMaxListeners(n) {\n    this.maxListeners = n;\n    return this;\n}\nfunction getMaxListeners() {\n    return this.maxListeners;\n}\nfunction listeners(event) {\n    if (this.emit === emit)\n        return this.events[event] ? this.events[event].tasksAsArray().slice() : [];\n    else {\n        if (this.events[event] && this.onceEvents[event]) {\n            return __spreadArray(__spreadArray([], this.events[event].tasksAsArray(), true), (typeof this.onceEvents[event] === 'function' ? [this.onceEvents[event]] : this.onceEvents[event]), true);\n        }\n        else if (this.events[event])\n            return this.events[event].tasksAsArray();\n        else if (this.onceEvents[event])\n            return (typeof this.onceEvents[event] === 'function' ? [this.onceEvents[event]] : this.onceEvents[event]);\n        else\n            return [];\n    }\n}\nfunction eventNames() {\n    var _this = this;\n    if (this.emit === emit) {\n        var keys = Object.keys(this.events);\n        return __spreadArray(__spreadArray([], keys, true), Array.from(this._symbolKeys), true).filter(function (x) { return (x in _this.events) && _this.events[x] && _this.events[x].length; });\n    }\n    else {\n        var keys = Object.keys(this.events).filter(function (x) { return _this.events[x] && _this.events[x].length; });\n        var keysO = Object.keys(this.onceEvents).filter(function (x) { return _this.onceEvents[x] && _this.onceEvents[x].length; });\n        return __spreadArray(__spreadArray(__spreadArray([], keys, true), keysO, true), Array.from(this._symbolKeys).filter(function (x) { return (((x in _this.events) && _this.events[x] && _this.events[x].length) ||\n            ((x in _this.onceEvents) && _this.onceEvents[x] && _this.onceEvents[x].length)); }), true);\n    }\n}\nfunction listenerCount(type) {\n    if (this.emit === emit)\n        return this.events[type] && this.events[type].length || 0;\n    else\n        return (this.events[type] && this.events[type].length || 0) + (this.onceEvents[type] && this.onceEvents[type].length || 0);\n}\nEventEmitter.prototype.emit = emit;\nEventEmitter.prototype.on = addListener;\nEventEmitter.prototype.once = once;\nEventEmitter.prototype.addListener = addListener;\nEventEmitter.prototype.removeListener = removeListener;\nEventEmitter.prototype.addListenerBound = addListenerBound;\nEventEmitter.prototype.removeListenerBound = removeListenerBound;\nEventEmitter.prototype.hasListeners = hasListeners;\nEventEmitter.prototype.prependListener = prependListener;\nEventEmitter.prototype.prependOnceListener = prependOnceListener;\nEventEmitter.prototype.off = removeListener;\nEventEmitter.prototype.removeAllListeners = removeAllListeners;\nEventEmitter.prototype.setMaxListeners = setMaxListeners;\nEventEmitter.prototype.getMaxListeners = getMaxListeners;\nEventEmitter.prototype.listeners = listeners;\nEventEmitter.prototype.eventNames = eventNames;\nEventEmitter.prototype.listenerCount = listenerCount;\n//# sourceMappingURL=ee.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n__exportStar(require(\"./types\"), exports);\n__exportStar(require(\"./ee\"), exports);\n//# sourceMappingURL=index.js.map","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\tcreateDebug.destroy = destroy;\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\t\tlet enableOverride = null;\n\t\tlet namespacesCache;\n\t\tlet enabledCache;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn '%';\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = createDebug.selectColor(namespace);\n\t\tdebug.extend = extend;\n\t\tdebug.destroy = createDebug.destroy; // XXX Temporary. Will be removed in the next major release.\n\n\t\tObject.defineProperty(debug, 'enabled', {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: false,\n\t\t\tget: () => {\n\t\t\t\tif (enableOverride !== null) {\n\t\t\t\t\treturn enableOverride;\n\t\t\t\t}\n\t\t\t\tif (namespacesCache !== createDebug.namespaces) {\n\t\t\t\t\tnamespacesCache = createDebug.namespaces;\n\t\t\t\t\tenabledCache = createDebug.enabled(namespace);\n\t\t\t\t}\n\n\t\t\t\treturn enabledCache;\n\t\t\t},\n\t\t\tset: v => {\n\t\t\t\tenableOverride = v;\n\t\t\t}\n\t\t});\n\n\t\t// Env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\treturn debug;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\t\tcreateDebug.namespaces = namespaces;\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tlet i;\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n\t\tconst len = split.length;\n\n\t\tfor (i = 0; i < len; i++) {\n\t\t\tif (!split[i]) {\n\t\t\t\t// ignore empty strings\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tnamespaces = split[i].replace(/\\*/g, '.*?');\n\n\t\t\tif (namespaces[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(new RegExp('^' + namespaces.slice(1) + '$'));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(new RegExp('^' + namespaces + '$'));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names.map(toNamespace),\n\t\t\t...createDebug.skips.map(toNamespace).map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tif (name[name.length - 1] === '*') {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet i;\n\t\tlet len;\n\n\t\tfor (i = 0, len = createDebug.skips.length; i < len; i++) {\n\t\t\tif (createDebug.skips[i].test(name)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0, len = createDebug.names.length; i < len; i++) {\n\t\t\tif (createDebug.names[i].test(name)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Convert regexp to namespace\n\t*\n\t* @param {RegExp} regxep\n\t* @return {String} namespace\n\t* @api private\n\t*/\n\tfunction toNamespace(regexp) {\n\t\treturn regexp.toString()\n\t\t\t.substring(2, regexp.toString().length - 2)\n\t\t\t.replace(/\\.\\*\\?$/, '*');\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\t/**\n\t* XXX DO NOT USE. This is a temporary stub function.\n\t* XXX It WILL be removed in the next major release.\n\t*/\n\tfunction destroy() {\n\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\nexports.destroy = (() => {\n\tlet warned = false;\n\n\treturn () => {\n\t\tif (!warned) {\n\t\t\twarned = true;\n\t\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t\t}\n\t};\n})();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.debug()` when available.\n * No-op when `console.debug` is not a \"function\".\n * If `console.debug` is not available, falls back\n * to `console.log`.\n *\n * @api public\n */\nexports.log = console.debug || console.log || (() => {});\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","function number(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error(`positive integer expected, not ${n}`);\n}\nfunction bool(b) {\n    if (typeof b !== 'boolean')\n        throw new Error(`boolean expected, not ${b}`);\n}\n// copied from utils\nexport function isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nfunction bytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Uint8Array expected');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error(`Uint8Array expected of length ${lengths}, not of length=${b.length}`);\n}\nfunction hash(h) {\n    if (typeof h !== 'function' || typeof h.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    number(h.outputLen);\n    number(h.blockLen);\n}\nfunction exists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\nfunction output(out, instance) {\n    bytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error(`digestInto() expects output buffer of length at least ${min}`);\n    }\n}\nexport { number, bool, bytes, hash, exists, output };\nconst assert = { number, bool, bytes, hash, exists, output };\nexport default assert;\n//# sourceMappingURL=_assert.js.map","export const crypto = typeof globalThis === 'object' && 'crypto' in globalThis ? globalThis.crypto : undefined;\n//# sourceMappingURL=crypto.js.map","/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nimport { crypto } from '@noble/hashes/crypto';\nimport { bytes as abytes } from './_assert.js';\n// export { isBytes } from './_assert.js';\n// We can't reuse isBytes from _assert, because somehow this causes huge perf issues\nexport function isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\n// Cast array to different type\nexport const u8 = (arr) => new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\nexport const u32 = (arr) => new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n// Cast array to view\nexport const createView = (arr) => new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n// The rotate right (circular right shift) operation for uint32\nexport const rotr = (word, shift) => (word << (32 - shift)) | (word >>> shift);\n// The rotate left (circular left shift) operation for uint32\nexport const rotl = (word, shift) => (word << shift) | ((word >>> (32 - shift)) >>> 0);\nexport const isLE = new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44;\n// The byte swap operation for uint32\nexport const byteSwap = (word) => ((word << 24) & 0xff000000) |\n    ((word << 8) & 0xff0000) |\n    ((word >>> 8) & 0xff00) |\n    ((word >>> 24) & 0xff);\n// Conditionally byte swap if on a big-endian platform\nexport const byteSwapIfBE = isLE ? (n) => n : (n) => byteSwap(n);\n// In place byte swap for Uint32Array\nexport function byteSwap32(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        arr[i] = byteSwap(arr[i]);\n    }\n}\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    abytes(bytes);\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\n// There is no setImmediate in browser and setTimeout is slow.\n// call of async fn will return Promise, which will be fullfiled only on\n// next scheduler queue processing step and this is exactly what we need.\nexport const nextTick = async () => { };\n// Returns control to thread each 'tick' ms to avoid blocking\nexport async function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await nextTick();\n        ts += diff;\n    }\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nexport function toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    abytes(data);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// For runtime check if class implements interface\nexport class Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nconst toStr = {}.toString;\nexport function checkOpts(defaults, opts) {\n    if (opts !== undefined && toStr.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\nexport function wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nexport function wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nexport function wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/**\n * Secure PRNG. Uses `crypto.getRandomValues`, which defers to OS.\n */\nexport function randomBytes(bytesLength = 32) {\n    if (crypto && typeof crypto.getRandomValues === 'function') {\n        return crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","import { exists, output } from './_assert.js';\nimport { Hash, createView, toBytes } from './utils.js';\n// Polyfill for Safari 14\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n// Choice: a ? b : c\nexport const Chi = (a, b, c) => (a & b) ^ (~a & c);\n// Majority function, true if any two inpust is true\nexport const Maj = (a, b, c) => (a & b) ^ (a & c) ^ (b & c);\n/**\n * Merkle-Damgard hash construction base class.\n * Could be used to create MD5, RIPEMD, SHA1, SHA2.\n */\nexport class HashMD extends Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = createView(this.buffer);\n    }\n    update(data) {\n        exists(this);\n        const { view, buffer, blockLen } = this;\n        data = toBytes(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = createView(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        exists(this);\n        output(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in\n        // current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = createView(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\n//# sourceMappingURL=_md.js.map","import { HashMD, Chi, Maj } from './_md.js';\nimport { rotr, wrapConstructor } from './utils.js';\n// SHA2-256 need to try 2^128 hashes to execute birthday attack.\n// BTC network is doing 2^67 hashes/sec as per early 2023.\n// Round constants:\n// first 32 bits of the fractional parts of the cube roots of the first 64 primes 2..311)\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n// Initial state:\n// first 32 bits of the fractional parts of the square roots of the first 8 primes 2..19\n// prettier-ignore\nconst SHA256_IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n// Temporary buffer, not used to store anything between runs\n// Named this way because it matches specification.\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends HashMD {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = SHA256_IV[0] | 0;\n        this.B = SHA256_IV[1] | 0;\n        this.C = SHA256_IV[2] | 0;\n        this.D = SHA256_IV[3] | 0;\n        this.E = SHA256_IV[4] | 0;\n        this.F = SHA256_IV[5] | 0;\n        this.G = SHA256_IV[6] | 0;\n        this.H = SHA256_IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = rotr(W15, 7) ^ rotr(W15, 18) ^ (W15 >>> 3);\n            const s1 = rotr(W2, 17) ^ rotr(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = rotr(E, 6) ^ rotr(E, 11) ^ rotr(E, 25);\n            const T1 = (H + sigma1 + Chi(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = rotr(A, 2) ^ rotr(A, 13) ^ rotr(A, 22);\n            const T2 = (sigma0 + Maj(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\n// Constants from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/**\n * SHA2-256 hash function\n * @param message - data that would be hashed\n */\nexport const sha256 = /* @__PURE__ */ wrapConstructor(() => new SHA256());\nexport const sha224 = /* @__PURE__ */ wrapConstructor(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// 100 lines of code in the file are duplicated from noble-hashes (utils).\n// This is OK: `abstract` directory does not use noble-hashes.\n// User may opt-in into using different hashing library. This way, noble-hashes\n// won't be included into their bundle.\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nexport function isBytes(a) {\n    return (a instanceof Uint8Array ||\n        (a != null && typeof a === 'object' && a.constructor.name === 'Uint8Array'));\n}\nexport function abytes(item) {\n    if (!isBytes(item))\n        throw new Error('Uint8Array expected');\n}\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nexport function bytesToHex(bytes) {\n    abytes(bytes);\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\nexport function numberToHexUnpadded(num) {\n    const hex = num.toString(16);\n    return hex.length & 1 ? `0${hex}` : hex;\n}\nexport function hexToNumber(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    // Big Endian\n    return BigInt(hex === '' ? '0' : `0x${hex}`);\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, _A: 65, _F: 70, _a: 97, _f: 102 };\nfunction asciiToBase16(char) {\n    if (char >= asciis._0 && char <= asciis._9)\n        return char - asciis._0;\n    if (char >= asciis._A && char <= asciis._F)\n        return char - (asciis._A - 10);\n    if (char >= asciis._a && char <= asciis._f)\n        return char - (asciis._a - 10);\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nexport function hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('padded hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2;\n    }\n    return array;\n}\n// BE: Big Endian, LE: Little Endian\nexport function bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nexport function bytesToNumberLE(bytes) {\n    abytes(bytes);\n    return hexToNumber(bytesToHex(Uint8Array.from(bytes).reverse()));\n}\nexport function numberToBytesBE(n, len) {\n    return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\nexport function numberToBytesLE(n, len) {\n    return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nexport function numberToVarBytesBE(n) {\n    return hexToBytes(numberToHexUnpadded(n));\n}\n/**\n * Takes hex string or Uint8Array, converts to Uint8Array.\n * Validates output length.\n * Will throw error for other types.\n * @param title descriptive title for an error e.g. 'private key'\n * @param hex hex string or Uint8Array\n * @param expectedLength optional, will compare to result array's length\n * @returns\n */\nexport function ensureBytes(title, hex, expectedLength) {\n    let res;\n    if (typeof hex === 'string') {\n        try {\n            res = hexToBytes(hex);\n        }\n        catch (e) {\n            throw new Error(`${title} must be valid hex string, got \"${hex}\". Cause: ${e}`);\n        }\n    }\n    else if (isBytes(hex)) {\n        // Uint8Array.from() instead of hash.slice() because node.js Buffer\n        // is instance of Uint8Array, and its slice() creates **mutable** copy\n        res = Uint8Array.from(hex);\n    }\n    else {\n        throw new Error(`${title} must be hex string or Uint8Array`);\n    }\n    const len = res.length;\n    if (typeof expectedLength === 'number' && len !== expectedLength)\n        throw new Error(`${title} expected ${expectedLength} bytes, got ${len}`);\n    return res;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nexport function concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// Compares 2 u8a-s in kinda constant time\nexport function equalBytes(a, b) {\n    if (a.length !== b.length)\n        return false;\n    let diff = 0;\n    for (let i = 0; i < a.length; i++)\n        diff |= a[i] ^ b[i];\n    return diff === 0;\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nexport function utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error(`utf8ToBytes expected string, got ${typeof str}`);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n// Bit operations\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n */\nexport function bitLen(n) {\n    let len;\n    for (len = 0; n > _0n; n >>= _1n, len += 1)\n        ;\n    return len;\n}\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nexport function bitGet(n, pos) {\n    return (n >> BigInt(pos)) & _1n;\n}\n/**\n * Sets single bit at position.\n */\nexport function bitSet(n, pos, value) {\n    return n | ((value ? _1n : _0n) << BigInt(pos));\n}\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nexport const bitMask = (n) => (_2n << BigInt(n - 1)) - _1n;\n// DRBG\nconst u8n = (data) => new Uint8Array(data); // creates Uint8Array\nconst u8fr = (arr) => Uint8Array.from(arr); // another shortcut\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nexport function createHmacDrbg(hashLen, qByteLen, hmacFn) {\n    if (typeof hashLen !== 'number' || hashLen < 2)\n        throw new Error('hashLen must be a number');\n    if (typeof qByteLen !== 'number' || qByteLen < 2)\n        throw new Error('qByteLen must be a number');\n    if (typeof hmacFn !== 'function')\n        throw new Error('hmacFn must be a function');\n    // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n    let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n    let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n    let i = 0; // Iterations counter, will throw when over 1000\n    const reset = () => {\n        v.fill(1);\n        k.fill(0);\n        i = 0;\n    };\n    const h = (...b) => hmacFn(k, v, ...b); // hmac(k)(v, ...values)\n    const reseed = (seed = u8n()) => {\n        // HMAC-DRBG reseed() function. Steps D-G\n        k = h(u8fr([0x00]), seed); // k = hmac(k || v || 0x00 || seed)\n        v = h(); // v = hmac(k || v)\n        if (seed.length === 0)\n            return;\n        k = h(u8fr([0x01]), seed); // k = hmac(k || v || 0x01 || seed)\n        v = h(); // v = hmac(k || v)\n    };\n    const gen = () => {\n        // HMAC-DRBG generate() function\n        if (i++ >= 1000)\n            throw new Error('drbg: tried 1000 values');\n        let len = 0;\n        const out = [];\n        while (len < qByteLen) {\n            v = h();\n            const sl = v.slice();\n            out.push(sl);\n            len += v.length;\n        }\n        return concatBytes(...out);\n    };\n    const genUntil = (seed, pred) => {\n        reset();\n        reseed(seed); // Steps D-G\n        let res = undefined; // Step H: grind until k is in [1..n-1]\n        while (!(res = pred(gen())))\n            reseed();\n        reset();\n        return res;\n    };\n    return genUntil;\n}\n// Validating curves and fields\nconst validatorFns = {\n    bigint: (val) => typeof val === 'bigint',\n    function: (val) => typeof val === 'function',\n    boolean: (val) => typeof val === 'boolean',\n    string: (val) => typeof val === 'string',\n    stringOrUint8Array: (val) => typeof val === 'string' || isBytes(val),\n    isSafeInteger: (val) => Number.isSafeInteger(val),\n    array: (val) => Array.isArray(val),\n    field: (val, object) => object.Fp.isValid(val),\n    hash: (val) => typeof val === 'function' && Number.isSafeInteger(val.outputLen),\n};\n// type Record<K extends string | number | symbol, T> = { [P in K]: T; }\nexport function validateObject(object, validators, optValidators = {}) {\n    const checkField = (fieldName, type, isOptional) => {\n        const checkVal = validatorFns[type];\n        if (typeof checkVal !== 'function')\n            throw new Error(`Invalid validator \"${type}\", expected function`);\n        const val = object[fieldName];\n        if (isOptional && val === undefined)\n            return;\n        if (!checkVal(val, object)) {\n            throw new Error(`Invalid param ${String(fieldName)}=${val} (${typeof val}), expected ${type}`);\n        }\n    };\n    for (const [fieldName, type] of Object.entries(validators))\n        checkField(fieldName, type, false);\n    for (const [fieldName, type] of Object.entries(optValidators))\n        checkField(fieldName, type, true);\n    return object;\n}\n// validate type tests\n// const o: { a: number; b: number; c: number } = { a: 1, b: 5, c: 6 };\n// const z0 = validateObject(o, { a: 'isSafeInteger' }, { c: 'bigint' }); // Ok!\n// // Should fail type-check\n// const z1 = validateObject(o, { a: 'tmp' }, { c: 'zz' });\n// const z2 = validateObject(o, { a: 'isSafeInteger' }, { c: 'zz' });\n// const z3 = validateObject(o, { test: 'boolean', z: 'bug' });\n// const z4 = validateObject(o, { a: 'boolean', z: 'bug' });\n//# sourceMappingURL=utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Utilities for modular arithmetics and finite fields\nimport { bitMask, numberToBytesBE, numberToBytesLE, bytesToNumberBE, bytesToNumberLE, ensureBytes, validateObject, } from './utils.js';\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3);\n// prettier-ignore\nconst _4n = BigInt(4), _5n = BigInt(5), _8n = BigInt(8);\n// prettier-ignore\nconst _9n = BigInt(9), _16n = BigInt(16);\n// Calculates a modulo b\nexport function mod(a, b) {\n    const result = a % b;\n    return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\n// TODO: use field version && remove\nexport function pow(num, power, modulo) {\n    if (modulo <= _0n || power < _0n)\n        throw new Error('Expected power/modulo > 0');\n    if (modulo === _1n)\n        return _0n;\n    let res = _1n;\n    while (power > _0n) {\n        if (power & _1n)\n            res = (res * num) % modulo;\n        num = (num * num) % modulo;\n        power >>= _1n;\n    }\n    return res;\n}\n// Does x ^ (2 ^ power) mod p. pow2(30, 4) == 30 ^ (2 ^ 4)\nexport function pow2(x, power, modulo) {\n    let res = x;\n    while (power-- > _0n) {\n        res *= res;\n        res %= modulo;\n    }\n    return res;\n}\n// Inverses number over modulo\nexport function invert(number, modulo) {\n    if (number === _0n || modulo <= _0n) {\n        throw new Error(`invert: expected positive integers, got n=${number} mod=${modulo}`);\n    }\n    // Euclidean GCD https://brilliant.org/wiki/extended-euclidean-algorithm/\n    // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n    let a = mod(number, modulo);\n    let b = modulo;\n    // prettier-ignore\n    let x = _0n, y = _1n, u = _1n, v = _0n;\n    while (a !== _0n) {\n        // JIT applies optimization if those two lines follow each other\n        const q = b / a;\n        const r = b % a;\n        const m = x - u * q;\n        const n = y - v * q;\n        // prettier-ignore\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    const gcd = b;\n    if (gcd !== _1n)\n        throw new Error('invert: does not exist');\n    return mod(x, modulo);\n}\n/**\n * Tonelli-Shanks square root search algorithm.\n * 1. https://eprint.iacr.org/2012/685.pdf (page 12)\n * 2. Square Roots from 1; 24, 51, 10 to Dan Shanks\n * Will start an infinite loop if field order P is not prime.\n * @param P field order\n * @returns function that takes field Fp (created from P) and number n\n */\nexport function tonelliShanks(P) {\n    // Legendre constant: used to calculate Legendre symbol (a | p),\n    // which denotes the value of a^((p-1)/2) (mod p).\n    // (a | p) ≡ 1    if a is a square (mod p)\n    // (a | p) ≡ -1   if a is not a square (mod p)\n    // (a | p) ≡ 0    if a ≡ 0 (mod p)\n    const legendreC = (P - _1n) / _2n;\n    let Q, S, Z;\n    // Step 1: By factoring out powers of 2 from p - 1,\n    // find q and s such that p - 1 = q*(2^s) with q odd\n    for (Q = P - _1n, S = 0; Q % _2n === _0n; Q /= _2n, S++)\n        ;\n    // Step 2: Select a non-square z such that (z | p) ≡ -1 and set c ≡ zq\n    for (Z = _2n; Z < P && pow(Z, legendreC, P) !== P - _1n; Z++)\n        ;\n    // Fast-path\n    if (S === 1) {\n        const p1div4 = (P + _1n) / _4n;\n        return function tonelliFast(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Slow-path\n    const Q1div2 = (Q + _1n) / _2n;\n    return function tonelliSlow(Fp, n) {\n        // Step 0: Check that n is indeed a square: (n | p) should not be ≡ -1\n        if (Fp.pow(n, legendreC) === Fp.neg(Fp.ONE))\n            throw new Error('Cannot find square root');\n        let r = S;\n        // TODO: will fail at Fp2/etc\n        let g = Fp.pow(Fp.mul(Fp.ONE, Z), Q); // will update both x and b\n        let x = Fp.pow(n, Q1div2); // first guess at the square root\n        let b = Fp.pow(n, Q); // first guess at the fudge factor\n        while (!Fp.eql(b, Fp.ONE)) {\n            if (Fp.eql(b, Fp.ZERO))\n                return Fp.ZERO; // https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm (4. If t = 0, return r = 0)\n            // Find m such b^(2^m)==1\n            let m = 1;\n            for (let t2 = Fp.sqr(b); m < r; m++) {\n                if (Fp.eql(t2, Fp.ONE))\n                    break;\n                t2 = Fp.sqr(t2); // t2 *= t2\n            }\n            // NOTE: r-m-1 can be bigger than 32, need to convert to bigint before shift, otherwise there will be overflow\n            const ge = Fp.pow(g, _1n << BigInt(r - m - 1)); // ge = 2^(r-m-1)\n            g = Fp.sqr(ge); // g = ge * ge\n            x = Fp.mul(x, ge); // x *= ge\n            b = Fp.mul(b, g); // b *= g\n            r = m;\n        }\n        return x;\n    };\n}\nexport function FpSqrt(P) {\n    // NOTE: different algorithms can give different roots, it is up to user to decide which one they want.\n    // For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n    // P ≡ 3 (mod 4)\n    // √n = n^((P+1)/4)\n    if (P % _4n === _3n) {\n        // Not all roots possible!\n        // const ORDER =\n        //   0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn;\n        // const NUM = 72057594037927816n;\n        const p1div4 = (P + _1n) / _4n;\n        return function sqrt3mod4(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            // Throw if root**2 != n\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Atkin algorithm for q ≡ 5 (mod 8), https://eprint.iacr.org/2012/685.pdf (page 10)\n    if (P % _8n === _5n) {\n        const c1 = (P - _5n) / _8n;\n        return function sqrt5mod8(Fp, n) {\n            const n2 = Fp.mul(n, _2n);\n            const v = Fp.pow(n2, c1);\n            const nv = Fp.mul(n, v);\n            const i = Fp.mul(Fp.mul(nv, _2n), v);\n            const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // P ≡ 9 (mod 16)\n    if (P % _16n === _9n) {\n        // NOTE: tonelli is too slow for bls-Fp2 calculations even on start\n        // Means we cannot use sqrt for constants at all!\n        //\n        // const c1 = Fp.sqrt(Fp.negate(Fp.ONE)); //  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n        // const c2 = Fp.sqrt(c1);                //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n        // const c3 = Fp.sqrt(Fp.negate(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n        // const c4 = (P + _7n) / _16n;           //  4. c4 = (q + 7) / 16        # Integer arithmetic\n        // sqrt = (x) => {\n        //   let tv1 = Fp.pow(x, c4);             //  1. tv1 = x^c4\n        //   let tv2 = Fp.mul(c1, tv1);           //  2. tv2 = c1 * tv1\n        //   const tv3 = Fp.mul(c2, tv1);         //  3. tv3 = c2 * tv1\n        //   let tv4 = Fp.mul(c3, tv1);           //  4. tv4 = c3 * tv1\n        //   const e1 = Fp.equals(Fp.square(tv2), x); //  5.  e1 = (tv2^2) == x\n        //   const e2 = Fp.equals(Fp.square(tv3), x); //  6.  e2 = (tv3^2) == x\n        //   tv1 = Fp.cmov(tv1, tv2, e1); //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n        //   tv2 = Fp.cmov(tv4, tv3, e2); //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n        //   const e3 = Fp.equals(Fp.square(tv2), x); //  9.  e3 = (tv2^2) == x\n        //   return Fp.cmov(tv1, tv2, e3); //  10.  z = CMOV(tv1, tv2, e3)  # Select the sqrt from tv1 and tv2\n        // }\n    }\n    // Other cases: Tonelli-Shanks algorithm\n    return tonelliShanks(P);\n}\n// Little-endian check for first LE bit (last BE bit);\nexport const isNegativeLE = (num, modulo) => (mod(num, modulo) & _1n) === _1n;\n// prettier-ignore\nconst FIELD_FIELDS = [\n    'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n    'eql', 'add', 'sub', 'mul', 'pow', 'div',\n    'addN', 'subN', 'mulN', 'sqrN'\n];\nexport function validateField(field) {\n    const initial = {\n        ORDER: 'bigint',\n        MASK: 'bigint',\n        BYTES: 'isSafeInteger',\n        BITS: 'isSafeInteger',\n    };\n    const opts = FIELD_FIELDS.reduce((map, val) => {\n        map[val] = 'function';\n        return map;\n    }, initial);\n    return validateObject(field, opts);\n}\n// Generic field functions\n/**\n * Same as `pow` but for Fp: non-constant-time.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n */\nexport function FpPow(f, num, power) {\n    // Should have same speed as pow for bigints\n    // TODO: benchmark!\n    if (power < _0n)\n        throw new Error('Expected power > 0');\n    if (power === _0n)\n        return f.ONE;\n    if (power === _1n)\n        return num;\n    let p = f.ONE;\n    let d = num;\n    while (power > _0n) {\n        if (power & _1n)\n            p = f.mul(p, d);\n        d = f.sqr(d);\n        power >>= _1n;\n    }\n    return p;\n}\n/**\n * Efficiently invert an array of Field elements.\n * `inv(0)` will return `undefined` here: make sure to throw an error.\n */\nexport function FpInvertBatch(f, nums) {\n    const tmp = new Array(nums.length);\n    // Walk from first to last, multiply them by each other MOD p\n    const lastMultiplied = nums.reduce((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = acc;\n        return f.mul(acc, num);\n    }, f.ONE);\n    // Invert last element\n    const inverted = f.inv(lastMultiplied);\n    // Walk from last to first, multiply them by inverted each other MOD p\n    nums.reduceRight((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = f.mul(acc, tmp[i]);\n        return f.mul(acc, num);\n    }, inverted);\n    return tmp;\n}\nexport function FpDiv(f, lhs, rhs) {\n    return f.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, f.ORDER) : f.inv(rhs));\n}\n// This function returns True whenever the value x is a square in the field F.\nexport function FpIsSquare(f) {\n    const legendreConst = (f.ORDER - _1n) / _2n; // Integer arithmetic\n    return (x) => {\n        const p = f.pow(x, legendreConst);\n        return f.eql(p, f.ZERO) || f.eql(p, f.ONE);\n    };\n}\n// CURVE.n lengths\nexport function nLength(n, nBitLength) {\n    // Bit size, byte size of CURVE.n\n    const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n    const nByteLength = Math.ceil(_nBitLength / 8);\n    return { nBitLength: _nBitLength, nByteLength };\n}\n/**\n * Initializes a finite field over prime. **Non-primes are not supported.**\n * Do not init in loop: slow. Very fragile: always run a benchmark on a change.\n * Major performance optimizations:\n * * a) denormalized operations like mulN instead of mul\n * * b) same object shape: never add or remove keys\n * * c) Object.freeze\n * @param ORDER prime positive bigint\n * @param bitLen how many bits the field consumes\n * @param isLE (def: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nexport function Field(ORDER, bitLen, isLE = false, redef = {}) {\n    if (ORDER <= _0n)\n        throw new Error(`Expected Field ORDER > 0, got ${ORDER}`);\n    const { nBitLength: BITS, nByteLength: BYTES } = nLength(ORDER, bitLen);\n    if (BYTES > 2048)\n        throw new Error('Field lengths over 2048 bytes are not supported');\n    const sqrtP = FpSqrt(ORDER);\n    const f = Object.freeze({\n        ORDER,\n        BITS,\n        BYTES,\n        MASK: bitMask(BITS),\n        ZERO: _0n,\n        ONE: _1n,\n        create: (num) => mod(num, ORDER),\n        isValid: (num) => {\n            if (typeof num !== 'bigint')\n                throw new Error(`Invalid field element: expected bigint, got ${typeof num}`);\n            return _0n <= num && num < ORDER; // 0 is valid element, but it's not invertible\n        },\n        is0: (num) => num === _0n,\n        isOdd: (num) => (num & _1n) === _1n,\n        neg: (num) => mod(-num, ORDER),\n        eql: (lhs, rhs) => lhs === rhs,\n        sqr: (num) => mod(num * num, ORDER),\n        add: (lhs, rhs) => mod(lhs + rhs, ORDER),\n        sub: (lhs, rhs) => mod(lhs - rhs, ORDER),\n        mul: (lhs, rhs) => mod(lhs * rhs, ORDER),\n        pow: (num, power) => FpPow(f, num, power),\n        div: (lhs, rhs) => mod(lhs * invert(rhs, ORDER), ORDER),\n        // Same as above, but doesn't normalize\n        sqrN: (num) => num * num,\n        addN: (lhs, rhs) => lhs + rhs,\n        subN: (lhs, rhs) => lhs - rhs,\n        mulN: (lhs, rhs) => lhs * rhs,\n        inv: (num) => invert(num, ORDER),\n        sqrt: redef.sqrt || ((n) => sqrtP(f, n)),\n        invertBatch: (lst) => FpInvertBatch(f, lst),\n        // TODO: do we really need constant cmov?\n        // We don't have const-time bigints anyway, so probably will be not very useful\n        cmov: (a, b, c) => (c ? b : a),\n        toBytes: (num) => (isLE ? numberToBytesLE(num, BYTES) : numberToBytesBE(num, BYTES)),\n        fromBytes: (bytes) => {\n            if (bytes.length !== BYTES)\n                throw new Error(`Fp.fromBytes: expected ${BYTES}, got ${bytes.length}`);\n            return isLE ? bytesToNumberLE(bytes) : bytesToNumberBE(bytes);\n        },\n    });\n    return Object.freeze(f);\n}\nexport function FpSqrtOdd(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? root : Fp.neg(root);\n}\nexport function FpSqrtEven(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(`Field doesn't have isOdd`);\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n/**\n * \"Constant-time\" private key generation utility.\n * Same as mapKeyToField, but accepts less bytes (40 instead of 48 for 32-byte field).\n * Which makes it slightly more biased, less secure.\n * @deprecated use mapKeyToField instead\n */\nexport function hashToPrivateScalar(hash, groupOrder, isLE = false) {\n    hash = ensureBytes('privateHash', hash);\n    const hashLen = hash.length;\n    const minLen = nLength(groupOrder).nByteLength + 8;\n    if (minLen < 24 || hashLen < minLen || hashLen > 1024)\n        throw new Error(`hashToPrivateScalar: expected ${minLen}-1024 bytes of input, got ${hashLen}`);\n    const num = isLE ? bytesToNumberLE(hash) : bytesToNumberBE(hash);\n    return mod(num, groupOrder - _1n) + _1n;\n}\n/**\n * Returns total number of bytes consumed by the field element.\n * For example, 32 bytes for usual 256-bit weierstrass curve.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of field\n */\nexport function getFieldBytesLength(fieldOrder) {\n    if (typeof fieldOrder !== 'bigint')\n        throw new Error('field order must be bigint');\n    const bitLength = fieldOrder.toString(2).length;\n    return Math.ceil(bitLength / 8);\n}\n/**\n * Returns minimal amount of bytes that can be safely reduced\n * by field order.\n * Should be 2^-128 for 128-bit curve such as P256.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of target hash\n */\nexport function getMinHashLength(fieldOrder) {\n    const length = getFieldBytesLength(fieldOrder);\n    return length + Math.ceil(length / 2);\n}\n/**\n * \"Constant-time\" private key generation utility.\n * Can take (n + n/2) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 48 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * FIPS 186-5, A.2 https://csrc.nist.gov/publications/detail/fips/186/5/final\n * RFC 9380, https://www.rfc-editor.org/rfc/rfc9380#section-5\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. secp256k1.CURVE.n)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nexport function mapHashToField(key, fieldOrder, isLE = false) {\n    const len = key.length;\n    const fieldLen = getFieldBytesLength(fieldOrder);\n    const minLen = getMinHashLength(fieldOrder);\n    // No small numbers: need to understand bias story. No huge numbers: easier to detect JS timings.\n    if (len < 16 || len < minLen || len > 1024)\n        throw new Error(`expected ${minLen}-1024 bytes of input, got ${len}`);\n    const num = isLE ? bytesToNumberBE(key) : bytesToNumberLE(key);\n    // `mod(x, 11)` can sometimes produce 0. `mod(x, 10) + 1` is the same, but no 0\n    const reduced = mod(num, fieldOrder - _1n) + _1n;\n    return isLE ? numberToBytesLE(reduced, fieldLen) : numberToBytesBE(reduced, fieldLen);\n}\n//# sourceMappingURL=modular.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Abelian group utilities\nimport { validateField, nLength } from './modular.js';\nimport { validateObject } from './utils.js';\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\n// Elliptic curve multiplication of Point by scalar. Fragile.\n// Scalars should always be less than curve order: this should be checked inside of a curve itself.\n// Creates precomputation tables for fast multiplication:\n// - private scalar is split by fixed size windows of W bits\n// - every window point is collected from window's table & added to accumulator\n// - since windows are different, same point inside tables won't be accessed more than once per calc\n// - each multiplication is 'Math.ceil(CURVE_ORDER / 𝑊) + 1' point additions (fixed for any scalar)\n// - +1 window is neccessary for wNAF\n// - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n// TODO: Research returning 2d JS array of windows, instead of a single window. This would allow\n// windows to be in different memory locations\nexport function wNAF(c, bits) {\n    const constTimeNegate = (condition, item) => {\n        const neg = item.negate();\n        return condition ? neg : item;\n    };\n    const opts = (W) => {\n        const windows = Math.ceil(bits / W) + 1; // +1, because\n        const windowSize = 2 ** (W - 1); // -1 because we skip zero\n        return { windows, windowSize };\n    };\n    return {\n        constTimeNegate,\n        // non-const time multiplication ladder\n        unsafeLadder(elm, n) {\n            let p = c.ZERO;\n            let d = elm;\n            while (n > _0n) {\n                if (n & _1n)\n                    p = p.add(d);\n                d = d.double();\n                n >>= _1n;\n            }\n            return p;\n        },\n        /**\n         * Creates a wNAF precomputation window. Used for caching.\n         * Default window size is set by `utils.precompute()` and is equal to 8.\n         * Number of precomputed points depends on the curve size:\n         * 2^(𝑊−1) * (Math.ceil(𝑛 / 𝑊) + 1), where:\n         * - 𝑊 is the window size\n         * - 𝑛 is the bitlength of the curve order.\n         * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n         * @returns precomputed point tables flattened to a single array\n         */\n        precomputeWindow(elm, W) {\n            const { windows, windowSize } = opts(W);\n            const points = [];\n            let p = elm;\n            let base = p;\n            for (let window = 0; window < windows; window++) {\n                base = p;\n                points.push(base);\n                // =1, because we skip zero\n                for (let i = 1; i < windowSize; i++) {\n                    base = base.add(p);\n                    points.push(base);\n                }\n                p = base.double();\n            }\n            return points;\n        },\n        /**\n         * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n         * @param W window size\n         * @param precomputes precomputed tables\n         * @param n scalar (we don't check here, but should be less than curve order)\n         * @returns real and fake (for const-time) points\n         */\n        wNAF(W, precomputes, n) {\n            // TODO: maybe check that scalar is less than group order? wNAF behavious is undefined otherwise\n            // But need to carefully remove other checks before wNAF. ORDER == bits here\n            const { windows, windowSize } = opts(W);\n            let p = c.ZERO;\n            let f = c.BASE;\n            const mask = BigInt(2 ** W - 1); // Create mask with W ones: 0b1111 for W=4 etc.\n            const maxNumber = 2 ** W;\n            const shiftBy = BigInt(W);\n            for (let window = 0; window < windows; window++) {\n                const offset = window * windowSize;\n                // Extract W bits.\n                let wbits = Number(n & mask);\n                // Shift number by W bits.\n                n >>= shiftBy;\n                // If the bits are bigger than max size, we'll split those.\n                // +224 => 256 - 32\n                if (wbits > windowSize) {\n                    wbits -= maxNumber;\n                    n += _1n;\n                }\n                // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n                // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n                // there is negate now: it is possible that negated element from low value\n                // would be the same as high element, which will create carry into next window.\n                // It's not obvious how this can fail, but still worth investigating later.\n                // Check if we're onto Zero point.\n                // Add random point inside current window to f.\n                const offset1 = offset;\n                const offset2 = offset + Math.abs(wbits) - 1; // -1 because we skip zero\n                const cond1 = window % 2 !== 0;\n                const cond2 = wbits < 0;\n                if (wbits === 0) {\n                    // The most important part for const-time getPublicKey\n                    f = f.add(constTimeNegate(cond1, precomputes[offset1]));\n                }\n                else {\n                    p = p.add(constTimeNegate(cond2, precomputes[offset2]));\n                }\n            }\n            // JIT-compiler should not eliminate f here, since it will later be used in normalizeZ()\n            // Even if the variable is still unused, there are some checks which will\n            // throw an exception, so compiler needs to prove they won't happen, which is hard.\n            // At this point there is a way to F be infinity-point even if p is not,\n            // which makes it less const-time: around 1 bigint multiply.\n            return { p, f };\n        },\n        wNAFCached(P, precomputesMap, n, transform) {\n            // @ts-ignore\n            const W = P._WINDOW_SIZE || 1;\n            // Calculate precomputes on a first run, reuse them after\n            let comp = precomputesMap.get(P);\n            if (!comp) {\n                comp = this.precomputeWindow(P, W);\n                if (W !== 1) {\n                    precomputesMap.set(P, transform(comp));\n                }\n            }\n            return this.wNAF(W, comp, n);\n        },\n    };\n}\nexport function validateBasic(curve) {\n    validateField(curve.Fp);\n    validateObject(curve, {\n        n: 'bigint',\n        h: 'bigint',\n        Gx: 'field',\n        Gy: 'field',\n    }, {\n        nBitLength: 'isSafeInteger',\n        nByteLength: 'isSafeInteger',\n    });\n    // Set defaults\n    return Object.freeze({\n        ...nLength(curve.n, curve.nBitLength),\n        ...curve,\n        ...{ p: curve.Fp.ORDER },\n    });\n}\n//# sourceMappingURL=curve.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\n// Short Weierstrass curve. The formula is: y² = x³ + ax + b\nimport * as mod from './modular.js';\nimport * as ut from './utils.js';\nimport { ensureBytes } from './utils.js';\nimport { wNAF, validateBasic } from './curve.js';\nfunction validatePointOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        a: 'field',\n        b: 'field',\n    }, {\n        allowedPrivateKeyLengths: 'array',\n        wrapPrivateKey: 'boolean',\n        isTorsionFree: 'function',\n        clearCofactor: 'function',\n        allowInfinityPoint: 'boolean',\n        fromBytes: 'function',\n        toBytes: 'function',\n    });\n    const { endo, Fp, a } = opts;\n    if (endo) {\n        if (!Fp.eql(a, Fp.ZERO)) {\n            throw new Error('Endomorphism can only be defined for Koblitz curves that have a=0');\n        }\n        if (typeof endo !== 'object' ||\n            typeof endo.beta !== 'bigint' ||\n            typeof endo.splitScalar !== 'function') {\n            throw new Error('Expected endomorphism with beta: bigint and splitScalar: function');\n        }\n    }\n    return Object.freeze({ ...opts });\n}\n// ASN.1 DER encoding utilities\nconst { bytesToNumberBE: b2n, hexToBytes: h2b } = ut;\nexport const DER = {\n    // asn.1 DER encoding utils\n    Err: class DERErr extends Error {\n        constructor(m = '') {\n            super(m);\n        }\n    },\n    _parseInt(data) {\n        const { Err: E } = DER;\n        if (data.length < 2 || data[0] !== 0x02)\n            throw new E('Invalid signature integer tag');\n        const len = data[1];\n        const res = data.subarray(2, len + 2);\n        if (!len || res.length !== len)\n            throw new E('Invalid signature integer: wrong length');\n        // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n        // since we always use positive integers here. It must always be empty:\n        // - add zero byte if exists\n        // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n        if (res[0] & 0b10000000)\n            throw new E('Invalid signature integer: negative');\n        if (res[0] === 0x00 && !(res[1] & 0b10000000))\n            throw new E('Invalid signature integer: unnecessary leading zero');\n        return { d: b2n(res), l: data.subarray(len + 2) }; // d is data, l is left\n    },\n    toSig(hex) {\n        // parse DER signature\n        const { Err: E } = DER;\n        const data = typeof hex === 'string' ? h2b(hex) : hex;\n        ut.abytes(data);\n        let l = data.length;\n        if (l < 2 || data[0] != 0x30)\n            throw new E('Invalid signature tag');\n        if (data[1] !== l - 2)\n            throw new E('Invalid signature: incorrect length');\n        const { d: r, l: sBytes } = DER._parseInt(data.subarray(2));\n        const { d: s, l: rBytesLeft } = DER._parseInt(sBytes);\n        if (rBytesLeft.length)\n            throw new E('Invalid signature: left bytes after parsing');\n        return { r, s };\n    },\n    hexFromSig(sig) {\n        // Add leading zero if first byte has negative bit enabled. More details in '_parseInt'\n        const slice = (s) => (Number.parseInt(s[0], 16) & 0b1000 ? '00' + s : s);\n        const h = (num) => {\n            const hex = num.toString(16);\n            return hex.length & 1 ? `0${hex}` : hex;\n        };\n        const s = slice(h(sig.s));\n        const r = slice(h(sig.r));\n        const shl = s.length / 2;\n        const rhl = r.length / 2;\n        const sl = h(shl);\n        const rl = h(rhl);\n        return `30${h(rhl + shl + 4)}02${rl}${r}02${sl}${s}`;\n    },\n};\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = BigInt(4);\nexport function weierstrassPoints(opts) {\n    const CURVE = validatePointOpts(opts);\n    const { Fp } = CURVE; // All curves has same field / group length as for now, but they can differ\n    const toBytes = CURVE.toBytes ||\n        ((_c, point, _isCompressed) => {\n            const a = point.toAffine();\n            return ut.concatBytes(Uint8Array.from([0x04]), Fp.toBytes(a.x), Fp.toBytes(a.y));\n        });\n    const fromBytes = CURVE.fromBytes ||\n        ((bytes) => {\n            // const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // if (head !== 0x04) throw new Error('Only non-compressed encoding is supported');\n            const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n            const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n            return { x, y };\n        });\n    /**\n     * y² = x³ + ax + b: Short weierstrass curve formula\n     * @returns y²\n     */\n    function weierstrassEquation(x) {\n        const { a, b } = CURVE;\n        const x2 = Fp.sqr(x); // x * x\n        const x3 = Fp.mul(x2, x); // x2 * x\n        return Fp.add(Fp.add(x3, Fp.mul(x, a)), b); // x3 + a * x + b\n    }\n    // Validate whether the passed curve params are valid.\n    // We check if curve equation works for generator point.\n    // `assertValidity()` won't work: `isTorsionFree()` is not available at this point in bls12-381.\n    // ProjectivePoint class has not been initialized yet.\n    if (!Fp.eql(Fp.sqr(CURVE.Gy), weierstrassEquation(CURVE.Gx)))\n        throw new Error('bad generator point: equation left != right');\n    // Valid group elements reside in range 1..n-1\n    function isWithinCurveOrder(num) {\n        return typeof num === 'bigint' && _0n < num && num < CURVE.n;\n    }\n    function assertGE(num) {\n        if (!isWithinCurveOrder(num))\n            throw new Error('Expected valid bigint: 0 < bigint < curve.n');\n    }\n    // Validates if priv key is valid and converts it to bigint.\n    // Supports options allowedPrivateKeyLengths and wrapPrivateKey.\n    function normPrivateKeyToScalar(key) {\n        const { allowedPrivateKeyLengths: lengths, nByteLength, wrapPrivateKey, n } = CURVE;\n        if (lengths && typeof key !== 'bigint') {\n            if (ut.isBytes(key))\n                key = ut.bytesToHex(key);\n            // Normalize to hex string, pad. E.g. P521 would norm 130-132 char hex to 132-char bytes\n            if (typeof key !== 'string' || !lengths.includes(key.length))\n                throw new Error('Invalid key');\n            key = key.padStart(nByteLength * 2, '0');\n        }\n        let num;\n        try {\n            num =\n                typeof key === 'bigint'\n                    ? key\n                    : ut.bytesToNumberBE(ensureBytes('private key', key, nByteLength));\n        }\n        catch (error) {\n            throw new Error(`private key must be ${nByteLength} bytes, hex or bigint, not ${typeof key}`);\n        }\n        if (wrapPrivateKey)\n            num = mod.mod(num, n); // disabled by default, enabled for BLS\n        assertGE(num); // num in range [1..N-1]\n        return num;\n    }\n    const pointPrecomputes = new Map();\n    function assertPrjPoint(other) {\n        if (!(other instanceof Point))\n            throw new Error('ProjectivePoint expected');\n    }\n    /**\n     * Projective Point works in 3d / projective (homogeneous) coordinates: (x, y, z) ∋ (x=x/z, y=y/z)\n     * Default Point works in 2d / affine coordinates: (x, y)\n     * We're doing calculations in projective, because its operations don't require costly inversion.\n     */\n    class Point {\n        constructor(px, py, pz) {\n            this.px = px;\n            this.py = py;\n            this.pz = pz;\n            if (px == null || !Fp.isValid(px))\n                throw new Error('x required');\n            if (py == null || !Fp.isValid(py))\n                throw new Error('y required');\n            if (pz == null || !Fp.isValid(pz))\n                throw new Error('z required');\n        }\n        // Does not validate if the point is on-curve.\n        // Use fromHex instead, or call assertValidity() later.\n        static fromAffine(p) {\n            const { x, y } = p || {};\n            if (!p || !Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('invalid affine point');\n            if (p instanceof Point)\n                throw new Error('projective point not allowed');\n            const is0 = (i) => Fp.eql(i, Fp.ZERO);\n            // fromAffine(x:0, y:0) would produce (x:0, y:0, z:1), but we need (x:0, y:1, z:0)\n            if (is0(x) && is0(y))\n                return Point.ZERO;\n            return new Point(x, y, Fp.ONE);\n        }\n        get x() {\n            return this.toAffine().x;\n        }\n        get y() {\n            return this.toAffine().y;\n        }\n        /**\n         * Takes a bunch of Projective Points but executes only one\n         * inversion on all of them. Inversion is very slow operation,\n         * so this improves performance massively.\n         * Optimization: converts a list of projective points to a list of identical points with Z=1.\n         */\n        static normalizeZ(points) {\n            const toInv = Fp.invertBatch(points.map((p) => p.pz));\n            return points.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n        }\n        /**\n         * Converts hash string or Uint8Array to Point.\n         * @param hex short/long ECDSA hex\n         */\n        static fromHex(hex) {\n            const P = Point.fromAffine(fromBytes(ensureBytes('pointHex', hex)));\n            P.assertValidity();\n            return P;\n        }\n        // Multiplies generator point by privateKey.\n        static fromPrivateKey(privateKey) {\n            return Point.BASE.multiply(normPrivateKeyToScalar(privateKey));\n        }\n        // \"Private method\", don't use it directly\n        _setWindowSize(windowSize) {\n            this._WINDOW_SIZE = windowSize;\n            pointPrecomputes.delete(this);\n        }\n        // A point on curve is valid if it conforms to equation.\n        assertValidity() {\n            if (this.is0()) {\n                // (0, 1, 0) aka ZERO is invalid in most contexts.\n                // In BLS, ZERO can be serialized, so we allow it.\n                // (0, 0, 0) is wrong representation of ZERO and is always invalid.\n                if (CURVE.allowInfinityPoint && !Fp.is0(this.py))\n                    return;\n                throw new Error('bad point: ZERO');\n            }\n            // Some 3rd-party test vectors require different wording between here & `fromCompressedHex`\n            const { x, y } = this.toAffine();\n            // Check if x, y are valid field elements\n            if (!Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('bad point: x or y not FE');\n            const left = Fp.sqr(y); // y²\n            const right = weierstrassEquation(x); // x³ + ax + b\n            if (!Fp.eql(left, right))\n                throw new Error('bad point: equation left != right');\n            if (!this.isTorsionFree())\n                throw new Error('bad point: not in prime-order subgroup');\n        }\n        hasEvenY() {\n            const { y } = this.toAffine();\n            if (Fp.isOdd)\n                return !Fp.isOdd(y);\n            throw new Error(\"Field doesn't support isOdd\");\n        }\n        /**\n         * Compare one point to another.\n         */\n        equals(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            const U1 = Fp.eql(Fp.mul(X1, Z2), Fp.mul(X2, Z1));\n            const U2 = Fp.eql(Fp.mul(Y1, Z2), Fp.mul(Y2, Z1));\n            return U1 && U2;\n        }\n        /**\n         * Flips point to one corresponding to (x, -y) in Affine coordinates.\n         */\n        negate() {\n            return new Point(this.px, Fp.neg(this.py), this.pz);\n        }\n        // Renes-Costello-Batina exception-free doubling formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 3\n        // Cost: 8M + 3S + 3*a + 2*b3 + 15add.\n        double() {\n            const { a, b } = CURVE;\n            const b3 = Fp.mul(b, _3n);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            let t0 = Fp.mul(X1, X1); // step 1\n            let t1 = Fp.mul(Y1, Y1);\n            let t2 = Fp.mul(Z1, Z1);\n            let t3 = Fp.mul(X1, Y1);\n            t3 = Fp.add(t3, t3); // step 5\n            Z3 = Fp.mul(X1, Z1);\n            Z3 = Fp.add(Z3, Z3);\n            X3 = Fp.mul(a, Z3);\n            Y3 = Fp.mul(b3, t2);\n            Y3 = Fp.add(X3, Y3); // step 10\n            X3 = Fp.sub(t1, Y3);\n            Y3 = Fp.add(t1, Y3);\n            Y3 = Fp.mul(X3, Y3);\n            X3 = Fp.mul(t3, X3);\n            Z3 = Fp.mul(b3, Z3); // step 15\n            t2 = Fp.mul(a, t2);\n            t3 = Fp.sub(t0, t2);\n            t3 = Fp.mul(a, t3);\n            t3 = Fp.add(t3, Z3);\n            Z3 = Fp.add(t0, t0); // step 20\n            t0 = Fp.add(Z3, t0);\n            t0 = Fp.add(t0, t2);\n            t0 = Fp.mul(t0, t3);\n            Y3 = Fp.add(Y3, t0);\n            t2 = Fp.mul(Y1, Z1); // step 25\n            t2 = Fp.add(t2, t2);\n            t0 = Fp.mul(t2, t3);\n            X3 = Fp.sub(X3, t0);\n            Z3 = Fp.mul(t2, t1);\n            Z3 = Fp.add(Z3, Z3); // step 30\n            Z3 = Fp.add(Z3, Z3);\n            return new Point(X3, Y3, Z3);\n        }\n        // Renes-Costello-Batina exception-free addition formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 1\n        // Cost: 12M + 0S + 3*a + 3*b3 + 23add.\n        add(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            const a = CURVE.a;\n            const b3 = Fp.mul(CURVE.b, _3n);\n            let t0 = Fp.mul(X1, X2); // step 1\n            let t1 = Fp.mul(Y1, Y2);\n            let t2 = Fp.mul(Z1, Z2);\n            let t3 = Fp.add(X1, Y1);\n            let t4 = Fp.add(X2, Y2); // step 5\n            t3 = Fp.mul(t3, t4);\n            t4 = Fp.add(t0, t1);\n            t3 = Fp.sub(t3, t4);\n            t4 = Fp.add(X1, Z1);\n            let t5 = Fp.add(X2, Z2); // step 10\n            t4 = Fp.mul(t4, t5);\n            t5 = Fp.add(t0, t2);\n            t4 = Fp.sub(t4, t5);\n            t5 = Fp.add(Y1, Z1);\n            X3 = Fp.add(Y2, Z2); // step 15\n            t5 = Fp.mul(t5, X3);\n            X3 = Fp.add(t1, t2);\n            t5 = Fp.sub(t5, X3);\n            Z3 = Fp.mul(a, t4);\n            X3 = Fp.mul(b3, t2); // step 20\n            Z3 = Fp.add(X3, Z3);\n            X3 = Fp.sub(t1, Z3);\n            Z3 = Fp.add(t1, Z3);\n            Y3 = Fp.mul(X3, Z3);\n            t1 = Fp.add(t0, t0); // step 25\n            t1 = Fp.add(t1, t0);\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.mul(b3, t4);\n            t1 = Fp.add(t1, t2);\n            t2 = Fp.sub(t0, t2); // step 30\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.add(t4, t2);\n            t0 = Fp.mul(t1, t4);\n            Y3 = Fp.add(Y3, t0);\n            t0 = Fp.mul(t5, t4); // step 35\n            X3 = Fp.mul(t3, X3);\n            X3 = Fp.sub(X3, t0);\n            t0 = Fp.mul(t3, t1);\n            Z3 = Fp.mul(t5, Z3);\n            Z3 = Fp.add(Z3, t0); // step 40\n            return new Point(X3, Y3, Z3);\n        }\n        subtract(other) {\n            return this.add(other.negate());\n        }\n        is0() {\n            return this.equals(Point.ZERO);\n        }\n        wNAF(n) {\n            return wnaf.wNAFCached(this, pointPrecomputes, n, (comp) => {\n                const toInv = Fp.invertBatch(comp.map((p) => p.pz));\n                return comp.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n            });\n        }\n        /**\n         * Non-constant-time multiplication. Uses double-and-add algorithm.\n         * It's faster, but should only be used when you don't care about\n         * an exposed private key e.g. sig verification, which works over *public* keys.\n         */\n        multiplyUnsafe(n) {\n            const I = Point.ZERO;\n            if (n === _0n)\n                return I;\n            assertGE(n); // Will throw on 0\n            if (n === _1n)\n                return this;\n            const { endo } = CURVE;\n            if (!endo)\n                return wnaf.unsafeLadder(this, n);\n            // Apply endomorphism\n            let { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n            let k1p = I;\n            let k2p = I;\n            let d = this;\n            while (k1 > _0n || k2 > _0n) {\n                if (k1 & _1n)\n                    k1p = k1p.add(d);\n                if (k2 & _1n)\n                    k2p = k2p.add(d);\n                d = d.double();\n                k1 >>= _1n;\n                k2 >>= _1n;\n            }\n            if (k1neg)\n                k1p = k1p.negate();\n            if (k2neg)\n                k2p = k2p.negate();\n            k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n            return k1p.add(k2p);\n        }\n        /**\n         * Constant time multiplication.\n         * Uses wNAF method. Windowed method may be 10% faster,\n         * but takes 2x longer to generate and consumes 2x memory.\n         * Uses precomputes when available.\n         * Uses endomorphism for Koblitz curves.\n         * @param scalar by which the point would be multiplied\n         * @returns New point\n         */\n        multiply(scalar) {\n            assertGE(scalar);\n            let n = scalar;\n            let point, fake; // Fake point is used to const-time mult\n            const { endo } = CURVE;\n            if (endo) {\n                const { k1neg, k1, k2neg, k2 } = endo.splitScalar(n);\n                let { p: k1p, f: f1p } = this.wNAF(k1);\n                let { p: k2p, f: f2p } = this.wNAF(k2);\n                k1p = wnaf.constTimeNegate(k1neg, k1p);\n                k2p = wnaf.constTimeNegate(k2neg, k2p);\n                k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n                point = k1p.add(k2p);\n                fake = f1p.add(f2p);\n            }\n            else {\n                const { p, f } = this.wNAF(n);\n                point = p;\n                fake = f;\n            }\n            // Normalize `z` for both points, but return only real one\n            return Point.normalizeZ([point, fake])[0];\n        }\n        /**\n         * Efficiently calculate `aP + bQ`. Unsafe, can expose private key, if used incorrectly.\n         * Not using Strauss-Shamir trick: precomputation tables are faster.\n         * The trick could be useful if both P and Q are not G (not in our case).\n         * @returns non-zero affine point\n         */\n        multiplyAndAddUnsafe(Q, a, b) {\n            const G = Point.BASE; // No Strauss-Shamir trick: we have 10% faster G precomputes\n            const mul = (P, a // Select faster multiply() method\n            ) => (a === _0n || a === _1n || !P.equals(G) ? P.multiplyUnsafe(a) : P.multiply(a));\n            const sum = mul(this, a).add(mul(Q, b));\n            return sum.is0() ? undefined : sum;\n        }\n        // Converts Projective point to affine (x, y) coordinates.\n        // Can accept precomputed Z^-1 - for example, from invertBatch.\n        // (x, y, z) ∋ (x=x/z, y=y/z)\n        toAffine(iz) {\n            const { px: x, py: y, pz: z } = this;\n            const is0 = this.is0();\n            // If invZ was 0, we return zero point. However we still want to execute\n            // all operations, so we replace invZ with a random number, 1.\n            if (iz == null)\n                iz = is0 ? Fp.ONE : Fp.inv(z);\n            const ax = Fp.mul(x, iz);\n            const ay = Fp.mul(y, iz);\n            const zz = Fp.mul(z, iz);\n            if (is0)\n                return { x: Fp.ZERO, y: Fp.ZERO };\n            if (!Fp.eql(zz, Fp.ONE))\n                throw new Error('invZ was invalid');\n            return { x: ax, y: ay };\n        }\n        isTorsionFree() {\n            const { h: cofactor, isTorsionFree } = CURVE;\n            if (cofactor === _1n)\n                return true; // No subgroups, always torsion-free\n            if (isTorsionFree)\n                return isTorsionFree(Point, this);\n            throw new Error('isTorsionFree() has not been declared for the elliptic curve');\n        }\n        clearCofactor() {\n            const { h: cofactor, clearCofactor } = CURVE;\n            if (cofactor === _1n)\n                return this; // Fast-path\n            if (clearCofactor)\n                return clearCofactor(Point, this);\n            return this.multiplyUnsafe(CURVE.h);\n        }\n        toRawBytes(isCompressed = true) {\n            this.assertValidity();\n            return toBytes(Point, this, isCompressed);\n        }\n        toHex(isCompressed = true) {\n            return ut.bytesToHex(this.toRawBytes(isCompressed));\n        }\n    }\n    Point.BASE = new Point(CURVE.Gx, CURVE.Gy, Fp.ONE);\n    Point.ZERO = new Point(Fp.ZERO, Fp.ONE, Fp.ZERO);\n    const _bits = CURVE.nBitLength;\n    const wnaf = wNAF(Point, CURVE.endo ? Math.ceil(_bits / 2) : _bits);\n    // Validate if generator point is on curve\n    return {\n        CURVE,\n        ProjectivePoint: Point,\n        normPrivateKeyToScalar,\n        weierstrassEquation,\n        isWithinCurveOrder,\n    };\n}\nfunction validateOpts(curve) {\n    const opts = validateBasic(curve);\n    ut.validateObject(opts, {\n        hash: 'hash',\n        hmac: 'function',\n        randomBytes: 'function',\n    }, {\n        bits2int: 'function',\n        bits2int_modN: 'function',\n        lowS: 'boolean',\n    });\n    return Object.freeze({ lowS: true, ...opts });\n}\nexport function weierstrass(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { Fp, n: CURVE_ORDER } = CURVE;\n    const compressedLen = Fp.BYTES + 1; // e.g. 33 for 32\n    const uncompressedLen = 2 * Fp.BYTES + 1; // e.g. 65 for 32\n    function isValidFieldElement(num) {\n        return _0n < num && num < Fp.ORDER; // 0 is banned since it's not invertible FE\n    }\n    function modN(a) {\n        return mod.mod(a, CURVE_ORDER);\n    }\n    function invN(a) {\n        return mod.invert(a, CURVE_ORDER);\n    }\n    const { ProjectivePoint: Point, normPrivateKeyToScalar, weierstrassEquation, isWithinCurveOrder, } = weierstrassPoints({\n        ...CURVE,\n        toBytes(_c, point, isCompressed) {\n            const a = point.toAffine();\n            const x = Fp.toBytes(a.x);\n            const cat = ut.concatBytes;\n            if (isCompressed) {\n                return cat(Uint8Array.from([point.hasEvenY() ? 0x02 : 0x03]), x);\n            }\n            else {\n                return cat(Uint8Array.from([0x04]), x, Fp.toBytes(a.y));\n            }\n        },\n        fromBytes(bytes) {\n            const len = bytes.length;\n            const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // this.assertValidity() is done inside of fromHex\n            if (len === compressedLen && (head === 0x02 || head === 0x03)) {\n                const x = ut.bytesToNumberBE(tail);\n                if (!isValidFieldElement(x))\n                    throw new Error('Point is not on curve');\n                const y2 = weierstrassEquation(x); // y² = x³ + ax + b\n                let y;\n                try {\n                    y = Fp.sqrt(y2); // y = y² ^ (p+1)/4\n                }\n                catch (sqrtError) {\n                    const suffix = sqrtError instanceof Error ? ': ' + sqrtError.message : '';\n                    throw new Error('Point is not on curve' + suffix);\n                }\n                const isYOdd = (y & _1n) === _1n;\n                // ECDSA\n                const isHeadOdd = (head & 1) === 1;\n                if (isHeadOdd !== isYOdd)\n                    y = Fp.neg(y);\n                return { x, y };\n            }\n            else if (len === uncompressedLen && head === 0x04) {\n                const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n                const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n                return { x, y };\n            }\n            else {\n                throw new Error(`Point of length ${len} was invalid. Expected ${compressedLen} compressed bytes or ${uncompressedLen} uncompressed bytes`);\n            }\n        },\n    });\n    const numToNByteStr = (num) => ut.bytesToHex(ut.numberToBytesBE(num, CURVE.nByteLength));\n    function isBiggerThanHalfOrder(number) {\n        const HALF = CURVE_ORDER >> _1n;\n        return number > HALF;\n    }\n    function normalizeS(s) {\n        return isBiggerThanHalfOrder(s) ? modN(-s) : s;\n    }\n    // slice bytes num\n    const slcNum = (b, from, to) => ut.bytesToNumberBE(b.slice(from, to));\n    /**\n     * ECDSA signature with its (r, s) properties. Supports DER & compact representations.\n     */\n    class Signature {\n        constructor(r, s, recovery) {\n            this.r = r;\n            this.s = s;\n            this.recovery = recovery;\n            this.assertValidity();\n        }\n        // pair (bytes of r, bytes of s)\n        static fromCompact(hex) {\n            const l = CURVE.nByteLength;\n            hex = ensureBytes('compactSignature', hex, l * 2);\n            return new Signature(slcNum(hex, 0, l), slcNum(hex, l, 2 * l));\n        }\n        // DER encoded ECDSA signature\n        // https://bitcoin.stackexchange.com/questions/57644/what-are-the-parts-of-a-bitcoin-transaction-input-script\n        static fromDER(hex) {\n            const { r, s } = DER.toSig(ensureBytes('DER', hex));\n            return new Signature(r, s);\n        }\n        assertValidity() {\n            // can use assertGE here\n            if (!isWithinCurveOrder(this.r))\n                throw new Error('r must be 0 < r < CURVE.n');\n            if (!isWithinCurveOrder(this.s))\n                throw new Error('s must be 0 < s < CURVE.n');\n        }\n        addRecoveryBit(recovery) {\n            return new Signature(this.r, this.s, recovery);\n        }\n        recoverPublicKey(msgHash) {\n            const { r, s, recovery: rec } = this;\n            const h = bits2int_modN(ensureBytes('msgHash', msgHash)); // Truncate hash\n            if (rec == null || ![0, 1, 2, 3].includes(rec))\n                throw new Error('recovery id invalid');\n            const radj = rec === 2 || rec === 3 ? r + CURVE.n : r;\n            if (radj >= Fp.ORDER)\n                throw new Error('recovery id 2 or 3 invalid');\n            const prefix = (rec & 1) === 0 ? '02' : '03';\n            const R = Point.fromHex(prefix + numToNByteStr(radj));\n            const ir = invN(radj); // r^-1\n            const u1 = modN(-h * ir); // -hr^-1\n            const u2 = modN(s * ir); // sr^-1\n            const Q = Point.BASE.multiplyAndAddUnsafe(R, u1, u2); // (sr^-1)R-(hr^-1)G = -(hr^-1)G + (sr^-1)\n            if (!Q)\n                throw new Error('point at infinify'); // unsafe is fine: no priv data leaked\n            Q.assertValidity();\n            return Q;\n        }\n        // Signatures should be low-s, to prevent malleability.\n        hasHighS() {\n            return isBiggerThanHalfOrder(this.s);\n        }\n        normalizeS() {\n            return this.hasHighS() ? new Signature(this.r, modN(-this.s), this.recovery) : this;\n        }\n        // DER-encoded\n        toDERRawBytes() {\n            return ut.hexToBytes(this.toDERHex());\n        }\n        toDERHex() {\n            return DER.hexFromSig({ r: this.r, s: this.s });\n        }\n        // padded bytes of r, then padded bytes of s\n        toCompactRawBytes() {\n            return ut.hexToBytes(this.toCompactHex());\n        }\n        toCompactHex() {\n            return numToNByteStr(this.r) + numToNByteStr(this.s);\n        }\n    }\n    const utils = {\n        isValidPrivateKey(privateKey) {\n            try {\n                normPrivateKeyToScalar(privateKey);\n                return true;\n            }\n            catch (error) {\n                return false;\n            }\n        },\n        normPrivateKeyToScalar: normPrivateKeyToScalar,\n        /**\n         * Produces cryptographically secure private key from random of size\n         * (groupLen + ceil(groupLen / 2)) with modulo bias being negligible.\n         */\n        randomPrivateKey: () => {\n            const length = mod.getMinHashLength(CURVE.n);\n            return mod.mapHashToField(CURVE.randomBytes(length), CURVE.n);\n        },\n        /**\n         * Creates precompute table for an arbitrary EC point. Makes point \"cached\".\n         * Allows to massively speed-up `point.multiply(scalar)`.\n         * @returns cached point\n         * @example\n         * const fast = utils.precompute(8, ProjectivePoint.fromHex(someonesPubKey));\n         * fast.multiply(privKey); // much faster ECDH now\n         */\n        precompute(windowSize = 8, point = Point.BASE) {\n            point._setWindowSize(windowSize);\n            point.multiply(BigInt(3)); // 3 is arbitrary, just need any number here\n            return point;\n        },\n    };\n    /**\n     * Computes public key for a private key. Checks for validity of the private key.\n     * @param privateKey private key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns Public key, full when isCompressed=false; short when isCompressed=true\n     */\n    function getPublicKey(privateKey, isCompressed = true) {\n        return Point.fromPrivateKey(privateKey).toRawBytes(isCompressed);\n    }\n    /**\n     * Quick and dirty check for item being public key. Does not validate hex, or being on-curve.\n     */\n    function isProbPub(item) {\n        const arr = ut.isBytes(item);\n        const str = typeof item === 'string';\n        const len = (arr || str) && item.length;\n        if (arr)\n            return len === compressedLen || len === uncompressedLen;\n        if (str)\n            return len === 2 * compressedLen || len === 2 * uncompressedLen;\n        if (item instanceof Point)\n            return true;\n        return false;\n    }\n    /**\n     * ECDH (Elliptic Curve Diffie Hellman).\n     * Computes shared public key from private key and public key.\n     * Checks: 1) private key validity 2) shared key is on-curve.\n     * Does NOT hash the result.\n     * @param privateA private key\n     * @param publicB different public key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns shared public key\n     */\n    function getSharedSecret(privateA, publicB, isCompressed = true) {\n        if (isProbPub(privateA))\n            throw new Error('first arg must be private key');\n        if (!isProbPub(publicB))\n            throw new Error('second arg must be public key');\n        const b = Point.fromHex(publicB); // check for being on-curve\n        return b.multiply(normPrivateKeyToScalar(privateA)).toRawBytes(isCompressed);\n    }\n    // RFC6979: ensure ECDSA msg is X bytes and < N. RFC suggests optional truncating via bits2octets.\n    // FIPS 186-4 4.6 suggests the leftmost min(nBitLen, outLen) bits, which matches bits2int.\n    // bits2int can produce res>N, we can do mod(res, N) since the bitLen is the same.\n    // int2octets can't be used; pads small msgs with 0: unacceptatble for trunc as per RFC vectors\n    const bits2int = CURVE.bits2int ||\n        function (bytes) {\n            // For curves with nBitLength % 8 !== 0: bits2octets(bits2octets(m)) !== bits2octets(m)\n            // for some cases, since bytes.length * 8 is not actual bitLength.\n            const num = ut.bytesToNumberBE(bytes); // check for == u8 done here\n            const delta = bytes.length * 8 - CURVE.nBitLength; // truncate to nBitLength leftmost bits\n            return delta > 0 ? num >> BigInt(delta) : num;\n        };\n    const bits2int_modN = CURVE.bits2int_modN ||\n        function (bytes) {\n            return modN(bits2int(bytes)); // can't use bytesToNumberBE here\n        };\n    // NOTE: pads output with zero as per spec\n    const ORDER_MASK = ut.bitMask(CURVE.nBitLength);\n    /**\n     * Converts to bytes. Checks if num in `[0..ORDER_MASK-1]` e.g.: `[0..2^256-1]`.\n     */\n    function int2octets(num) {\n        if (typeof num !== 'bigint')\n            throw new Error('bigint expected');\n        if (!(_0n <= num && num < ORDER_MASK))\n            throw new Error(`bigint expected < 2^${CURVE.nBitLength}`);\n        // works with order, can have different size than numToField!\n        return ut.numberToBytesBE(num, CURVE.nByteLength);\n    }\n    // Steps A, D of RFC6979 3.2\n    // Creates RFC6979 seed; converts msg/privKey to numbers.\n    // Used only in sign, not in verify.\n    // NOTE: we cannot assume here that msgHash has same amount of bytes as curve order, this will be wrong at least for P521.\n    // Also it can be bigger for P224 + SHA256\n    function prepSig(msgHash, privateKey, opts = defaultSigOpts) {\n        if (['recovered', 'canonical'].some((k) => k in opts))\n            throw new Error('sign() legacy options not supported');\n        const { hash, randomBytes } = CURVE;\n        let { lowS, prehash, extraEntropy: ent } = opts; // generates low-s sigs by default\n        if (lowS == null)\n            lowS = true; // RFC6979 3.2: we skip step A, because we already provide hash\n        msgHash = ensureBytes('msgHash', msgHash);\n        if (prehash)\n            msgHash = ensureBytes('prehashed msgHash', hash(msgHash));\n        // We can't later call bits2octets, since nested bits2int is broken for curves\n        // with nBitLength % 8 !== 0. Because of that, we unwrap it here as int2octets call.\n        // const bits2octets = (bits) => int2octets(bits2int_modN(bits))\n        const h1int = bits2int_modN(msgHash);\n        const d = normPrivateKeyToScalar(privateKey); // validate private key, convert to bigint\n        const seedArgs = [int2octets(d), int2octets(h1int)];\n        // extraEntropy. RFC6979 3.6: additional k' (optional).\n        if (ent != null && ent !== false) {\n            // K = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || k')\n            const e = ent === true ? randomBytes(Fp.BYTES) : ent; // generate random bytes OR pass as-is\n            seedArgs.push(ensureBytes('extraEntropy', e)); // check for being bytes\n        }\n        const seed = ut.concatBytes(...seedArgs); // Step D of RFC6979 3.2\n        const m = h1int; // NOTE: no need to call bits2int second time here, it is inside truncateHash!\n        // Converts signature params into point w r/s, checks result for validity.\n        function k2sig(kBytes) {\n            // RFC 6979 Section 3.2, step 3: k = bits2int(T)\n            const k = bits2int(kBytes); // Cannot use fields methods, since it is group element\n            if (!isWithinCurveOrder(k))\n                return; // Important: all mod() calls here must be done over N\n            const ik = invN(k); // k^-1 mod n\n            const q = Point.BASE.multiply(k).toAffine(); // q = Gk\n            const r = modN(q.x); // r = q.x mod n\n            if (r === _0n)\n                return;\n            // Can use scalar blinding b^-1(bm + bdr) where b ∈ [1,q−1] according to\n            // https://tches.iacr.org/index.php/TCHES/article/view/7337/6509. We've decided against it:\n            // a) dependency on CSPRNG b) 15% slowdown c) doesn't really help since bigints are not CT\n            const s = modN(ik * modN(m + r * d)); // Not using blinding here\n            if (s === _0n)\n                return;\n            let recovery = (q.x === r ? 0 : 2) | Number(q.y & _1n); // recovery bit (2 or 3, when q.x > n)\n            let normS = s;\n            if (lowS && isBiggerThanHalfOrder(s)) {\n                normS = normalizeS(s); // if lowS was passed, ensure s is always\n                recovery ^= 1; // // in the bottom half of N\n            }\n            return new Signature(r, normS, recovery); // use normS, not s\n        }\n        return { seed, k2sig };\n    }\n    const defaultSigOpts = { lowS: CURVE.lowS, prehash: false };\n    const defaultVerOpts = { lowS: CURVE.lowS, prehash: false };\n    /**\n     * Signs message hash with a private key.\n     * ```\n     * sign(m, d, k) where\n     *   (x, y) = G × k\n     *   r = x mod n\n     *   s = (m + dr)/k mod n\n     * ```\n     * @param msgHash NOT message. msg needs to be hashed to `msgHash`, or use `prehash`.\n     * @param privKey private key\n     * @param opts lowS for non-malleable sigs. extraEntropy for mixing randomness into k. prehash will hash first arg.\n     * @returns signature with recovery param\n     */\n    function sign(msgHash, privKey, opts = defaultSigOpts) {\n        const { seed, k2sig } = prepSig(msgHash, privKey, opts); // Steps A, D of RFC6979 3.2.\n        const C = CURVE;\n        const drbg = ut.createHmacDrbg(C.hash.outputLen, C.nByteLength, C.hmac);\n        return drbg(seed, k2sig); // Steps B, C, D, E, F, G\n    }\n    // Enable precomputes. Slows down first publicKey computation by 20ms.\n    Point.BASE._setWindowSize(8);\n    // utils.precompute(8, ProjectivePoint.BASE)\n    /**\n     * Verifies a signature against message hash and public key.\n     * Rejects lowS signatures by default: to override,\n     * specify option `{lowS: false}`. Implements section 4.1.4 from https://www.secg.org/sec1-v2.pdf:\n     *\n     * ```\n     * verify(r, s, h, P) where\n     *   U1 = hs^-1 mod n\n     *   U2 = rs^-1 mod n\n     *   R = U1⋅G - U2⋅P\n     *   mod(R.x, n) == r\n     * ```\n     */\n    function verify(signature, msgHash, publicKey, opts = defaultVerOpts) {\n        const sg = signature;\n        msgHash = ensureBytes('msgHash', msgHash);\n        publicKey = ensureBytes('publicKey', publicKey);\n        if ('strict' in opts)\n            throw new Error('options.strict was renamed to lowS');\n        const { lowS, prehash } = opts;\n        let _sig = undefined;\n        let P;\n        try {\n            if (typeof sg === 'string' || ut.isBytes(sg)) {\n                // Signature can be represented in 2 ways: compact (2*nByteLength) & DER (variable-length).\n                // Since DER can also be 2*nByteLength bytes, we check for it first.\n                try {\n                    _sig = Signature.fromDER(sg);\n                }\n                catch (derError) {\n                    if (!(derError instanceof DER.Err))\n                        throw derError;\n                    _sig = Signature.fromCompact(sg);\n                }\n            }\n            else if (typeof sg === 'object' && typeof sg.r === 'bigint' && typeof sg.s === 'bigint') {\n                const { r, s } = sg;\n                _sig = new Signature(r, s);\n            }\n            else {\n                throw new Error('PARSE');\n            }\n            P = Point.fromHex(publicKey);\n        }\n        catch (error) {\n            if (error.message === 'PARSE')\n                throw new Error(`signature must be Signature instance, Uint8Array or hex string`);\n            return false;\n        }\n        if (lowS && _sig.hasHighS())\n            return false;\n        if (prehash)\n            msgHash = CURVE.hash(msgHash);\n        const { r, s } = _sig;\n        const h = bits2int_modN(msgHash); // Cannot use fields methods, since it is group element\n        const is = invN(s); // s^-1\n        const u1 = modN(h * is); // u1 = hs^-1 mod n\n        const u2 = modN(r * is); // u2 = rs^-1 mod n\n        const R = Point.BASE.multiplyAndAddUnsafe(P, u1, u2)?.toAffine(); // R = u1⋅G + u2⋅P\n        if (!R)\n            return false;\n        const v = modN(R.x);\n        return v === r;\n    }\n    return {\n        CURVE,\n        getPublicKey,\n        getSharedSecret,\n        sign,\n        verify,\n        ProjectivePoint: Point,\n        Signature,\n        utils,\n    };\n}\n/**\n * Implementation of the Shallue and van de Woestijne method for any weierstrass curve.\n * TODO: check if there is a way to merge this with uvRatio in Edwards; move to modular.\n * b = True and y = sqrt(u / v) if (u / v) is square in F, and\n * b = False and y = sqrt(Z * (u / v)) otherwise.\n * @param Fp\n * @param Z\n * @returns\n */\nexport function SWUFpSqrtRatio(Fp, Z) {\n    // Generic implementation\n    const q = Fp.ORDER;\n    let l = _0n;\n    for (let o = q - _1n; o % _2n === _0n; o /= _2n)\n        l += _1n;\n    const c1 = l; // 1. c1, the largest integer such that 2^c1 divides q - 1.\n    // We need 2n ** c1 and 2n ** (c1-1). We can't use **; but we can use <<.\n    // 2n ** c1 == 2n << (c1-1)\n    const _2n_pow_c1_1 = _2n << (c1 - _1n - _1n);\n    const _2n_pow_c1 = _2n_pow_c1_1 * _2n;\n    const c2 = (q - _1n) / _2n_pow_c1; // 2. c2 = (q - 1) / (2^c1)  # Integer arithmetic\n    const c3 = (c2 - _1n) / _2n; // 3. c3 = (c2 - 1) / 2            # Integer arithmetic\n    const c4 = _2n_pow_c1 - _1n; // 4. c4 = 2^c1 - 1                # Integer arithmetic\n    const c5 = _2n_pow_c1_1; // 5. c5 = 2^(c1 - 1)                  # Integer arithmetic\n    const c6 = Fp.pow(Z, c2); // 6. c6 = Z^c2\n    const c7 = Fp.pow(Z, (c2 + _1n) / _2n); // 7. c7 = Z^((c2 + 1) / 2)\n    let sqrtRatio = (u, v) => {\n        let tv1 = c6; // 1. tv1 = c6\n        let tv2 = Fp.pow(v, c4); // 2. tv2 = v^c4\n        let tv3 = Fp.sqr(tv2); // 3. tv3 = tv2^2\n        tv3 = Fp.mul(tv3, v); // 4. tv3 = tv3 * v\n        let tv5 = Fp.mul(u, tv3); // 5. tv5 = u * tv3\n        tv5 = Fp.pow(tv5, c3); // 6. tv5 = tv5^c3\n        tv5 = Fp.mul(tv5, tv2); // 7. tv5 = tv5 * tv2\n        tv2 = Fp.mul(tv5, v); // 8. tv2 = tv5 * v\n        tv3 = Fp.mul(tv5, u); // 9. tv3 = tv5 * u\n        let tv4 = Fp.mul(tv3, tv2); // 10. tv4 = tv3 * tv2\n        tv5 = Fp.pow(tv4, c5); // 11. tv5 = tv4^c5\n        let isQR = Fp.eql(tv5, Fp.ONE); // 12. isQR = tv5 == 1\n        tv2 = Fp.mul(tv3, c7); // 13. tv2 = tv3 * c7\n        tv5 = Fp.mul(tv4, tv1); // 14. tv5 = tv4 * tv1\n        tv3 = Fp.cmov(tv2, tv3, isQR); // 15. tv3 = CMOV(tv2, tv3, isQR)\n        tv4 = Fp.cmov(tv5, tv4, isQR); // 16. tv4 = CMOV(tv5, tv4, isQR)\n        // 17. for i in (c1, c1 - 1, ..., 2):\n        for (let i = c1; i > _1n; i--) {\n            let tv5 = i - _2n; // 18.    tv5 = i - 2\n            tv5 = _2n << (tv5 - _1n); // 19.    tv5 = 2^tv5\n            let tvv5 = Fp.pow(tv4, tv5); // 20.    tv5 = tv4^tv5\n            const e1 = Fp.eql(tvv5, Fp.ONE); // 21.    e1 = tv5 == 1\n            tv2 = Fp.mul(tv3, tv1); // 22.    tv2 = tv3 * tv1\n            tv1 = Fp.mul(tv1, tv1); // 23.    tv1 = tv1 * tv1\n            tvv5 = Fp.mul(tv4, tv1); // 24.    tv5 = tv4 * tv1\n            tv3 = Fp.cmov(tv2, tv3, e1); // 25.    tv3 = CMOV(tv2, tv3, e1)\n            tv4 = Fp.cmov(tvv5, tv4, e1); // 26.    tv4 = CMOV(tv5, tv4, e1)\n        }\n        return { isValid: isQR, value: tv3 };\n    };\n    if (Fp.ORDER % _4n === _3n) {\n        // sqrt_ratio_3mod4(u, v)\n        const c1 = (Fp.ORDER - _3n) / _4n; // 1. c1 = (q - 3) / 4     # Integer arithmetic\n        const c2 = Fp.sqrt(Fp.neg(Z)); // 2. c2 = sqrt(-Z)\n        sqrtRatio = (u, v) => {\n            let tv1 = Fp.sqr(v); // 1. tv1 = v^2\n            const tv2 = Fp.mul(u, v); // 2. tv2 = u * v\n            tv1 = Fp.mul(tv1, tv2); // 3. tv1 = tv1 * tv2\n            let y1 = Fp.pow(tv1, c1); // 4. y1 = tv1^c1\n            y1 = Fp.mul(y1, tv2); // 5. y1 = y1 * tv2\n            const y2 = Fp.mul(y1, c2); // 6. y2 = y1 * c2\n            const tv3 = Fp.mul(Fp.sqr(y1), v); // 7. tv3 = y1^2; 8. tv3 = tv3 * v\n            const isQR = Fp.eql(tv3, u); // 9. isQR = tv3 == u\n            let y = Fp.cmov(y2, y1, isQR); // 10. y = CMOV(y2, y1, isQR)\n            return { isValid: isQR, value: y }; // 11. return (isQR, y) isQR ? y : y*c2\n        };\n    }\n    // No curves uses that\n    // if (Fp.ORDER % _8n === _5n) // sqrt_ratio_5mod8\n    return sqrtRatio;\n}\n/**\n * Simplified Shallue-van de Woestijne-Ulas Method\n * https://www.rfc-editor.org/rfc/rfc9380#section-6.6.2\n */\nexport function mapToCurveSimpleSWU(Fp, opts) {\n    mod.validateField(Fp);\n    if (!Fp.isValid(opts.A) || !Fp.isValid(opts.B) || !Fp.isValid(opts.Z))\n        throw new Error('mapToCurveSimpleSWU: invalid opts');\n    const sqrtRatio = SWUFpSqrtRatio(Fp, opts.Z);\n    if (!Fp.isOdd)\n        throw new Error('Fp.isOdd is not implemented!');\n    // Input: u, an element of F.\n    // Output: (x, y), a point on E.\n    return (u) => {\n        // prettier-ignore\n        let tv1, tv2, tv3, tv4, tv5, tv6, x, y;\n        tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n        tv1 = Fp.mul(tv1, opts.Z); // 2.  tv1 = Z * tv1\n        tv2 = Fp.sqr(tv1); // 3.  tv2 = tv1^2\n        tv2 = Fp.add(tv2, tv1); // 4.  tv2 = tv2 + tv1\n        tv3 = Fp.add(tv2, Fp.ONE); // 5.  tv3 = tv2 + 1\n        tv3 = Fp.mul(tv3, opts.B); // 6.  tv3 = B * tv3\n        tv4 = Fp.cmov(opts.Z, Fp.neg(tv2), !Fp.eql(tv2, Fp.ZERO)); // 7.  tv4 = CMOV(Z, -tv2, tv2 != 0)\n        tv4 = Fp.mul(tv4, opts.A); // 8.  tv4 = A * tv4\n        tv2 = Fp.sqr(tv3); // 9.  tv2 = tv3^2\n        tv6 = Fp.sqr(tv4); // 10. tv6 = tv4^2\n        tv5 = Fp.mul(tv6, opts.A); // 11. tv5 = A * tv6\n        tv2 = Fp.add(tv2, tv5); // 12. tv2 = tv2 + tv5\n        tv2 = Fp.mul(tv2, tv3); // 13. tv2 = tv2 * tv3\n        tv6 = Fp.mul(tv6, tv4); // 14. tv6 = tv6 * tv4\n        tv5 = Fp.mul(tv6, opts.B); // 15. tv5 = B * tv6\n        tv2 = Fp.add(tv2, tv5); // 16. tv2 = tv2 + tv5\n        x = Fp.mul(tv1, tv3); // 17.   x = tv1 * tv3\n        const { isValid, value } = sqrtRatio(tv2, tv6); // 18. (is_gx1_square, y1) = sqrt_ratio(tv2, tv6)\n        y = Fp.mul(tv1, u); // 19.   y = tv1 * u  -> Z * u^3 * y1\n        y = Fp.mul(y, value); // 20.   y = y * y1\n        x = Fp.cmov(x, tv3, isValid); // 21.   x = CMOV(x, tv3, is_gx1_square)\n        y = Fp.cmov(y, value, isValid); // 22.   y = CMOV(y, y1, is_gx1_square)\n        const e1 = Fp.isOdd(u) === Fp.isOdd(y); // 23.  e1 = sgn0(u) == sgn0(y)\n        y = Fp.cmov(Fp.neg(y), y, e1); // 24.   y = CMOV(-y, y, e1)\n        x = Fp.div(x, tv4); // 25.   x = x / tv4\n        return { x, y };\n    };\n}\n//# sourceMappingURL=weierstrass.js.map","import { hash as assertHash, bytes as assertBytes, exists as assertExists } from './_assert.js';\nimport { Hash, toBytes } from './utils.js';\n// HMAC (RFC 2104)\nexport class HMAC extends Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        assertHash(hash);\n        const key = toBytes(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        assertExists(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        assertExists(this);\n        assertBytes(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n */\nexport const hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nhmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { hmac } from '@noble/hashes/hmac';\nimport { concatBytes, randomBytes } from '@noble/hashes/utils';\nimport { weierstrass } from './abstract/weierstrass.js';\n// connects noble-curves to noble-hashes\nexport function getHash(hash) {\n    return {\n        hash,\n        hmac: (key, ...msgs) => hmac(hash, key, concatBytes(...msgs)),\n        randomBytes,\n    };\n}\nexport function createCurve(curveDef, defHash) {\n    const create = (hash) => weierstrass({ ...curveDef, ...getHash(hash) });\n    return Object.freeze({ ...create(defHash), create });\n}\n//# sourceMappingURL=_shortw_utils.js.map","/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nimport { sha256 } from '@noble/hashes/sha256';\nimport { randomBytes } from '@noble/hashes/utils';\nimport { Field, mod, pow2 } from './abstract/modular.js';\nimport { mapToCurveSimpleSWU } from './abstract/weierstrass.js';\nimport { bytesToNumberBE, concatBytes, ensureBytes, numberToBytesBE } from './abstract/utils.js';\nimport { createHasher, isogenyMap } from './abstract/hash-to-curve.js';\nimport { createCurve } from './_shortw_utils.js';\nconst secp256k1P = BigInt('0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f');\nconst secp256k1N = BigInt('0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141');\nconst _1n = BigInt(1);\nconst _2n = BigInt(2);\nconst divNearest = (a, b) => (a + b / _2n) / b;\n/**\n * √n = n^((p+1)/4) for fields p = 3 mod 4. We unwrap the loop and multiply bit-by-bit.\n * (P+1n/4n).toString(2) would produce bits [223x 1, 0, 22x 1, 4x 0, 11, 00]\n */\nfunction sqrtMod(y) {\n    const P = secp256k1P;\n    // prettier-ignore\n    const _3n = BigInt(3), _6n = BigInt(6), _11n = BigInt(11), _22n = BigInt(22);\n    // prettier-ignore\n    const _23n = BigInt(23), _44n = BigInt(44), _88n = BigInt(88);\n    const b2 = (y * y * y) % P; // x^3, 11\n    const b3 = (b2 * b2 * y) % P; // x^7\n    const b6 = (pow2(b3, _3n, P) * b3) % P;\n    const b9 = (pow2(b6, _3n, P) * b3) % P;\n    const b11 = (pow2(b9, _2n, P) * b2) % P;\n    const b22 = (pow2(b11, _11n, P) * b11) % P;\n    const b44 = (pow2(b22, _22n, P) * b22) % P;\n    const b88 = (pow2(b44, _44n, P) * b44) % P;\n    const b176 = (pow2(b88, _88n, P) * b88) % P;\n    const b220 = (pow2(b176, _44n, P) * b44) % P;\n    const b223 = (pow2(b220, _3n, P) * b3) % P;\n    const t1 = (pow2(b223, _23n, P) * b22) % P;\n    const t2 = (pow2(t1, _6n, P) * b2) % P;\n    const root = pow2(t2, _2n, P);\n    if (!Fp.eql(Fp.sqr(root), y))\n        throw new Error('Cannot find square root');\n    return root;\n}\nconst Fp = Field(secp256k1P, undefined, undefined, { sqrt: sqrtMod });\nexport const secp256k1 = createCurve({\n    a: BigInt(0), // equation params: a, b\n    b: BigInt(7), // Seem to be rigid: bitcointalk.org/index.php?topic=289795.msg3183975#msg3183975\n    Fp, // Field's prime: 2n**256n - 2n**32n - 2n**9n - 2n**8n - 2n**7n - 2n**6n - 2n**4n - 1n\n    n: secp256k1N, // Curve order, total count of valid points in the field\n    // Base point (x, y) aka generator point\n    Gx: BigInt('55066263022277343669578718895168534326250603453777594175500187360389116729240'),\n    Gy: BigInt('32670510020758816978083085130507043184471273380659243275938904335757337482424'),\n    h: BigInt(1), // Cofactor\n    lowS: true, // Allow only low-S signatures by default in sign() and verify()\n    /**\n     * secp256k1 belongs to Koblitz curves: it has efficiently computable endomorphism.\n     * Endomorphism uses 2x less RAM, speeds up precomputation by 2x and ECDH / key recovery by 20%.\n     * For precomputed wNAF it trades off 1/2 init time & 1/3 ram for 20% perf hit.\n     * Explanation: https://gist.github.com/paulmillr/eb670806793e84df628a7c434a873066\n     */\n    endo: {\n        beta: BigInt('0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee'),\n        splitScalar: (k) => {\n            const n = secp256k1N;\n            const a1 = BigInt('0x3086d221a7d46bcde86c90e49284eb15');\n            const b1 = -_1n * BigInt('0xe4437ed6010e88286f547fa90abfe4c3');\n            const a2 = BigInt('0x114ca50f7a8e2f3f657c1108d9d44cfd8');\n            const b2 = a1;\n            const POW_2_128 = BigInt('0x100000000000000000000000000000000'); // (2n**128n).toString(16)\n            const c1 = divNearest(b2 * k, n);\n            const c2 = divNearest(-b1 * k, n);\n            let k1 = mod(k - c1 * a1 - c2 * a2, n);\n            let k2 = mod(-c1 * b1 - c2 * b2, n);\n            const k1neg = k1 > POW_2_128;\n            const k2neg = k2 > POW_2_128;\n            if (k1neg)\n                k1 = n - k1;\n            if (k2neg)\n                k2 = n - k2;\n            if (k1 > POW_2_128 || k2 > POW_2_128) {\n                throw new Error('splitScalar: Endomorphism failed, k=' + k);\n            }\n            return { k1neg, k1, k2neg, k2 };\n        },\n    },\n}, sha256);\n// Schnorr signatures are superior to ECDSA from above. Below is Schnorr-specific BIP0340 code.\n// https://github.com/bitcoin/bips/blob/master/bip-0340.mediawiki\nconst _0n = BigInt(0);\nconst fe = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1P;\nconst ge = (x) => typeof x === 'bigint' && _0n < x && x < secp256k1N;\n/** An object mapping tags to their tagged hash prefix of [SHA256(tag) | SHA256(tag)] */\nconst TAGGED_HASH_PREFIXES = {};\nfunction taggedHash(tag, ...messages) {\n    let tagP = TAGGED_HASH_PREFIXES[tag];\n    if (tagP === undefined) {\n        const tagH = sha256(Uint8Array.from(tag, (c) => c.charCodeAt(0)));\n        tagP = concatBytes(tagH, tagH);\n        TAGGED_HASH_PREFIXES[tag] = tagP;\n    }\n    return sha256(concatBytes(tagP, ...messages));\n}\n// ECDSA compact points are 33-byte. Schnorr is 32: we strip first byte 0x02 or 0x03\nconst pointToBytes = (point) => point.toRawBytes(true).slice(1);\nconst numTo32b = (n) => numberToBytesBE(n, 32);\nconst modP = (x) => mod(x, secp256k1P);\nconst modN = (x) => mod(x, secp256k1N);\nconst Point = secp256k1.ProjectivePoint;\nconst GmulAdd = (Q, a, b) => Point.BASE.multiplyAndAddUnsafe(Q, a, b);\n// Calculate point, scalar and bytes\nfunction schnorrGetExtPubKey(priv) {\n    let d_ = secp256k1.utils.normPrivateKeyToScalar(priv); // same method executed in fromPrivateKey\n    let p = Point.fromPrivateKey(d_); // P = d'⋅G; 0 < d' < n check is done inside\n    const scalar = p.hasEvenY() ? d_ : modN(-d_);\n    return { scalar: scalar, bytes: pointToBytes(p) };\n}\n/**\n * lift_x from BIP340. Convert 32-byte x coordinate to elliptic curve point.\n * @returns valid point checked for being on-curve\n */\nfunction lift_x(x) {\n    if (!fe(x))\n        throw new Error('bad x: need 0 < x < p'); // Fail if x ≥ p.\n    const xx = modP(x * x);\n    const c = modP(xx * x + BigInt(7)); // Let c = x³ + 7 mod p.\n    let y = sqrtMod(c); // Let y = c^(p+1)/4 mod p.\n    if (y % _2n !== _0n)\n        y = modP(-y); // Return the unique point P such that x(P) = x and\n    const p = new Point(x, y, _1n); // y(P) = y if y mod 2 = 0 or y(P) = p-y otherwise.\n    p.assertValidity();\n    return p;\n}\n/**\n * Create tagged hash, convert it to bigint, reduce modulo-n.\n */\nfunction challenge(...args) {\n    return modN(bytesToNumberBE(taggedHash('BIP0340/challenge', ...args)));\n}\n/**\n * Schnorr public key is just `x` coordinate of Point as per BIP340.\n */\nfunction schnorrGetPublicKey(privateKey) {\n    return schnorrGetExtPubKey(privateKey).bytes; // d'=int(sk). Fail if d'=0 or d'≥n. Ret bytes(d'⋅G)\n}\n/**\n * Creates Schnorr signature as per BIP340. Verifies itself before returning anything.\n * auxRand is optional and is not the sole source of k generation: bad CSPRNG won't be dangerous.\n */\nfunction schnorrSign(message, privateKey, auxRand = randomBytes(32)) {\n    const m = ensureBytes('message', message);\n    const { bytes: px, scalar: d } = schnorrGetExtPubKey(privateKey); // checks for isWithinCurveOrder\n    const a = ensureBytes('auxRand', auxRand, 32); // Auxiliary random data a: a 32-byte array\n    const t = numTo32b(d ^ bytesToNumberBE(taggedHash('BIP0340/aux', a))); // Let t be the byte-wise xor of bytes(d) and hash/aux(a)\n    const rand = taggedHash('BIP0340/nonce', t, px, m); // Let rand = hash/nonce(t || bytes(P) || m)\n    const k_ = modN(bytesToNumberBE(rand)); // Let k' = int(rand) mod n\n    if (k_ === _0n)\n        throw new Error('sign failed: k is zero'); // Fail if k' = 0.\n    const { bytes: rx, scalar: k } = schnorrGetExtPubKey(k_); // Let R = k'⋅G.\n    const e = challenge(rx, px, m); // Let e = int(hash/challenge(bytes(R) || bytes(P) || m)) mod n.\n    const sig = new Uint8Array(64); // Let sig = bytes(R) || bytes((k + ed) mod n).\n    sig.set(rx, 0);\n    sig.set(numTo32b(modN(k + e * d)), 32);\n    // If Verify(bytes(P), m, sig) (see below) returns failure, abort\n    if (!schnorrVerify(sig, m, px))\n        throw new Error('sign: Invalid signature produced');\n    return sig;\n}\n/**\n * Verifies Schnorr signature.\n * Will swallow errors & return false except for initial type validation of arguments.\n */\nfunction schnorrVerify(signature, message, publicKey) {\n    const sig = ensureBytes('signature', signature, 64);\n    const m = ensureBytes('message', message);\n    const pub = ensureBytes('publicKey', publicKey, 32);\n    try {\n        const P = lift_x(bytesToNumberBE(pub)); // P = lift_x(int(pk)); fail if that fails\n        const r = bytesToNumberBE(sig.subarray(0, 32)); // Let r = int(sig[0:32]); fail if r ≥ p.\n        if (!fe(r))\n            return false;\n        const s = bytesToNumberBE(sig.subarray(32, 64)); // Let s = int(sig[32:64]); fail if s ≥ n.\n        if (!ge(s))\n            return false;\n        const e = challenge(numTo32b(r), pointToBytes(P), m); // int(challenge(bytes(r)||bytes(P)||m))%n\n        const R = GmulAdd(P, s, modN(-e)); // R = s⋅G - e⋅P\n        if (!R || !R.hasEvenY() || R.toAffine().x !== r)\n            return false; // -eP == (n-e)P\n        return true; // Fail if is_infinite(R) / not has_even_y(R) / x(R) ≠ r.\n    }\n    catch (error) {\n        return false;\n    }\n}\nexport const schnorr = /* @__PURE__ */ (() => ({\n    getPublicKey: schnorrGetPublicKey,\n    sign: schnorrSign,\n    verify: schnorrVerify,\n    utils: {\n        randomPrivateKey: secp256k1.utils.randomPrivateKey,\n        lift_x,\n        pointToBytes,\n        numberToBytesBE,\n        bytesToNumberBE,\n        taggedHash,\n        mod,\n    },\n}))();\nconst isoMap = /* @__PURE__ */ (() => isogenyMap(Fp, [\n    // xNum\n    [\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7',\n        '0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581',\n        '0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262',\n        '0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c',\n    ],\n    // xDen\n    [\n        '0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b',\n        '0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n    // yNum\n    [\n        '0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c',\n        '0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3',\n        '0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931',\n        '0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84',\n    ],\n    // yDen\n    [\n        '0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b',\n        '0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573',\n        '0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f',\n        '0x0000000000000000000000000000000000000000000000000000000000000001', // LAST 1\n    ],\n].map((i) => i.map((j) => BigInt(j)))))();\nconst mapSWU = /* @__PURE__ */ (() => mapToCurveSimpleSWU(Fp, {\n    A: BigInt('0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533'),\n    B: BigInt('1771'),\n    Z: Fp.create(BigInt('-11')),\n}))();\nconst htf = /* @__PURE__ */ (() => createHasher(secp256k1.ProjectivePoint, (scalars) => {\n    const { x, y } = mapSWU(Fp.create(scalars[0]));\n    return isoMap(x, y);\n}, {\n    DST: 'secp256k1_XMD:SHA-256_SSWU_RO_',\n    encodeDST: 'secp256k1_XMD:SHA-256_SSWU_NU_',\n    p: Fp.ORDER,\n    m: 1,\n    k: 128,\n    expand: 'xmd',\n    hash: sha256,\n}))();\nexport const hashToCurve = /* @__PURE__ */ (() => htf.hashToCurve)();\nexport const encodeToCurve = /* @__PURE__ */ (() => htf.encodeToCurve)();\n//# sourceMappingURL=secp256k1.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.LRUCacheNode = void 0;\r\nclass LRUCacheNode {\r\n    constructor(key, value, options) {\r\n        const { entryExpirationTimeInMS = null, next = null, prev = null, onEntryEvicted, onEntryMarkedAsMostRecentlyUsed, clone, cloneFn } = options !== null && options !== void 0 ? options : {};\r\n        if (typeof entryExpirationTimeInMS === 'number' &&\r\n            (entryExpirationTimeInMS <= 0 || Number.isNaN(entryExpirationTimeInMS))) {\r\n            throw new Error('entryExpirationTimeInMS must either be null (no expiry) or greater than 0');\r\n        }\r\n        this.clone = clone !== null && clone !== void 0 ? clone : false;\r\n        this.cloneFn = cloneFn !== null && cloneFn !== void 0 ? cloneFn : this.defaultClone;\r\n        this.key = key;\r\n        this.internalValue = this.clone ? this.cloneFn(value) : value;\r\n        this.created = Date.now();\r\n        this.entryExpirationTimeInMS = entryExpirationTimeInMS;\r\n        this.next = next;\r\n        this.prev = prev;\r\n        this.onEntryEvicted = onEntryEvicted;\r\n        this.onEntryMarkedAsMostRecentlyUsed = onEntryMarkedAsMostRecentlyUsed;\r\n    }\r\n    get value() {\r\n        return this.clone ? this.cloneFn(this.internalValue) : this.internalValue;\r\n    }\r\n    get isExpired() {\r\n        return typeof this.entryExpirationTimeInMS === 'number' && Date.now() - this.created > this.entryExpirationTimeInMS;\r\n    }\r\n    invokeOnEvicted() {\r\n        if (this.onEntryEvicted) {\r\n            const { key, value, isExpired } = this;\r\n            this.onEntryEvicted({ key, value, isExpired });\r\n        }\r\n    }\r\n    invokeOnEntryMarkedAsMostRecentlyUsed() {\r\n        if (this.onEntryMarkedAsMostRecentlyUsed) {\r\n            const { key, value } = this;\r\n            this.onEntryMarkedAsMostRecentlyUsed({ key, value });\r\n        }\r\n    }\r\n    defaultClone(value) {\r\n        if (typeof value === 'boolean' || typeof value === 'string' || typeof value === 'number') {\r\n            return value;\r\n        }\r\n        return JSON.parse(JSON.stringify(value));\r\n    }\r\n}\r\nexports.LRUCacheNode = LRUCacheNode;\r\n//# sourceMappingURL=LRUCacheNode.js.map","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.LRUCache = void 0;\r\nconst LRUCacheNode_1 = require(\"./LRUCacheNode\");\r\n/**\r\n * A key value cache that implements the LRU policy.\r\n *\r\n * @typeparam TKey The type of the keys in the cache. Defaults to `string`.\r\n * @typeparam TValue The type of the values in the cache. Defaults to `any`.\r\n *\r\n * @see {@link https://en.wikipedia.org/wiki/Cache_replacement_policies#Least_recently_used_(LRU)}\r\n */\r\nclass LRUCache {\r\n    /**\r\n     * Creates a new instance of the LRUCache.\r\n     *\r\n     * @param options Additional configuration options for the LRUCache.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * // No options.\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // With options.\r\n     * const cache = new LRUCache({\r\n     *  entryExpirationTimeInMS: 10000\r\n     * });\r\n     * ```\r\n     */\r\n    constructor(options) {\r\n        this.lookupTable = new Map();\r\n        this.head = null;\r\n        this.tail = null;\r\n        const { maxSize = 25, entryExpirationTimeInMS = null, onEntryEvicted, onEntryMarkedAsMostRecentlyUsed, cloneFn, clone } = options !== null && options !== void 0 ? options : {};\r\n        if (Number.isNaN(maxSize) || maxSize <= 0) {\r\n            throw new Error('maxSize must be greater than 0.');\r\n        }\r\n        if (typeof entryExpirationTimeInMS === 'number' &&\r\n            (entryExpirationTimeInMS <= 0 || Number.isNaN(entryExpirationTimeInMS))) {\r\n            throw new Error('entryExpirationTimeInMS must either be null (no expiry) or greater than 0');\r\n        }\r\n        this.maxSizeInternal = maxSize;\r\n        this.entryExpirationTimeInMS = entryExpirationTimeInMS;\r\n        this.onEntryEvicted = onEntryEvicted;\r\n        this.onEntryMarkedAsMostRecentlyUsed = onEntryMarkedAsMostRecentlyUsed;\r\n        this.clone = clone;\r\n        this.cloneFn = cloneFn;\r\n    }\r\n    /**\r\n     * Returns the number of entries in the LRUCache object.\r\n     * If the cache has entryExpirationTimeInMS set, expired entries will be removed before the size is returned.\r\n     *\r\n     * @returns The number of entries in the cache.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * const size = cache.size;\r\n     *\r\n     * // Will log 1\r\n     * console.log(size);\r\n     * ```\r\n     */\r\n    get size() {\r\n        this.cleanCache();\r\n        return this.lookupTable.size;\r\n    }\r\n    /**\r\n     * Returns the number of entries that can still be added to the LRUCache without evicting existing entries.\r\n     *\r\n     * @returns The number of entries that can still be added without evicting existing entries.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache({ maxSize: 10 });\r\n     *\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * const remainingSize = cache.remainingSize;\r\n     *\r\n     * // Will log 9 due to 9 spots remaining before reaching maxSize of 10.\r\n     * console.log(remainingSize);\r\n     * ```\r\n     */\r\n    get remainingSize() {\r\n        return this.maxSizeInternal - this.size;\r\n    }\r\n    /**\r\n     * Returns the most recently used (newest) entry in the cache.\r\n     * This will not mark the entry as recently used.\r\n     * If the newest node is expired, it will be removed.\r\n     *\r\n     * @returns The most recently used (newest) entry in the cache.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache({ maxSize: 10 });\r\n     *\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * const newest = cache.newest;\r\n     *\r\n     * // Will log testValue\r\n     * console.log(newest.value);\r\n     *\r\n     * // Will log testKey\r\n     * console.log(newest.key);\r\n     * ```\r\n     */\r\n    get newest() {\r\n        if (!this.head) {\r\n            return null;\r\n        }\r\n        if (this.head.isExpired) {\r\n            this.removeNodeFromListAndLookupTable(this.head);\r\n            return this.newest;\r\n        }\r\n        return this.mapNodeToEntry(this.head);\r\n    }\r\n    /**\r\n     * Returns the least recently used (oldest) entry in the cache.\r\n     * This will not mark the entry as recently used.\r\n     * If the oldest node is expired, it will be removed.\r\n     *\r\n     * @returns The least recently used (oldest) entry in the cache.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache({ maxSize: 10 });\r\n     *\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * const oldest = cache.oldest;\r\n     *\r\n     * // Will log testValue\r\n     * console.log(oldest.value);\r\n     *\r\n     * // Will log testKey\r\n     * console.log(oldest.key);\r\n     * ```\r\n     */\r\n    get oldest() {\r\n        if (!this.tail) {\r\n            return null;\r\n        }\r\n        if (this.tail.isExpired) {\r\n            this.removeNodeFromListAndLookupTable(this.tail);\r\n            return this.oldest;\r\n        }\r\n        return this.mapNodeToEntry(this.tail);\r\n    }\r\n    /**\r\n     * Gets or sets the maxSize of the cache.\r\n     * This will evict the least recently used entries if needed to reach new maxSize.\r\n     *\r\n     * @param value The new value for maxSize. Must be greater than 0.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache({ maxSize: 10 });\r\n     *\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * // Will be 10\r\n     * const maxSize = cache.maxSize;\r\n     *\r\n     * // Set new maxSize to 5. If there are more than 5 items in the cache, the least recently used entries will be removed until cache size is 5.\r\n     * cache.maxSize = 5;\r\n     * ```\r\n     */\r\n    get maxSize() {\r\n        return this.maxSizeInternal;\r\n    }\r\n    set maxSize(value) {\r\n        if (Number.isNaN(value) || value <= 0) {\r\n            throw new Error('maxSize must be greater than 0.');\r\n        }\r\n        this.maxSizeInternal = value;\r\n        this.enforceSizeLimit();\r\n    }\r\n    /**\r\n     * Sets the value for the key in the LRUCache object. Returns the LRUCache object.\r\n     * This marks the newly added entry as the most recently used entry.\r\n     * If adding the new entry makes the cache size go above maxSize,\r\n     * this will evict the least recently used entries until size is equal to maxSize.\r\n     *\r\n     * @param key The key of the entry.\r\n     * @param value The value to set for the key.\r\n     * @param entryOptions Additional configuration options for the cache entry.\r\n     *\r\n     * @returns The LRUCache instance.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * // Set the key key2 to value value2. Pass in optional options.\r\n     * cache.set('key2', 'value2', { entryExpirationTimeInMS: 10 });\r\n     * ```\r\n     */\r\n    set(key, value, entryOptions) {\r\n        const currentNodeForKey = this.lookupTable.get(key);\r\n        if (currentNodeForKey) {\r\n            this.removeNodeFromListAndLookupTable(currentNodeForKey);\r\n        }\r\n        const node = new LRUCacheNode_1.LRUCacheNode(key, value, {\r\n            entryExpirationTimeInMS: this.entryExpirationTimeInMS,\r\n            onEntryEvicted: this.onEntryEvicted,\r\n            onEntryMarkedAsMostRecentlyUsed: this.onEntryMarkedAsMostRecentlyUsed,\r\n            clone: this.clone,\r\n            cloneFn: this.cloneFn,\r\n            ...entryOptions\r\n        });\r\n        this.setNodeAsHead(node);\r\n        this.lookupTable.set(key, node);\r\n        this.enforceSizeLimit();\r\n        return this;\r\n    }\r\n    /**\r\n     * Returns the value associated to the key, or null if there is none or if the entry is expired.\r\n     * If an entry is returned, this marks the returned entry as the most recently used entry.\r\n     *\r\n     * @param key The key of the entry to get.\r\n     *\r\n     * @returns The cached value or null.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * // Will be 'testValue'. Entry will now be most recently used.\r\n     * const item1 = cache.get('testKey');\r\n     *\r\n     * // Will be null\r\n     * const item2 = cache.get('keyNotInCache');\r\n     * ```\r\n     */\r\n    get(key) {\r\n        const node = this.lookupTable.get(key);\r\n        if (!node) {\r\n            return null;\r\n        }\r\n        if (node.isExpired) {\r\n            this.removeNodeFromListAndLookupTable(node);\r\n            return null;\r\n        }\r\n        this.setNodeAsHead(node);\r\n        return node.value;\r\n    }\r\n    /**\r\n     * Returns the value associated to the key, or null if there is none or if the entry is expired.\r\n     * If an entry is returned, this will not mark the entry as most recently accessed.\r\n     * Useful if a value is needed but the order of the cache should not be changed.\r\n     *\r\n     * @param key The key of the entry to get.\r\n     *\r\n     * @returns The cached value or null.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * // Will be 'testValue'\r\n     * const item1 = cache.peek('testKey');\r\n     *\r\n     * // Will be null\r\n     * const item2 = cache.peek('keyNotInCache');\r\n     * ```\r\n     */\r\n    peek(key) {\r\n        const node = this.lookupTable.get(key);\r\n        if (!node) {\r\n            return null;\r\n        }\r\n        if (node.isExpired) {\r\n            this.removeNodeFromListAndLookupTable(node);\r\n            return null;\r\n        }\r\n        return node.value;\r\n    }\r\n    /**\r\n     * Deletes the entry for the passed in key.\r\n     *\r\n     * @param key The key of the entry to delete\r\n     *\r\n     * @returns True if an element in the LRUCache object existed and has been removed,\r\n     * or false if the element does not exist.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * // Will be true\r\n     * const wasDeleted = cache.delete('testKey');\r\n     *\r\n     * // Will be false\r\n     * const wasDeleted2 = cache.delete('keyNotInCache');\r\n     * ```\r\n     */\r\n    delete(key) {\r\n        const node = this.lookupTable.get(key);\r\n        if (!node) {\r\n            return false;\r\n        }\r\n        return this.removeNodeFromListAndLookupTable(node);\r\n    }\r\n    /**\r\n     * Returns a boolean asserting whether a value has been associated to the key in the LRUCache object or not.\r\n     * This does not mark the entry as recently used.\r\n     * If the cache has a key but the entry is expired, it will be removed and false will be returned.\r\n     *\r\n     * @param key The key of the entry to check if exists\r\n     *\r\n     * @returns true if the cache contains the supplied key. False if not.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * // Will be true\r\n     * const wasDeleted = cache.has('testKey');\r\n     *\r\n     * // Will be false\r\n     * const wasDeleted2 = cache.has('keyNotInCache');\r\n     * ```\r\n     */\r\n    has(key) {\r\n        const node = this.lookupTable.get(key);\r\n        if (!node) {\r\n            return false;\r\n        }\r\n        if (node.isExpired) {\r\n            this.removeNodeFromListAndLookupTable(node);\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * Removes all entries in the cache.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * // Clear cache.\r\n     * cache.clear();\r\n     * ```\r\n     */\r\n    clear() {\r\n        this.head = null;\r\n        this.tail = null;\r\n        this.lookupTable.clear();\r\n    }\r\n    /**\r\n     * Searches the cache for an entry matching the passed in condition.\r\n     * Expired entries will be skipped (and removed).\r\n     * If multiply entries in the cache match the condition, the most recently used entry will be returned.\r\n     * If an entry is returned, this marks the returned entry as the most recently used entry.\r\n     *\r\n     * @param condition The condition to apply to each entry in the\r\n     *\r\n     * @returns The first cache entry to match the condition. Null if none match.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * // item will be { key: 'testKey', value: 'testValue }\r\n     * const item = cache.find(entry => {\r\n     *   const { key, value } = entry;\r\n     *\r\n     *   if (key === 'testKey' || value === 'something') {\r\n     *     return true;\r\n     *   }\r\n     *\r\n     *   return false;\r\n     * });\r\n     *\r\n     * // item2 will be null\r\n     * const item2 = cache.find(entry => entry.key === 'notInCache');\r\n     * ```\r\n     */\r\n    find(condition) {\r\n        let node = this.head;\r\n        while (node) {\r\n            if (node.isExpired) {\r\n                const next = node.next;\r\n                this.removeNodeFromListAndLookupTable(node);\r\n                node = next;\r\n                continue;\r\n            }\r\n            const entry = this.mapNodeToEntry(node);\r\n            if (condition(entry)) {\r\n                this.setNodeAsHead(node);\r\n                return entry;\r\n            }\r\n            node = node.next;\r\n        }\r\n        return null;\r\n    }\r\n    /**\r\n     * Iterates over and applies the callback function to each entry in the cache.\r\n     * Iterates in order from most recently accessed entry to least recently.\r\n     * Expired entries will be skipped (and removed).\r\n     * No entry will be marked as recently used.\r\n     *\r\n     * @param callback the callback function to apply to the entry\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * cache.forEach((key, value, index) => {\r\n     *   // do something with key, value, and/or index\r\n     * });\r\n     * ```\r\n     */\r\n    forEach(callback) {\r\n        let node = this.head;\r\n        let index = 0;\r\n        while (node) {\r\n            if (node.isExpired) {\r\n                const next = node.next;\r\n                this.removeNodeFromListAndLookupTable(node);\r\n                node = next;\r\n                continue;\r\n            }\r\n            callback(node.value, node.key, index);\r\n            node = node.next;\r\n            index++;\r\n        }\r\n    }\r\n    /**\r\n     * Creates a Generator which can be used with for ... of ... to iterate over the cache values.\r\n     * Iterates in order from most recently accessed entry to least recently.\r\n     * Expired entries will be skipped (and removed).\r\n     * No entry will be marked as accessed.\r\n     *\r\n     * @returns A Generator for the cache values.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * for (const value of cache.values()) {\r\n     *   // do something with the value\r\n     * }\r\n     * ```\r\n     */\r\n    *values() {\r\n        let node = this.head;\r\n        while (node) {\r\n            if (node.isExpired) {\r\n                const next = node.next;\r\n                this.removeNodeFromListAndLookupTable(node);\r\n                node = next;\r\n                continue;\r\n            }\r\n            yield node.value;\r\n            node = node.next;\r\n        }\r\n    }\r\n    /**\r\n     * Creates a Generator which can be used with for ... of ... to iterate over the cache keys.\r\n     * Iterates in order from most recently accessed entry to least recently.\r\n     * Expired entries will be skipped (and removed).\r\n     * No entry will be marked as accessed.\r\n     *\r\n     * @returns A Generator for the cache keys.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * for (const key of cache.keys()) {\r\n     *   // do something with the key\r\n     * }\r\n     * ```\r\n     */\r\n    *keys() {\r\n        let node = this.head;\r\n        while (node) {\r\n            if (node.isExpired) {\r\n                const next = node.next;\r\n                this.removeNodeFromListAndLookupTable(node);\r\n                node = next;\r\n                continue;\r\n            }\r\n            yield node.key;\r\n            node = node.next;\r\n        }\r\n    }\r\n    /**\r\n     * Creates a Generator which can be used with for ... of ... to iterate over the cache entries.\r\n     * Iterates in order from most recently accessed entry to least recently.\r\n     * Expired entries will be skipped (and removed).\r\n     * No entry will be marked as accessed.\r\n     *\r\n     * @returns A Generator for the cache entries.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * for (const entry of cache.entries()) {\r\n     *   const { key, value } = entry;\r\n     *   // do something with the entry\r\n     * }\r\n     * ```\r\n     */\r\n    *entries() {\r\n        let node = this.head;\r\n        while (node) {\r\n            if (node.isExpired) {\r\n                const next = node.next;\r\n                this.removeNodeFromListAndLookupTable(node);\r\n                node = next;\r\n                continue;\r\n            }\r\n            yield this.mapNodeToEntry(node);\r\n            node = node.next;\r\n        }\r\n    }\r\n    /**\r\n     * Creates a Generator which can be used with for ... of ... to iterate over the cache entries.\r\n     * Iterates in order from most recently accessed entry to least recently.\r\n     * Expired entries will be skipped (and removed).\r\n     * No entry will be marked as accessed.\r\n     *\r\n     * @returns A Generator for the cache entries.\r\n     *\r\n     * @example\r\n     * ```typescript\r\n     * const cache = new LRUCache();\r\n     *\r\n     * // Set the key testKey to value testValue\r\n     * cache.set('testKey', 'testValue');\r\n     *\r\n     * for (const entry of cache) {\r\n     *   const { key, value } = entry;\r\n     *   // do something with the entry\r\n     * }\r\n     * ```\r\n     */\r\n    *[Symbol.iterator]() {\r\n        let node = this.head;\r\n        while (node) {\r\n            if (node.isExpired) {\r\n                const next = node.next;\r\n                this.removeNodeFromListAndLookupTable(node);\r\n                node = next;\r\n                continue;\r\n            }\r\n            yield this.mapNodeToEntry(node);\r\n            node = node.next;\r\n        }\r\n    }\r\n    enforceSizeLimit() {\r\n        let node = this.tail;\r\n        while (node !== null && this.size > this.maxSizeInternal) {\r\n            const prev = node.prev;\r\n            this.removeNodeFromListAndLookupTable(node);\r\n            node = prev;\r\n        }\r\n    }\r\n    mapNodeToEntry({ key, value }) {\r\n        return {\r\n            key,\r\n            value\r\n        };\r\n    }\r\n    setNodeAsHead(node) {\r\n        this.removeNodeFromList(node);\r\n        if (!this.head) {\r\n            this.head = node;\r\n            this.tail = node;\r\n        }\r\n        else {\r\n            node.next = this.head;\r\n            this.head.prev = node;\r\n            this.head = node;\r\n        }\r\n        node.invokeOnEntryMarkedAsMostRecentlyUsed();\r\n    }\r\n    removeNodeFromList(node) {\r\n        if (node.prev !== null) {\r\n            node.prev.next = node.next;\r\n        }\r\n        if (node.next !== null) {\r\n            node.next.prev = node.prev;\r\n        }\r\n        if (this.head === node) {\r\n            this.head = node.next;\r\n        }\r\n        if (this.tail === node) {\r\n            this.tail = node.prev;\r\n        }\r\n        node.next = null;\r\n        node.prev = null;\r\n    }\r\n    removeNodeFromListAndLookupTable(node) {\r\n        node.invokeOnEvicted();\r\n        this.removeNodeFromList(node);\r\n        return this.lookupTable.delete(node.key);\r\n    }\r\n    cleanCache() {\r\n        // Don't spend time cleaning if entries don't expire.\r\n        if (!this.entryExpirationTimeInMS) {\r\n            return;\r\n        }\r\n        const expiredNodes = [];\r\n        for (const node of this.lookupTable.values()) {\r\n            if (node.isExpired) {\r\n                expiredNodes.push(node);\r\n            }\r\n        }\r\n        expiredNodes.forEach(node => this.removeNodeFromListAndLookupTable(node));\r\n    }\r\n}\r\nexports.LRUCache = LRUCache;\r\n//# sourceMappingURL=LRUCache.js.map","\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n      desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\n__exportStar(require(\"./LRUCache\"), exports);\r\n//# sourceMappingURL=index.js.map","\"use strict\";\n/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.bytes = exports.stringToBytes = exports.str = exports.bytesToString = exports.hex = exports.utf8 = exports.bech32m = exports.bech32 = exports.base58check = exports.base58xmr = exports.base58xrp = exports.base58flickr = exports.base58 = exports.base64url = exports.base64 = exports.base32crockford = exports.base32hex = exports.base32 = exports.base16 = exports.utils = exports.assertNumber = void 0;\nfunction assertNumber(n) {\n    if (!Number.isSafeInteger(n))\n        throw new Error(`Wrong integer: ${n}`);\n}\nexports.assertNumber = assertNumber;\nfunction chain(...args) {\n    const wrap = (a, b) => (c) => a(b(c));\n    const encode = Array.from(args)\n        .reverse()\n        .reduce((acc, i) => (acc ? wrap(acc, i.encode) : i.encode), undefined);\n    const decode = args.reduce((acc, i) => (acc ? wrap(acc, i.decode) : i.decode), undefined);\n    return { encode, decode };\n}\nfunction alphabet(alphabet) {\n    return {\n        encode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('alphabet.encode input should be an array of numbers');\n            return digits.map((i) => {\n                assertNumber(i);\n                if (i < 0 || i >= alphabet.length)\n                    throw new Error(`Digit index outside alphabet: ${i} (alphabet: ${alphabet.length})`);\n                return alphabet[i];\n            });\n        },\n        decode: (input) => {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('alphabet.decode input should be array of strings');\n            return input.map((letter) => {\n                if (typeof letter !== 'string')\n                    throw new Error(`alphabet.decode: not string element=${letter}`);\n                const index = alphabet.indexOf(letter);\n                if (index === -1)\n                    throw new Error(`Unknown letter: \"${letter}\". Allowed: ${alphabet}`);\n                return index;\n            });\n        },\n    };\n}\nfunction join(separator = '') {\n    if (typeof separator !== 'string')\n        throw new Error('join separator should be string');\n    return {\n        encode: (from) => {\n            if (!Array.isArray(from) || (from.length && typeof from[0] !== 'string'))\n                throw new Error('join.encode input should be array of strings');\n            for (let i of from)\n                if (typeof i !== 'string')\n                    throw new Error(`join.encode: non-string input=${i}`);\n            return from.join(separator);\n        },\n        decode: (to) => {\n            if (typeof to !== 'string')\n                throw new Error('join.decode input should be string');\n            return to.split(separator);\n        },\n    };\n}\nfunction padding(bits, chr = '=') {\n    assertNumber(bits);\n    if (typeof chr !== 'string')\n        throw new Error('padding chr should be string');\n    return {\n        encode(data) {\n            if (!Array.isArray(data) || (data.length && typeof data[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of data)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.encode: non-string input=${i}`);\n            while ((data.length * bits) % 8)\n                data.push(chr);\n            return data;\n        },\n        decode(input) {\n            if (!Array.isArray(input) || (input.length && typeof input[0] !== 'string'))\n                throw new Error('padding.encode input should be array of strings');\n            for (let i of input)\n                if (typeof i !== 'string')\n                    throw new Error(`padding.decode: non-string input=${i}`);\n            let end = input.length;\n            if ((end * bits) % 8)\n                throw new Error('Invalid padding: string should have whole number of bytes');\n            for (; end > 0 && input[end - 1] === chr; end--) {\n                if (!(((end - 1) * bits) % 8))\n                    throw new Error('Invalid padding: string has too much padding');\n            }\n            return input.slice(0, end);\n        },\n    };\n}\nfunction normalize(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('normalize fn should be function');\n    return { encode: (from) => from, decode: (to) => fn(to) };\n}\nfunction convertRadix(data, from, to) {\n    if (from < 2)\n        throw new Error(`convertRadix: wrong from=${from}, base cannot be less than 2`);\n    if (to < 2)\n        throw new Error(`convertRadix: wrong to=${to}, base cannot be less than 2`);\n    if (!Array.isArray(data))\n        throw new Error('convertRadix: data should be array');\n    if (!data.length)\n        return [];\n    let pos = 0;\n    const res = [];\n    const digits = Array.from(data);\n    digits.forEach((d) => {\n        assertNumber(d);\n        if (d < 0 || d >= from)\n            throw new Error(`Wrong integer: ${d}`);\n    });\n    while (true) {\n        let carry = 0;\n        let done = true;\n        for (let i = pos; i < digits.length; i++) {\n            const digit = digits[i];\n            const digitBase = from * carry + digit;\n            if (!Number.isSafeInteger(digitBase) ||\n                (from * carry) / from !== carry ||\n                digitBase - digit !== from * carry) {\n                throw new Error('convertRadix: carry overflow');\n            }\n            carry = digitBase % to;\n            digits[i] = Math.floor(digitBase / to);\n            if (!Number.isSafeInteger(digits[i]) || digits[i] * to + carry !== digitBase)\n                throw new Error('convertRadix: carry overflow');\n            if (!done)\n                continue;\n            else if (!digits[i])\n                pos = i;\n            else\n                done = false;\n        }\n        res.push(carry);\n        if (done)\n            break;\n    }\n    for (let i = 0; i < data.length - 1 && data[i] === 0; i++)\n        res.push(0);\n    return res.reverse();\n}\nconst gcd = (a, b) => (!b ? a : gcd(b, a % b));\nconst radix2carry = (from, to) => from + (to - gcd(from, to));\nfunction convertRadix2(data, from, to, padding) {\n    if (!Array.isArray(data))\n        throw new Error('convertRadix2: data should be array');\n    if (from <= 0 || from > 32)\n        throw new Error(`convertRadix2: wrong from=${from}`);\n    if (to <= 0 || to > 32)\n        throw new Error(`convertRadix2: wrong to=${to}`);\n    if (radix2carry(from, to) > 32) {\n        throw new Error(`convertRadix2: carry overflow from=${from} to=${to} carryBits=${radix2carry(from, to)}`);\n    }\n    let carry = 0;\n    let pos = 0;\n    const mask = 2 ** to - 1;\n    const res = [];\n    for (const n of data) {\n        assertNumber(n);\n        if (n >= 2 ** from)\n            throw new Error(`convertRadix2: invalid data word=${n} from=${from}`);\n        carry = (carry << from) | n;\n        if (pos + from > 32)\n            throw new Error(`convertRadix2: carry overflow pos=${pos} from=${from}`);\n        pos += from;\n        for (; pos >= to; pos -= to)\n            res.push(((carry >> (pos - to)) & mask) >>> 0);\n        carry &= 2 ** pos - 1;\n    }\n    carry = (carry << (to - pos)) & mask;\n    if (!padding && pos >= from)\n        throw new Error('Excess padding');\n    if (!padding && carry)\n        throw new Error(`Non-zero padding: ${carry}`);\n    if (padding && pos > 0)\n        res.push(carry >>> 0);\n    return res;\n}\nfunction radix(num) {\n    assertNumber(num);\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix.encode input should be Uint8Array');\n            return convertRadix(Array.from(bytes), 2 ** 8, num);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix.decode input should be array of strings');\n            return Uint8Array.from(convertRadix(digits, num, 2 ** 8));\n        },\n    };\n}\nfunction radix2(bits, revPadding = false) {\n    assertNumber(bits);\n    if (bits <= 0 || bits > 32)\n        throw new Error('radix2: bits should be in (0..32]');\n    if (radix2carry(8, bits) > 32 || radix2carry(bits, 8) > 32)\n        throw new Error('radix2: carry overflow');\n    return {\n        encode: (bytes) => {\n            if (!(bytes instanceof Uint8Array))\n                throw new Error('radix2.encode input should be Uint8Array');\n            return convertRadix2(Array.from(bytes), 8, bits, !revPadding);\n        },\n        decode: (digits) => {\n            if (!Array.isArray(digits) || (digits.length && typeof digits[0] !== 'number'))\n                throw new Error('radix2.decode input should be array of strings');\n            return Uint8Array.from(convertRadix2(digits, bits, 8, revPadding));\n        },\n    };\n}\nfunction unsafeWrapper(fn) {\n    if (typeof fn !== 'function')\n        throw new Error('unsafeWrapper fn should be function');\n    return function (...args) {\n        try {\n            return fn.apply(null, args);\n        }\n        catch (e) { }\n    };\n}\nfunction checksum(len, fn) {\n    assertNumber(len);\n    if (typeof fn !== 'function')\n        throw new Error('checksum fn should be function');\n    return {\n        encode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.encode: input should be Uint8Array');\n            const checksum = fn(data).slice(0, len);\n            const res = new Uint8Array(data.length + len);\n            res.set(data);\n            res.set(checksum, data.length);\n            return res;\n        },\n        decode(data) {\n            if (!(data instanceof Uint8Array))\n                throw new Error('checksum.decode: input should be Uint8Array');\n            const payload = data.slice(0, -len);\n            const newChecksum = fn(payload).slice(0, len);\n            const oldChecksum = data.slice(-len);\n            for (let i = 0; i < len; i++)\n                if (newChecksum[i] !== oldChecksum[i])\n                    throw new Error('Invalid checksum');\n            return payload;\n        },\n    };\n}\nexports.utils = { alphabet, chain, checksum, radix, radix2, join, padding };\nexports.base16 = chain(radix2(4), alphabet('0123456789ABCDEF'), join(''));\nexports.base32 = chain(radix2(5), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZ234567'), padding(5), join(''));\nexports.base32hex = chain(radix2(5), alphabet('0123456789ABCDEFGHIJKLMNOPQRSTUV'), padding(5), join(''));\nexports.base32crockford = chain(radix2(5), alphabet('0123456789ABCDEFGHJKMNPQRSTVWXYZ'), join(''), normalize((s) => s.toUpperCase().replace(/O/g, '0').replace(/[IL]/g, '1')));\nexports.base64 = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'), padding(6), join(''));\nexports.base64url = chain(radix2(6), alphabet('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_'), padding(6), join(''));\nconst genBase58 = (abc) => chain(radix(58), alphabet(abc), join(''));\nexports.base58 = genBase58('123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz');\nexports.base58flickr = genBase58('123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ');\nexports.base58xrp = genBase58('rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz');\nconst XMR_BLOCK_LEN = [0, 2, 3, 5, 6, 7, 9, 10, 11];\nexports.base58xmr = {\n    encode(data) {\n        let res = '';\n        for (let i = 0; i < data.length; i += 8) {\n            const block = data.subarray(i, i + 8);\n            res += exports.base58.encode(block).padStart(XMR_BLOCK_LEN[block.length], '1');\n        }\n        return res;\n    },\n    decode(str) {\n        let res = [];\n        for (let i = 0; i < str.length; i += 11) {\n            const slice = str.slice(i, i + 11);\n            const blockLen = XMR_BLOCK_LEN.indexOf(slice.length);\n            const block = exports.base58.decode(slice);\n            for (let j = 0; j < block.length - blockLen; j++) {\n                if (block[j] !== 0)\n                    throw new Error('base58xmr: wrong padding');\n            }\n            res = res.concat(Array.from(block.slice(block.length - blockLen)));\n        }\n        return Uint8Array.from(res);\n    },\n};\nconst base58check = (sha256) => chain(checksum(4, (data) => sha256(sha256(data))), exports.base58);\nexports.base58check = base58check;\nconst BECH_ALPHABET = chain(alphabet('qpzry9x8gf2tvdw0s3jn54khce6mua7l'), join(''));\nconst POLYMOD_GENERATORS = [0x3b6a57b2, 0x26508e6d, 0x1ea119fa, 0x3d4233dd, 0x2a1462b3];\nfunction bech32Polymod(pre) {\n    const b = pre >> 25;\n    let chk = (pre & 0x1ffffff) << 5;\n    for (let i = 0; i < POLYMOD_GENERATORS.length; i++) {\n        if (((b >> i) & 1) === 1)\n            chk ^= POLYMOD_GENERATORS[i];\n    }\n    return chk;\n}\nfunction bechChecksum(prefix, words, encodingConst = 1) {\n    const len = prefix.length;\n    let chk = 1;\n    for (let i = 0; i < len; i++) {\n        const c = prefix.charCodeAt(i);\n        if (c < 33 || c > 126)\n            throw new Error(`Invalid prefix (${prefix})`);\n        chk = bech32Polymod(chk) ^ (c >> 5);\n    }\n    chk = bech32Polymod(chk);\n    for (let i = 0; i < len; i++)\n        chk = bech32Polymod(chk) ^ (prefix.charCodeAt(i) & 0x1f);\n    for (let v of words)\n        chk = bech32Polymod(chk) ^ v;\n    for (let i = 0; i < 6; i++)\n        chk = bech32Polymod(chk);\n    chk ^= encodingConst;\n    return BECH_ALPHABET.encode(convertRadix2([chk % 2 ** 30], 30, 5, false));\n}\nfunction genBech32(encoding) {\n    const ENCODING_CONST = encoding === 'bech32' ? 1 : 0x2bc830a3;\n    const _words = radix2(5);\n    const fromWords = _words.decode;\n    const toWords = _words.encode;\n    const fromWordsUnsafe = unsafeWrapper(fromWords);\n    function encode(prefix, words, limit = 90) {\n        if (typeof prefix !== 'string')\n            throw new Error(`bech32.encode prefix should be string, not ${typeof prefix}`);\n        if (!Array.isArray(words) || (words.length && typeof words[0] !== 'number'))\n            throw new Error(`bech32.encode words should be array of numbers, not ${typeof words}`);\n        const actualLength = prefix.length + 7 + words.length;\n        if (limit !== false && actualLength > limit)\n            throw new TypeError(`Length ${actualLength} exceeds limit ${limit}`);\n        prefix = prefix.toLowerCase();\n        return `${prefix}1${BECH_ALPHABET.encode(words)}${bechChecksum(prefix, words, ENCODING_CONST)}`;\n    }\n    function decode(str, limit = 90) {\n        if (typeof str !== 'string')\n            throw new Error(`bech32.decode input should be string, not ${typeof str}`);\n        if (str.length < 8 || (limit !== false && str.length > limit))\n            throw new TypeError(`Wrong string length: ${str.length} (${str}). Expected (8..${limit})`);\n        const lowered = str.toLowerCase();\n        if (str !== lowered && str !== str.toUpperCase())\n            throw new Error(`String must be lowercase or uppercase`);\n        str = lowered;\n        const sepIndex = str.lastIndexOf('1');\n        if (sepIndex === 0 || sepIndex === -1)\n            throw new Error(`Letter \"1\" must be present between prefix and data only`);\n        const prefix = str.slice(0, sepIndex);\n        const _words = str.slice(sepIndex + 1);\n        if (_words.length < 6)\n            throw new Error('Data must be at least 6 characters long');\n        const words = BECH_ALPHABET.decode(_words).slice(0, -6);\n        const sum = bechChecksum(prefix, words, ENCODING_CONST);\n        if (!_words.endsWith(sum))\n            throw new Error(`Invalid checksum in ${str}: expected \"${sum}\"`);\n        return { prefix, words };\n    }\n    const decodeUnsafe = unsafeWrapper(decode);\n    function decodeToBytes(str) {\n        const { prefix, words } = decode(str, false);\n        return { prefix, words, bytes: fromWords(words) };\n    }\n    return { encode, decode, decodeToBytes, decodeUnsafe, fromWords, fromWordsUnsafe, toWords };\n}\nexports.bech32 = genBech32('bech32');\nexports.bech32m = genBech32('bech32m');\nexports.utf8 = {\n    encode: (data) => new TextDecoder().decode(data),\n    decode: (str) => new TextEncoder().encode(str),\n};\nexports.hex = chain(radix2(4), alphabet('0123456789abcdef'), join(''), normalize((s) => {\n    if (typeof s !== 'string' || s.length % 2)\n        throw new TypeError(`hex.decode: expected string, got ${typeof s} with length ${s.length}`);\n    return s.toLowerCase();\n}));\nconst CODERS = {\n    utf8: exports.utf8, hex: exports.hex, base16: exports.base16, base32: exports.base32, base64: exports.base64, base64url: exports.base64url, base58: exports.base58, base58xmr: exports.base58xmr\n};\nconst coderTypeError = `Invalid encoding type. Available types: ${Object.keys(CODERS).join(', ')}`;\nconst bytesToString = (type, bytes) => {\n    if (typeof type !== 'string' || !CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (!(bytes instanceof Uint8Array))\n        throw new TypeError('bytesToString() expects Uint8Array');\n    return CODERS[type].encode(bytes);\n};\nexports.bytesToString = bytesToString;\nexports.str = exports.bytesToString;\nconst stringToBytes = (type, str) => {\n    if (!CODERS.hasOwnProperty(type))\n        throw new TypeError(coderTypeError);\n    if (typeof str !== 'string')\n        throw new TypeError('stringToBytes() expects string');\n    return CODERS[type].decode(str);\n};\nexports.stringToBytes = stringToBytes;\nexports.bytes = exports.stringToBytes;\n","const {bech32, hex, utf8} = require('@scure/base')\n\n// defaults for encode; default timestamp is current time at call\nconst DEFAULTNETWORK = {\n  // default network is bitcoin\n  bech32: 'bc',\n  pubKeyHash: 0x00,\n  scriptHash: 0x05,\n  validWitnessVersions: [0]\n}\nconst TESTNETWORK = {\n  bech32: 'tb',\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  validWitnessVersions: [0]\n}\nconst SIGNETNETWORK = {\n  bech32: 'tbs',\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  validWitnessVersions: [0]\n}\nconst REGTESTNETWORK = {\n  bech32: 'bcrt',\n  pubKeyHash: 0x6f,\n  scriptHash: 0xc4,\n  validWitnessVersions: [0]\n}\nconst SIMNETWORK = {\n  bech32: 'sb',\n  pubKeyHash: 0x3f,\n  scriptHash: 0x7b,\n  validWitnessVersions: [0]\n}\n\nconst FEATUREBIT_ORDER = [\n  'option_data_loss_protect',\n  'initial_routing_sync',\n  'option_upfront_shutdown_script',\n  'gossip_queries',\n  'var_onion_optin',\n  'gossip_queries_ex',\n  'option_static_remotekey',\n  'payment_secret',\n  'basic_mpp',\n  'option_support_large_channel'\n]\n\nconst DIVISORS = {\n  m: BigInt(1e3),\n  u: BigInt(1e6),\n  n: BigInt(1e9),\n  p: BigInt(1e12)\n}\n\nconst MAX_MILLISATS = BigInt('2100000000000000000')\n\nconst MILLISATS_PER_BTC = BigInt(1e11)\n\nconst TAGCODES = {\n  payment_hash: 1,\n  payment_secret: 16,\n  description: 13,\n  payee: 19,\n  description_hash: 23, // commit to longer descriptions (used by lnurl-pay)\n  expiry: 6, // default: 3600 (1 hour)\n  min_final_cltv_expiry: 24, // default: 9\n  fallback_address: 9,\n  route_hint: 3, // for extra routing info (private etc.)\n  feature_bits: 5,\n  metadata: 27\n}\n\n// reverse the keys and values of TAGCODES and insert into TAGNAMES\nconst TAGNAMES = {}\nfor (let i = 0, keys = Object.keys(TAGCODES); i < keys.length; i++) {\n  const currentName = keys[i]\n  const currentCode = TAGCODES[keys[i]].toString()\n  TAGNAMES[currentCode] = currentName\n}\n\nconst TAGPARSERS = {\n  1: words => hex.encode(bech32.fromWordsUnsafe(words)), // 256 bits\n  16: words => hex.encode(bech32.fromWordsUnsafe(words)), // 256 bits\n  13: words => utf8.encode(bech32.fromWordsUnsafe(words)), // string variable length\n  19: words => hex.encode(bech32.fromWordsUnsafe(words)), // 264 bits\n  23: words => hex.encode(bech32.fromWordsUnsafe(words)), // 256 bits\n  27: words => hex.encode(bech32.fromWordsUnsafe(words)), // variable\n  6: wordsToIntBE, // default: 3600 (1 hour)\n  24: wordsToIntBE, // default: 9\n  3: routingInfoParser, // for extra routing info (private etc.)\n  5: featureBitsParser // keep feature bits as array of 5 bit words\n}\n\nfunction getUnknownParser(tagCode) {\n  return words => ({\n    tagCode: parseInt(tagCode),\n    words: bech32.encode('unknown', words, Number.MAX_SAFE_INTEGER)\n  })\n}\n\nfunction wordsToIntBE(words) {\n  return words.reverse().reduce((total, item, index) => {\n    return total + item * Math.pow(32, index)\n  }, 0)\n}\n\n// first convert from words to buffer, trimming padding where necessary\n// parse in 51 byte chunks. See encoder for details.\nfunction routingInfoParser(words) {\n  const routes = []\n  let pubkey,\n    shortChannelId,\n    feeBaseMSats,\n    feeProportionalMillionths,\n    cltvExpiryDelta\n  let routesBuffer = bech32.fromWordsUnsafe(words)\n  while (routesBuffer.length > 0) {\n    pubkey = hex.encode(routesBuffer.slice(0, 33)) // 33 bytes\n    shortChannelId = hex.encode(routesBuffer.slice(33, 41)) // 8 bytes\n    feeBaseMSats = parseInt(hex.encode(routesBuffer.slice(41, 45)), 16) // 4 bytes\n    feeProportionalMillionths = parseInt(\n      hex.encode(routesBuffer.slice(45, 49)),\n      16\n    ) // 4 bytes\n    cltvExpiryDelta = parseInt(hex.encode(routesBuffer.slice(49, 51)), 16) // 2 bytes\n\n    routesBuffer = routesBuffer.slice(51)\n\n    routes.push({\n      pubkey,\n      short_channel_id: shortChannelId,\n      fee_base_msat: feeBaseMSats,\n      fee_proportional_millionths: feeProportionalMillionths,\n      cltv_expiry_delta: cltvExpiryDelta\n    })\n  }\n  return routes\n}\n\nfunction featureBitsParser(words) {\n  const bools = words\n    .slice()\n    .reverse()\n    .map(word => [\n      !!(word & 0b1),\n      !!(word & 0b10),\n      !!(word & 0b100),\n      !!(word & 0b1000),\n      !!(word & 0b10000)\n    ])\n    .reduce((finalArr, itemArr) => finalArr.concat(itemArr), [])\n  while (bools.length < FEATUREBIT_ORDER.length * 2) {\n    bools.push(false)\n  }\n\n  const featureBits = {}\n\n  FEATUREBIT_ORDER.forEach((featureName, index) => {\n    let status\n    if (bools[index * 2]) {\n      status = 'required'\n    } else if (bools[index * 2 + 1]) {\n      status = 'supported'\n    } else {\n      status = 'unsupported'\n    }\n    featureBits[featureName] = status\n  })\n\n  const extraBits = bools.slice(FEATUREBIT_ORDER.length * 2)\n  featureBits.extra_bits = {\n    start_bit: FEATUREBIT_ORDER.length * 2,\n    bits: extraBits,\n    has_required: extraBits.reduce(\n      (result, bit, index) =>\n        index % 2 !== 0 ? result || false : result || bit,\n      false\n    )\n  }\n\n  return featureBits\n}\n\nfunction hrpToMillisat(hrpString, outputString) {\n  let divisor, value\n  if (hrpString.slice(-1).match(/^[munp]$/)) {\n    divisor = hrpString.slice(-1)\n    value = hrpString.slice(0, -1)\n  } else if (hrpString.slice(-1).match(/^[^munp0-9]$/)) {\n    throw new Error('Not a valid multiplier for the amount')\n  } else {\n    value = hrpString\n  }\n\n  if (!value.match(/^\\d+$/))\n    throw new Error('Not a valid human readable amount')\n\n  const valueBN = BigInt(value)\n\n  const millisatoshisBN = divisor\n    ? (valueBN * MILLISATS_PER_BTC) / DIVISORS[divisor]\n    : valueBN * MILLISATS_PER_BTC\n\n  if (\n    (divisor === 'p' && !(valueBN % BigInt(10) === BigInt(0))) ||\n    millisatoshisBN > MAX_MILLISATS\n  ) {\n    throw new Error('Amount is outside of valid range')\n  }\n\n  return outputString ? millisatoshisBN.toString() : millisatoshisBN\n}\n\n// decode will only have extra comments that aren't covered in encode comments.\n// also if anything is hard to read I'll comment.\nfunction decode(paymentRequest, network) {\n  if (typeof paymentRequest !== 'string')\n    throw new Error('Lightning Payment Request must be string')\n  if (paymentRequest.slice(0, 2).toLowerCase() !== 'ln')\n    throw new Error('Not a proper lightning payment request')\n\n  const sections = []\n  const decoded = bech32.decode(paymentRequest, Number.MAX_SAFE_INTEGER)\n  paymentRequest = paymentRequest.toLowerCase()\n  const prefix = decoded.prefix\n  let words = decoded.words\n  let letters = paymentRequest.slice(prefix.length + 1)\n  let sigWords = words.slice(-104)\n  words = words.slice(0, -104)\n\n  // Without reverse lookups, can't say that the multipier at the end must\n  // have a number before it, so instead we parse, and if the second group\n  // doesn't have anything, there's a good chance the last letter of the\n  // coin type got captured by the third group, so just re-regex without\n  // the number.\n  let prefixMatches = prefix.match(/^ln(\\S+?)(\\d*)([a-zA-Z]?)$/)\n  if (prefixMatches && !prefixMatches[2])\n    prefixMatches = prefix.match(/^ln(\\S+)$/)\n  if (!prefixMatches) {\n    throw new Error('Not a proper lightning payment request')\n  }\n\n  // \"ln\" section\n  sections.push({\n    name: 'lightning_network',\n    letters: 'ln'\n  })\n\n  // \"bc\" section\n  const bech32Prefix = prefixMatches[1]\n  let coinNetwork\n  if (!network) {\n    switch (bech32Prefix) {\n      case DEFAULTNETWORK.bech32:\n        coinNetwork = DEFAULTNETWORK\n        break\n      case TESTNETWORK.bech32:\n        coinNetwork = TESTNETWORK\n        break\n      case SIGNETNETWORK.bech32:\n        coinNetwork = SIGNETNETWORK\n        break\n      case REGTESTNETWORK.bech32:\n        coinNetwork = REGTESTNETWORK\n        break\n      case SIMNETWORK.bech32:\n        coinNetwork = SIMNETWORK\n        break\n    }\n  } else {\n    if (\n      network.bech32 === undefined ||\n      network.pubKeyHash === undefined ||\n      network.scriptHash === undefined ||\n      !Array.isArray(network.validWitnessVersions)\n    )\n      throw new Error('Invalid network')\n    coinNetwork = network\n  }\n  if (!coinNetwork || coinNetwork.bech32 !== bech32Prefix) {\n    throw new Error('Unknown coin bech32 prefix')\n  }\n  sections.push({\n    name: 'coin_network',\n    letters: bech32Prefix,\n    value: coinNetwork\n  })\n\n  // amount section\n  const value = prefixMatches[2]\n  let millisatoshis\n  if (value) {\n    const divisor = prefixMatches[3]\n    millisatoshis = hrpToMillisat(value + divisor, true)\n    sections.push({\n      name: 'amount',\n      letters: prefixMatches[2] + prefixMatches[3],\n      value: millisatoshis\n    })\n  } else {\n    millisatoshis = null\n  }\n\n  // \"1\" separator\n  sections.push({\n    name: 'separator',\n    letters: '1'\n  })\n\n  // timestamp\n  const timestamp = wordsToIntBE(words.slice(0, 7))\n  words = words.slice(7) // trim off the left 7 words\n  sections.push({\n    name: 'timestamp',\n    letters: letters.slice(0, 7),\n    value: timestamp\n  })\n  letters = letters.slice(7)\n\n  let tagName, parser, tagLength, tagWords\n  // we have no tag count to go on, so just keep hacking off words\n  // until we have none.\n  while (words.length > 0) {\n    const tagCode = words[0].toString()\n    tagName = TAGNAMES[tagCode] || 'unknown_tag'\n    parser = TAGPARSERS[tagCode] || getUnknownParser(tagCode)\n    words = words.slice(1)\n\n    tagLength = wordsToIntBE(words.slice(0, 2))\n    words = words.slice(2)\n\n    tagWords = words.slice(0, tagLength)\n    words = words.slice(tagLength)\n\n    sections.push({\n      name: tagName,\n      tag: letters[0],\n      letters: letters.slice(0, 1 + 2 + tagLength),\n      value: parser(tagWords) // see: parsers for more comments\n    })\n    letters = letters.slice(1 + 2 + tagLength)\n  }\n\n  // signature\n  sections.push({\n    name: 'signature',\n    letters: letters.slice(0, 104),\n    value: hex.encode(bech32.fromWordsUnsafe(sigWords))\n  })\n  letters = letters.slice(104)\n\n  // checksum\n  sections.push({\n    name: 'checksum',\n    letters: letters\n  })\n\n  let result = {\n    paymentRequest,\n    sections,\n\n    get expiry() {\n      let exp = sections.find(s => s.name === 'expiry')\n      if (exp) return getValue('timestamp') + exp.value\n    },\n\n    get route_hints() {\n      return sections.filter(s => s.name === 'route_hint').map(s => s.value)\n    }\n  }\n\n  for (let name in TAGCODES) {\n    if (name === 'route_hint') {\n      // route hints can be multiple, so this won't work for them\n      continue\n    }\n\n    Object.defineProperty(result, name, {\n      get() {\n        return getValue(name)\n      }\n    })\n  }\n\n  return result\n\n  function getValue(name) {\n    let section = sections.find(s => s.name === name)\n    return section ? section.value : undefined\n  }\n}\n\nmodule.exports = {\n  decode,\n  hrpToMillisat\n}\n","// src/user/index.ts\nimport { nip19 as nip194 } from \"nostr-tools\";\n\n// src/events/index.ts\nimport { EventEmitter as EventEmitter4 } from \"tseep\";\n\n// src/outbox/relay-ranking.ts\nfunction getTopRelaysForAuthors(ndk, authors) {\n  const relaysWithCount = /* @__PURE__ */ new Map();\n  authors.forEach((author) => {\n    const writeRelays = getWriteRelaysFor(ndk, author);\n    if (writeRelays) {\n      writeRelays.forEach((relay) => {\n        const count = relaysWithCount.get(relay) || 0;\n        relaysWithCount.set(relay, count + 1);\n      });\n    }\n  });\n  let sortedRelays = Array.from(relaysWithCount.entries()).sort((a, b) => b[1] - a[1]);\n  return sortedRelays.map((entry) => entry[0]);\n}\n\n// src/outbox/read/with-authors.ts\nfunction getWriteRelaysFor(ndk, author) {\n  if (!ndk.outboxTracker)\n    return void 0;\n  return ndk.outboxTracker.data.get(author)?.writeRelays;\n}\nfunction getAllRelaysForAllPubkeys(ndk, pubkeys) {\n  const pubkeysToRelays = /* @__PURE__ */ new Map();\n  const authorsMissingRelays = /* @__PURE__ */ new Set();\n  pubkeys.forEach((author) => {\n    const writeRelays = getWriteRelaysFor(ndk, author);\n    if (writeRelays && writeRelays.size > 0) {\n      writeRelays.forEach((relay) => {\n        const pubkeysInRelay = pubkeysToRelays.get(relay) || /* @__PURE__ */ new Set();\n        pubkeysInRelay.add(author);\n        pubkeysToRelays.set(relay, pubkeysInRelay);\n      });\n      pubkeysToRelays.set(author, writeRelays);\n    } else {\n      authorsMissingRelays.add(author);\n    }\n  });\n  return { pubkeysToRelays, authorsMissingRelays };\n}\nfunction getRelaysForFilterWithAuthors(ndk, authors, pool, relayGoalPerAuthor = 2) {\n  const relayToAuthorsMap = /* @__PURE__ */ new Map();\n  const { pubkeysToRelays, authorsMissingRelays } = getAllRelaysForAllPubkeys(ndk, authors);\n  const sortedRelays = getTopRelaysForAuthors(ndk, authors);\n  const addAuthorToRelay = (author, relay) => {\n    const authorsInRelay = relayToAuthorsMap.get(relay) || [];\n    authorsInRelay.push(author);\n    relayToAuthorsMap.set(relay, authorsInRelay);\n  };\n  for (const [author, authorRelays] of pubkeysToRelays.entries()) {\n    let missingRelaysForThisAuthor = relayGoalPerAuthor;\n    for (const authorRelay of authorRelays) {\n      if (relayToAuthorsMap.has(authorRelay)) {\n        addAuthorToRelay(author, authorRelay);\n        missingRelaysForThisAuthor--;\n      }\n    }\n    if (missingRelaysForThisAuthor <= 0)\n      continue;\n    for (const relay of sortedRelays) {\n      if (missingRelaysForThisAuthor <= 0)\n        break;\n      if (authorRelays.has(relay)) {\n        addAuthorToRelay(author, relay);\n        missingRelaysForThisAuthor--;\n      }\n    }\n  }\n  for (const author of authorsMissingRelays) {\n    Array.from(pool.relays.keys()).forEach((relay) => {\n      const authorsInRelay = relayToAuthorsMap.get(relay) || [];\n      authorsInRelay.push(author);\n      relayToAuthorsMap.set(relay, authorsInRelay);\n    });\n  }\n  return relayToAuthorsMap;\n}\n\n// src/relay/index.ts\nimport debug from \"debug\";\nimport { EventEmitter as EventEmitter2 } from \"tseep\";\n\n// src/relay/connectivity.ts\nimport { relayInit } from \"nostr-tools\";\n\n// src/utils/timeout.ts\nasync function runWithTimeout(fn, timeoutMs, timeoutMessage) {\n  if (!timeoutMs)\n    return fn();\n  return new Promise((resolve, reject) => {\n    const timeout = setTimeout(() => {\n      reject(new Error(timeoutMessage || `Timed out after ${timeoutMs}ms`));\n    }, timeoutMs);\n    fn().then(resolve, reject).finally(() => clearTimeout(timeout));\n  });\n}\n\n// src/relay/connectivity.ts\nvar NDKRelayConnectivity = class {\n  ndkRelay;\n  _status;\n  relay;\n  timeoutMs;\n  connectedAt;\n  _connectionStats = {\n    attempts: 0,\n    success: 0,\n    durations: []\n  };\n  debug;\n  reconnectTimeout;\n  constructor(ndkRelay) {\n    this.ndkRelay = ndkRelay;\n    this._status = 3 /* DISCONNECTED */;\n    this.relay = relayInit(this.ndkRelay.url);\n    this.debug = this.ndkRelay.debug.extend(\"connectivity\");\n    this.relay.on(\"notice\", (notice) => this.handleNotice(notice));\n  }\n  async connect(timeoutMs) {\n    if (this.reconnectTimeout) {\n      clearTimeout(this.reconnectTimeout);\n      this.reconnectTimeout = void 0;\n    }\n    timeoutMs ??= this.timeoutMs;\n    if (!this.timeoutMs && timeoutMs)\n      this.timeoutMs = timeoutMs;\n    const connectHandler = () => {\n      this.updateConnectionStats.connected();\n      this._status = 1 /* CONNECTED */;\n      this.ndkRelay.emit(\"connect\");\n      this.ndkRelay.emit(\"ready\");\n    };\n    const disconnectHandler = () => {\n      this.updateConnectionStats.disconnected();\n      if (this._status === 1 /* CONNECTED */) {\n        this._status = 3 /* DISCONNECTED */;\n        this.handleReconnection();\n      }\n      this.ndkRelay.emit(\"disconnect\");\n    };\n    const authHandler = async (challenge) => {\n      this.debug(\"Relay requested authentication\", {\n        havePolicy: !!this.ndkRelay.authPolicy\n      });\n      if (this.ndkRelay.authPolicy) {\n        if (this._status !== 7 /* AUTHENTICATING */) {\n          this._status = 7 /* AUTHENTICATING */;\n          await this.ndkRelay.authPolicy(this.ndkRelay, challenge);\n          if (this._status === 7 /* AUTHENTICATING */) {\n            this.debug(\"Authentication policy finished\");\n            this._status = 1 /* CONNECTED */;\n            this.ndkRelay.emit(\"authed\");\n          }\n        }\n      } else {\n        await this.ndkRelay.emit(\"auth\", challenge);\n      }\n    };\n    try {\n      this.updateConnectionStats.attempt();\n      if (this._status === 3 /* DISCONNECTED */)\n        this._status = 0 /* CONNECTING */;\n      else\n        this._status = 4 /* RECONNECTING */;\n      this.relay.off(\"connect\", connectHandler);\n      this.relay.off(\"disconnect\", disconnectHandler);\n      this.relay.on(\"connect\", connectHandler);\n      this.relay.on(\"disconnect\", disconnectHandler);\n      this.relay.on(\"auth\", authHandler);\n      await runWithTimeout(this.relay.connect, timeoutMs, \"Timed out while connecting\");\n    } catch (e) {\n      this.debug(\"Failed to connect\", e);\n      this._status = 3 /* DISCONNECTED */;\n      this.handleReconnection();\n      throw e;\n    }\n  }\n  disconnect() {\n    this._status = 2 /* DISCONNECTING */;\n    this.relay.close();\n  }\n  get status() {\n    return this._status;\n  }\n  isAvailable() {\n    return this._status === 1 /* CONNECTED */;\n  }\n  /**\n   * Evaluates the connection stats to determine if the relay is flapping.\n   */\n  isFlapping() {\n    const durations = this._connectionStats.durations;\n    if (durations.length % 3 !== 0)\n      return false;\n    const sum = durations.reduce((a, b) => a + b, 0);\n    const avg = sum / durations.length;\n    const variance = durations.map((x) => Math.pow(x - avg, 2)).reduce((a, b) => a + b, 0) / durations.length;\n    const stdDev = Math.sqrt(variance);\n    const isFlapping = stdDev < 1e3;\n    return isFlapping;\n  }\n  async handleNotice(notice) {\n    if (notice.includes(\"oo many\") || notice.includes(\"aximum\")) {\n      this.disconnect();\n      setTimeout(() => this.connect(), 2e3);\n      this.debug(this.relay.url, \"Relay complaining?\", notice);\n    }\n    this.ndkRelay.emit(\"notice\", this.relay, notice);\n  }\n  /**\n   * Called when the relay is unexpectedly disconnected.\n   */\n  handleReconnection(attempt = 0) {\n    if (this.reconnectTimeout)\n      return;\n    this.debug(\"Attempting to reconnect\", { attempt });\n    if (this.isFlapping()) {\n      this.ndkRelay.emit(\"flapping\", this, this._connectionStats);\n      this._status = 5 /* FLAPPING */;\n      return;\n    }\n    const reconnectDelay = this.connectedAt ? Math.max(0, 6e4 - (Date.now() - this.connectedAt)) : 5e3 * (this._connectionStats.attempts + 1);\n    this.reconnectTimeout = setTimeout(() => {\n      this.reconnectTimeout = void 0;\n      this._status = 4 /* RECONNECTING */;\n      this.debug(`Reconnection attempt #${attempt}`);\n      this.connect().then(() => {\n        this.debug(\"Reconnected\");\n      }).catch((err) => {\n        this.debug(\"Reconnect failed\", err);\n        if (attempt < 10) {\n          setTimeout(() => {\n            this.handleReconnection(attempt + 1);\n          }, 1e3 * (attempt + 1) ^ 2);\n        } else {\n          this.debug(\"Reconnect failed after 10 attempts\");\n        }\n      });\n    }, reconnectDelay);\n    this.debug(\"Reconnecting in\", reconnectDelay);\n    this._connectionStats.nextReconnectAt = Date.now() + reconnectDelay;\n  }\n  /**\n   * Utility functions to update the connection stats.\n   */\n  updateConnectionStats = {\n    connected: () => {\n      this._connectionStats.success++;\n      this._connectionStats.connectedAt = Date.now();\n    },\n    disconnected: () => {\n      if (this._connectionStats.connectedAt) {\n        this._connectionStats.durations.push(\n          Date.now() - this._connectionStats.connectedAt\n        );\n        if (this._connectionStats.durations.length > 100) {\n          this._connectionStats.durations.shift();\n        }\n      }\n      this._connectionStats.connectedAt = void 0;\n    },\n    attempt: () => {\n      this._connectionStats.attempts++;\n    }\n  };\n  /**\n   * Returns the connection stats.\n   */\n  get connectionStats() {\n    return this._connectionStats;\n  }\n};\n\n// src/relay/publisher.ts\nvar NDKRelayPublisher = class {\n  ndkRelay;\n  constructor(ndkRelay) {\n    this.ndkRelay = ndkRelay;\n  }\n  /**\n   * Published an event to the relay; if the relay is not connected, it will\n   * wait for the relay to connect before publishing the event.\n   *\n   * If the relay does not connect within the timeout, the publish operation\n   * will fail.\n   * @param event  The event to publish\n   * @param timeoutMs  The timeout for the publish operation in milliseconds\n   * @returns A promise that resolves when the event has been published or rejects if the operation times out\n   */\n  async publish(event, timeoutMs = 2500) {\n    const publishWhenConnected = () => {\n      return new Promise((resolve, reject) => {\n        try {\n          this.publishEvent(event, timeoutMs).then((result) => resolve(result)).catch((err) => reject(err));\n        } catch (err) {\n          reject(err);\n        }\n      });\n    };\n    const timeoutPromise = new Promise((_, reject) => {\n      setTimeout(() => reject(new Error(\"Timeout\")), timeoutMs);\n    });\n    const onConnectHandler = () => {\n      publishWhenConnected().then((result) => connectResolve(result)).catch((err) => connectReject(err));\n    };\n    let connectResolve;\n    let connectReject;\n    if (this.ndkRelay.status === 1 /* CONNECTED */) {\n      return Promise.race([publishWhenConnected(), timeoutPromise]);\n    } else {\n      return Promise.race([\n        new Promise((resolve, reject) => {\n          connectResolve = resolve;\n          connectReject = reject;\n          this.ndkRelay.once(\"connect\", onConnectHandler);\n        }),\n        timeoutPromise\n      ]).finally(() => {\n        this.ndkRelay.removeListener(\"connect\", onConnectHandler);\n      });\n    }\n  }\n  async publishEvent(event, timeoutMs) {\n    const nostrEvent = await event.toNostrEvent();\n    const publish = this.ndkRelay.connectivity.relay.publish(nostrEvent);\n    let publishTimeout;\n    const publishPromise = new Promise((resolve, reject) => {\n      publish.then(() => {\n        clearTimeout(publishTimeout);\n        this.ndkRelay.emit(\"published\", event);\n        resolve(true);\n      }).catch((err) => {\n        clearTimeout(publishTimeout);\n        this.ndkRelay.debug(\"Publish failed\", err, event.id);\n        this.ndkRelay.emit(\"publish:failed\", event, err);\n        reject(err);\n      });\n    });\n    if (!timeoutMs || event.isEphemeral()) {\n      return publishPromise;\n    }\n    const timeoutPromise = new Promise((_, reject) => {\n      publishTimeout = setTimeout(() => {\n        this.ndkRelay.debug(\"Publish timed out\", event.rawEvent());\n        this.ndkRelay.emit(\"publish:failed\", event, \"Timeout\");\n        reject(new Error(\"Publish operation timed out\"));\n      }, timeoutMs);\n    });\n    return Promise.race([publishPromise, timeoutPromise]);\n  }\n  async auth(event) {\n    return this.ndkRelay.connectivity.relay.auth(event.rawEvent());\n  }\n};\n\n// src/relay/subscriptions.ts\nimport { EventEmitter } from \"tseep\";\nimport { matchFilter } from \"nostr-tools\";\n\n// src/subscription/grouping.ts\nfunction calculateGroupableId(filters) {\n  const elements = [];\n  for (const filter of filters) {\n    const hasTimeConstraints = filter.since || filter.until;\n    if (hasTimeConstraints)\n      return null;\n    const keys = Object.keys(filter || {}).sort().join(\"-\");\n    elements.push(keys);\n  }\n  return elements.join(\"|\");\n}\nfunction mergeFilters(filters) {\n  const result = {};\n  filters.forEach((filter) => {\n    Object.entries(filter).forEach(([key, value]) => {\n      if (Array.isArray(value)) {\n        if (result[key] === void 0) {\n          result[key] = [...value];\n        } else {\n          result[key] = Array.from(/* @__PURE__ */ new Set([...result[key], ...value]));\n        }\n      } else {\n        result[key] = value;\n      }\n    });\n  });\n  return result;\n}\n\n// src/subscription/utils.ts\nimport { nip19 } from \"nostr-tools\";\nvar MAX_SUBID_LENGTH = 20;\nfunction queryFullyFilled(subscription) {\n  if (filterIncludesIds(subscription.filter)) {\n    if (resultHasAllRequestedIds(subscription)) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction compareFilter(filter1, filter2) {\n  if (Object.keys(filter1).length !== Object.keys(filter2).length)\n    return false;\n  for (const [key, value] of Object.entries(filter1)) {\n    const valuesInFilter2 = filter2[key];\n    if (!valuesInFilter2)\n      return false;\n    if (Array.isArray(value) && Array.isArray(valuesInFilter2)) {\n      const v = value;\n      for (const valueInFilter2 of valuesInFilter2) {\n        const val = valueInFilter2;\n        if (!v.includes(val)) {\n          return false;\n        }\n      }\n    } else {\n      if (valuesInFilter2 !== value)\n        return false;\n    }\n  }\n  return true;\n}\nfunction filterIncludesIds(filter) {\n  return !!filter[\"ids\"];\n}\nfunction resultHasAllRequestedIds(subscription) {\n  const ids = subscription.filter[\"ids\"];\n  return !!ids && ids.length === subscription.eventFirstSeen.size;\n}\nfunction generateSubId(subscriptions, filters) {\n  const subIds = subscriptions.map((sub) => sub.subId).filter(Boolean);\n  const subIdParts = [];\n  const filterNonKindKeys = /* @__PURE__ */ new Set();\n  const filterKinds = /* @__PURE__ */ new Set();\n  if (subIds.length > 0) {\n    subIdParts.push(Array.from(new Set(subIds)).join(\",\"));\n  } else {\n    for (const filter of filters) {\n      for (const key of Object.keys(filter)) {\n        if (key === \"kinds\") {\n          filter.kinds?.forEach((k) => filterKinds.add(k));\n        } else {\n          filterNonKindKeys.add(key);\n        }\n      }\n    }\n    if (filterKinds.size > 0) {\n      subIdParts.push(\"kinds:\" + Array.from(filterKinds).join(\",\"));\n    }\n    if (filterNonKindKeys.size > 0) {\n      subIdParts.push(Array.from(filterNonKindKeys).join(\",\"));\n    }\n  }\n  let subId = subIdParts.join(\"-\");\n  if (subId.length > MAX_SUBID_LENGTH)\n    subId = subId.substring(0, MAX_SUBID_LENGTH);\n  if (subIds.length !== 1) {\n    subId += \"-\" + Math.floor(Math.random() * 999).toString();\n  }\n  return subId;\n}\nfunction filterFromId(id) {\n  let decoded;\n  if (id.match(NIP33_A_REGEX)) {\n    const [kind, pubkey, identifier] = id.split(\":\");\n    const filter = {\n      authors: [pubkey],\n      kinds: [parseInt(kind)]\n    };\n    if (identifier) {\n      filter[\"#d\"] = [identifier];\n    }\n    return filter;\n  }\n  try {\n    decoded = nip19.decode(id);\n    switch (decoded.type) {\n      case \"nevent\":\n        return { ids: [decoded.data.id] };\n      case \"note\":\n        return { ids: [decoded.data] };\n      case \"naddr\":\n        return {\n          authors: [decoded.data.pubkey],\n          \"#d\": [decoded.data.identifier],\n          kinds: [decoded.data.kind]\n        };\n    }\n  } catch (e) {\n  }\n  return { ids: [id] };\n}\nfunction isNip33AValue(value) {\n  return value.match(NIP33_A_REGEX) !== null;\n}\nvar NIP33_A_REGEX = /^(\\d+):([0-9A-Fa-f]+)(?::(.*))?$/;\nfunction relaysFromBech32(bech322) {\n  try {\n    const decoded = nip19.decode(bech322);\n    if ([\"naddr\", \"nevent\"].includes(decoded?.type)) {\n      const data = decoded.data;\n      if (data?.relays) {\n        return data.relays.map((r) => new NDKRelay(r));\n      }\n    }\n  } catch (e) {\n  }\n  return [];\n}\n\n// src/relay/subscriptions.ts\nvar NDKGroupedSubscriptions = class extends EventEmitter {\n  subscriptions;\n  req;\n  debug;\n  constructor(subscriptions, debug7) {\n    super();\n    this.subscriptions = subscriptions;\n    this.debug = debug7 || this.subscriptions[0].subscription.debug.extend(\"grouped\");\n    for (const subscription of subscriptions) {\n      this.handleSubscriptionClosure(subscription);\n    }\n  }\n  /**\n   * Adds a subscription to this group.\n   * @param subscription\n   */\n  addSubscription(subscription) {\n    this.subscriptions.push(subscription);\n    this.handleSubscriptionClosure(subscription);\n  }\n  eventReceived(event) {\n    for (const subscription of this.subscriptions) {\n      subscription.eventReceived(event);\n    }\n  }\n  eoseReceived(relay) {\n    const subscriptionsToInform = Array.from(this.subscriptions);\n    subscriptionsToInform.forEach(async (subscription) => {\n      subscription.subscription.eoseReceived(relay);\n    });\n  }\n  handleSubscriptionClosure(subscription) {\n    subscription.subscription.on(\"close\", () => {\n      const index = this.subscriptions.findIndex(\n        (i) => i.subscription === subscription.subscription\n      );\n      this.subscriptions.splice(index, 1);\n      if (this.subscriptions.length <= 0) {\n        this.emit(\"close\");\n      }\n    });\n  }\n  /**\n   * Maps each subscription through a transformation function.\n   * @param fn - The transformation function.\n   * @returns A new array with each subscription transformed by fn.\n   */\n  map(fn) {\n    return this.subscriptions.map(fn);\n  }\n  [Symbol.iterator]() {\n    let index = 0;\n    const subscriptions = this.subscriptions;\n    return {\n      next() {\n        if (index < subscriptions.length) {\n          return { value: subscriptions[index++], done: false };\n        } else {\n          return { value: null, done: true };\n        }\n      }\n    };\n  }\n};\nvar NDKSubscriptionFilters = class {\n  subscription;\n  filters = [];\n  ndkRelay;\n  constructor(subscription, filters, ndkRelay) {\n    this.subscription = subscription;\n    this.filters = filters;\n    this.ndkRelay = ndkRelay;\n  }\n  eventReceived(event) {\n    if (!this.eventMatchesLocalFilter(event))\n      return;\n    this.subscription.eventReceived(event, this.ndkRelay, false);\n  }\n  eventMatchesLocalFilter(event) {\n    const rawEvent = event.rawEvent();\n    return this.filters.some((filter) => matchFilter(filter, rawEvent));\n  }\n};\nfunction findMatchingActiveSubscriptions(activeSubscriptions, filters) {\n  if (activeSubscriptions.length !== filters.length)\n    return false;\n  for (let i = 0; i < activeSubscriptions.length; i++) {\n    if (!compareFilter(activeSubscriptions[i], filters[i])) {\n      break;\n    }\n    return activeSubscriptions[i];\n  }\n  return void 0;\n}\nvar NDKRelaySubscriptions = class {\n  ndkRelay;\n  delayedItems = /* @__PURE__ */ new Map();\n  delayedTimers = /* @__PURE__ */ new Map();\n  /**\n   * Active subscriptions this relay is connected to\n   */\n  activeSubscriptions = /* @__PURE__ */ new Map();\n  activeSubscriptionsByGroupId = /* @__PURE__ */ new Map();\n  executionTimeoutsByGroupId = /* @__PURE__ */ new Map();\n  debug;\n  groupingDebug;\n  conn;\n  constructor(ndkRelay) {\n    this.ndkRelay = ndkRelay;\n    this.conn = ndkRelay.connectivity;\n    this.debug = ndkRelay.debug.extend(\"subscriptions\");\n    this.groupingDebug = ndkRelay.debug.extend(\"grouping\");\n  }\n  /**\n   * Creates or queues a subscription to the relay.\n   */\n  subscribe(subscription, filters) {\n    const groupableId = calculateGroupableId(filters);\n    const subscriptionFilters = new NDKSubscriptionFilters(\n      subscription,\n      filters,\n      this.ndkRelay\n    );\n    const isNotGroupable = !groupableId || !subscription.isGroupable();\n    if (isNotGroupable) {\n      this.executeSubscriptions(\n        groupableId,\n        // hacky\n        new NDKGroupedSubscriptions([subscriptionFilters]),\n        filters\n      );\n      return;\n    }\n    const activeSubscriptions = this.activeSubscriptionsByGroupId.get(groupableId);\n    if (activeSubscriptions) {\n      const matchingSubscription = findMatchingActiveSubscriptions(\n        activeSubscriptions.filters,\n        filters\n      );\n      if (matchingSubscription) {\n        const activeSubscription = this.activeSubscriptions.get(activeSubscriptions.sub);\n        activeSubscription?.addSubscription(\n          new NDKSubscriptionFilters(subscription, filters, this.ndkRelay)\n        );\n        return;\n      }\n    }\n    let delayedItem = this.delayedItems.get(groupableId);\n    if (!delayedItem) {\n      delayedItem = new NDKGroupedSubscriptions([subscriptionFilters]);\n      this.delayedItems.set(groupableId, delayedItem);\n      delayedItem.once(\"close\", () => {\n        const delayedItem2 = this.delayedItems.get(groupableId);\n        if (!delayedItem2)\n          return;\n        this.delayedItems.delete(groupableId);\n      });\n    } else {\n      delayedItem.addSubscription(subscriptionFilters);\n    }\n    let timeout = this.executionTimeoutsByGroupId.get(groupableId);\n    if (!timeout || subscription.opts.groupableDelayType === \"at-most\") {\n      timeout = setTimeout(() => {\n        this.executeGroup(groupableId, subscription);\n      }, subscription.opts.groupableDelay);\n      this.executionTimeoutsByGroupId.set(groupableId, timeout);\n    }\n    if (this.delayedTimers.has(groupableId)) {\n      this.delayedTimers.get(groupableId).push(timeout);\n    } else {\n      this.delayedTimers.set(groupableId, [timeout]);\n    }\n  }\n  /**\n   * Executes a delayed subscription via its groupable ID.\n   * @param groupableId\n   */\n  executeGroup(groupableId, triggeredBy) {\n    const delayedItem = this.delayedItems.get(groupableId);\n    this.delayedItems.delete(groupableId);\n    const timeouts = this.delayedTimers.get(groupableId);\n    this.delayedTimers.delete(groupableId);\n    if (timeouts) {\n      for (const timeout of timeouts) {\n        clearTimeout(timeout);\n      }\n    }\n    if (delayedItem) {\n      const filterCount = delayedItem.subscriptions[0].filters.length;\n      const mergedFilters = [];\n      for (let i = 0; i < filterCount; i++) {\n        const allFiltersAtIndex = delayedItem.map((di) => di.filters[i]);\n        mergedFilters.push(mergeFilters(allFiltersAtIndex));\n      }\n      this.executeSubscriptions(groupableId, delayedItem, mergedFilters);\n    }\n  }\n  executeSubscriptionsWhenConnected(groupableId, groupedSubscriptions, mergedFilters) {\n    const readyListener = () => {\n      this.debug(\"new relay coming online for active subscription\", {\n        relay: this.ndkRelay.url\n        // mergedFilters: JSON.stringify(mergedFilters),\n      });\n      this.executeSubscriptionsConnected(groupableId, groupedSubscriptions, mergedFilters);\n    };\n    this.ndkRelay.once(\"ready\", readyListener);\n    groupedSubscriptions.once(\"close\", () => {\n      this.ndkRelay.removeListener(\"ready\", readyListener);\n    });\n  }\n  /**\n   * Executes one or more subscriptions.\n   *\n   * If the relay is not connected, subscriptions will be queued\n   * until the relay connects.\n   *\n   * @param groupableId\n   * @param subscriptionFilters\n   * @param mergedFilters\n   */\n  executeSubscriptions(groupableId, groupedSubscriptions, mergedFilters) {\n    if (this.conn.isAvailable()) {\n      this.executeSubscriptionsConnected(groupableId, groupedSubscriptions, mergedFilters);\n    } else {\n      this.executeSubscriptionsWhenConnected(\n        groupableId,\n        groupedSubscriptions,\n        mergedFilters\n      );\n    }\n  }\n  /**\n   * Executes one or more subscriptions.\n   *\n   * When there are more than one subscription, results\n   * will be sent to the right subscription\n   *\n   * @param subscriptions\n   * @param filters The filters as they should be sent to the relay\n   */\n  executeSubscriptionsConnected(groupableId, groupedSubscriptions, mergedFilters) {\n    const subscriptions = [];\n    for (const { subscription } of groupedSubscriptions) {\n      subscriptions.push(subscription);\n    }\n    const subId = generateSubId(subscriptions, mergedFilters);\n    groupedSubscriptions.req = mergedFilters;\n    const subOptions = { id: subId };\n    if (this.ndkRelay.trusted || subscriptions.every((sub2) => sub2.opts.skipVerification)) {\n      subOptions.skipVerification = true;\n    }\n    const sub = this.conn.relay.sub(mergedFilters, subOptions);\n    this.activeSubscriptions.set(sub, groupedSubscriptions);\n    if (groupableId) {\n      this.activeSubscriptionsByGroupId.set(groupableId, { filters: mergedFilters, sub });\n    }\n    sub.on(\"event\", (event) => {\n      const e = new NDKEvent(void 0, event);\n      e.relay = this.ndkRelay;\n      const subFilters = this.activeSubscriptions.get(sub);\n      subFilters?.eventReceived(e);\n    });\n    sub.on(\"eose\", () => {\n      const subFilters = this.activeSubscriptions.get(sub);\n      subFilters?.eoseReceived(this.ndkRelay);\n    });\n    groupedSubscriptions.once(\"close\", () => {\n      sub.unsub();\n      this.activeSubscriptions.delete(sub);\n      if (groupableId) {\n        this.activeSubscriptionsByGroupId.delete(groupableId);\n      }\n    });\n    this.executeSubscriptionsWhenConnected(groupableId, groupedSubscriptions, mergedFilters);\n    return sub;\n  }\n  executedFilters() {\n    const ret = /* @__PURE__ */ new Map();\n    for (const [, groupedSubscriptions] of this.activeSubscriptions) {\n      ret.set(\n        groupedSubscriptions.req,\n        groupedSubscriptions.map((sub) => sub.subscription)\n      );\n    }\n    return ret;\n  }\n};\n\n// src/relay/index.ts\nvar NDKRelayStatus = /* @__PURE__ */ ((NDKRelayStatus2) => {\n  NDKRelayStatus2[NDKRelayStatus2[\"CONNECTING\"] = 0] = \"CONNECTING\";\n  NDKRelayStatus2[NDKRelayStatus2[\"CONNECTED\"] = 1] = \"CONNECTED\";\n  NDKRelayStatus2[NDKRelayStatus2[\"DISCONNECTING\"] = 2] = \"DISCONNECTING\";\n  NDKRelayStatus2[NDKRelayStatus2[\"DISCONNECTED\"] = 3] = \"DISCONNECTED\";\n  NDKRelayStatus2[NDKRelayStatus2[\"RECONNECTING\"] = 4] = \"RECONNECTING\";\n  NDKRelayStatus2[NDKRelayStatus2[\"FLAPPING\"] = 5] = \"FLAPPING\";\n  NDKRelayStatus2[NDKRelayStatus2[\"AUTH_REQUIRED\"] = 6] = \"AUTH_REQUIRED\";\n  NDKRelayStatus2[NDKRelayStatus2[\"AUTHENTICATING\"] = 7] = \"AUTHENTICATING\";\n  return NDKRelayStatus2;\n})(NDKRelayStatus || {});\nvar NDKRelay = class extends EventEmitter2 {\n  url;\n  scores;\n  connectivity;\n  subs;\n  publisher;\n  authPolicy;\n  /**\n   * Whether this relay is trusted.\n   *\n   * Trusted relay's events do not get their signature verified.\n   */\n  trusted = false;\n  complaining = false;\n  debug;\n  constructor(url, authPolicy) {\n    super();\n    this.url = url;\n    this.scores = /* @__PURE__ */ new Map();\n    this.debug = debug(`ndk:relay:${url}`);\n    this.connectivity = new NDKRelayConnectivity(this);\n    this.subs = new NDKRelaySubscriptions(this);\n    this.publisher = new NDKRelayPublisher(this);\n    this.authPolicy = authPolicy;\n  }\n  get status() {\n    return this.connectivity.status;\n  }\n  get connectionStats() {\n    return this.connectivity.connectionStats;\n  }\n  /**\n   * Connects to the relay.\n   */\n  async connect(timeoutMs) {\n    return this.connectivity.connect(timeoutMs);\n  }\n  /**\n   * Disconnects from the relay.\n   */\n  disconnect() {\n    if (this.status === 3 /* DISCONNECTED */) {\n      return;\n    }\n    this.connectivity.disconnect();\n  }\n  /**\n   * Queues or executes the subscription of a specific set of filters\n   * within this relay.\n   *\n   * @param subscription NDKSubscription this filters belong to.\n   * @param filters Filters to execute\n   */\n  subscribe(subscription, filters) {\n    this.subs.subscribe(subscription, filters);\n  }\n  /**\n   * Publishes an event to the relay with an optional timeout.\n   *\n   * If the relay is not connected, the event will be published when the relay connects,\n   * unless the timeout is reached before the relay connects.\n   *\n   * @param event The event to publish\n   * @param timeoutMs The timeout for the publish operation in milliseconds\n   * @returns A promise that resolves when the event has been published or rejects if the operation times out\n   */\n  async publish(event, timeoutMs = 2500) {\n    return this.publisher.publish(event, timeoutMs);\n  }\n  async auth(event) {\n    return this.publisher.auth(event);\n  }\n  /**\n   * Called when this relay has responded with an event but\n   * wasn't the fastest one.\n   * @param timeDiffInMs The time difference in ms between the fastest and this relay in milliseconds\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  scoreSlowerEvent(timeDiffInMs) {\n  }\n  /** @deprecated Use referenceTags instead. */\n  tagReference(marker) {\n    const tag = [\"r\", this.url];\n    if (marker) {\n      tag.push(marker);\n    }\n    return tag;\n  }\n  referenceTags() {\n    return [[\"r\", this.url]];\n  }\n  activeSubscriptions() {\n    return this.subs.executedFilters();\n  }\n};\n\n// src/relay/sets/index.ts\nvar PublishError = class extends Error {\n  errors;\n  constructor(message, errors) {\n    super(message);\n    this.errors = errors;\n  }\n  get relayErrors() {\n    const errors = [];\n    for (const [relay, err] of this.errors) {\n      errors.push(`${relay.url}: ${err}`);\n    }\n    return errors.join(\"\\n\");\n  }\n};\nvar NDKRelaySet = class _NDKRelaySet {\n  relays;\n  debug;\n  ndk;\n  constructor(relays, ndk) {\n    this.relays = relays;\n    this.ndk = ndk;\n    this.debug = ndk.debug.extend(\"relayset\");\n  }\n  /**\n   * Adds a relay to this set.\n   */\n  addRelay(relay) {\n    this.relays.add(relay);\n  }\n  /**\n   * Creates a relay set from a list of relay URLs.\n   *\n   * If no connection to the relay is found in the pool it will temporarily\n   * connect to it.\n   *\n   * @param relayUrls - list of relay URLs to include in this set\n   * @param ndk\n   * @returns NDKRelaySet\n   */\n  static fromRelayUrls(relayUrls, ndk) {\n    const relays = /* @__PURE__ */ new Set();\n    for (const url of relayUrls) {\n      const relay = ndk.pool.relays.get(url);\n      if (relay) {\n        relays.add(relay);\n      } else {\n        const temporaryRelay = new NDKRelay(url);\n        ndk.pool.useTemporaryRelay(temporaryRelay);\n        relays.add(temporaryRelay);\n      }\n    }\n    return new _NDKRelaySet(new Set(relays), ndk);\n  }\n  /**\n   * Publish an event to all relays in this set. Returns the number of relays that have received the event.\n   * @param event\n   * @param timeoutMs - timeout in milliseconds for each publish operation and connection operation\n   * @returns A set where the event was successfully published to\n   * @throws PublishError if no relay was able to receive the event\n   * @example\n   * ```typescript\n   * const event = new NDKEvent(ndk, {kinds: [NDKKind.Message], \"#d\": [\"123\"]});\n   * try {\n   *    const publishedToRelays = await relaySet.publish(event);\n   *    console.log(`published to ${publishedToRelays.size} relays`)\n   * } catch (error) {\n   *   console.error(\"error publishing to relays\", error);\n   *\n   *   if (error instanceof PublishError) {\n   *      for (const [relay, err] of error.errors) {\n   *         console.error(`error publishing to relay ${relay.url}`, err);\n   *       }\n   *   }\n   * }\n   * ```\n   */\n  async publish(event, timeoutMs) {\n    const publishedToRelays = /* @__PURE__ */ new Set();\n    const errors = /* @__PURE__ */ new Map();\n    const isEphemeral2 = event.isEphemeral();\n    const promises = Array.from(this.relays).map((relay) => {\n      return new Promise((resolve) => {\n        relay.publish(event, timeoutMs).then((e) => {\n          publishedToRelays.add(relay);\n          resolve();\n        }).catch((err) => {\n          if (!isEphemeral2) {\n            errors.set(relay, err);\n            this.debug(\"error publishing to relay\", {\n              relay: relay.url,\n              err\n            });\n          }\n          resolve();\n        });\n      });\n    });\n    await Promise.all(promises);\n    if (publishedToRelays.size === 0) {\n      if (!isEphemeral2) {\n        throw new PublishError(\"No relay was able to receive the event\", errors);\n      }\n    }\n    return publishedToRelays;\n  }\n  get size() {\n    return this.relays.size;\n  }\n};\n\n// src/relay/sets/calculate.ts\nfunction calculateRelaySetFromEvent(ndk, event) {\n  const relays = /* @__PURE__ */ new Set();\n  ndk.pool?.relays.forEach((relay) => relays.add(relay));\n  return new NDKRelaySet(relays, ndk);\n}\nfunction calculateRelaySetsFromFilter(ndk, filters, pool) {\n  const result = /* @__PURE__ */ new Map();\n  const authors = /* @__PURE__ */ new Set();\n  filters.forEach((filter) => {\n    if (filter.authors) {\n      filter.authors.forEach((author) => authors.add(author));\n    }\n  });\n  if (authors.size > 0) {\n    const authorToRelaysMap = getRelaysForFilterWithAuthors(ndk, Array.from(authors), pool);\n    for (const relayUrl of authorToRelaysMap.keys()) {\n      result.set(relayUrl, []);\n    }\n    for (const filter of filters) {\n      if (filter.authors) {\n        for (const [relayUrl, authors2] of authorToRelaysMap.entries()) {\n          const authorFilterAndRelayPubkeyIntersection = filter.authors.filter(\n            (author) => authors2.includes(author)\n          );\n          result.set(relayUrl, [\n            ...result.get(relayUrl),\n            {\n              ...filter,\n              // Overwrite authors sent to this relay with the authors that were\n              // present in the filter and are also present in the relay\n              authors: authorFilterAndRelayPubkeyIntersection\n            }\n          ]);\n        }\n      } else {\n        for (const relayUrl of authorToRelaysMap.keys()) {\n          result.set(relayUrl, [...result.get(relayUrl), filter]);\n        }\n      }\n    }\n  } else {\n    Array.from(pool.relays.keys()).forEach((relay) => {\n      result.set(relay, filters);\n    });\n  }\n  return result;\n}\nfunction calculateRelaySetsFromFilters(ndk, filters, pool) {\n  return calculateRelaySetsFromFilter(ndk, filters, pool);\n}\n\n// src/events/content-tagger.ts\nimport { nip19 as nip192 } from \"nostr-tools\";\nfunction mergeTags(tags1, tags2) {\n  const tagMap = /* @__PURE__ */ new Map();\n  const generateKey = (tag) => tag.join(\",\");\n  const isContained = (smaller, larger) => {\n    return smaller.every((value, index) => value === larger[index]);\n  };\n  const processTag = (tag) => {\n    for (let [key, existingTag] of tagMap) {\n      if (isContained(existingTag, tag) || isContained(tag, existingTag)) {\n        if (tag.length >= existingTag.length) {\n          tagMap.set(key, tag);\n        }\n        return;\n      }\n    }\n    tagMap.set(generateKey(tag), tag);\n  };\n  tags1.concat(tags2).forEach(processTag);\n  return Array.from(tagMap.values());\n}\nasync function generateContentTags(content, tags = []) {\n  const tagRegex = /(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g;\n  const hashtagRegex = /#(\\w+)/g;\n  let promises = [];\n  const addTagIfNew = (t) => {\n    if (!tags.find((t2) => t2[0] === t[0] && t2[1] === t[1])) {\n      tags.push(t);\n    }\n  };\n  content = content.replace(tagRegex, (tag) => {\n    try {\n      const entity = tag.split(/(@|nostr:)/)[2];\n      const { type, data } = nip192.decode(entity);\n      let t;\n      switch (type) {\n        case \"npub\":\n          t = [\"p\", data];\n          break;\n        case \"nprofile\":\n          t = [\"p\", data.pubkey];\n          break;\n        case \"note\":\n          promises.push(\n            new Promise(async (resolve) => {\n              addTagIfNew([\n                \"e\",\n                data,\n                await maybeGetEventRelayUrl(entity),\n                \"mention\"\n              ]);\n              resolve();\n            })\n          );\n          break;\n        case \"nevent\":\n          promises.push(\n            new Promise(async (resolve) => {\n              let { id, relays, author } = data;\n              if (!relays || relays.length === 0) {\n                relays = [await maybeGetEventRelayUrl(entity)];\n              }\n              addTagIfNew([\"e\", id, relays[0], \"mention\"]);\n              if (author)\n                addTagIfNew([\"p\", author]);\n              resolve();\n            })\n          );\n          break;\n        case \"naddr\":\n          promises.push(\n            new Promise(async (resolve) => {\n              const id = [data.kind, data.pubkey, data.identifier].join(\":\");\n              let relays = data.relays ?? [];\n              if (relays.length === 0) {\n                relays = [await maybeGetEventRelayUrl(entity)];\n              }\n              addTagIfNew([\"a\", id, relays[0], \"mention\"]);\n              addTagIfNew([\"p\", data.pubkey]);\n              resolve();\n            })\n          );\n          break;\n        default:\n          return tag;\n      }\n      if (t)\n        addTagIfNew(t);\n      return `nostr:${entity}`;\n    } catch (error) {\n      return tag;\n    }\n  });\n  await Promise.all(promises);\n  content = content.replace(hashtagRegex, (tag, word) => {\n    const t = [\"t\", word];\n    if (!tags.find((t2) => t2[0] === t[0] && t2[1] === t[1])) {\n      tags.push(t);\n    }\n    return tag;\n  });\n  return { content, tags };\n}\nasync function maybeGetEventRelayUrl(nip19Id) {\n  return \"\";\n}\n\n// src/events/kind.ts\nfunction isReplaceable() {\n  if (this.kind === void 0)\n    throw new Error(\"Kind not set\");\n  return [0, 3].includes(this.kind) || this.kind >= 1e4 && this.kind < 2e4 || this.kind >= 3e4 && this.kind < 4e4;\n}\nfunction isEphemeral() {\n  if (this.kind === void 0)\n    throw new Error(\"Kind not set\");\n  return this.kind >= 2e4 && this.kind < 3e4;\n}\nfunction isParamReplaceable() {\n  if (this.kind === void 0)\n    throw new Error(\"Kind not set\");\n  return this.kind >= 3e4 && this.kind < 4e4;\n}\n\n// src/events/kinds/index.ts\nvar NDKKind = /* @__PURE__ */ ((NDKKind2) => {\n  NDKKind2[NDKKind2[\"Metadata\"] = 0] = \"Metadata\";\n  NDKKind2[NDKKind2[\"Text\"] = 1] = \"Text\";\n  NDKKind2[NDKKind2[\"RecommendRelay\"] = 2] = \"RecommendRelay\";\n  NDKKind2[NDKKind2[\"Contacts\"] = 3] = \"Contacts\";\n  NDKKind2[NDKKind2[\"EncryptedDirectMessage\"] = 4] = \"EncryptedDirectMessage\";\n  NDKKind2[NDKKind2[\"EventDeletion\"] = 5] = \"EventDeletion\";\n  NDKKind2[NDKKind2[\"Repost\"] = 6] = \"Repost\";\n  NDKKind2[NDKKind2[\"Reaction\"] = 7] = \"Reaction\";\n  NDKKind2[NDKKind2[\"BadgeAward\"] = 8] = \"BadgeAward\";\n  NDKKind2[NDKKind2[\"GroupChat\"] = 9] = \"GroupChat\";\n  NDKKind2[NDKKind2[\"GroupNote\"] = 11] = \"GroupNote\";\n  NDKKind2[NDKKind2[\"GroupReply\"] = 12] = \"GroupReply\";\n  NDKKind2[NDKKind2[\"GenericRepost\"] = 16] = \"GenericRepost\";\n  NDKKind2[NDKKind2[\"ChannelCreation\"] = 40] = \"ChannelCreation\";\n  NDKKind2[NDKKind2[\"ChannelMetadata\"] = 41] = \"ChannelMetadata\";\n  NDKKind2[NDKKind2[\"ChannelMessage\"] = 42] = \"ChannelMessage\";\n  NDKKind2[NDKKind2[\"ChannelHideMessage\"] = 43] = \"ChannelHideMessage\";\n  NDKKind2[NDKKind2[\"ChannelMuteUser\"] = 44] = \"ChannelMuteUser\";\n  NDKKind2[NDKKind2[\"Media\"] = 1063] = \"Media\";\n  NDKKind2[NDKKind2[\"Report\"] = 1984] = \"Report\";\n  NDKKind2[NDKKind2[\"Label\"] = 1985] = \"Label\";\n  NDKKind2[NDKKind2[\"DVMReqTextExtraction\"] = 5e3] = \"DVMReqTextExtraction\";\n  NDKKind2[NDKKind2[\"DVMReqTextSummarization\"] = 5001] = \"DVMReqTextSummarization\";\n  NDKKind2[NDKKind2[\"DVMReqTextTranslation\"] = 5002] = \"DVMReqTextTranslation\";\n  NDKKind2[NDKKind2[\"DVMReqTextGeneration\"] = 5050] = \"DVMReqTextGeneration\";\n  NDKKind2[NDKKind2[\"DVMReqImageGeneration\"] = 5100] = \"DVMReqImageGeneration\";\n  NDKKind2[NDKKind2[\"DVMReqDiscoveryNostrContent\"] = 5300] = \"DVMReqDiscoveryNostrContent\";\n  NDKKind2[NDKKind2[\"DVMReqDiscoveryNostrPeople\"] = 5301] = \"DVMReqDiscoveryNostrPeople\";\n  NDKKind2[NDKKind2[\"DVMReqTimestamping\"] = 5900] = \"DVMReqTimestamping\";\n  NDKKind2[NDKKind2[\"DVMEventSchedule\"] = 5905] = \"DVMEventSchedule\";\n  NDKKind2[NDKKind2[\"DVMJobFeedback\"] = 7e3] = \"DVMJobFeedback\";\n  NDKKind2[NDKKind2[\"Subscribe\"] = 7001] = \"Subscribe\";\n  NDKKind2[NDKKind2[\"Unsubscribe\"] = 7002] = \"Unsubscribe\";\n  NDKKind2[NDKKind2[\"SubscriptionReceipt\"] = 7003] = \"SubscriptionReceipt\";\n  NDKKind2[NDKKind2[\"GroupAdminAddUser\"] = 9e3] = \"GroupAdminAddUser\";\n  NDKKind2[NDKKind2[\"GroupAdminRemoveUser\"] = 9001] = \"GroupAdminRemoveUser\";\n  NDKKind2[NDKKind2[\"GroupAdminEditMetadata\"] = 9002] = \"GroupAdminEditMetadata\";\n  NDKKind2[NDKKind2[\"GroupAdminEditStatus\"] = 9006] = \"GroupAdminEditStatus\";\n  NDKKind2[NDKKind2[\"MuteList\"] = 1e4] = \"MuteList\";\n  NDKKind2[NDKKind2[\"PinList\"] = 10001] = \"PinList\";\n  NDKKind2[NDKKind2[\"RelayList\"] = 10002] = \"RelayList\";\n  NDKKind2[NDKKind2[\"BookmarkList\"] = 10003] = \"BookmarkList\";\n  NDKKind2[NDKKind2[\"CommunityList\"] = 10004] = \"CommunityList\";\n  NDKKind2[NDKKind2[\"PublicChatList\"] = 10005] = \"PublicChatList\";\n  NDKKind2[NDKKind2[\"BlockRelayList\"] = 10006] = \"BlockRelayList\";\n  NDKKind2[NDKKind2[\"SearchRelayList\"] = 10007] = \"SearchRelayList\";\n  NDKKind2[NDKKind2[\"SimpleGroupList\"] = 10009] = \"SimpleGroupList\";\n  NDKKind2[NDKKind2[\"InterestList\"] = 10015] = \"InterestList\";\n  NDKKind2[NDKKind2[\"EmojiList\"] = 10030] = \"EmojiList\";\n  NDKKind2[NDKKind2[\"NostrWaletConnectInfo\"] = 13194] = \"NostrWaletConnectInfo\";\n  NDKKind2[NDKKind2[\"TierList\"] = 17e3] = \"TierList\";\n  NDKKind2[NDKKind2[\"FollowSet\"] = 3e4] = \"FollowSet\";\n  NDKKind2[NDKKind2[\"CategorizedPeopleList\"] = 3e4 /* FollowSet */] = \"CategorizedPeopleList\";\n  NDKKind2[NDKKind2[\"CategorizedBookmarkList\"] = 30001] = \"CategorizedBookmarkList\";\n  NDKKind2[NDKKind2[\"RelaySet\"] = 30002] = \"RelaySet\";\n  NDKKind2[NDKKind2[\"CategorizedRelayList\"] = 30002 /* RelaySet */] = \"CategorizedRelayList\";\n  NDKKind2[NDKKind2[\"BookmarkSet\"] = 30003] = \"BookmarkSet\";\n  NDKKind2[NDKKind2[\"CurationSet\"] = 30004] = \"CurationSet\";\n  NDKKind2[NDKKind2[\"ArticleCurationSet\"] = 30004] = \"ArticleCurationSet\";\n  NDKKind2[NDKKind2[\"VideoCurationSet\"] = 30005] = \"VideoCurationSet\";\n  NDKKind2[NDKKind2[\"InterestSet\"] = 30015] = \"InterestSet\";\n  NDKKind2[NDKKind2[\"InterestsList\"] = 30015 /* InterestSet */] = \"InterestsList\";\n  NDKKind2[NDKKind2[\"EmojiSet\"] = 30030] = \"EmojiSet\";\n  NDKKind2[NDKKind2[\"HighlightSet\"] = 39802] = \"HighlightSet\";\n  NDKKind2[NDKKind2[\"SubscriptionTier\"] = 37001] = \"SubscriptionTier\";\n  NDKKind2[NDKKind2[\"CategorizedHighlightList\"] = 39802 /* HighlightSet */] = \"CategorizedHighlightList\";\n  NDKKind2[NDKKind2[\"ZapRequest\"] = 9734] = \"ZapRequest\";\n  NDKKind2[NDKKind2[\"Zap\"] = 9735] = \"Zap\";\n  NDKKind2[NDKKind2[\"Highlight\"] = 9802] = \"Highlight\";\n  NDKKind2[NDKKind2[\"ClientAuth\"] = 22242] = \"ClientAuth\";\n  NDKKind2[NDKKind2[\"NostrWalletConnectReq\"] = 23194] = \"NostrWalletConnectReq\";\n  NDKKind2[NDKKind2[\"NostrWalletConnectRes\"] = 23195] = \"NostrWalletConnectRes\";\n  NDKKind2[NDKKind2[\"NostrConnect\"] = 24133] = \"NostrConnect\";\n  NDKKind2[NDKKind2[\"HttpAuth\"] = 27235] = \"HttpAuth\";\n  NDKKind2[NDKKind2[\"ProfileBadge\"] = 30008] = \"ProfileBadge\";\n  NDKKind2[NDKKind2[\"BadgeDefinition\"] = 30009] = \"BadgeDefinition\";\n  NDKKind2[NDKKind2[\"MarketStall\"] = 30017] = \"MarketStall\";\n  NDKKind2[NDKKind2[\"MarketProduct\"] = 30018] = \"MarketProduct\";\n  NDKKind2[NDKKind2[\"Article\"] = 30023] = \"Article\";\n  NDKKind2[NDKKind2[\"AppSpecificData\"] = 30078] = \"AppSpecificData\";\n  NDKKind2[NDKKind2[\"Classified\"] = 30402] = \"Classified\";\n  NDKKind2[NDKKind2[\"HorizontalVideo\"] = 34235] = \"HorizontalVideo\";\n  NDKKind2[NDKKind2[\"GroupMetadata\"] = 39e3] = \"GroupMetadata\";\n  NDKKind2[NDKKind2[\"GroupMembers\"] = 39002] = \"GroupMembers\";\n  NDKKind2[NDKKind2[\"AppRecommendation\"] = 31989] = \"AppRecommendation\";\n  NDKKind2[NDKKind2[\"AppHandler\"] = 31990] = \"AppHandler\";\n  return NDKKind2;\n})(NDKKind || {});\nvar NDKListKinds = [\n  1e4 /* MuteList */,\n  10001 /* PinList */,\n  10002 /* RelayList */,\n  10003 /* BookmarkList */,\n  10004 /* CommunityList */,\n  10005 /* PublicChatList */,\n  10006 /* BlockRelayList */,\n  10007 /* SearchRelayList */,\n  10015 /* InterestList */,\n  10030 /* EmojiList */,\n  3e4 /* FollowSet */,\n  30003 /* BookmarkSet */,\n  30001 /* CategorizedBookmarkList */,\n  // Backwards compatibility\n  30002 /* RelaySet */,\n  30004 /* ArticleCurationSet */,\n  30005 /* VideoCurationSet */,\n  30015 /* InterestSet */,\n  30030 /* EmojiSet */,\n  39802 /* HighlightSet */\n];\n\n// src/events/nip04.ts\nasync function encrypt(recipient, signer) {\n  if (!this.ndk)\n    throw new Error(\"No NDK instance found!\");\n  if (!signer) {\n    await this.ndk.assertSigner();\n    signer = this.ndk.signer;\n  }\n  if (!recipient) {\n    const pTags = this.getMatchingTags(\"p\");\n    if (pTags.length !== 1) {\n      throw new Error(\n        \"No recipient could be determined and no explicit recipient was provided\"\n      );\n    }\n    recipient = this.ndk.getUser({ hexpubkey: pTags[0][1] });\n  }\n  this.content = await signer?.encrypt(recipient, this.content);\n}\nasync function decrypt(sender, signer) {\n  if (!this.ndk)\n    throw new Error(\"No NDK instance found!\");\n  if (!signer) {\n    await this.ndk.assertSigner();\n    signer = this.ndk.signer;\n  }\n  if (!sender) {\n    sender = this.author;\n  }\n  this.content = await signer?.decrypt(sender, this.content);\n}\n\n// src/events/nip19.ts\nimport { nip19 as nip193 } from \"nostr-tools\";\nfunction encode() {\n  let relays = [];\n  if (this.onRelays.length > 0) {\n    relays = this.onRelays.map((relay) => relay.url);\n  } else if (this.relay) {\n    relays = [this.relay.url];\n  }\n  if (this.isParamReplaceable()) {\n    return nip193.naddrEncode({\n      kind: this.kind,\n      pubkey: this.pubkey,\n      identifier: this.replaceableDTag(),\n      relays\n    });\n  } else if (relays.length > 0) {\n    return nip193.neventEncode({\n      id: this.tagId(),\n      relays,\n      author: this.pubkey\n    });\n  } else {\n    return nip193.noteEncode(this.tagId());\n  }\n}\n\n// src/events/repost.ts\nasync function repost(publish = true, signer) {\n  if (!signer && publish) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    signer = this.ndk.signer;\n  }\n  const e = new NDKEvent(this.ndk, {\n    kind: getKind(this),\n    content: \"\"\n  });\n  e.tag(this);\n  if (e.kind === 16 /* GenericRepost */) {\n    e.tags.push([\"k\", `${this.kind}`]);\n  }\n  if (signer)\n    await e.sign(signer);\n  if (publish)\n    await e.publish();\n  return e;\n}\nfunction getKind(event) {\n  if (event.kind === 1) {\n    return 6 /* Repost */;\n  }\n  return 16 /* GenericRepost */;\n}\n\n// src/events/serializer.ts\nfunction serialize() {\n  return JSON.stringify([0, this.pubkey, this.created_at, this.kind, this.tags, this.content]);\n}\n\n// src/events/validation.ts\nimport { sha256 } from \"@noble/hashes/sha256\";\nimport { bytesToHex } from \"@noble/hashes/utils\";\nimport { schnorr } from \"@noble/curves/secp256k1\";\nvar PUBKEY_REGEX = /^[a-f0-9]{64}$/;\nfunction validate() {\n  if (typeof this.kind !== \"number\")\n    return false;\n  if (typeof this.content !== \"string\")\n    return false;\n  if (typeof this.created_at !== \"number\")\n    return false;\n  if (typeof this.pubkey !== \"string\")\n    return false;\n  if (!this.pubkey.match(PUBKEY_REGEX))\n    return false;\n  if (!Array.isArray(this.tags))\n    return false;\n  for (let i = 0; i < this.tags.length; i++) {\n    const tag = this.tags[i];\n    if (!Array.isArray(tag))\n      return false;\n    for (let j = 0; j < tag.length; j++) {\n      if (typeof tag[j] === \"object\")\n        return false;\n    }\n  }\n  return true;\n}\nfunction verifySignature(persist) {\n  if (typeof this.signatureVerified === \"boolean\")\n    return this.signatureVerified;\n  const hash = this.getEventHash();\n  if (hash !== this.id) {\n    return persist ? this.signatureVerified = false : false;\n  }\n  try {\n    return this.signatureVerified = schnorr.verify(this.sig, hash, this.pubkey);\n  } catch (err) {\n    return this.signatureVerified = false;\n  }\n}\nfunction getEventHash() {\n  const eventHash = sha256(new TextEncoder().encode(this.serialize()));\n  return bytesToHex(eventHash);\n}\n\n// src/zap/index.ts\nimport { bech32 } from \"@scure/base\";\nimport { EventEmitter as EventEmitter3 } from \"tseep\";\nimport { nip57 } from \"nostr-tools\";\nimport createDebug from \"debug\";\nvar debug2 = createDebug(\"ndk:zap\");\nvar DEFAULT_RELAYS = [\n  \"wss://nos.lol\",\n  \"wss://relay.nostr.band\",\n  \"wss://relay.f7z.io\",\n  \"wss://relay.damus.io\",\n  \"wss://nostr.mom\",\n  \"wss://no.str.cr\"\n];\nvar NDKZap = class _NDKZap extends EventEmitter3 {\n  ndk;\n  zappedEvent;\n  zappedUser;\n  fetch = fetch;\n  constructor(args) {\n    super();\n    this.ndk = args.ndk;\n    this.zappedEvent = args.zappedEvent;\n    this.fetch = args._fetch || fetch;\n    this.zappedUser = args.zappedUser || this.ndk.getUser({ hexpubkey: this.zappedEvent?.pubkey });\n  }\n  /**\n   * Fetches the zapper's pubkey for the zapped user\n   */\n  static async getZapperPubkey(ndk, forUser) {\n    const zappedUser = ndk.getUser({ pubkey: forUser });\n    const zap = new _NDKZap({ ndk, zappedUser });\n    const lnurlspec = await zap.getZapSpec();\n    return lnurlspec?.nostrPubkey;\n  }\n  async getZapSpec() {\n    if (!this.zappedUser)\n      throw new Error(\"No user to zap was provided\");\n    return this.zappedUser.getZapConfiguration(this.ndk);\n  }\n  async getZapSpecWithoutCache() {\n    let lud06;\n    let lud16;\n    let zapEndpoint;\n    let profile;\n    if (this.zappedUser) {\n      if (!this.zappedUser.profile) {\n        await this.zappedUser.fetchProfile({ groupable: false });\n      }\n      profile = this.zappedUser.profile;\n      lud06 = (this.zappedUser.profile || {}).lud06;\n      lud16 = (this.zappedUser.profile || {}).lud16;\n    }\n    if (lud16 && !lud16.startsWith(\"LNURL\")) {\n      const [name, domain] = lud16.split(\"@\");\n      zapEndpoint = `https://${domain}/.well-known/lnurlp/${name}`;\n    } else if (lud06) {\n      const { words } = bech32.decode(lud06, 1e3);\n      const data = bech32.fromWords(words);\n      const utf8Decoder = new TextDecoder(\"utf-8\");\n      zapEndpoint = utf8Decoder.decode(data);\n    }\n    if (!zapEndpoint) {\n      debug2(\"No zap endpoint found\", profile, { lud06, lud16 });\n      throw new Error(\"No zap endpoint found\");\n    }\n    try {\n      const _fetch = this.fetch || this.ndk.httpFetch;\n      const response = await _fetch(zapEndpoint);\n      if (response.status !== 200) {\n        const text = await response.text();\n        throw new Error(`Unable to fetch zap endpoint ${zapEndpoint}: ${text}`);\n      }\n      return await response.json();\n    } catch (e) {\n      throw new Error(`Unable to fetch zap endpoint ${zapEndpoint}: ${e}`);\n    }\n  }\n  async getZapEndpoint() {\n    const zapSpec = await this.getZapSpec();\n    if (!zapSpec)\n      return;\n    let zapEndpointCallback;\n    if (zapSpec?.allowsNostr && (zapSpec?.nostrPubkey || zapSpec?.nostrPubkey)) {\n      zapEndpointCallback = zapSpec.callback;\n    }\n    return zapEndpointCallback;\n  }\n  /**\n   * Generates a kind:9734 zap request and returns the payment request\n   * @param amount amount to zap in millisatoshis\n   * @param comment optional comment to include in the zap request\n   * @param extraTags optional extra tags to include in the zap request\n   * @param relays optional relays to ask zapper to publish the zap to\n   * @returns the payment request\n   */\n  async createZapRequest(amount, comment, extraTags, relays, signer) {\n    const res = await this.generateZapRequest(amount, comment, extraTags, relays);\n    if (!res)\n      return null;\n    const { event, zapEndpoint } = res;\n    if (!event) {\n      throw new Error(\"No zap request event found\");\n    }\n    await event.sign(signer);\n    let invoice;\n    try {\n      debug2(`Getting invoice for zap request: ${zapEndpoint}`);\n      invoice = await this.getInvoice(event, amount, zapEndpoint);\n    } catch (e) {\n      throw new Error(\"Failed to get invoice: \" + e);\n    }\n    return invoice;\n  }\n  async getInvoice(event, amount, zapEndpoint) {\n    debug2(\n      `Fetching invoice from ${zapEndpoint}?` + new URLSearchParams({\n        amount: amount.toString(),\n        nostr: encodeURIComponent(JSON.stringify(event.rawEvent()))\n      })\n    );\n    const url = new URL(zapEndpoint);\n    url.searchParams.append(\"amount\", amount.toString());\n    url.searchParams.append(\"nostr\", JSON.stringify(event.rawEvent()));\n    debug2(`Fetching invoice from ${url.toString()}`);\n    const response = await fetch(url.toString());\n    debug2(`Got response from zap endpoint: ${zapEndpoint}`, { status: response.status });\n    if (response.status !== 200) {\n      debug2(`Received non-200 status from zap endpoint: ${zapEndpoint}`, {\n        status: response.status,\n        amount,\n        nostr: JSON.stringify(event.rawEvent())\n      });\n      const text = await response.text();\n      throw new Error(`Unable to fetch zap endpoint ${zapEndpoint}: ${text}`);\n    }\n    const body = await response.json();\n    return body.pr;\n  }\n  async generateZapRequest(amount, comment, extraTags, relays, signer) {\n    const zapEndpoint = await this.getZapEndpoint();\n    if (!zapEndpoint) {\n      throw new Error(\"No zap endpoint found\");\n    }\n    if (!this.zappedEvent && !this.zappedUser)\n      throw new Error(\"No zapped event or user found\");\n    const zapRequest = nip57.makeZapRequest({\n      profile: this.zappedUser.pubkey,\n      // set the event to null since nostr-tools doesn't support nip-33 zaps\n      event: null,\n      amount,\n      comment: comment || \"\",\n      relays: relays ?? this.relays()\n    });\n    if (this.zappedEvent) {\n      const tags = this.zappedEvent.referenceTags();\n      const nonPTags = tags.filter((tag) => tag[0] !== \"p\");\n      zapRequest.tags.push(...nonPTags);\n    }\n    zapRequest.tags.push([\"lnurl\", zapEndpoint]);\n    const event = new NDKEvent(this.ndk, zapRequest);\n    if (extraTags) {\n      event.tags = event.tags.concat(extraTags);\n    }\n    return { event, zapEndpoint };\n  }\n  /**\n   * @returns the relays to use for the zap request\n   */\n  relays() {\n    let r = [];\n    if (this.ndk?.pool?.relays) {\n      r = this.ndk.pool.urls();\n    }\n    if (!r.length) {\n      r = DEFAULT_RELAYS;\n    }\n    return r;\n  }\n};\n\n// src/events/index.ts\nvar NDKEvent = class _NDKEvent extends EventEmitter4 {\n  ndk;\n  created_at;\n  content = \"\";\n  tags = [];\n  kind;\n  id = \"\";\n  sig;\n  pubkey = \"\";\n  signatureVerified;\n  _author = void 0;\n  /**\n   * The relay that this event was first received from.\n   */\n  relay;\n  /**\n   * The relays that this event was received from and/or successfully published to.\n   */\n  onRelays = [];\n  constructor(ndk, event) {\n    super();\n    this.ndk = ndk;\n    this.created_at = event?.created_at;\n    this.content = event?.content || \"\";\n    this.tags = event?.tags || [];\n    this.id = event?.id || \"\";\n    this.sig = event?.sig;\n    this.pubkey = event?.pubkey || \"\";\n    this.kind = event?.kind;\n  }\n  /**\n   * Returns the event as is.\n   */\n  rawEvent() {\n    return {\n      created_at: this.created_at,\n      content: this.content,\n      tags: this.tags,\n      kind: this.kind,\n      pubkey: this.pubkey,\n      id: this.id,\n      sig: this.sig\n    };\n  }\n  set author(user) {\n    this.pubkey = user.hexpubkey;\n    this._author = void 0;\n  }\n  /**\n   * Returns an NDKUser for the author of the event.\n   */\n  get author() {\n    if (this._author)\n      return this._author;\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    const user = this.ndk.getUser({ hexpubkey: this.pubkey });\n    this._author = user;\n    return user;\n  }\n  tag(userOrTagOrEvent, marker, skipAuthorTag) {\n    let tags = [];\n    const isNDKUser = userOrTagOrEvent.fetchProfile !== void 0;\n    if (isNDKUser) {\n      const tag = [\"p\", userOrTagOrEvent.pubkey];\n      if (marker)\n        tag.push(...[\"\", marker]);\n      tags.push(tag);\n    } else if (userOrTagOrEvent instanceof _NDKEvent) {\n      const event = userOrTagOrEvent;\n      skipAuthorTag ??= event?.pubkey === this.pubkey;\n      tags = event.referenceTags(marker, skipAuthorTag);\n      for (const pTag of event.getMatchingTags(\"p\")) {\n        if (pTag[1] === this.pubkey)\n          continue;\n        if (this.tags.find((t) => t[0] === \"p\" && t[1] === pTag[1]))\n          continue;\n        this.tags.push([\"p\", pTag[1]]);\n      }\n    } else if (Array.isArray(userOrTagOrEvent)) {\n      tags = [userOrTagOrEvent];\n    } else {\n      throw new Error(\"Invalid argument\", userOrTagOrEvent);\n    }\n    this.tags = mergeTags(this.tags, tags);\n  }\n  /**\n   * Return a NostrEvent object, trying to fill in missing fields\n   * when possible, adding tags when necessary.\n   * @param pubkey {string} The pubkey of the user who the event belongs to.\n   * @returns {Promise<NostrEvent>} A promise that resolves to a NostrEvent.\n   */\n  async toNostrEvent(pubkey) {\n    if (!pubkey && this.pubkey === \"\") {\n      const user = await this.ndk?.signer?.user();\n      this.pubkey = user?.hexpubkey || \"\";\n    }\n    if (!this.created_at)\n      this.created_at = Math.floor(Date.now() / 1e3);\n    const nostrEvent = this.rawEvent();\n    const { content, tags } = await this.generateTags();\n    nostrEvent.content = content || \"\";\n    nostrEvent.tags = tags;\n    try {\n      this.id = this.getEventHash();\n    } catch (e) {\n    }\n    if (this.id)\n      nostrEvent.id = this.id;\n    if (this.sig)\n      nostrEvent.sig = this.sig;\n    return nostrEvent;\n  }\n  serialize = serialize.bind(this);\n  getEventHash = getEventHash.bind(this);\n  validate = validate.bind(this);\n  verifySignature = verifySignature.bind(this);\n  isReplaceable = isReplaceable.bind(this);\n  isEphemeral = isEphemeral.bind(this);\n  isParamReplaceable = isParamReplaceable.bind(this);\n  /**\n   * Encodes a bech32 id.\n   *\n   * @param relays {string[]} The relays to encode in the id\n   * @returns {string} - Encoded naddr, note or nevent.\n   */\n  encode = encode.bind(this);\n  encrypt = encrypt.bind(this);\n  decrypt = decrypt.bind(this);\n  /**\n   * Get all tags with the given name\n   * @param tagName {string} The name of the tag to search for\n   * @returns {NDKTag[]} An array of the matching tags\n   */\n  getMatchingTags(tagName) {\n    return this.tags.filter((tag) => tag[0] === tagName);\n  }\n  /**\n   * Get the first tag with the given name\n   * @param tagName Tag name to search for\n   * @returns The value of the first tag with the given name, or undefined if no such tag exists\n   */\n  tagValue(tagName) {\n    const tags = this.getMatchingTags(tagName);\n    if (tags.length === 0)\n      return void 0;\n    return tags[0][1];\n  }\n  /**\n   * Gets the NIP-31 \"alt\" tag of the event.\n   */\n  get alt() {\n    return this.tagValue(\"alt\");\n  }\n  /**\n   * Sets the NIP-31 \"alt\" tag of the event. Use this to set an alt tag so\n   * clients that don't handle a particular event kind can display something\n   * useful for users.\n   */\n  set alt(alt) {\n    this.removeTag(\"alt\");\n    if (alt)\n      this.tags.push([\"alt\", alt]);\n  }\n  /**\n   * Gets the NIP-33 \"d\" tag of the event.\n   */\n  get dTag() {\n    return this.tagValue(\"d\");\n  }\n  /**\n   * Sets the NIP-33 \"d\" tag of the event.\n   */\n  set dTag(value) {\n    this.removeTag(\"d\");\n    if (value)\n      this.tags.push([\"d\", value]);\n  }\n  /**\n   * Remove all tags with the given name (e.g. \"d\", \"a\", \"p\")\n   * @param tagName Tag name to search for and remove\n   * @returns {void}\n   */\n  removeTag(tagName) {\n    this.tags = this.tags.filter((tag) => tag[0] !== tagName);\n  }\n  /**\n   * Sign the event if a signer is present.\n   *\n   * It will generate tags.\n   * Repleacable events will have their created_at field set to the current time.\n   * @param signer {NDKSigner} The NDKSigner to use to sign the event\n   * @returns {Promise<string>} A Promise that resolves to the signature of the signed event.\n   */\n  async sign(signer) {\n    if (!signer) {\n      this.ndk?.assertSigner();\n      signer = this.ndk.signer;\n    } else {\n      this.author = await signer.user();\n    }\n    await this.generateTags();\n    if (this.isReplaceable()) {\n      this.created_at = Math.floor(Date.now() / 1e3);\n    }\n    const nostrEvent = await this.toNostrEvent();\n    this.sig = await signer.sign(nostrEvent);\n    return this.sig;\n  }\n  /**\n   * Attempt to sign and then publish an NDKEvent to a given relaySet.\n   * If no relaySet is provided, the relaySet will be calculated by NDK.\n   * @param relaySet {NDKRelaySet} The relaySet to publish the even to.\n   * @returns A promise that resolves to the relays the event was published to.\n   */\n  async publish(relaySet, timeoutMs) {\n    if (!this.sig)\n      await this.sign();\n    if (!this.ndk)\n      throw new Error(\"NDKEvent must be associated with an NDK instance to publish\");\n    if (!relaySet) {\n      relaySet = this.ndk.devWriteRelaySet || calculateRelaySetFromEvent(this.ndk, this);\n    }\n    this.ndk.debug(`publish to ${relaySet.size} relays`, this.rawEvent());\n    if (this.kind === 5 /* EventDeletion */ && this.ndk.cacheAdapter?.deleteEvent) {\n      this.ndk.cacheAdapter.deleteEvent(this);\n    }\n    const relays = await relaySet.publish(this, timeoutMs);\n    this.onRelays = Array.from(relays);\n    return relays;\n  }\n  /**\n   * Generates tags for users, notes, and other events tagged in content.\n   * Will also generate random \"d\" tag for parameterized replaceable events where needed.\n   * @returns {ContentTag} The tags and content of the event.\n   */\n  async generateTags() {\n    let tags = [];\n    const g = await generateContentTags(this.content, this.tags);\n    const content = g.content;\n    tags = g.tags;\n    if (this.kind && this.isParamReplaceable()) {\n      const dTag = this.getMatchingTags(\"d\")[0];\n      if (!dTag) {\n        const title = this.tagValue(\"title\");\n        const randLength = title ? 6 : 16;\n        let str = [...Array(randLength)].map(() => Math.random().toString(36)[2]).join(\"\");\n        if (title && title.length > 0) {\n          str = title.replace(/[^a-z0-9]+/gi, \"-\").replace(/^-|-$/g, \"\") + \"-\" + str;\n        }\n        tags.push([\"d\", str]);\n      }\n    }\n    if ((this.ndk?.clientName || this.ndk?.clientNip89) && !this.tagValue(\"client\")) {\n      const clientTag = [\"client\", this.ndk.clientName ?? \"\"];\n      if (this.ndk.clientNip89)\n        clientTag.push(this.ndk.clientNip89);\n      tags.push(clientTag);\n    }\n    return { content: content || \"\", tags };\n  }\n  muted() {\n    const authorMutedEntry = this.ndk?.mutedIds.get(this.pubkey);\n    if (authorMutedEntry && authorMutedEntry === \"p\")\n      return \"author\";\n    const eventTagReference = this.tagReference();\n    const eventMutedEntry = this.ndk?.mutedIds.get(eventTagReference[1]);\n    if (eventMutedEntry && eventMutedEntry === eventTagReference[0])\n      return \"event\";\n    return null;\n  }\n  /**\n   * Returns the \"d\" tag of a parameterized replaceable event or throws an error if the event isn't\n   * a parameterized replaceable event.\n   * @returns {string} the \"d\" tag of the event.\n   */\n  replaceableDTag() {\n    if (this.kind && this.kind >= 3e4 && this.kind <= 4e4) {\n      const dTag = this.getMatchingTags(\"d\")[0];\n      const dTagId = dTag ? dTag[1] : \"\";\n      return dTagId;\n    }\n    throw new Error(\"Event is not a parameterized replaceable event\");\n  }\n  /**\n   * Provides a deduplication key for the event.\n   *\n   * For kinds 0, 3, 10k-20k this will be the event <kind>:<pubkey>\n   * For kinds 30k-40k this will be the event <kind>:<pubkey>:<d-tag>\n   * For all other kinds this will be the event id\n   */\n  deduplicationKey() {\n    if (this.kind === 0 || this.kind === 3 || this.kind && this.kind >= 1e4 && this.kind < 2e4) {\n      return `${this.kind}:${this.pubkey}`;\n    } else {\n      return this.tagId();\n    }\n  }\n  /**\n   * Returns the id of the event or, if it's a parameterized event, the generated id of the event using \"d\" tag, pubkey, and kind.\n   * @returns {string} The id\n   */\n  tagId() {\n    if (this.isParamReplaceable()) {\n      return this.tagAddress();\n    }\n    return this.id;\n  }\n  /**\n   * Returns the \"reference\" value (\"<kind>:<author-pubkey>:<d-tag>\") for this replaceable event.\n   * @returns {string} The id\n   */\n  tagAddress() {\n    if (!this.isParamReplaceable()) {\n      throw new Error(\"This must only be called on replaceable events\");\n    }\n    const dTagId = this.replaceableDTag();\n    return `${this.kind}:${this.pubkey}:${dTagId}`;\n  }\n  /**\n   * Get the tag that can be used to reference this event from another event.\n   *\n   * Consider using referenceTags() instead (unless you have a good reason to use this)\n   *\n   * @example\n   *     event = new NDKEvent(ndk, { kind: 30000, pubkey: 'pubkey', tags: [ [\"d\", \"d-code\"] ] });\n   *     event.tagReference(); // [\"a\", \"30000:pubkey:d-code\"]\n   *\n   *     event = new NDKEvent(ndk, { kind: 1, pubkey: 'pubkey', id: \"eventid\" });\n   *     event.tagReference(); // [\"e\", \"eventid\"]\n   * @returns {NDKTag} The NDKTag object referencing this event\n   */\n  tagReference(marker) {\n    let tag;\n    if (this.isParamReplaceable()) {\n      tag = [\"a\", this.tagAddress()];\n    } else {\n      tag = [\"e\", this.tagId()];\n    }\n    if (this.relay) {\n      tag.push(this.relay.url);\n    } else {\n      tag.push(\"\");\n    }\n    if (marker) {\n      tag.push(marker);\n    }\n    return tag;\n  }\n  /**\n   * Get the tags that can be used to reference this event from another event\n   * @param marker The marker to use in the tag\n   * @example\n   *     event = new NDKEvent(ndk, { kind: 30000, pubkey: 'pubkey', tags: [ [\"d\", \"d-code\"] ] });\n   *     event.referenceTags(); // [[\"a\", \"30000:pubkey:d-code\"], [\"e\", \"parent-id\"]]\n   *\n   *     event = new NDKEvent(ndk, { kind: 1, pubkey: 'pubkey', id: \"eventid\" });\n   *     event.referenceTags(); // [[\"e\", \"parent-id\"]]\n   * @returns {NDKTag} The NDKTag object referencing this event\n   */\n  referenceTags(marker, skipAuthorTag) {\n    let tags = [];\n    if (this.isParamReplaceable()) {\n      tags = [\n        [\"a\", this.tagAddress()],\n        [\"e\", this.id]\n      ];\n    } else {\n      tags = [[\"e\", this.id]];\n    }\n    if (this.relay?.url) {\n      tags = tags.map((tag) => {\n        tag.push(this.relay?.url);\n        return tag;\n      });\n    } else if (marker) {\n      tags = tags.map((tag) => {\n        tag.push(\"\");\n        return tag;\n      });\n    }\n    if (marker) {\n      tags.forEach((tag) => tag.push(marker));\n    }\n    if (!skipAuthorTag)\n      tags.push(...this.author.referenceTags());\n    return tags;\n  }\n  /**\n   * Provides the filter that will return matching events for this event.\n   *\n   * @example\n   *    event = new NDKEvent(ndk, { kind: 30000, pubkey: 'pubkey', tags: [ [\"d\", \"d-code\"] ] });\n   *    event.filter(); // { \"#a\": [\"30000:pubkey:d-code\"] }\n   * @example\n   *    event = new NDKEvent(ndk, { kind: 1, pubkey: 'pubkey', id: \"eventid\" });\n   *    event.filter(); // { \"#e\": [\"eventid\"] }\n   *\n   * @returns The filter that will return matching events for this event\n   */\n  filter() {\n    if (this.isParamReplaceable()) {\n      return { \"#a\": [this.tagId()] };\n    } else {\n      return { \"#e\": [this.tagId()] };\n    }\n  }\n  /**\n   * Create a zap request for an existing event\n   *\n   * @param amount The amount to zap in millisatoshis\n   * @param comment A comment to add to the zap request\n   * @param extraTags Extra tags to add to the zap request\n   * @param recipient The zap recipient (optional for events)\n   * @param signer The signer to use (will default to the NDK instance's signer)\n   */\n  async zap(amount, comment, extraTags, recipient, signer) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    if (!signer) {\n      this.ndk.assertSigner();\n    }\n    const zap = new NDKZap({\n      ndk: this.ndk,\n      zappedEvent: this,\n      zappedUser: recipient\n    });\n    const relays = Array.from(this.ndk.pool.relays.keys());\n    const paymentRequest = await zap.createZapRequest(\n      amount,\n      comment,\n      extraTags,\n      relays,\n      signer\n    );\n    return paymentRequest;\n  }\n  /**\n   * Generates a deletion event of the current event\n   *\n   * @param reason The reason for the deletion\n   * @param publish Whether to publish the deletion event automatically\n   * @returns The deletion event\n   */\n  async delete(reason, publish = true) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    const e = new _NDKEvent(this.ndk, {\n      kind: 5 /* EventDeletion */,\n      content: reason || \"\"\n    });\n    e.tag(this);\n    if (publish)\n      await e.publish();\n    return e;\n  }\n  /**\n   * NIP-18 reposting event.\n   *\n   * @param publish Whether to publish the reposted event automatically\n   * @param signer The signer to use for signing the reposted event\n   * @returns The reposted event\n   *\n   * @function\n   */\n  repost = repost.bind(this);\n  /**\n   * React to an existing event\n   *\n   * @param content The content of the reaction\n   */\n  async react(content, publish = true) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    const e = new _NDKEvent(this.ndk, {\n      kind: 7 /* Reaction */,\n      content\n    });\n    e.tag(this);\n    if (publish) {\n      await e.publish();\n    } else {\n      await e.sign();\n    }\n    return e;\n  }\n  /**\n   * Checks whether the event is valid per underlying NIPs.\n   *\n   * This method is meant to be overridden by subclasses that implement specific NIPs\n   * to allow the enforcement of NIP-specific validation rules.\n   *\n   * Otherwise, it will only check for basic event properties.\n   *\n   */\n  get isValid() {\n    return this.validate();\n  }\n};\n\n// src/subscription/index.ts\nimport { EventEmitter as EventEmitter5 } from \"tseep\";\nvar NDKSubscriptionCacheUsage = /* @__PURE__ */ ((NDKSubscriptionCacheUsage2) => {\n  NDKSubscriptionCacheUsage2[\"ONLY_CACHE\"] = \"ONLY_CACHE\";\n  NDKSubscriptionCacheUsage2[\"CACHE_FIRST\"] = \"CACHE_FIRST\";\n  NDKSubscriptionCacheUsage2[\"PARALLEL\"] = \"PARALLEL\";\n  NDKSubscriptionCacheUsage2[\"ONLY_RELAY\"] = \"ONLY_RELAY\";\n  return NDKSubscriptionCacheUsage2;\n})(NDKSubscriptionCacheUsage || {});\nvar defaultOpts = {\n  closeOnEose: false,\n  cacheUsage: \"CACHE_FIRST\" /* CACHE_FIRST */,\n  groupable: true,\n  groupableDelay: 100,\n  groupableDelayType: \"at-most\"\n};\nvar NDKSubscription = class extends EventEmitter5 {\n  subId;\n  filters;\n  opts;\n  pool;\n  skipVerification = false;\n  skipValidation = false;\n  /**\n   * Tracks the filters as they are executed on each relay\n   */\n  relayFilters;\n  relaySet;\n  ndk;\n  debug;\n  eoseDebug;\n  /**\n   * Events that have been seen by the subscription, with the time they were first seen.\n   */\n  eventFirstSeen = /* @__PURE__ */ new Map();\n  /**\n   * Relays that have sent an EOSE.\n   */\n  eosesSeen = /* @__PURE__ */ new Set();\n  /**\n   * Events that have been seen by the subscription per relay.\n   */\n  eventsPerRelay = /* @__PURE__ */ new Map();\n  /**\n   * The time the last event was received by the subscription.\n   * This is used to calculate when EOSE should be emitted.\n   */\n  lastEventReceivedAt;\n  internalId;\n  constructor(ndk, filters, opts, relaySet, subId) {\n    super();\n    this.ndk = ndk;\n    this.pool = opts?.pool || ndk.pool;\n    this.opts = { ...defaultOpts, ...opts || {} };\n    this.filters = filters instanceof Array ? filters : [filters];\n    this.subId = subId || opts?.subId;\n    this.internalId = Math.random().toString(36).substring(7);\n    this.relaySet = relaySet;\n    this.debug = ndk.debug.extend(`subscription[${opts?.subId ?? this.internalId}]`);\n    this.eoseDebug = this.debug.extend(\"eose\");\n    this.skipVerification = opts?.skipVerification || false;\n    this.skipValidation = opts?.skipValidation || false;\n    if (!this.opts.closeOnEose) {\n      this.debug(\n        `Creating a permanent subscription`,\n        this.opts,\n        JSON.stringify(this.filters)\n      );\n    }\n    if (this.opts.cacheUsage === \"ONLY_CACHE\" /* ONLY_CACHE */ && !this.opts.closeOnEose) {\n      throw new Error(\"Cannot use cache-only options with a persistent subscription\");\n    }\n  }\n  /**\n   * Provides access to the first filter of the subscription for\n   * backwards compatibility.\n   */\n  get filter() {\n    return this.filters[0];\n  }\n  isGroupable() {\n    return this.opts?.groupable || false;\n  }\n  shouldQueryCache() {\n    return this.opts?.cacheUsage !== \"ONLY_RELAY\" /* ONLY_RELAY */;\n  }\n  shouldQueryRelays() {\n    return this.opts?.cacheUsage !== \"ONLY_CACHE\" /* ONLY_CACHE */;\n  }\n  shouldWaitForCache() {\n    return (\n      // Must want to close on EOSE; subscriptions\n      // that want to receive further updates must\n      // always hit the relay\n      this.opts.closeOnEose && // Cache adapter must claim to be fast\n      !!this.ndk.cacheAdapter?.locking && // If explicitly told to run in parallel, then\n      // we should not wait for the cache\n      this.opts.cacheUsage !== \"PARALLEL\" /* PARALLEL */\n    );\n  }\n  /**\n   * Start the subscription. This is the main method that should be called\n   * after creating a subscription.\n   */\n  async start() {\n    let cachePromise;\n    if (this.shouldQueryCache()) {\n      cachePromise = this.startWithCache();\n      if (this.shouldWaitForCache()) {\n        await cachePromise;\n        if (queryFullyFilled(this)) {\n          this.emit(\"eose\", this);\n          return;\n        }\n      }\n    }\n    if (this.shouldQueryRelays()) {\n      this.startWithRelays();\n    } else {\n      this.emit(\"eose\", this);\n    }\n    return;\n  }\n  stop() {\n    this.emit(\"close\", this);\n    this.removeAllListeners();\n  }\n  /**\n   * @returns Whether the subscription has an authors filter.\n   */\n  hasAuthorsFilter() {\n    return this.filters.some((f) => f.authors?.length);\n  }\n  async startWithCache() {\n    if (this.ndk.cacheAdapter?.query) {\n      const promise = this.ndk.cacheAdapter.query(this);\n      if (this.ndk.cacheAdapter.locking) {\n        await promise;\n      }\n    }\n  }\n  /**\n   * Send REQ to relays\n   */\n  startWithRelays() {\n    if (!this.relaySet) {\n      this.relayFilters = calculateRelaySetsFromFilters(this.ndk, this.filters, this.pool);\n    } else {\n      this.relayFilters = /* @__PURE__ */ new Map();\n      for (const relay of this.relaySet.relays) {\n        this.relayFilters.set(relay.url, this.filters);\n      }\n    }\n    if (!this.relayFilters || this.relayFilters.size === 0) {\n      this.debug(`No relays to subscribe to`, this.pool.relays.size);\n      return;\n    }\n    for (const [relayUrl, filters] of this.relayFilters) {\n      const relay = this.pool.getRelay(relayUrl);\n      relay.subscribe(this, filters);\n    }\n  }\n  // EVENT handling\n  /**\n   * Called when an event is received from a relay or the cache\n   * @param event\n   * @param relay\n   * @param fromCache Whether the event was received from the cache\n   */\n  eventReceived(event, relay, fromCache = false) {\n    if (relay) {\n      event.relay ??= relay;\n      event.onRelays.push(relay);\n    }\n    if (!relay)\n      relay = event.relay;\n    if (!this.skipValidation) {\n      if (!event.isValid) {\n        this.debug(`Event failed validation`, event);\n        return;\n      }\n    }\n    if (!this.skipVerification) {\n      if (!event.verifySignature(true)) {\n        this.debug(`Event failed signature validation`, event);\n        return;\n      }\n    }\n    if (!fromCache && relay) {\n      let events = this.eventsPerRelay.get(relay);\n      if (!events) {\n        events = /* @__PURE__ */ new Set();\n        this.eventsPerRelay.set(relay, events);\n      }\n      events.add(event.id);\n      const eventAlreadySeen = this.eventFirstSeen.has(event.id);\n      if (eventAlreadySeen) {\n        const timeSinceFirstSeen = Date.now() - (this.eventFirstSeen.get(event.id) || 0);\n        relay.scoreSlowerEvent(timeSinceFirstSeen);\n        this.emit(\"event:dup\", event, relay, timeSinceFirstSeen, this);\n        return;\n      }\n      if (this.ndk.cacheAdapter) {\n        this.ndk.cacheAdapter.setEvent(event, this.filters, relay);\n      }\n      this.eventFirstSeen.set(event.id, Date.now());\n    } else {\n      this.eventFirstSeen.set(event.id, 0);\n    }\n    if (!event.ndk)\n      event.ndk = this.ndk;\n    this.emit(\"event\", event, relay, this);\n    this.lastEventReceivedAt = Date.now();\n  }\n  // EOSE handling\n  eoseTimeout;\n  eoseReceived(relay) {\n    this.eosesSeen.add(relay);\n    let lastEventSeen = this.lastEventReceivedAt ? Date.now() - this.lastEventReceivedAt : void 0;\n    const hasSeenAllEoses = this.eosesSeen.size === this.relayFilters?.size;\n    const queryFilled = queryFullyFilled(this);\n    if (queryFilled) {\n      this.emit(\"eose\");\n      this.eoseDebug(`Query fully filled`);\n      if (this.opts?.closeOnEose) {\n        this.stop();\n      } else {\n      }\n    } else if (hasSeenAllEoses) {\n      this.emit(\"eose\");\n      this.eoseDebug(`All EOSEs seen`);\n      if (this.opts?.closeOnEose) {\n        this.stop();\n      } else {\n      }\n    } else {\n      let timeToWaitForNextEose = 1e3;\n      const percentageOfRelaysThatHaveSentEose = this.eosesSeen.size / this.relayFilters.size;\n      if (this.eosesSeen.size >= 2 && percentageOfRelaysThatHaveSentEose >= 0.5) {\n        timeToWaitForNextEose = timeToWaitForNextEose * (1 - percentageOfRelaysThatHaveSentEose);\n        if (this.eoseTimeout) {\n          clearTimeout(this.eoseTimeout);\n        }\n        const sendEoseTimeout = () => {\n          lastEventSeen = this.lastEventReceivedAt ? Date.now() - this.lastEventReceivedAt : void 0;\n          if (lastEventSeen !== void 0 && lastEventSeen < 20) {\n            this.eoseTimeout = setTimeout(sendEoseTimeout, timeToWaitForNextEose);\n          } else {\n            this.emit(\"eose\");\n            if (this.opts?.closeOnEose)\n              this.stop();\n          }\n        };\n        this.eoseTimeout = setTimeout(sendEoseTimeout, timeToWaitForNextEose);\n      }\n    }\n  }\n};\n\n// src/user/follows.ts\nasync function follows(opts, outbox, kind = 3 /* Contacts */) {\n  if (!this.ndk)\n    throw new Error(\"NDK not set\");\n  const contactListEvent = await this.ndk.fetchEvent(\n    { kinds: [kind], authors: [this.pubkey] },\n    opts || { groupable: false }\n  );\n  if (contactListEvent) {\n    const pubkeys = /* @__PURE__ */ new Set();\n    contactListEvent.tags.forEach((tag) => {\n      if (tag[0] === \"p\")\n        pubkeys.add(tag[1]);\n    });\n    if (outbox) {\n      this.ndk?.outboxTracker?.trackUsers(Array.from(pubkeys));\n    }\n    return [...pubkeys].reduce((acc, pubkey) => {\n      const user = new NDKUser({ pubkey });\n      user.ndk = this.ndk;\n      acc.add(user);\n      return acc;\n    }, /* @__PURE__ */ new Set());\n  }\n  return /* @__PURE__ */ new Set();\n}\n\n// src/user/profile.ts\nfunction profileFromEvent(event) {\n  const profile = {};\n  let payload;\n  try {\n    payload = JSON.parse(event.content);\n  } catch (error) {\n    throw new Error(`Failed to parse profile event: ${error}`);\n  }\n  Object.keys(payload).forEach((key) => {\n    switch (key) {\n      case \"name\":\n        profile.name = payload.name;\n        break;\n      case \"display_name\":\n        profile.displayName = payload.display_name;\n        break;\n      case \"image\":\n      case \"picture\":\n        profile.image = payload.picture || payload.image;\n        break;\n      case \"banner\":\n        profile.banner = payload.banner;\n        break;\n      case \"bio\":\n        profile.bio = payload.bio;\n        break;\n      case \"nip05\":\n        profile.nip05 = payload.nip05;\n        break;\n      case \"lud06\":\n        profile.lud06 = payload.lud06;\n        break;\n      case \"lud16\":\n        profile.lud16 = payload.lud16;\n        break;\n      case \"about\":\n        profile.about = payload.about;\n        break;\n      case \"zapService\":\n        profile.zapService = payload.zapService;\n        break;\n      case \"website\":\n        profile.website = payload.website;\n        break;\n      default:\n        profile[key] = payload[key];\n        break;\n    }\n  });\n  return profile;\n}\nfunction serializeProfile(profile) {\n  const payload = {};\n  for (const [key, val] of Object.entries(profile)) {\n    switch (key) {\n      case \"username\":\n      case \"name\":\n        payload.name = val;\n        break;\n      case \"displayName\":\n        payload.display_name = val;\n        break;\n      case \"image\":\n      case \"picture\":\n        payload.picture = val;\n        break;\n      case \"bio\":\n      case \"about\":\n        payload.about = val;\n        break;\n      default:\n        payload[key] = val;\n        break;\n    }\n  }\n  return JSON.stringify(payload);\n}\n\n// src/user/nip05.ts\nvar NIP05_REGEX = /^(?:([\\w.+-]+)@)?([\\w.-]+)$/;\nasync function getNip05For(ndk, fullname, _fetch = fetch, fetchOpts = {}) {\n  return await ndk.queuesNip05.add({\n    id: fullname,\n    func: async () => {\n      if (ndk.cacheAdapter && ndk.cacheAdapter.loadNip05) {\n        const profile = await ndk.cacheAdapter.loadNip05(fullname);\n        if (profile !== \"missing\") {\n          if (profile) {\n            const user = new NDKUser({\n              pubkey: profile.pubkey,\n              relayUrls: profile.relays,\n              nip46Urls: profile.nip46\n            });\n            user.ndk = ndk;\n            return user;\n          } else {\n            return null;\n          }\n        }\n      }\n      const match = fullname.match(NIP05_REGEX);\n      if (!match)\n        return null;\n      const [_, name = \"_\", domain] = match;\n      try {\n        const res = await _fetch(\n          `https://${domain}/.well-known/nostr.json?name=${name}`,\n          fetchOpts\n        );\n        const { names, relays, nip46 } = parseNIP05Result(await res.json());\n        const pubkey = names[name.toLowerCase()];\n        let profile = null;\n        if (pubkey) {\n          profile = { pubkey, relays: relays?.[pubkey], nip46: nip46?.[pubkey] };\n        }\n        if (ndk?.cacheAdapter && ndk.cacheAdapter.saveNip05) {\n          ndk.cacheAdapter.saveNip05(fullname, profile);\n        }\n        return profile;\n      } catch (_e) {\n        if (ndk?.cacheAdapter && ndk.cacheAdapter.saveNip05) {\n          ndk?.cacheAdapter.saveNip05(fullname, null);\n        }\n        console.error(\"Failed to fetch NIP05 for\", fullname, _e);\n        return null;\n      }\n    }\n  });\n}\nfunction parseNIP05Result(json) {\n  const result = {\n    names: {}\n  };\n  for (const [name, pubkey] of Object.entries(json.names)) {\n    if (typeof name === \"string\" && typeof pubkey === \"string\") {\n      result.names[name.toLowerCase()] = pubkey;\n    }\n  }\n  if (json.relays) {\n    result.relays = {};\n    for (const [pubkey, relays] of Object.entries(json.relays)) {\n      if (typeof pubkey === \"string\" && Array.isArray(relays)) {\n        result.relays[pubkey] = relays.filter(\n          (relay) => typeof relay === \"string\"\n        );\n      }\n    }\n  }\n  if (json.nip46) {\n    result.nip46 = {};\n    for (const [pubkey, nip46] of Object.entries(json.nip46)) {\n      if (typeof pubkey === \"string\" && Array.isArray(nip46)) {\n        result.nip46[pubkey] = nip46.filter((relay) => typeof relay === \"string\");\n      }\n    }\n  }\n  return result;\n}\n\n// src/user/index.ts\nvar NDKUser = class _NDKUser {\n  ndk;\n  profile;\n  _npub;\n  _pubkey;\n  relayUrls = [];\n  nip46Urls = [];\n  constructor(opts) {\n    if (opts.npub)\n      this._npub = opts.npub;\n    if (opts.hexpubkey)\n      this._pubkey = opts.hexpubkey;\n    if (opts.pubkey)\n      this._pubkey = opts.pubkey;\n    if (opts.relayUrls)\n      this.relayUrls = opts.relayUrls;\n    if (opts.nip46Urls)\n      this.nip46Urls = opts.nip46Urls;\n  }\n  get npub() {\n    if (!this._npub) {\n      if (!this._pubkey)\n        throw new Error(\"hexpubkey not set\");\n      this._npub = nip194.npubEncode(this.pubkey);\n    }\n    return this._npub;\n  }\n  set npub(npub) {\n    this._npub = npub;\n  }\n  /**\n   * Get the user's hexpubkey\n   * @returns {Hexpubkey} The user's hexpubkey\n   *\n   * @deprecated Use `pubkey` instead\n   */\n  get hexpubkey() {\n    return this.pubkey;\n  }\n  /**\n   * Set the user's hexpubkey\n   * @param pubkey {Hexpubkey} The user's hexpubkey\n   * @deprecated Use `pubkey` instead\n   */\n  set hexpubkey(pubkey) {\n    this._pubkey = pubkey;\n  }\n  /**\n   * Get the user's pubkey\n   * @returns {string} The user's pubkey\n   */\n  get pubkey() {\n    if (!this._pubkey) {\n      if (!this._npub)\n        throw new Error(\"npub not set\");\n      this._pubkey = nip194.decode(this.npub).data;\n    }\n    return this._pubkey;\n  }\n  /**\n   * Set the user's pubkey\n   * @param pubkey {string} The user's pubkey\n   */\n  set pubkey(pubkey) {\n    this._pubkey = pubkey;\n  }\n  /**\n   * Retrieves the zapper this pubkey has designated as an issuer of zap receipts\n   */\n  async getZapConfiguration(ndk) {\n    ndk ??= this.ndk;\n    if (!ndk)\n      throw new Error(\"No NDK instance found\");\n    const process = async () => {\n      if (this.ndk?.cacheAdapter?.loadUsersLNURLDoc) {\n        const doc = await this.ndk.cacheAdapter.loadUsersLNURLDoc(this.pubkey);\n        if (doc !== \"missing\") {\n          if (doc === null)\n            return;\n          if (doc)\n            return doc;\n        }\n      }\n      const zap = new NDKZap({ ndk, zappedUser: this });\n      const lnurlspec = await zap.getZapSpecWithoutCache();\n      if (this.ndk?.cacheAdapter?.saveUsersLNURLDoc) {\n        this.ndk.cacheAdapter.saveUsersLNURLDoc(this.pubkey, lnurlspec || null);\n      }\n      if (!lnurlspec)\n        return;\n      return lnurlspec;\n    };\n    return await ndk.queuesZapConfig.add({\n      id: this.pubkey,\n      func: process\n    });\n  }\n  /**\n   * Fetches the zapper's pubkey for the zapped user\n   * @returns The zapper's pubkey if one can be found\n   */\n  async getZapperPubkey() {\n    const zapConfig = await this.getZapConfiguration();\n    return zapConfig?.nostrPubkey;\n  }\n  /**\n   * Instantiate an NDKUser from a NIP-05 string\n   * @param nip05Id {string} The user's NIP-05\n   * @param ndk {NDK} An NDK instance\n   * @param skipCache {boolean} Whether to skip the cache or not\n   * @returns {NDKUser | undefined} An NDKUser if one is found for the given NIP-05, undefined otherwise.\n   */\n  static async fromNip05(nip05Id, ndk, skipCache = false) {\n    if (!ndk)\n      throw new Error(\"No NDK instance found\");\n    let opts = {};\n    if (skipCache)\n      opts.cache = \"no-cache\";\n    const profile = await getNip05For(ndk, nip05Id, ndk?.httpFetch, opts);\n    if (profile) {\n      const user = new _NDKUser({\n        pubkey: profile.pubkey,\n        relayUrls: profile.relays,\n        nip46Urls: profile.nip46\n      });\n      user.ndk = ndk;\n      return user;\n    }\n  }\n  /**\n   * Fetch a user's profile\n   * @param opts {NDKSubscriptionOptions} A set of NDKSubscriptionOptions\n   * @returns User Profile\n   */\n  async fetchProfile(opts) {\n    if (!this.ndk)\n      throw new Error(\"NDK not set\");\n    if (!this.profile)\n      this.profile = {};\n    let setMetadataEvents = null;\n    if (this.ndk.cacheAdapter && this.ndk.cacheAdapter.fetchProfile && opts?.cacheUsage !== \"ONLY_RELAY\" /* ONLY_RELAY */) {\n      const profile = await this.ndk.cacheAdapter.fetchProfile(this.pubkey);\n      if (profile) {\n        this.profile = profile;\n        return profile;\n      }\n    }\n    if (!opts && // if no options have been set\n    this.ndk.cacheAdapter && // and we have a cache\n    this.ndk.cacheAdapter.locking) {\n      setMetadataEvents = await this.ndk.fetchEvents(\n        {\n          kinds: [0],\n          authors: [this.pubkey]\n        },\n        {\n          cacheUsage: \"ONLY_CACHE\" /* ONLY_CACHE */,\n          closeOnEose: true,\n          groupable: false\n        }\n      );\n      opts = {\n        cacheUsage: \"ONLY_RELAY\" /* ONLY_RELAY */,\n        closeOnEose: true,\n        groupable: true,\n        groupableDelay: 250\n      };\n    }\n    if (!setMetadataEvents || setMetadataEvents.size === 0) {\n      setMetadataEvents = await this.ndk.fetchEvents(\n        {\n          kinds: [0],\n          authors: [this.pubkey]\n        },\n        opts\n      );\n    }\n    const sortedSetMetadataEvents = Array.from(setMetadataEvents).sort(\n      (a, b) => a.created_at - b.created_at\n    );\n    if (sortedSetMetadataEvents.length === 0)\n      return null;\n    this.profile = profileFromEvent(sortedSetMetadataEvents[0]);\n    if (this.profile && this.ndk.cacheAdapter && this.ndk.cacheAdapter.saveProfile) {\n      this.ndk.cacheAdapter.saveProfile(this.pubkey, this.profile);\n    }\n    return this.profile;\n  }\n  /**\n   * Returns a set of users that this user follows.\n   */\n  follows = follows.bind(this);\n  /** @deprecated Use referenceTags instead. */\n  /**\n   * Get the tag that can be used to reference this user in an event\n   * @returns {NDKTag} an NDKTag\n   */\n  tagReference() {\n    return [\"p\", this.pubkey];\n  }\n  /**\n   * Get the tags that can be used to reference this user in an event\n   * @returns {NDKTag[]} an array of NDKTag\n   */\n  referenceTags(marker) {\n    const tag = [[\"p\", this.pubkey]];\n    if (!marker)\n      return tag;\n    tag[0].push(\"\", marker);\n    return tag;\n  }\n  /**\n   * Publishes the current profile.\n   */\n  async publish() {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    if (!this.profile)\n      throw new Error(\"No profile available\");\n    this.ndk.assertSigner();\n    const event = new NDKEvent(this.ndk, {\n      kind: 0,\n      content: serializeProfile(this.profile)\n    });\n    await event.publish();\n  }\n  /**\n   * Add a follow to this user's contact list\n   *\n   * @param newFollow {NDKUser} The user to follow\n   * @param currentFollowList {Set<NDKUser>} The current follow list\n   * @param kind {NDKKind} The kind to use for this contact list (defaults to `3`)\n   * @returns {Promise<boolean>} True if the follow was added, false if the follow already exists\n   */\n  async follow(newFollow, currentFollowList, kind = 3 /* Contacts */) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    if (!currentFollowList) {\n      currentFollowList = await this.follows(void 0, void 0, kind);\n    }\n    if (currentFollowList.has(newFollow)) {\n      return false;\n    }\n    currentFollowList.add(newFollow);\n    const event = new NDKEvent(this.ndk, { kind });\n    for (const follow of currentFollowList) {\n      event.tag(follow);\n    }\n    await event.publish();\n    return true;\n  }\n  /**\n   * Remove a follow from this user's contact list\n   *\n   * @param user {NDKUser} The user to unfollow\n   * @param currentFollowList {Set<NDKUser>} The current follow list\n   * @param kind {NDKKind} The kind to use for this contact list (defaults to `3`)\n   * @returns {Promise<boolean>} True if the follow was removed, false if the follow did not exist\n   */\n  async unfollow(user, currentFollowList, kind = 3 /* Contacts */) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    this.ndk.assertSigner();\n    if (!currentFollowList) {\n      currentFollowList = await this.follows(void 0, void 0, kind);\n    }\n    if (!currentFollowList.has(user)) {\n      return false;\n    }\n    currentFollowList.delete(user);\n    const event = new NDKEvent(this.ndk, { kind });\n    for (const follow of currentFollowList) {\n      event.tag(follow);\n    }\n    await event.publish();\n    return true;\n  }\n  /**\n   * Validate a user's NIP-05 identifier (usually fetched from their kind:0 profile data)\n   *\n   * @param nip05Id The NIP-05 string to validate\n   * @returns {Promise<boolean | null>} True if the NIP-05 is found and matches this user's pubkey,\n   * False if the NIP-05 is found but doesn't match this user's pubkey,\n   * null if the NIP-05 isn't found on the domain or we're unable to verify (because of network issues, etc.)\n   */\n  async validateNip05(nip05Id) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    const profilePointer = await getNip05For(this.ndk, nip05Id);\n    if (profilePointer === null)\n      return null;\n    return profilePointer.pubkey === this.pubkey;\n  }\n  /**\n   * Zap a user\n   *\n   * @param amount The amount to zap in millisatoshis\n   * @param comment A comment to add to the zap request\n   * @param extraTags Extra tags to add to the zap request\n   * @param signer The signer to use (will default to the NDK instance's signer)\n   */\n  async zap(amount, comment, extraTags, signer) {\n    if (!this.ndk)\n      throw new Error(\"No NDK instance found\");\n    if (!signer) {\n      this.ndk.assertSigner();\n    }\n    const zap = new NDKZap({\n      ndk: this.ndk,\n      zappedUser: this\n    });\n    const relays = Array.from(this.ndk.pool.relays.keys());\n    const paymentRequest = await zap.createZapRequest(\n      amount,\n      comment,\n      extraTags,\n      relays,\n      signer\n    );\n    return paymentRequest;\n  }\n};\n\n// src/events/kinds/lists/index.ts\nvar NDKList = class _NDKList extends NDKEvent {\n  _encryptedTags;\n  /**\n   * Stores the number of bytes the content was before decryption\n   * to expire the cache when the content changes.\n   */\n  encryptedTagsLength;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 30001 /* CategorizedBookmarkList */;\n  }\n  /**\n   * Wrap a NDKEvent into a NDKList\n   */\n  static from(ndkEvent) {\n    return new _NDKList(ndkEvent.ndk, ndkEvent.rawEvent());\n  }\n  /**\n   * Returns the title of the list. Falls back on fetching the name tag value.\n   */\n  get title() {\n    const titleTag = this.tagValue(\"title\") || this.tagValue(\"name\");\n    if (this.kind === 3 /* Contacts */ && !titleTag) {\n      return \"Contacts\";\n    } else if (this.kind === 1e4 /* MuteList */ && !titleTag) {\n      return \"Mute\";\n    } else if (this.kind === 10001 /* PinList */ && !titleTag) {\n      return \"Pinned Notes\";\n    } else if (this.kind === 10002 /* RelayList */ && !titleTag) {\n      return \"Relay Metadata\";\n    } else if (this.kind === 10003 /* BookmarkList */ && !titleTag) {\n      return \"Bookmarks\";\n    } else if (this.kind === 10004 /* CommunityList */ && !titleTag) {\n      return \"Communities\";\n    } else if (this.kind === 10005 /* PublicChatList */ && !titleTag) {\n      return \"Public Chats\";\n    } else if (this.kind === 10006 /* BlockRelayList */ && !titleTag) {\n      return \"Blocked Relays\";\n    } else if (this.kind === 10007 /* SearchRelayList */ && !titleTag) {\n      return \"Search Relays\";\n    } else if (this.kind === 10015 /* InterestList */ && !titleTag) {\n      return \"Interests\";\n    } else if (this.kind === 10030 /* EmojiList */ && !titleTag) {\n      return \"Emojis\";\n    } else {\n      return titleTag ?? this.tagValue(\"d\");\n    }\n  }\n  /**\n   * Sets the title of the list.\n   */\n  set title(title) {\n    this.removeTag(\"title\");\n    this.removeTag(\"name\");\n    if (title) {\n      this.tags.push([\"title\", title]);\n    } else {\n      throw new Error(\"Title cannot be empty\");\n    }\n  }\n  /**\n   * Returns the name of the list.\n   * @deprecated Please use \"title\" instead.\n   */\n  get name() {\n    const nameTag = this.tagValue(\"name\");\n    if (this.kind === 3 /* Contacts */ && !nameTag) {\n      return \"Contacts\";\n    } else if (this.kind === 1e4 /* MuteList */ && !nameTag) {\n      return \"Mute\";\n    } else if (this.kind === 10001 /* PinList */ && !nameTag) {\n      return \"Pinned Notes\";\n    } else if (this.kind === 10002 /* RelayList */ && !nameTag) {\n      return \"Relay Metadata\";\n    } else if (this.kind === 10003 /* BookmarkList */ && !nameTag) {\n      return \"Bookmarks\";\n    } else if (this.kind === 10004 /* CommunityList */ && !nameTag) {\n      return \"Communities\";\n    } else if (this.kind === 10005 /* PublicChatList */ && !nameTag) {\n      return \"Public Chats\";\n    } else if (this.kind === 10006 /* BlockRelayList */ && !nameTag) {\n      return \"Blocked Relays\";\n    } else if (this.kind === 10007 /* SearchRelayList */ && !nameTag) {\n      return \"Search Relays\";\n    } else if (this.kind === 10015 /* InterestList */ && !nameTag) {\n      return \"Interests\";\n    } else if (this.kind === 10030 /* EmojiList */ && !nameTag) {\n      return \"Emojis\";\n    } else {\n      return nameTag ?? this.tagValue(\"d\");\n    }\n  }\n  /**\n   * Sets the name of the list.\n   * @deprecated Please use \"title\" instead. This method will use the `title` tag instead.\n   */\n  set name(name) {\n    this.removeTag(\"name\");\n    if (name) {\n      this.tags.push([\"title\", name]);\n    } else {\n      throw new Error(\"Name cannot be empty\");\n    }\n  }\n  /**\n   * Returns the description of the list.\n   */\n  get description() {\n    return this.tagValue(\"description\");\n  }\n  /**\n   * Sets the description of the list.\n   */\n  set description(name) {\n    if (name) {\n      this.tags.push([\"description\", name]);\n    } else {\n      this.removeTag(\"description\");\n    }\n  }\n  isEncryptedTagsCacheValid() {\n    return !!(this._encryptedTags && this.encryptedTagsLength === this.content.length);\n  }\n  /**\n   * Returns the decrypted content of the list.\n   */\n  async encryptedTags(useCache = true) {\n    if (useCache && this.isEncryptedTagsCacheValid())\n      return this._encryptedTags;\n    if (!this.ndk)\n      throw new Error(\"NDK instance not set\");\n    if (!this.ndk.signer)\n      throw new Error(\"NDK signer not set\");\n    const user = await this.ndk.signer.user();\n    try {\n      if (this.content.length > 0) {\n        try {\n          const decryptedContent = await this.ndk.signer.decrypt(user, this.content);\n          const a = JSON.parse(decryptedContent);\n          if (a && a[0]) {\n            this.encryptedTagsLength = this.content.length;\n            return this._encryptedTags = a;\n          }\n          this.encryptedTagsLength = this.content.length;\n          return this._encryptedTags = [];\n        } catch (e) {\n          console.log(`error decrypting ${this.content}`);\n        }\n      }\n    } catch (e) {\n    }\n    return [];\n  }\n  /**\n   * This method can be overriden to validate that a tag is valid for this list.\n   *\n   * (i.e. the NDKPersonList can validate that items are NDKUser instances)\n   */\n  validateTag(tagValue) {\n    return true;\n  }\n  /**\n   * Returns the unecrypted items in this list.\n   */\n  get items() {\n    return this.tags.filter((t) => {\n      return ![\n        \"d\",\n        \"L\",\n        \"l\",\n        \"title\",\n        \"name\",\n        \"description\",\n        \"summary\",\n        \"image\",\n        \"thumb\",\n        \"alt\",\n        \"expiration\",\n        \"subject\",\n        \"client\"\n      ].includes(t[0]);\n    });\n  }\n  /**\n   * Adds a new item to the list.\n   * @param relay Relay to add\n   * @param mark Optional mark to add to the item\n   * @param encrypted Whether to encrypt the item\n   */\n  async addItem(item, mark = void 0, encrypted = false) {\n    if (!this.ndk)\n      throw new Error(\"NDK instance not set\");\n    if (!this.ndk.signer)\n      throw new Error(\"NDK signer not set\");\n    let tags;\n    if (item instanceof NDKEvent) {\n      tags = item.referenceTags();\n    } else if (item instanceof NDKUser) {\n      tags = item.referenceTags();\n    } else if (item instanceof NDKRelay) {\n      tags = item.referenceTags();\n    } else if (Array.isArray(item)) {\n      tags = [item];\n    } else {\n      throw new Error(\"Invalid object type\");\n    }\n    if (mark)\n      tags[0].push(mark);\n    if (encrypted) {\n      const user = await this.ndk.signer.user();\n      const currentList = await this.encryptedTags();\n      currentList.push(...tags);\n      this._encryptedTags = currentList;\n      this.encryptedTagsLength = this.content.length;\n      this.content = JSON.stringify(currentList);\n      await this.encrypt(user);\n    } else {\n      this.tags.push(...tags);\n    }\n    this.created_at = Math.floor(Date.now() / 1e3);\n    this.emit(\"change\");\n  }\n  /**\n   * Removes an item from the list.\n   *\n   * @param index The index of the item to remove.\n   * @param encrypted Whether to remove from the encrypted list or not.\n   */\n  async removeItem(index, encrypted) {\n    if (!this.ndk)\n      throw new Error(\"NDK instance not set\");\n    if (!this.ndk.signer)\n      throw new Error(\"NDK signer not set\");\n    if (encrypted) {\n      const user = await this.ndk.signer.user();\n      const currentList = await this.encryptedTags();\n      currentList.splice(index, 1);\n      this._encryptedTags = currentList;\n      this.encryptedTagsLength = this.content.length;\n      this.content = JSON.stringify(currentList);\n      await this.encrypt(user);\n    } else {\n      this.tags.splice(index, 1);\n    }\n    this.created_at = Math.floor(Date.now() / 1e3);\n    this.emit(\"change\");\n    return this;\n  }\n  /**\n   * Creates a filter that will result in fetching\n   * the items of this list\n   * @example\n   * const list = new NDKList(...);\n   * const filters = list.filterForItems();\n   * const events = await ndk.fetchEvents(filters);\n   */\n  filterForItems() {\n    const ids = /* @__PURE__ */ new Set();\n    const nip33Queries = /* @__PURE__ */ new Map();\n    const filters = [];\n    for (const tag of this.items) {\n      if (tag[0] === \"e\" && tag[1]) {\n        ids.add(tag[1]);\n      } else if (tag[0] === \"a\" && tag[1]) {\n        const [kind, pubkey, dTag] = tag[1].split(\":\");\n        if (!kind || !pubkey)\n          continue;\n        const key = `${kind}:${pubkey}`;\n        const item = nip33Queries.get(key) || [];\n        item.push(dTag || \"\");\n        nip33Queries.set(key, item);\n      }\n    }\n    if (ids.size > 0) {\n      filters.push({ ids: Array.from(ids) });\n    }\n    if (nip33Queries.size > 0) {\n      for (const [key, values] of nip33Queries.entries()) {\n        const [kind, pubkey] = key.split(\":\");\n        filters.push({\n          kinds: [parseInt(kind)],\n          authors: [pubkey],\n          \"#d\": values\n        });\n      }\n    }\n    return filters;\n  }\n};\nvar lists_default = NDKList;\n\n// src/user/pin.ts\nasync function pinEvent(user, event, pinEvent2, publish) {\n  const kind = 10001 /* PinList */;\n  if (!user.ndk)\n    throw new Error(\"No NDK instance found\");\n  user.ndk.assertSigner();\n  if (!pinEvent2) {\n    const events = await user.ndk.fetchEvents(\n      { kinds: [kind], authors: [user.pubkey] },\n      { cacheUsage: \"ONLY_RELAY\" /* ONLY_RELAY */ }\n    );\n    if (events.size > 0) {\n      pinEvent2 = lists_default.from(Array.from(events)[0]);\n    } else {\n      pinEvent2 = new NDKEvent(user.ndk, {\n        kind\n      });\n    }\n  }\n  pinEvent2.tag(event);\n  if (publish) {\n    await pinEvent2.publish();\n  }\n  return pinEvent2;\n}\n\n// src/events/kinds/article.ts\nvar NDKArticle = class _NDKArticle extends NDKEvent {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 30023 /* Article */;\n  }\n  /**\n   * Creates a NDKArticle from an existing NDKEvent.\n   *\n   * @param event NDKEvent to create the NDKArticle from.\n   * @returns NDKArticle\n   */\n  static from(event) {\n    return new _NDKArticle(event.ndk, event.rawEvent());\n  }\n  /**\n   * Getter for the article title.\n   *\n   * @returns {string | undefined} - The article title if available, otherwise undefined.\n   */\n  get title() {\n    return this.tagValue(\"title\");\n  }\n  /**\n   * Setter for the article title.\n   *\n   * @param {string | undefined} title - The title to set for the article.\n   */\n  set title(title) {\n    this.removeTag(\"title\");\n    if (title)\n      this.tags.push([\"title\", title]);\n  }\n  /**\n   * Getter for the article image.\n   *\n   * @returns {string | undefined} - The article image if available, otherwise undefined.\n   */\n  get image() {\n    return this.tagValue(\"image\");\n  }\n  /**\n   * Setter for the article image.\n   *\n   * @param {string | undefined} image - The image to set for the article.\n   */\n  set image(image) {\n    this.removeTag(\"image\");\n    if (image)\n      this.tags.push([\"image\", image]);\n  }\n  get summary() {\n    return this.tagValue(\"summary\");\n  }\n  set summary(summary) {\n    this.removeTag(\"summary\");\n    if (summary)\n      this.tags.push([\"summary\", summary]);\n  }\n  /**\n   * Getter for the article's publication timestamp.\n   *\n   * @returns {number | undefined} - The Unix timestamp of when the article was published or undefined.\n   */\n  get published_at() {\n    const tag = this.tagValue(\"published_at\");\n    if (tag) {\n      return parseInt(tag);\n    }\n    return void 0;\n  }\n  /**\n   * Setter for the article's publication timestamp.\n   *\n   * @param {number | undefined} timestamp - The Unix timestamp to set for the article's publication date.\n   */\n  set published_at(timestamp) {\n    this.removeTag(\"published_at\");\n    if (timestamp !== void 0) {\n      this.tags.push([\"published_at\", timestamp.toString()]);\n    }\n  }\n  /**\n   * Generates content tags for the article.\n   *\n   * This method first checks and sets the publication date if not available,\n   * and then generates content tags based on the base NDKEvent class.\n   *\n   * @returns {ContentTag} - The generated content tags.\n   */\n  async generateTags() {\n    super.generateTags();\n    if (!this.published_at) {\n      this.published_at = this.created_at;\n    }\n    return super.generateTags();\n  }\n  /**\n   * Getter for the article's URL.\n   *\n   * @returns {string | undefined} - The article's URL if available, otherwise undefined.\n   */\n  get url() {\n    return this.tagValue(\"url\");\n  }\n  /**\n   * Setter for the article's URL.\n   *\n   * @param {string | undefined} url - The URL to set for the article.\n   */\n  set url(url) {\n    if (url) {\n      this.tags.push([\"url\", url]);\n    } else {\n      this.removeTag(\"url\");\n    }\n  }\n};\n\n// src/events/kinds/classified.ts\nvar NDKClassified = class _NDKClassified extends NDKEvent {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 30402 /* Classified */;\n  }\n  /**\n   * Creates a NDKClassified from an existing NDKEvent.\n   *\n   * @param event NDKEvent to create the NDKClassified from.\n   * @returns NDKClassified\n   */\n  static from(event) {\n    return new _NDKClassified(event.ndk, event.rawEvent());\n  }\n  /**\n   * Getter for the classified title.\n   *\n   * @returns {string | undefined} - The classified title if available, otherwise undefined.\n   */\n  get title() {\n    return this.tagValue(\"title\");\n  }\n  /**\n   * Setter for the classified title.\n   *\n   * @param {string | undefined} title - The title to set for the classified.\n   */\n  set title(title) {\n    this.removeTag(\"title\");\n    if (title)\n      this.tags.push([\"title\", title]);\n  }\n  /**\n   * Getter for the classified summary.\n   *\n   * @returns {string | undefined} - The classified summary if available, otherwise undefined.\n   */\n  get summary() {\n    return this.tagValue(\"summary\");\n  }\n  /**\n   * Setter for the classified summary.\n   *\n   * @param {string | undefined} summary - The summary to set for the classified.\n   */\n  set summary(summary) {\n    this.removeTag(\"summary\");\n    if (summary)\n      this.tags.push([\"summary\", summary]);\n  }\n  /**\n   * Getter for the classified's publication timestamp.\n   *\n   * @returns {number | undefined} - The Unix timestamp of when the classified was published or undefined.\n   */\n  get published_at() {\n    const tag = this.tagValue(\"published_at\");\n    if (tag) {\n      return parseInt(tag);\n    }\n    return void 0;\n  }\n  /**\n   * Setter for the classified's publication timestamp.\n   *\n   * @param {number | undefined} timestamp - The Unix timestamp to set for the classified's publication date.\n   */\n  set published_at(timestamp) {\n    this.removeTag(\"published_at\");\n    if (timestamp !== void 0) {\n      this.tags.push([\"published_at\", timestamp.toString()]);\n    }\n  }\n  /**\n   * Getter for the classified location.\n   *\n   * @returns {string | undefined} - The classified location if available, otherwise undefined.\n   */\n  get location() {\n    return this.tagValue(\"location\");\n  }\n  /**\n   * Setter for the classified location.\n   *\n   * @param {string | undefined} location - The location to set for the classified.\n   */\n  set location(location) {\n    this.removeTag(\"location\");\n    if (location)\n      this.tags.push([\"location\", location]);\n  }\n  /**\n   * Getter for the classified price.\n   *\n   * @returns {NDKClassifiedPriceTag | undefined} - The classified price if available, otherwise undefined.\n   */\n  get price() {\n    const priceTag = this.tags.find((tag) => tag[0] === \"price\");\n    if (priceTag) {\n      return {\n        amount: parseFloat(priceTag[1]),\n        currency: priceTag[2],\n        frequency: priceTag[3]\n      };\n    } else {\n      return void 0;\n    }\n  }\n  /**\n   * Setter for the classified price.\n   *\n   * @param price - The price to set for the classified.\n   */\n  set price(priceTag) {\n    if (typeof priceTag === \"string\") {\n      priceTag = {\n        amount: parseFloat(priceTag)\n      };\n    }\n    if (priceTag?.amount) {\n      const tag = [\"price\", priceTag.amount.toString()];\n      if (priceTag.currency)\n        tag.push(priceTag.currency);\n      if (priceTag.frequency)\n        tag.push(priceTag.frequency);\n      this.tags.push(tag);\n    } else {\n      this.removeTag(\"price\");\n    }\n  }\n  /**\n   * Generates content tags for the classified.\n   *\n   * This method first checks and sets the publication date if not available,\n   * and then generates content tags based on the base NDKEvent class.\n   *\n   * @returns {ContentTag} - The generated content tags.\n   */\n  async generateTags() {\n    super.generateTags();\n    if (!this.published_at) {\n      this.published_at = this.created_at;\n    }\n    return super.generateTags();\n  }\n};\n\n// src/events/kinds/video.ts\nvar NDKVideo = class _NDKVideo extends NDKEvent {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 34235 /* HorizontalVideo */;\n  }\n  /**\n   * Creates a NDKArticle from an existing NDKEvent.\n   *\n   * @param event NDKEvent to create the NDKArticle from.\n   * @returns NDKArticle\n   */\n  static from(event) {\n    return new _NDKVideo(event.ndk, event.rawEvent());\n  }\n  /**\n   * Getter for the article title.\n   *\n   * @returns {string | undefined} - The article title if available, otherwise undefined.\n   */\n  get title() {\n    return this.tagValue(\"title\");\n  }\n  /**\n   * Setter for the article title.\n   *\n   * @param {string | undefined} title - The title to set for the article.\n   */\n  set title(title) {\n    this.removeTag(\"title\");\n    if (title)\n      this.tags.push([\"title\", title]);\n  }\n  /**\n   * Getter for the article thumbnail.\n   *\n   * @returns {string | undefined} - The article thumbnail if available, otherwise undefined.\n   */\n  get thumbnail() {\n    return this.tagValue(\"thumb\");\n  }\n  /**\n   * Setter for the article thumbnail.\n   *\n   * @param {string | undefined} thumbnail - The thumbnail to set for the article.\n   */\n  set thumbnail(thumbnail) {\n    this.removeTag(\"thumb\");\n    if (thumbnail)\n      this.tags.push([\"thumb\", thumbnail]);\n  }\n  get url() {\n    return this.tagValue(\"url\");\n  }\n  set url(url) {\n    this.removeTag(\"url\");\n    if (url)\n      this.tags.push([\"url\", url]);\n  }\n  /**\n   * Getter for the article's publication timestamp.\n   *\n   * @returns {number | undefined} - The Unix timestamp of when the article was published or undefined.\n   */\n  get published_at() {\n    const tag = this.tagValue(\"published_at\");\n    if (tag) {\n      return parseInt(tag);\n    }\n    return void 0;\n  }\n  /**\n   * Setter for the article's publication timestamp.\n   *\n   * @param {number | undefined} timestamp - The Unix timestamp to set for the article's publication date.\n   */\n  set published_at(timestamp) {\n    this.removeTag(\"published_at\");\n    if (timestamp !== void 0) {\n      this.tags.push([\"published_at\", timestamp.toString()]);\n    }\n  }\n  /**\n   * Generates content tags for the article.\n   *\n   * This method first checks and sets the publication date if not available,\n   * and then generates content tags based on the base NDKEvent class.\n   *\n   * @returns {ContentTag} - The generated content tags.\n   */\n  async generateTags() {\n    super.generateTags();\n    if (!this.published_at) {\n      this.published_at = this.created_at;\n    }\n    return super.generateTags();\n  }\n  get duration() {\n    const tag = this.tagValue(\"duration\");\n    if (tag) {\n      return parseInt(tag);\n    }\n    return void 0;\n  }\n  /**\n   * Setter for the video's duration\n   *\n   * @param {number | undefined} duration - The duration to set for the video (in seconds)\n   */\n  set duration(dur) {\n    this.removeTag(\"duration\");\n    if (dur !== void 0) {\n      this.tags.push([\"duration\", Math.floor(dur).toString()]);\n    }\n  }\n};\n\n// src/events/kinds/highlight.ts\nimport { nip19 as nip195 } from \"nostr-tools\";\nvar NDKHighlight = class _NDKHighlight extends NDKEvent {\n  _article;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 9802 /* Highlight */;\n  }\n  static from(event) {\n    return new _NDKHighlight(event.ndk, event.rawEvent());\n  }\n  get url() {\n    return this.tagValue(\"r\");\n  }\n  /**\n   * Context tag.\n   */\n  set context(context) {\n    if (context === void 0) {\n      this.tags = this.tags.filter(([tag, value]) => tag !== \"context\");\n    } else {\n      this.tags = this.tags.filter(([tag, value]) => tag !== \"context\");\n      this.tags.push([\"context\", context]);\n    }\n  }\n  get context() {\n    return this.tags.find(([tag, value]) => tag === \"context\")?.[1] ?? void 0;\n  }\n  /**\n   * Will return the article URL or NDKEvent if they have already been\n   * set (it won't attempt to load remote events)\n   */\n  get article() {\n    return this._article;\n  }\n  /**\n   * Article the highlight is coming from.\n   *\n   * @param article Article URL or NDKEvent.\n   */\n  set article(article) {\n    this._article = article;\n    if (typeof article === \"string\") {\n      this.tags.push([\"r\", article]);\n    } else {\n      this.tag(article);\n    }\n  }\n  getArticleTag() {\n    return this.getMatchingTags(\"a\")[0] || this.getMatchingTags(\"e\")[0] || this.getMatchingTags(\"r\")[0];\n  }\n  async getArticle() {\n    if (this._article !== void 0)\n      return this._article;\n    let taggedBech32;\n    const articleTag = this.getArticleTag();\n    if (!articleTag)\n      return void 0;\n    switch (articleTag[0]) {\n      case \"a\":\n        const [kind, pubkey, identifier] = articleTag[1].split(\":\");\n        taggedBech32 = nip195.naddrEncode({ kind: parseInt(kind), pubkey, identifier });\n        break;\n      case \"e\":\n        taggedBech32 = nip195.noteEncode(articleTag[1]);\n        break;\n      case \"r\":\n        this._article = articleTag[1];\n        break;\n    }\n    if (taggedBech32) {\n      let a = await this.ndk?.fetchEvent(taggedBech32);\n      if (a) {\n        if (a.kind === 30023 /* Article */) {\n          a = NDKArticle.from(a);\n        }\n        this._article = a;\n      }\n    }\n    return this._article;\n  }\n};\n\n// ../node_modules/.pnpm/normalize-url@8.0.1/node_modules/normalize-url/index.js\nvar DATA_URL_DEFAULT_MIME_TYPE = \"text/plain\";\nvar DATA_URL_DEFAULT_CHARSET = \"us-ascii\";\nvar testParameter = (name, filters) => filters.some((filter) => filter instanceof RegExp ? filter.test(name) : filter === name);\nvar supportedProtocols = /* @__PURE__ */ new Set([\n  \"https:\",\n  \"http:\",\n  \"file:\"\n]);\nvar hasCustomProtocol = (urlString) => {\n  try {\n    const { protocol } = new URL(urlString);\n    return protocol.endsWith(\":\") && !protocol.includes(\".\") && !supportedProtocols.has(protocol);\n  } catch {\n    return false;\n  }\n};\nvar normalizeDataURL = (urlString, { stripHash }) => {\n  const match = /^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(urlString);\n  if (!match) {\n    throw new Error(`Invalid URL: ${urlString}`);\n  }\n  let { type, data, hash } = match.groups;\n  const mediaType = type.split(\";\");\n  hash = stripHash ? \"\" : hash;\n  let isBase64 = false;\n  if (mediaType[mediaType.length - 1] === \"base64\") {\n    mediaType.pop();\n    isBase64 = true;\n  }\n  const mimeType = mediaType.shift()?.toLowerCase() ?? \"\";\n  const attributes = mediaType.map((attribute) => {\n    let [key, value = \"\"] = attribute.split(\"=\").map((string) => string.trim());\n    if (key === \"charset\") {\n      value = value.toLowerCase();\n      if (value === DATA_URL_DEFAULT_CHARSET) {\n        return \"\";\n      }\n    }\n    return `${key}${value ? `=${value}` : \"\"}`;\n  }).filter(Boolean);\n  const normalizedMediaType = [\n    ...attributes\n  ];\n  if (isBase64) {\n    normalizedMediaType.push(\"base64\");\n  }\n  if (normalizedMediaType.length > 0 || mimeType && mimeType !== DATA_URL_DEFAULT_MIME_TYPE) {\n    normalizedMediaType.unshift(mimeType);\n  }\n  return `data:${normalizedMediaType.join(\";\")},${isBase64 ? data.trim() : data}${hash ? `#${hash}` : \"\"}`;\n};\nfunction normalizeUrl(urlString, options) {\n  options = {\n    defaultProtocol: \"http\",\n    normalizeProtocol: true,\n    forceHttp: false,\n    forceHttps: false,\n    stripAuthentication: true,\n    stripHash: false,\n    stripTextFragment: true,\n    stripWWW: true,\n    removeQueryParameters: [/^utm_\\w+/i],\n    removeTrailingSlash: true,\n    removeSingleSlash: true,\n    removeDirectoryIndex: false,\n    removeExplicitPort: false,\n    sortQueryParameters: true,\n    ...options\n  };\n  if (typeof options.defaultProtocol === \"string\" && !options.defaultProtocol.endsWith(\":\")) {\n    options.defaultProtocol = `${options.defaultProtocol}:`;\n  }\n  urlString = urlString.trim();\n  if (/^data:/i.test(urlString)) {\n    return normalizeDataURL(urlString, options);\n  }\n  if (hasCustomProtocol(urlString)) {\n    return urlString;\n  }\n  const hasRelativeProtocol = urlString.startsWith(\"//\");\n  const isRelativeUrl = !hasRelativeProtocol && /^\\.*\\//.test(urlString);\n  if (!isRelativeUrl) {\n    urlString = urlString.replace(/^(?!(?:\\w+:)?\\/\\/)|^\\/\\//, options.defaultProtocol);\n  }\n  const urlObject = new URL(urlString);\n  if (options.forceHttp && options.forceHttps) {\n    throw new Error(\"The `forceHttp` and `forceHttps` options cannot be used together\");\n  }\n  if (options.forceHttp && urlObject.protocol === \"https:\") {\n    urlObject.protocol = \"http:\";\n  }\n  if (options.forceHttps && urlObject.protocol === \"http:\") {\n    urlObject.protocol = \"https:\";\n  }\n  if (options.stripAuthentication) {\n    urlObject.username = \"\";\n    urlObject.password = \"\";\n  }\n  if (options.stripHash) {\n    urlObject.hash = \"\";\n  } else if (options.stripTextFragment) {\n    urlObject.hash = urlObject.hash.replace(/#?:~:text.*?$/i, \"\");\n  }\n  if (urlObject.pathname) {\n    const protocolRegex = /\\b[a-z][a-z\\d+\\-.]{1,50}:\\/\\//g;\n    let lastIndex = 0;\n    let result = \"\";\n    for (; ; ) {\n      const match = protocolRegex.exec(urlObject.pathname);\n      if (!match) {\n        break;\n      }\n      const protocol = match[0];\n      const protocolAtIndex = match.index;\n      const intermediate = urlObject.pathname.slice(lastIndex, protocolAtIndex);\n      result += intermediate.replace(/\\/{2,}/g, \"/\");\n      result += protocol;\n      lastIndex = protocolAtIndex + protocol.length;\n    }\n    const remnant = urlObject.pathname.slice(lastIndex, urlObject.pathname.length);\n    result += remnant.replace(/\\/{2,}/g, \"/\");\n    urlObject.pathname = result;\n  }\n  if (urlObject.pathname) {\n    try {\n      urlObject.pathname = decodeURI(urlObject.pathname);\n    } catch {\n    }\n  }\n  if (options.removeDirectoryIndex === true) {\n    options.removeDirectoryIndex = [/^index\\.[a-z]+$/];\n  }\n  if (Array.isArray(options.removeDirectoryIndex) && options.removeDirectoryIndex.length > 0) {\n    let pathComponents = urlObject.pathname.split(\"/\");\n    const lastComponent = pathComponents[pathComponents.length - 1];\n    if (testParameter(lastComponent, options.removeDirectoryIndex)) {\n      pathComponents = pathComponents.slice(0, -1);\n      urlObject.pathname = pathComponents.slice(1).join(\"/\") + \"/\";\n    }\n  }\n  if (urlObject.hostname) {\n    urlObject.hostname = urlObject.hostname.replace(/\\.$/, \"\");\n    if (options.stripWWW && /^www\\.(?!www\\.)[a-z\\-\\d]{1,63}\\.[a-z.\\-\\d]{2,63}$/.test(urlObject.hostname)) {\n      urlObject.hostname = urlObject.hostname.replace(/^www\\./, \"\");\n    }\n  }\n  if (Array.isArray(options.removeQueryParameters)) {\n    for (const key of [...urlObject.searchParams.keys()]) {\n      if (testParameter(key, options.removeQueryParameters)) {\n        urlObject.searchParams.delete(key);\n      }\n    }\n  }\n  if (!Array.isArray(options.keepQueryParameters) && options.removeQueryParameters === true) {\n    urlObject.search = \"\";\n  }\n  if (Array.isArray(options.keepQueryParameters) && options.keepQueryParameters.length > 0) {\n    for (const key of [...urlObject.searchParams.keys()]) {\n      if (!testParameter(key, options.keepQueryParameters)) {\n        urlObject.searchParams.delete(key);\n      }\n    }\n  }\n  if (options.sortQueryParameters) {\n    urlObject.searchParams.sort();\n    try {\n      urlObject.search = decodeURIComponent(urlObject.search);\n    } catch {\n    }\n  }\n  if (options.removeTrailingSlash) {\n    urlObject.pathname = urlObject.pathname.replace(/\\/$/, \"\");\n  }\n  if (options.removeExplicitPort && urlObject.port) {\n    urlObject.port = \"\";\n  }\n  const oldUrlString = urlString;\n  urlString = urlObject.toString();\n  if (!options.removeSingleSlash && urlObject.pathname === \"/\" && !oldUrlString.endsWith(\"/\") && urlObject.hash === \"\") {\n    urlString = urlString.replace(/\\/$/, \"\");\n  }\n  if ((options.removeTrailingSlash || urlObject.pathname === \"/\") && urlObject.hash === \"\" && options.removeSingleSlash) {\n    urlString = urlString.replace(/\\/$/, \"\");\n  }\n  if (hasRelativeProtocol && !options.normalizeProtocol) {\n    urlString = urlString.replace(/^http:\\/\\//, \"//\");\n  }\n  if (options.stripProtocol) {\n    urlString = urlString.replace(/^(?:https?:)?\\/\\//, \"\");\n  }\n  return urlString;\n}\n\n// src/utils/normalize-url.ts\nfunction normalizeRelayUrl(url) {\n  let r = normalizeUrl(url, {\n    stripAuthentication: false,\n    stripWWW: false,\n    stripHash: true\n  });\n  if (!r.endsWith(\"/\")) {\n    r += \"/\";\n  }\n  return r;\n}\nfunction normalize(urls) {\n  const normalized = /* @__PURE__ */ new Set();\n  for (const url of urls) {\n    try {\n      normalized.add(normalizeRelayUrl(url));\n    } catch {\n    }\n  }\n  return Array.from(normalized);\n}\n\n// src/events/kinds/NDKRelayList.ts\nvar READ_MARKER = \"read\";\nvar WRITE_MARKER = \"write\";\nvar NDKRelayList = class _NDKRelayList extends NDKEvent {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 10002 /* RelayList */;\n  }\n  static from(ndkEvent) {\n    return new _NDKRelayList(ndkEvent.ndk, ndkEvent.rawEvent());\n  }\n  static async forUser(pubkey, ndk) {\n    const result = await this.forUsers([pubkey], ndk);\n    return result.get(pubkey);\n  }\n  /**\n   * Gathers a set of relay list events for a given set of users.\n   * @returns A map of pubkeys to relay list.\n   */\n  static async forUsers(pubkeys, ndk) {\n    const pool = ndk.outboxPool || ndk.pool;\n    const set = /* @__PURE__ */ new Set();\n    for (const relay of pool.relays.values())\n      set.add(relay);\n    const relayLists = /* @__PURE__ */ new Map();\n    const fromContactList = /* @__PURE__ */ new Map();\n    const relaySet = new NDKRelaySet(set, ndk);\n    await Promise.all([\n      // Fetch all kind 10002 events\n      new Promise(async (resolve) => {\n        const lists = await ndk.fetchEvents(\n          { kinds: [10002], authors: pubkeys },\n          { closeOnEose: true, pool, groupable: false },\n          relaySet\n        );\n        for (const relayList of lists) {\n          relayLists.set(relayList.pubkey, _NDKRelayList.from(relayList));\n        }\n        resolve();\n      }),\n      // Also fetch all kind 3 events\n      new Promise(async (resolve) => {\n        const lists = await ndk.fetchEvents(\n          { kinds: [3], authors: pubkeys },\n          { closeOnEose: true, pool, groupable: false },\n          relaySet\n        );\n        for (const relayList of lists) {\n          const list = relayListFromKind3(ndk, relayList);\n          if (list)\n            fromContactList.set(relayList.pubkey, list);\n        }\n        resolve();\n      })\n    ]);\n    const result = /* @__PURE__ */ new Map();\n    for (const pubkey of pubkeys) {\n      const relayList = relayLists.get(pubkey) ?? fromContactList.get(pubkey);\n      if (relayList)\n        result.set(pubkey, relayList);\n    }\n    return result;\n  }\n  get readRelayUrls() {\n    return this.tags.filter((tag) => tag[0] === \"r\" || tag[0] === \"relay\").filter((tag) => !tag[2] || tag[2] && tag[2] === READ_MARKER).map((tag) => tag[1]);\n  }\n  set readRelayUrls(relays) {\n    for (const relay of relays) {\n      this.tags.push([\"r\", relay, READ_MARKER]);\n    }\n  }\n  get writeRelayUrls() {\n    return this.tags.filter((tag) => tag[0] === \"r\" || tag[0] === \"relay\").filter((tag) => !tag[2] || tag[2] && tag[2] === WRITE_MARKER).map((tag) => tag[1]);\n  }\n  set writeRelayUrls(relays) {\n    for (const relay of relays) {\n      this.tags.push([\"r\", relay, WRITE_MARKER]);\n    }\n  }\n  get bothRelayUrls() {\n    return this.tags.filter((tag) => tag[0] === \"r\" || tag[0] === \"relay\").filter((tag) => !tag[2]).map((tag) => tag[1]);\n  }\n  set bothRelayUrls(relays) {\n    for (const relay of relays) {\n      this.tags.push([\"r\", relay]);\n    }\n  }\n  get relays() {\n    return this.tags.filter((tag) => tag[0] === \"r\" || tag[0] === \"relay\").map((tag) => tag[1]);\n  }\n};\nfunction relayListFromKind3(ndk, contactList) {\n  try {\n    const content = JSON.parse(contactList.content);\n    const relayList = new NDKRelayList(ndk);\n    const readRelays = /* @__PURE__ */ new Set();\n    const writeRelays = /* @__PURE__ */ new Set();\n    for (let [key, config] of Object.entries(content)) {\n      try {\n        key = normalizeRelayUrl(key);\n      } catch {\n        continue;\n      }\n      if (!config) {\n        readRelays.add(key);\n        writeRelays.add(key);\n      } else {\n        const relayConfig = config;\n        if (relayConfig.write)\n          writeRelays.add(key);\n        if (relayConfig.read)\n          readRelays.add(key);\n      }\n    }\n    relayList.readRelayUrls = Array.from(readRelays);\n    relayList.writeRelayUrls = Array.from(writeRelays);\n    return relayList;\n  } catch {\n  }\n  return void 0;\n}\n\n// src/events/kinds/repost.ts\nvar NDKRepost = class _NDKRepost extends NDKEvent {\n  _repostedEvents;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n  }\n  static from(event) {\n    return new _NDKRepost(event.ndk, event.rawEvent());\n  }\n  /**\n   * Returns all reposted events by the current event.\n   *\n   * @param klass Optional class to convert the events to.\n   * @returns\n   */\n  async repostedEvents(klass, opts) {\n    const items = [];\n    if (!this.ndk)\n      throw new Error(\"NDK instance not set\");\n    if (this._repostedEvents !== void 0)\n      return this._repostedEvents;\n    for (const eventId of this.repostedEventIds()) {\n      const filter = filterForId(eventId);\n      const event = await this.ndk.fetchEvent(filter, opts);\n      if (event) {\n        items.push(klass ? klass.from(event) : event);\n      }\n    }\n    return items;\n  }\n  /**\n   * Returns the reposted event IDs.\n   */\n  repostedEventIds() {\n    return this.tags.filter((t) => t[0] === \"e\" || t[0] === \"a\").map((t) => t[1]);\n  }\n};\nfunction filterForId(id) {\n  if (id.match(/:/)) {\n    const [kind, pubkey, identifier] = id.split(\":\");\n    return {\n      kinds: [parseInt(kind)],\n      authors: [pubkey],\n      \"#d\": [identifier]\n    };\n  } else {\n    return { ids: [id] };\n  }\n}\n\n// src/events/kinds/nip89/NDKAppHandler.ts\nvar NDKAppHandlerEvent = class _NDKAppHandlerEvent extends NDKEvent {\n  profile;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 31990 /* AppHandler */;\n  }\n  static from(ndkEvent) {\n    return new _NDKAppHandlerEvent(ndkEvent.ndk, ndkEvent.rawEvent());\n  }\n  /**\n   * Fetches app handler information\n   * If no app information is available on the kind:31990,\n   * we fetch the event's author's profile and return that instead.\n   */\n  async fetchProfile() {\n    if (this.profile === void 0 && this.content.length > 0) {\n      try {\n        const profile = JSON.parse(this.content);\n        if (profile && profile.name) {\n          return profile;\n        } else {\n          this.profile = null;\n        }\n      } catch (e) {\n        this.profile = null;\n      }\n    }\n    return new Promise((resolve, reject) => {\n      const author = this.author;\n      author.fetchProfile().then(() => {\n        resolve(author.profile);\n      }).catch(reject);\n    });\n  }\n};\n\n// src/events/kinds/subscriptions/amount.ts\nvar possibleIntervalFrequencies = [\n  \"daily\",\n  \"weekly\",\n  \"monthly\",\n  \"quarterly\",\n  \"yearly\"\n];\nfunction calculateTermDurationInSeconds(term) {\n  switch (term) {\n    case \"daily\":\n      return 24 * 60 * 60;\n    case \"weekly\":\n      return 7 * 24 * 60 * 60;\n    case \"monthly\":\n      return 30 * 24 * 60 * 60;\n    case \"quarterly\":\n      return 3 * 30 * 24 * 60 * 60;\n    case \"yearly\":\n      return 365 * 24 * 60 * 60;\n  }\n}\nfunction newAmount(amount, currency, term) {\n  return [\"amount\", amount.toString(), currency, term];\n}\nfunction parseTagToSubscriptionAmount(tag) {\n  const amount = parseInt(tag[1]);\n  if (isNaN(amount) || amount === void 0 || amount === null || amount <= 0)\n    return void 0;\n  const currency = tag[2];\n  if (currency === void 0 || currency === \"\")\n    return void 0;\n  const term = tag[3];\n  if (term === void 0)\n    return void 0;\n  if (!possibleIntervalFrequencies.includes(term))\n    return void 0;\n  return {\n    amount,\n    currency,\n    term\n  };\n}\n\n// src/events/kinds/subscriptions/tier.ts\nvar NDKSubscriptionTier = class _NDKSubscriptionTier extends NDKArticle {\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 37001 /* SubscriptionTier */;\n  }\n  /**\n   * Creates a new NDKSubscriptionTier from an event\n   * @param event\n   * @returns NDKSubscriptionTier\n   */\n  static from(event) {\n    return new _NDKSubscriptionTier(event.ndk, event.rawEvent());\n  }\n  /**\n   * Returns perks for this tier\n   */\n  get perks() {\n    return this.getMatchingTags(\"perk\").map((tag) => tag[1]).filter((perk) => perk !== void 0);\n  }\n  /**\n   * Adds a perk to this tier\n   */\n  addPerk(perk) {\n    this.tags.push([\"perk\", perk]);\n  }\n  /**\n   * Returns the amount for this tier\n   */\n  get amounts() {\n    return this.getMatchingTags(\"amount\").map((tag) => parseTagToSubscriptionAmount(tag)).filter((a) => a !== void 0);\n  }\n  /**\n   * Adds an amount to this tier\n   * @param amount Amount in the smallest unit of the currency (e.g. cents, msats)\n   * @param currency Currency code. Use msat for millisatoshis\n   * @param term One of daily, weekly, monthly, quarterly, yearly\n   */\n  addAmount(amount, currency, term) {\n    this.tags.push(newAmount(amount, currency, term));\n  }\n  /**\n   * Sets a relay where content related to this tier can be found\n   * @param relayUrl URL of the relay\n   */\n  set relayUrl(relayUrl) {\n    this.tags.push([\"r\", relayUrl]);\n  }\n  /**\n   * Returns the relay URLs for this tier\n   */\n  get relayUrls() {\n    return this.getMatchingTags(\"r\").map((tag) => tag[1]).filter((relay) => relay !== void 0);\n  }\n  /**\n   * Gets the verifier pubkey for this tier. This is the pubkey that will generate\n   * subscription payment receipts\n   */\n  get verifierPubkey() {\n    return this.tagValue(\"p\");\n  }\n  /**\n   * Sets the verifier pubkey for this tier.\n   */\n  set verifierPubkey(pubkey) {\n    this.removeTag(\"p\");\n    if (pubkey)\n      this.tags.push([\"p\", pubkey]);\n  }\n  /**\n   * Checks if this tier is valid\n   */\n  get isValid() {\n    return this.title !== void 0 && // Must have a title\n    this.amounts.length > 0;\n  }\n};\n\n// src/events/kinds/subscriptions/subscription-start.ts\nimport debug3 from \"debug\";\nvar NDKSubscriptionStart = class _NDKSubscriptionStart extends NDKEvent {\n  debug;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 7001 /* Subscribe */;\n    this.debug = ndk?.debug.extend(\"subscription-start\") ?? debug3(\"ndk:subscription-start\");\n  }\n  static from(event) {\n    return new _NDKSubscriptionStart(event.ndk, event.rawEvent());\n  }\n  /**\n   * Recipient of the subscription. I.e. The author of this event subscribes to this user.\n   */\n  get recipient() {\n    const pTag = this.getMatchingTags(\"p\")?.[0];\n    if (!pTag)\n      return void 0;\n    const user = new NDKUser({ pubkey: pTag[1] });\n    return user;\n  }\n  set recipient(user) {\n    this.removeTag(\"p\");\n    if (!user)\n      return;\n    this.tags.push([\"p\", user.pubkey]);\n  }\n  /**\n   * The amount of the subscription.\n   */\n  get amount() {\n    const amountTag = this.getMatchingTags(\"amount\")?.[0];\n    if (!amountTag)\n      return void 0;\n    return parseTagToSubscriptionAmount(amountTag);\n  }\n  set amount(amount) {\n    this.removeTag(\"amount\");\n    if (!amount)\n      return;\n    this.tags.push(newAmount(amount.amount, amount.currency, amount.term));\n  }\n  /**\n   * The event id or NIP-33 tag id of the tier that the user is subscribing to.\n   */\n  get tierId() {\n    const eTag = this.getMatchingTags(\"e\")?.[0];\n    const aTag = this.getMatchingTags(\"a\")?.[0];\n    if (!eTag || !aTag)\n      return void 0;\n    return eTag[1] ?? aTag[1];\n  }\n  set tier(tier) {\n    this.removeTag(\"e\");\n    this.removeTag(\"a\");\n    this.removeTag(\"event\");\n    if (!tier)\n      return;\n    this.tag(tier);\n    this.removeTag(\"p\");\n    this.tags.push([\"p\", tier.pubkey]);\n    this.tags.push([\"event\", JSON.stringify(tier.rawEvent())]);\n  }\n  /**\n   * Fetches the tier that the user is subscribing to.\n   */\n  async fetchTier() {\n    const eventTag = this.tagValue(\"event\");\n    if (eventTag) {\n      try {\n        const parsedEvent = JSON.parse(eventTag);\n        return NDKSubscriptionTier.from(parsedEvent);\n      } catch {\n        this.debug(\"Failed to parse event tag\");\n      }\n    }\n    const tierId = this.tierId;\n    if (!tierId)\n      return void 0;\n    const e = await this.ndk?.fetchEvent(tierId);\n    if (!e)\n      return void 0;\n    return NDKSubscriptionTier.from(e);\n  }\n  get isValid() {\n    if (this.getMatchingTags(\"amount\").length !== 1) {\n      this.debug(\"Invalid # of amount tag\");\n      return false;\n    }\n    if (!this.amount) {\n      this.debug(\"Invalid amount tag\");\n      return false;\n    }\n    if (this.getMatchingTags(\"p\").length !== 1) {\n      this.debug(\"Invalid # of p tag\");\n      return false;\n    }\n    if (!this.recipient) {\n      this.debug(\"Invalid p tag\");\n      return false;\n    }\n    return true;\n  }\n};\n\n// src/events/kinds/subscriptions/receipt.ts\nimport debug4 from \"debug\";\nvar NDKSubscriptionReceipt = class _NDKSubscriptionReceipt extends NDKEvent {\n  debug;\n  constructor(ndk, rawEvent) {\n    super(ndk, rawEvent);\n    this.kind ??= 7003 /* SubscriptionReceipt */;\n    this.debug = ndk?.debug.extend(\"subscription-start\") ?? debug4(\"ndk:subscription-start\");\n  }\n  static from(event) {\n    return new _NDKSubscriptionReceipt(event.ndk, event.rawEvent());\n  }\n  /**\n   * This is the person being subscribed to\n   */\n  get recipient() {\n    const pTag = this.getMatchingTags(\"p\")?.[0];\n    if (!pTag)\n      return void 0;\n    const user = new NDKUser({ pubkey: pTag[1] });\n    return user;\n  }\n  set recipient(user) {\n    this.removeTag(\"p\");\n    if (!user)\n      return;\n    this.tags.push([\"p\", user.pubkey]);\n  }\n  /**\n   * This is the person subscribing\n   */\n  get subscriber() {\n    const PTag = this.getMatchingTags(\"P\")?.[0];\n    if (!PTag)\n      return void 0;\n    const user = new NDKUser({ pubkey: PTag[1] });\n    return user;\n  }\n  set subscriber(user) {\n    this.removeTag(\"P\");\n    if (!user)\n      return;\n    this.tags.push([\"P\", user.pubkey]);\n  }\n  set subscriptionStart(event) {\n    this.debug(`before setting subscription start: ${this.rawEvent}`);\n    this.removeTag(\"e\");\n    this.tag(event, \"subscription\", true);\n    this.debug(`after setting subscription start: ${this.rawEvent}`);\n  }\n  get tierName() {\n    const tag = this.getMatchingTags(\"tier\")?.[0];\n    return tag?.[1];\n  }\n  get isValid() {\n    const period = this.validPeriod;\n    if (!period) {\n      return false;\n    }\n    if (period.start > period.end) {\n      return false;\n    }\n    const pTags = this.getMatchingTags(\"p\");\n    const PTags = this.getMatchingTags(\"P\");\n    if (pTags.length !== 1 || PTags.length !== 1) {\n      return false;\n    }\n    return true;\n  }\n  get validPeriod() {\n    const tag = this.getMatchingTags(\"valid\")?.[0];\n    if (!tag)\n      return void 0;\n    try {\n      return {\n        start: new Date(parseInt(tag[1]) * 1e3),\n        end: new Date(parseInt(tag[2]) * 1e3)\n      };\n    } catch {\n      return void 0;\n    }\n  }\n  set validPeriod(period) {\n    this.removeTag(\"valid\");\n    if (!period)\n      return;\n    this.tags.push([\n      \"valid\",\n      Math.floor(period.start.getTime() / 1e3).toString(),\n      Math.floor(period.end.getTime() / 1e3).toString()\n    ]);\n  }\n  get startPeriod() {\n    return this.validPeriod?.start;\n  }\n  get endPeriod() {\n    return this.validPeriod?.end;\n  }\n  /**\n   * Whether the subscription is currently active\n   */\n  isActive(time) {\n    time ??= /* @__PURE__ */ new Date();\n    const period = this.validPeriod;\n    if (!period)\n      return false;\n    if (time < period.start)\n      return false;\n    if (time > period.end)\n      return false;\n    return true;\n  }\n};\n\n// src/events/kinds/dvm/request.ts\nvar NDKDVMRequest = class _NDKDVMRequest extends NDKEvent {\n  constructor(ndk, event) {\n    super(ndk, event);\n  }\n  static from(event) {\n    return new _NDKDVMRequest(event.ndk, event.rawEvent());\n  }\n  set bid(msatAmount) {\n    if (msatAmount === void 0) {\n      this.removeTag(\"bid\");\n    } else {\n      this.tags.push([\"bid\", msatAmount.toString()]);\n    }\n  }\n  get bid() {\n    const v = this.tagValue(\"bid\");\n    if (v === void 0)\n      return void 0;\n    return parseInt(v);\n  }\n  /**\n   * Adds a new input to the job\n   * @param args The arguments to the input\n   */\n  addInput(...args) {\n    this.tags.push([\"i\", ...args]);\n  }\n  /**\n   * Adds a new parameter to the job\n   */\n  addParam(...args) {\n    this.tags.push([\"param\", ...args]);\n  }\n  set output(output) {\n    if (output === void 0) {\n      this.removeTag(\"output\");\n    } else {\n      if (typeof output === \"string\")\n        output = [output];\n      this.tags.push([\"output\", ...output]);\n    }\n  }\n  get output() {\n    const outputTag = this.getMatchingTags(\"output\")[0];\n    return outputTag ? outputTag.slice(1) : void 0;\n  }\n  get params() {\n    const paramTags = this.getMatchingTags(\"param\");\n    return paramTags.map((t) => t.slice(1));\n  }\n  getParam(name) {\n    const paramTag = this.getMatchingTags(\"param\").find((t) => t[1] === name);\n    return paramTag ? paramTag[2] : void 0;\n  }\n  /**\n   * Enables job encryption for this event\n   * @param dvm DVM that will receive the event\n   * @param signer Signer to use for encryption\n   */\n  async encryption(dvm, signer) {\n    const dvmTags = [\"i\", \"param\", \"output\", \"relays\", \"bid\"];\n    const tags = this.tags.filter((t) => dvmTags.includes(t[0]));\n    this.tags = this.tags.filter((t) => !dvmTags.includes(t[0]));\n    this.content = JSON.stringify(tags);\n    this.tag(dvm);\n    this.tags.push([\"encrypted\"]);\n    await this.encrypt(dvm, signer);\n  }\n  /**\n   * Sets the DVM that will receive the event\n   */\n  set dvm(dvm) {\n    this.removeTag(\"p\");\n    if (dvm)\n      this.tag(dvm);\n  }\n};\n\n// src/events/kinds/dvm/NDKTranscriptionDVM.ts\nvar NDKTranscriptionDVM = class _NDKTranscriptionDVM extends NDKDVMRequest {\n  constructor(ndk, event) {\n    super(ndk, event);\n    this.kind = 5e3 /* DVMReqTextExtraction */;\n  }\n  static from(event) {\n    return new _NDKTranscriptionDVM(event.ndk, event.rawEvent());\n  }\n  /**\n   * Returns the original source of the transcription\n   */\n  get url() {\n    const inputTags = this.getMatchingTags(\"i\");\n    if (inputTags.length !== 1) {\n      return void 0;\n    }\n    return inputTags[0][1];\n  }\n  /**\n   * Getter for the title tag\n   */\n  get title() {\n    return this.tagValue(\"title\");\n  }\n  /**\n   * Setter for the title tag\n   */\n  set title(value) {\n    this.removeTag(\"title\");\n    if (value) {\n      this.tags.push([\"title\", value]);\n    }\n  }\n  /**\n   * Getter for the image tag\n   */\n  get image() {\n    return this.tagValue(\"image\");\n  }\n  /**\n   * Setter for the image tag\n   */\n  set image(value) {\n    this.removeTag(\"image\");\n    if (value) {\n      this.tags.push([\"image\", value]);\n    }\n  }\n};\n\n// src/events/kinds/dvm/result.ts\nvar NDKDVMJobResult = class _NDKDVMJobResult extends NDKEvent {\n  constructor(ndk, event) {\n    super(ndk, event);\n  }\n  static from(event) {\n    return new _NDKDVMJobResult(event.ndk, event.rawEvent());\n  }\n  setAmount(msat, invoice) {\n    this.removeTag(\"amount\");\n    const tag = [\"amount\", msat.toString()];\n    if (invoice)\n      tag.push(invoice);\n    this.tags.push(tag);\n  }\n  set result(result) {\n    if (result === void 0) {\n      this.content = \"\";\n    } else {\n      this.content = result;\n    }\n  }\n  get result() {\n    if (this.content === \"\") {\n      return void 0;\n    }\n    return this.content;\n  }\n  set status(status) {\n    this.removeTag(\"status\");\n    if (status !== void 0) {\n      this.tags.push([\"status\", status]);\n    }\n  }\n  get status() {\n    return this.tagValue(\"status\");\n  }\n  get jobRequestId() {\n    for (const eTag of this.getMatchingTags(\"e\")) {\n      if (eTag[2] === \"job\")\n        return eTag[1];\n    }\n    if (this.jobRequest)\n      return this.jobRequest.id;\n    return this.tagValue(\"e\");\n  }\n  set jobRequest(event) {\n    this.removeTag(\"request\");\n    if (event) {\n      this.kind = event.kind + 1e3;\n      this.tags.push([\"request\", JSON.stringify(event.rawEvent())]);\n      this.tag(event);\n    }\n  }\n  get jobRequest() {\n    const tag = this.tagValue(\"request\");\n    if (tag === void 0) {\n      return void 0;\n    }\n    return new NDKEvent(this.ndk, JSON.parse(tag));\n  }\n};\n\n// src/events/kinds/dvm/feedback.ts\nvar NDKDvmJobFeedbackStatus = /* @__PURE__ */ ((NDKDvmJobFeedbackStatus2) => {\n  NDKDvmJobFeedbackStatus2[\"Processing\"] = \"processing\";\n  NDKDvmJobFeedbackStatus2[\"Success\"] = \"success\";\n  NDKDvmJobFeedbackStatus2[\"Scheduled\"] = \"scheduled\";\n  NDKDvmJobFeedbackStatus2[\"PayReq\"] = \"payment_required\";\n  return NDKDvmJobFeedbackStatus2;\n})(NDKDvmJobFeedbackStatus || {});\nvar NDKDVMJobFeedback = class _NDKDVMJobFeedback extends NDKEvent {\n  constructor(ndk, event) {\n    super(ndk, event);\n    this.kind ??= 7e3 /* DVMJobFeedback */;\n  }\n  static async from(event) {\n    const e = new _NDKDVMJobFeedback(event.ndk, event.rawEvent());\n    if (e.encrypted)\n      await e.dvmDecrypt();\n    return e;\n  }\n  get status() {\n    return this.tagValue(\"status\");\n  }\n  set status(status) {\n    this.removeTag(\"status\");\n    if (status !== void 0) {\n      this.tags.push([\"status\", status]);\n    }\n  }\n  get encrypted() {\n    return !!this.getMatchingTags(\"encrypted\")[0];\n  }\n  async dvmDecrypt() {\n    await this.decrypt();\n    const decryptedContent = JSON.parse(this.content);\n    this.tags.push(...decryptedContent);\n  }\n};\n\n// src/nwc/index.ts\nimport { EventEmitter as EventEmitter6 } from \"tseep\";\n\n// src/nwc/pay_invoice.ts\nasync function payInvoice(invoice) {\n  const ret = await this.sendReq(\"pay_invoice\", { invoice });\n  return ret;\n}\n\n// src/signers/private-key/index.ts\nimport { generatePrivateKey, getPublicKey, getSignature, nip04 } from \"nostr-tools\";\nvar NDKPrivateKeySigner = class _NDKPrivateKeySigner {\n  _user;\n  privateKey;\n  constructor(privateKey) {\n    if (privateKey) {\n      this.privateKey = privateKey;\n      this._user = new NDKUser({\n        hexpubkey: getPublicKey(this.privateKey)\n      });\n    }\n  }\n  static generate() {\n    const privateKey = generatePrivateKey();\n    return new _NDKPrivateKeySigner(privateKey);\n  }\n  async blockUntilReady() {\n    if (!this._user) {\n      throw new Error(\"NDKUser not initialized\");\n    }\n    return this._user;\n  }\n  async user() {\n    await this.blockUntilReady();\n    return this._user;\n  }\n  async sign(event) {\n    if (!this.privateKey) {\n      throw Error(\"Attempted to sign without a private key\");\n    }\n    return getSignature(event, this.privateKey);\n  }\n  async encrypt(recipient, value) {\n    if (!this.privateKey) {\n      throw Error(\"Attempted to encrypt without a private key\");\n    }\n    const recipientHexPubKey = recipient.hexpubkey;\n    return await nip04.encrypt(this.privateKey, recipientHexPubKey, value);\n  }\n  async decrypt(sender, value) {\n    if (!this.privateKey) {\n      throw Error(\"Attempted to decrypt without a private key\");\n    }\n    const senderHexPubKey = sender.hexpubkey;\n    return await nip04.decrypt(this.privateKey, senderHexPubKey, value);\n  }\n};\n\n// src/nwc/req.ts\nasync function sendReq(method, params) {\n  const event = new NDKEvent(this.ndk, {\n    kind: 23194 /* NostrWalletConnectReq */,\n    tags: [[\"p\", this.walletService.pubkey]],\n    content: JSON.stringify({ method, params })\n  });\n  this.debug(\"Sending request\", event.content);\n  await event.encrypt(this.walletService, this.signer);\n  await event.sign(this.signer);\n  this.debug(\"Request encrypted and signed\");\n  return new Promise(async (resolve, reject) => {\n    try {\n      const eTag = event.tagId();\n      if (!eTag)\n        throw new Error(\"Failed to get e-tag\");\n      const processEvent = (payload) => {\n        this.off(eTag, processEvent);\n        this.off(\"event\", processEvent);\n        this.debug(\"Received response\", payload);\n        try {\n          const content = JSON.parse(payload);\n          if (content.error)\n            reject(content);\n          resolve(content);\n        } catch (e) {\n          this.debug(\"Failed to parse response\", e);\n          reject({\n            result_type: \"error\",\n            error: {\n              code: \"failed_to_parse_response\",\n              message: e.message\n            }\n          });\n        }\n      };\n      const sub = this.ndk.subscribe(\n        {\n          kinds: [23195 /* NostrWalletConnectRes */],\n          \"#e\": [eTag],\n          limit: 1\n        },\n        { groupable: false, subId: `nwc-${method}` },\n        this.relaySet\n      );\n      sub.on(\"event\", async (event2) => {\n        await event2.decrypt(event2.author, this.signer);\n        processEvent(event2.content);\n        sub.stop();\n      });\n      this.once(eTag, processEvent);\n      this.once(\"event\", processEvent);\n      this.debug(\"Sending request to relay\", event.rawEvent());\n      await event.publish(this.relaySet);\n    } catch (e) {\n      this.debug(\"Failed to send request\", e, e.relayErrors);\n      reject({\n        result_type: \"error\",\n        error: {\n          code: \"failed_to_send_request\",\n          message: e.message\n        }\n      });\n    }\n  });\n}\n\n// src/nwc/get_balance.ts\nasync function getBalance() {\n  const ret = await this.sendReq(\"get_balance\", {});\n  return ret;\n}\n\n// src/nwc/get_info.ts\nasync function getInfo() {\n  const ret = await this.sendReq(\"get_info\", {});\n  return ret;\n}\n\n// src/nwc/index.ts\nvar NDKNwc = class _NDKNwc extends EventEmitter6 {\n  ndk;\n  debug;\n  /**\n   * The Wallet Service's public key\n   */\n  walletService;\n  relaySet;\n  signer;\n  active = false;\n  /**\n   *\n   * @param opts: NostrWalletConnectOptions\n   * @returns NDKNwc\n   */\n  constructor({\n    ndk,\n    pubkey,\n    relayUrls,\n    secret\n  }) {\n    super();\n    this.ndk = ndk;\n    this.walletService = ndk.getUser({ pubkey });\n    this.relaySet = new NDKRelaySet(\n      new Set(relayUrls.map((url) => ndk.pool.getRelay(url))),\n      ndk\n    );\n    this.signer = new NDKPrivateKeySigner(secret);\n    this.debug = ndk.debug.extend(\"nwc\");\n    this.debug(`Starting with wallet service ${this.walletService.npub}`);\n  }\n  static async fromURI(ndk, uri) {\n    const u = new URL(uri);\n    if (u.protocol !== \"nostr+walletconnect:\") {\n      throw new Error(\"Invalid protocol\");\n    }\n    const nwc = new _NDKNwc({\n      ndk,\n      pubkey: u.host ?? u.pathname,\n      relayUrls: u.searchParams.getAll(\"relay\") ?? [\"\"],\n      secret: u.searchParams.get(\"secret\") ?? \"\"\n    });\n    return nwc;\n  }\n  /**\n   * Blocks until we're subscribed to talk to the wallet service\n   * @param msTimeout Timeout in ms to wait for the subscription to be ready\n   * @returns\n   */\n  async blockUntilReady(msTimeout) {\n    const signerUser = await this.signer.user();\n    const timeout = new Promise((_, reject) => {\n      setTimeout(() => {\n        reject(new Error(\"Timeout\"));\n      }, msTimeout);\n    });\n    const subPromise = new Promise((resolve) => {\n      const sub = this.ndk.subscribe(\n        {\n          kinds: [23195 /* NostrWalletConnectRes */],\n          \"#p\": [signerUser.pubkey],\n          limit: 1\n        },\n        { groupable: false, subId: \"nwc\" },\n        this.relaySet\n      );\n      sub.on(\"event\", async (event) => {\n        this.debug(\"received response\", event.rawEvent());\n        const eTag = event.tagValue(\"e\");\n        if (!eTag) {\n          this.debug(\"Received an event without an e-tag\");\n          return;\n        }\n        this.debug(\"received an event\", eTag);\n        try {\n          await event.decrypt(event.author, this.signer);\n          this.emit(eTag, event.content);\n        } catch (e) {\n          this.debug(\"Failed to decrypt event\", e);\n          return;\n        }\n      });\n      sub.on(\"eose\", () => {\n        this.debug(\"Subscription ready\");\n        this.active = true;\n        resolve();\n      });\n      sub.on(\"close\", () => {\n        this.debug(\"Subscription closed\");\n        this.active = false;\n      });\n    });\n    const promises = [subPromise];\n    if (msTimeout)\n      promises.push(timeout);\n    return await Promise.race(promises);\n  }\n  async sendReq(method, params) {\n    return await sendReq.call(this, method, params);\n  }\n  async payInvoice(invoice) {\n    return await payInvoice.call(this, invoice);\n  }\n  async getInfo() {\n    return await getInfo.call(this);\n  }\n  getBalance = getBalance.bind(this);\n};\n\n// src/thread/index.ts\nfunction eventsBySameAuthor(op, events) {\n  const eventsByAuthor = /* @__PURE__ */ new Map();\n  eventsByAuthor.set(op.id, op);\n  events.forEach((event) => {\n    if (event.pubkey === op.pubkey) {\n      eventsByAuthor.set(event.id, event);\n    }\n  });\n  return eventsByAuthor;\n}\nfunction eventIsReply(op, event, threadIds) {\n  if (!threadIds)\n    threadIds = /* @__PURE__ */ new Set();\n  threadIds.add(op.id);\n  if (threadIds.has(event.id))\n    return false;\n  const replyMarker = event.tags.find((tag) => {\n    return threadIds.has(tag[1]) && tag[3] === \"reply\";\n  });\n  return !!replyMarker;\n  if (replyMarker)\n    return true;\n  const hasMarker = !!event.tags.find((tag) => [\"reply\", \"mention\"].includes(tag[3]));\n  if (hasMarker)\n    return false;\n  const expectedTags = event.getMatchingTags(\"e\").map((tag) => tag[1]);\n  expectedTags.push(event.id);\n  return event.getMatchingTags(\"e\").every((tag) => expectedTags.includes(tag[1]));\n}\nfunction eventThreads(op, events) {\n  const eventsByAuthor = eventsBySameAuthor(op, events);\n  const threadEvents = events.filter((event) => eventIsPartOfThread(op, event, eventsByAuthor));\n  return threadEvents.sort((a, b) => a.created_at - b.created_at);\n}\nfunction getEventReplyIds(event) {\n  return event.getMatchingTags(\"e\").filter((tag) => tag[3] === \"reply\").map((tag) => tag[1]);\n}\nfunction isEventOriginalPost(event) {\n  return getEventReplyIds(event).length === 0;\n}\nfunction eventThreadIds(op, events) {\n  const threadIds = /* @__PURE__ */ new Map();\n  const threadEvents = eventThreads(op, events);\n  threadEvents.forEach((event) => threadIds.set(event.id, event));\n  return threadIds;\n}\nfunction eventReplies(op, events, threadEventIds) {\n  threadEventIds ??= new Set(eventThreadIds(op, events).keys());\n  return events.filter((event) => eventIsReply(op, event, threadEventIds));\n}\nfunction eventIsPartOfThread(op, event, eventsByAuthor) {\n  if (op.pubkey !== event.pubkey)\n    return false;\n  const taggedEventIds = event.getMatchingTags(\"e\").map((tag) => tag[1]);\n  const allTaggedEventsAreByOriginalAuthor = taggedEventIds.every((id) => eventsByAuthor.has(id));\n  return allTaggedEventsAreByOriginalAuthor;\n}\nfunction eventHasETagMarkers(event) {\n  return event.getMatchingTags(\"e\").some((tag) => tag[3]);\n}\nfunction getRootEventId(event) {\n  let rootEventTag = event.tags.find((tag) => tag[0] === \"e\" && tag[3] === \"root\");\n  if (!rootEventTag) {\n    if (eventHasETagMarkers(event))\n      return null;\n    if (event.getMatchingTags(\"e\").length === 1) {\n      return event.getMatchingTags(\"e\")[0][1];\n    }\n  }\n  return rootEventTag ? rootEventTag[1] : null;\n}\n\n// src/events/kinds/simple-group/index.ts\nvar NDKSimpleGroup = class _NDKSimpleGroup {\n  ndk;\n  groupId;\n  relaySet;\n  constructor(ndk, groupId, relaySet) {\n    this.ndk = ndk;\n    this.groupId = groupId;\n    this.relaySet = relaySet;\n  }\n  /**\n   * Adds a user to the group using a kind:9000 event\n   * @param user user to add\n   * @param opts options\n   */\n  async addUser(user) {\n    const addUserEvent = _NDKSimpleGroup.generateAddUserEvent(user.pubkey, this.groupId);\n    addUserEvent.ndk = this.ndk;\n    const relays = await addUserEvent.publish(this.relaySet);\n    return addUserEvent;\n  }\n  async getMemberListEvent() {\n    const memberList = await this.ndk.fetchEvent(\n      {\n        kinds: [39002 /* GroupMembers */],\n        \"#d\": [this.groupId]\n      },\n      void 0,\n      this.relaySet\n    );\n    return memberList;\n  }\n  /**\n   * Gets a list of users that belong to this group\n   */\n  async getMembers() {\n    const members = [];\n    const memberPubkeys = /* @__PURE__ */ new Set();\n    const memberListEvent = await this.getMemberListEvent();\n    if (!memberListEvent)\n      return [];\n    for (const pTag of memberListEvent.getMatchingTags(\"p\")) {\n      const pubkey = pTag[1];\n      if (memberPubkeys.has(pubkey))\n        continue;\n      memberPubkeys.add(pubkey);\n      try {\n        members.push(this.ndk.getUser({ pubkey }));\n      } catch {\n      }\n    }\n    return members;\n  }\n  /**\n   * Generates an event that lists the members of a group.\n   * @param groupId\n   * @returns\n   */\n  static generateUserListEvent(groupId) {\n    const event = new NDKEvent(void 0, {\n      kind: 39002 /* GroupMembers */,\n      tags: [\n        [\"h\", groupId],\n        [\"alt\", \"Group Member List\"]\n      ]\n    });\n    return event;\n  }\n  /**\n   * Generates an event that adds a user to a group.\n   * @param userPubkey pubkey of the user to add\n   * @param groupId group to add the user to\n   * @returns\n   */\n  static generateAddUserEvent(userPubkey, groupId) {\n    const event = new NDKEvent(void 0, {\n      kind: 9e3 /* GroupAdminAddUser */,\n      tags: [[\"h\", groupId]]\n    });\n    event.tags.push([\"p\", userPubkey]);\n    return event;\n  }\n};\n\n// src/relay/auth-policies.ts\nimport createDebug2 from \"debug\";\nfunction disconnect(pool, debug7) {\n  debug7 ??= createDebug2(\"ndk:relay:auth-policies:disconnect\");\n  return async (relay) => {\n    debug7(`Relay ${relay.url} requested authentication, disconnecting`);\n    pool.removeRelay(relay.url);\n  };\n}\nasync function signAndAuth(event, relay, signer, debug7, resolve, reject) {\n  try {\n    await event.sign(signer);\n    await relay.auth(event);\n    resolve(event);\n  } catch (e) {\n    debug7(`Failed to publish auth event to relay ${relay.url}`, e);\n    reject(event);\n  }\n}\nfunction signIn({ ndk, signer, debug: debug7 } = {}) {\n  debug7 ??= createDebug2(\"ndk:auth-policies:signIn\");\n  return async (relay, challenge) => {\n    debug7(`Relay ${relay.url} requested authentication, signing in`);\n    const event = new NDKEvent(ndk);\n    event.kind = 22242 /* ClientAuth */;\n    event.tags = [\n      [\"relay\", relay.url],\n      [\"challenge\", challenge]\n    ];\n    signer ??= ndk?.signer;\n    return new Promise(async (resolve, reject) => {\n      if (signer) {\n        await signAndAuth(event, relay, signer, debug7, resolve, reject);\n      } else {\n        ndk?.once(\"signer:ready\", async (signer2) => {\n          await signAndAuth(event, relay, signer2, debug7, resolve, reject);\n        });\n      }\n    });\n  };\n}\nvar NDKRelayAuthPolicies = {\n  disconnect,\n  signIn\n};\n\n// src/signers/nip07/index.ts\nimport debug5 from \"debug\";\nvar NDKNip07Signer = class {\n  _userPromise;\n  nip04Queue = [];\n  nip04Processing = false;\n  debug;\n  waitTimeout;\n  /**\n   * @param waitTimeout - The timeout in milliseconds to wait for the NIP-07 to become available\n   */\n  constructor(waitTimeout = 1e3) {\n    this.debug = debug5(\"ndk:nip07\");\n    this.waitTimeout = waitTimeout;\n  }\n  async blockUntilReady() {\n    await this.waitForExtension();\n    const pubkey = await window.nostr.getPublicKey();\n    if (!pubkey) {\n      throw new Error(\"User rejected access\");\n    }\n    return new NDKUser({ hexpubkey: pubkey });\n  }\n  /**\n   * Getter for the user property.\n   * @returns The NDKUser instance.\n   */\n  async user() {\n    if (!this._userPromise) {\n      this._userPromise = this.blockUntilReady();\n    }\n    return this._userPromise;\n  }\n  /**\n   * Signs the given Nostr event.\n   * @param event - The Nostr event to be signed.\n   * @returns The signature of the signed event.\n   * @throws Error if the NIP-07 is not available on the window object.\n   */\n  async sign(event) {\n    await this.waitForExtension();\n    const signedEvent = await window.nostr.signEvent(event);\n    return signedEvent.sig;\n  }\n  async relays() {\n    await this.waitForExtension();\n    const relays = await window.nostr.getRelays?.() || {};\n    const activeRelays = [];\n    for (const url of Object.keys(relays)) {\n      if (relays[url].read && relays[url].write) {\n        activeRelays.push(url);\n      }\n    }\n    return activeRelays.map((url) => new NDKRelay(url));\n  }\n  async encrypt(recipient, value) {\n    await this.waitForExtension();\n    const recipientHexPubKey = recipient.hexpubkey;\n    return this.queueNip04(\"encrypt\", recipientHexPubKey, value);\n  }\n  async decrypt(sender, value) {\n    await this.waitForExtension();\n    const senderHexPubKey = sender.hexpubkey;\n    return this.queueNip04(\"decrypt\", senderHexPubKey, value);\n  }\n  async queueNip04(type, counterpartyHexpubkey, value) {\n    return new Promise((resolve, reject) => {\n      this.nip04Queue.push({\n        type,\n        counterpartyHexpubkey,\n        value,\n        resolve,\n        reject\n      });\n      if (!this.nip04Processing) {\n        this.processNip04Queue();\n      }\n    });\n  }\n  async processNip04Queue(item, retries = 0) {\n    if (!item && this.nip04Queue.length === 0) {\n      this.nip04Processing = false;\n      return;\n    }\n    this.nip04Processing = true;\n    const { type, counterpartyHexpubkey, value, resolve, reject } = item || this.nip04Queue.shift();\n    this.debug(\"Processing encryption queue item\", {\n      type,\n      counterpartyHexpubkey,\n      value\n    });\n    try {\n      let result;\n      if (type === \"encrypt\") {\n        result = await window.nostr.nip04.encrypt(counterpartyHexpubkey, value);\n      } else {\n        result = await window.nostr.nip04.decrypt(counterpartyHexpubkey, value);\n      }\n      resolve(result);\n    } catch (error) {\n      if (error.message && error.message.includes(\"call already executing\")) {\n        if (retries < 5) {\n          this.debug(\"Retrying encryption queue item\", {\n            type,\n            counterpartyHexpubkey,\n            value,\n            retries\n          });\n          setTimeout(() => {\n            this.processNip04Queue(item, retries + 1);\n          }, 50 * retries);\n          return;\n        }\n      }\n      reject(error);\n    }\n    this.processNip04Queue();\n  }\n  waitForExtension() {\n    return new Promise((resolve, reject) => {\n      if (window.nostr) {\n        resolve();\n        return;\n      }\n      let timerId;\n      const intervalId = setInterval(() => {\n        if (window.nostr) {\n          clearTimeout(timerId);\n          clearInterval(intervalId);\n          resolve();\n        }\n      }, 100);\n      timerId = setTimeout(() => {\n        clearInterval(intervalId);\n        reject(new Error(\"NIP-07 extension not available\"));\n      }, this.waitTimeout);\n    });\n  }\n};\n\n// src/signers/nip46/rpc.ts\nimport { EventEmitter as EventEmitter7 } from \"tseep\";\nvar NDKNostrRpc = class extends EventEmitter7 {\n  ndk;\n  signer;\n  debug;\n  constructor(ndk, signer, debug7) {\n    super();\n    this.ndk = ndk;\n    this.signer = signer;\n    this.debug = debug7.extend(\"rpc\");\n  }\n  /**\n   * Subscribe to a filter. This function will resolve once the subscription is ready.\n   */\n  subscribe(filter) {\n    const sub = this.ndk.subscribe(filter, {\n      closeOnEose: false,\n      groupable: false\n    });\n    sub.on(\"event\", async (event) => {\n      try {\n        const parsedEvent = await this.parseEvent(event);\n        if (parsedEvent.method) {\n          this.emit(\"request\", parsedEvent);\n        } else {\n          this.emit(`response-${parsedEvent.id}`, parsedEvent);\n        }\n      } catch (e) {\n        this.debug(\"error parsing event\", e, event.rawEvent());\n      }\n    });\n    return new Promise((resolve, reject) => {\n      sub.on(\"eose\", () => resolve(sub));\n    });\n  }\n  async parseEvent(event) {\n    const remoteUser = this.ndk.getUser({ hexpubkey: event.pubkey });\n    remoteUser.ndk = this.ndk;\n    const decryptedContent = await this.signer.decrypt(remoteUser, event.content);\n    const parsedContent = JSON.parse(decryptedContent);\n    const { id, method, params, result, error } = parsedContent;\n    if (method) {\n      return { id, pubkey: event.pubkey, method, params, event };\n    } else {\n      return { id, result, error, event };\n    }\n  }\n  async sendResponse(id, remotePubkey, result, kind = 24133 /* NostrConnect */, error) {\n    const res = { id, result };\n    if (error) {\n      res.error = error;\n    }\n    const localUser = await this.signer.user();\n    const remoteUser = this.ndk.getUser({ hexpubkey: remotePubkey });\n    const event = new NDKEvent(this.ndk, {\n      kind,\n      content: JSON.stringify(res),\n      tags: [[\"p\", remotePubkey]],\n      pubkey: localUser.hexpubkey\n    });\n    event.content = await this.signer.encrypt(remoteUser, event.content);\n    await event.sign(this.signer);\n    await event.publish();\n  }\n  /**\n   * Sends a request.\n   * @param remotePubkey\n   * @param method\n   * @param params\n   * @param kind\n   * @param id\n   */\n  async sendRequest(remotePubkey, method, params = [], kind = 24133, cb) {\n    const id = Math.random().toString(36).substring(7);\n    const localUser = await this.signer.user();\n    const remoteUser = this.ndk.getUser({ hexpubkey: remotePubkey });\n    const request = { id, method, params };\n    const promise = new Promise((resolve) => {\n      const responseHandler = (response) => {\n        if (response.result === \"auth_url\") {\n          this.once(`response-${id}`, responseHandler);\n          this.emit(\"authUrl\", response.error);\n        } else if (cb) {\n          cb(response);\n        }\n      };\n      this.once(`response-${id}`, responseHandler);\n    });\n    const event = new NDKEvent(this.ndk, {\n      kind,\n      content: JSON.stringify(request),\n      tags: [[\"p\", remotePubkey]],\n      pubkey: localUser.pubkey\n    });\n    event.content = await this.signer.encrypt(remoteUser, event.content);\n    await event.sign(this.signer);\n    this.debug(`sending ${method} request to`, remotePubkey);\n    await event.publish();\n    return promise;\n  }\n};\n\n// src/signers/nip46/backend/ping.ts\nvar PingEventHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const debug7 = backend.debug.extend(\"ping\");\n    debug7(`ping request from ${remotePubkey}`);\n    if (await backend.pubkeyAllowed({ id, pubkey: remotePubkey, method: \"ping\" })) {\n      debug7(`connection request from ${remotePubkey} allowed`);\n      return \"pong\";\n    } else {\n      debug7(`connection request from ${remotePubkey} rejected`);\n    }\n    return void 0;\n  }\n};\n\n// src/signers/nip46/backend/connect.ts\nvar ConnectEventHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const [_, token] = params;\n    const debug7 = backend.debug.extend(\"connect\");\n    debug7(`connection request from ${remotePubkey}`);\n    if (token && backend.applyToken) {\n      debug7(`applying token`);\n      await backend.applyToken(remotePubkey, token);\n    }\n    if (await backend.pubkeyAllowed({\n      id,\n      pubkey: remotePubkey,\n      method: \"connect\",\n      params: token\n    })) {\n      debug7(`connection request from ${remotePubkey} allowed`);\n      return \"ack\";\n    } else {\n      debug7(`connection request from ${remotePubkey} rejected`);\n    }\n    return void 0;\n  }\n};\n\n// src/signers/nip46/backend/get-public-key.ts\nvar GetPublicKeyHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    return backend.localUser?.pubkey;\n  }\n};\n\n// src/signers/nip46/backend/nip04-decrypt.ts\nvar Nip04DecryptHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const [senderPubkey, payload] = params;\n    const senderUser = new NDKUser({ hexpubkey: senderPubkey });\n    const decryptedPayload = await decrypt2(backend, id, remotePubkey, senderUser, payload);\n    return decryptedPayload;\n  }\n};\nasync function decrypt2(backend, id, remotePubkey, senderUser, payload) {\n  if (!await backend.pubkeyAllowed({\n    id,\n    pubkey: remotePubkey,\n    method: \"decrypt\",\n    params: payload\n  })) {\n    backend.debug(`decrypt request from ${remotePubkey} rejected`);\n    return void 0;\n  }\n  return await backend.signer.decrypt(senderUser, payload);\n}\n\n// src/signers/nip46/backend/nip04-encrypt.ts\nvar Nip04EncryptHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const [recipientPubkey, payload] = params;\n    const recipientUser = new NDKUser({ hexpubkey: recipientPubkey });\n    const encryptedPayload = await encrypt2(backend, id, remotePubkey, recipientUser, payload);\n    return encryptedPayload;\n  }\n};\nasync function encrypt2(backend, id, remotePubkey, recipientUser, payload) {\n  if (!await backend.pubkeyAllowed({\n    id,\n    pubkey: remotePubkey,\n    method: \"encrypt\",\n    params: payload\n  })) {\n    backend.debug(`encrypt request from ${remotePubkey} rejected`);\n    return void 0;\n  }\n  return await backend.signer.encrypt(recipientUser, payload);\n}\n\n// src/signers/nip46/backend/sign-event.ts\nvar SignEventHandlingStrategy = class {\n  async handle(backend, id, remotePubkey, params) {\n    const event = await signEvent(backend, id, remotePubkey, params);\n    if (!event)\n      return void 0;\n    return JSON.stringify(await event.toNostrEvent());\n  }\n};\nasync function signEvent(backend, id, remotePubkey, params) {\n  const [eventString] = params;\n  backend.debug(`sign event request from ${remotePubkey}`);\n  const event = new NDKEvent(backend.ndk, JSON.parse(eventString));\n  backend.debug(\"event to sign\", event.rawEvent());\n  if (!await backend.pubkeyAllowed({\n    id,\n    pubkey: remotePubkey,\n    method: \"sign_event\",\n    params: event\n  })) {\n    backend.debug(`sign event request from ${remotePubkey} rejected`);\n    return void 0;\n  }\n  backend.debug(`sign event request from ${remotePubkey} allowed`);\n  await event.sign(backend.signer);\n  return event;\n}\n\n// src/signers/nip46/backend/index.ts\nvar NDKNip46Backend = class {\n  ndk;\n  signer;\n  localUser;\n  debug;\n  rpc;\n  permitCallback;\n  /**\n   * @param ndk The NDK instance to use\n   * @param privateKeyOrSigner The private key or signer of the npub that wants to be published as\n   * @param permitCallback Callback executed when permission is requested\n   */\n  constructor(ndk, privateKeyOrSigner, permitCallback) {\n    this.ndk = ndk;\n    this.signer = typeof privateKeyOrSigner === \"string\" ? new NDKPrivateKeySigner(privateKeyOrSigner) : privateKeyOrSigner;\n    this.debug = ndk.debug.extend(\"nip46:backend\");\n    this.rpc = new NDKNostrRpc(ndk, this.signer, this.debug);\n    this.permitCallback = permitCallback;\n  }\n  /**\n   * This method starts the backend, which will start listening for incoming\n   * requests.\n   */\n  async start() {\n    this.localUser = await this.signer.user();\n    const sub = this.ndk.subscribe(\n      {\n        kinds: [24133],\n        \"#p\": [this.localUser.hexpubkey]\n      },\n      { closeOnEose: false }\n    );\n    sub.on(\"event\", (e) => this.handleIncomingEvent(e));\n  }\n  handlers = {\n    connect: new ConnectEventHandlingStrategy(),\n    sign_event: new SignEventHandlingStrategy(),\n    nip04_encrypt: new Nip04EncryptHandlingStrategy(),\n    nip04_decrypt: new Nip04DecryptHandlingStrategy(),\n    get_public_key: new GetPublicKeyHandlingStrategy(),\n    ping: new PingEventHandlingStrategy()\n  };\n  /**\n   * Enables the user to set a custom strategy for handling incoming events.\n   * @param method - The method to set the strategy for\n   * @param strategy - The strategy to set\n   */\n  setStrategy(method, strategy) {\n    this.handlers[method] = strategy;\n  }\n  /**\n   * Overload this method to apply tokens, which can\n   * wrap permission sets to be applied to a pubkey.\n   * @param pubkey public key to apply token to\n   * @param token token to apply\n   */\n  async applyToken(pubkey, token) {\n    throw new Error(\"connection token not supported\");\n  }\n  async handleIncomingEvent(event) {\n    const { id, method, params } = await this.rpc.parseEvent(event);\n    const remotePubkey = event.pubkey;\n    let response;\n    this.debug(\"incoming event\", { id, method, params });\n    if (!event.verifySignature(false)) {\n      this.debug(\"invalid signature\", event.rawEvent());\n      return;\n    }\n    const strategy = this.handlers[method];\n    if (strategy) {\n      try {\n        response = await strategy.handle(this, id, remotePubkey, params);\n      } catch (e) {\n        this.debug(\"error handling event\", e, { id, method, params });\n        this.rpc.sendResponse(id, remotePubkey, \"error\", void 0, e.message);\n      }\n    } else {\n      this.debug(\"unsupported method\", { method, params });\n    }\n    if (response) {\n      this.debug(`sending response to ${remotePubkey}`, response);\n      this.rpc.sendResponse(id, remotePubkey, response);\n    } else {\n      this.rpc.sendResponse(id, remotePubkey, \"error\", void 0, \"Not authorized\");\n    }\n  }\n  /**\n   * This method should be overriden by the user to allow or reject incoming\n   * connections.\n   */\n  async pubkeyAllowed(params) {\n    return this.permitCallback(params);\n  }\n};\n\n// src/signers/nip46/index.ts\nimport { EventEmitter as EventEmitter8 } from \"tseep\";\nvar NDKNip46Signer = class extends EventEmitter8 {\n  ndk;\n  remoteUser;\n  remotePubkey;\n  token;\n  localSigner;\n  nip05;\n  rpc;\n  debug;\n  relayUrls = [];\n  /**\n   * @param ndk - The NDK instance to use\n   * @param tokenOrRemoteUser - The public key, or a connection token, of the npub that wants to be published as\n   * @param localSigner - The signer that will be used to request events to be signed\n   */\n  constructor(ndk, tokenOrRemoteUser, localSigner) {\n    super();\n    let remotePubkey;\n    let token;\n    if (tokenOrRemoteUser.includes(\"#\")) {\n      const parts = tokenOrRemoteUser.split(\"#\");\n      remotePubkey = new NDKUser({ npub: parts[0] }).pubkey;\n      token = parts[1];\n    } else if (tokenOrRemoteUser.startsWith(\"npub\")) {\n      remotePubkey = new NDKUser({\n        npub: tokenOrRemoteUser\n      }).pubkey;\n    } else if (tokenOrRemoteUser.match(/\\./)) {\n      this.nip05 = tokenOrRemoteUser;\n    } else {\n      remotePubkey = tokenOrRemoteUser;\n    }\n    this.ndk = ndk;\n    if (remotePubkey)\n      this.remotePubkey = remotePubkey;\n    this.token = token;\n    this.debug = ndk.debug.extend(\"nip46:signer\");\n    this.remoteUser = new NDKUser({ pubkey: remotePubkey });\n    if (!localSigner) {\n      this.localSigner = NDKPrivateKeySigner.generate();\n    } else {\n      this.localSigner = localSigner;\n    }\n    this.rpc = new NDKNostrRpc(ndk, this.localSigner, this.debug);\n    this.rpc.on(\"authUrl\", (...props) => {\n      this.emit(\"authUrl\", ...props);\n    });\n    this.localSigner.user().then((localUser) => {\n      this.rpc.subscribe({\n        kinds: [24133 /* NostrConnect */, 24133 /* NostrConnect */ + 1],\n        \"#p\": [localUser.pubkey]\n      });\n    });\n  }\n  /**\n   * Get the user that is being published as\n   */\n  async user() {\n    return this.remoteUser;\n  }\n  async blockUntilReady() {\n    const localUser = await this.localSigner.user();\n    const remoteUser = this.ndk.getUser({ pubkey: this.remotePubkey });\n    if (this.nip05 && !this.remotePubkey) {\n      NDKUser.fromNip05(this.nip05).then((user) => {\n        if (user) {\n          this.remoteUser = user;\n          this.remotePubkey = user.pubkey;\n          this.relayUrls = user.nip46Urls;\n        }\n      });\n    }\n    if (!this.remotePubkey) {\n      throw new Error(\"Remote pubkey not set\");\n    }\n    return new Promise((resolve, reject) => {\n      setTimeout(() => {\n        const connectParams = [this.remotePubkey];\n        if (this.token) {\n          connectParams.push(this.token);\n        }\n        this.rpc.sendRequest(\n          this.remotePubkey,\n          \"connect\",\n          connectParams,\n          24133,\n          (response) => {\n            if (response.result === \"ack\") {\n              resolve(remoteUser);\n            } else {\n              reject(response.error);\n            }\n          }\n        );\n      }, 100);\n    });\n  }\n  async encrypt(recipient, value) {\n    this.debug(\"asking for encryption\");\n    const promise = new Promise((resolve, reject) => {\n      this.rpc.sendRequest(\n        this.remotePubkey,\n        \"nip04_encrypt\",\n        [recipient.pubkey, value],\n        24133,\n        (response) => {\n          if (!response.error) {\n            resolve(response.result);\n          } else {\n            reject(response.error);\n          }\n        }\n      );\n    });\n    return promise;\n  }\n  async decrypt(sender, value) {\n    this.debug(\"asking for decryption\");\n    const promise = new Promise((resolve, reject) => {\n      this.rpc.sendRequest(\n        this.remotePubkey,\n        \"nip04_decrypt\",\n        [sender.pubkey, value],\n        24133,\n        (response) => {\n          if (!response.error) {\n            const value2 = JSON.parse(response.result);\n            resolve(value2[0]);\n          } else {\n            reject(response.error);\n          }\n        }\n      );\n    });\n    return promise;\n  }\n  async sign(event) {\n    this.debug(\"asking for a signature\");\n    const promise = new Promise((resolve, reject) => {\n      this.rpc.sendRequest(\n        this.remotePubkey,\n        \"sign_event\",\n        [JSON.stringify(event)],\n        24133,\n        (response) => {\n          this.debug(\"got a response\", response);\n          if (!response.error) {\n            const json = JSON.parse(response.result);\n            resolve(json.sig);\n          } else {\n            reject(response.error);\n          }\n        }\n      );\n    });\n    return promise;\n  }\n  /**\n   * Allows creating a new account on the remote server.\n   * @param username Desired username for the NIP-05\n   * @param domain Desired domain for the NIP-05\n   * @param email Email address to associate with this account -- Remote servers may use this for recovery\n   * @returns The public key of the newly created account\n   */\n  async createAccount(username, domain, email) {\n    this.debug(\"asking to create an account\");\n    const req = [];\n    if (username)\n      req.push(username);\n    if (domain)\n      req.push(domain);\n    if (email)\n      req.push(email);\n    return new Promise((resolve, reject) => {\n      this.rpc.sendRequest(\n        this.remotePubkey,\n        \"create_account\",\n        req,\n        24133 /* NostrConnect */,\n        (response) => {\n          this.debug(\"got a response\", response);\n          if (!response.error) {\n            const pubkey = response.result;\n            resolve(pubkey);\n          } else {\n            reject(response.error);\n          }\n        }\n      );\n    });\n  }\n};\n\n// src/dvm/schedule.ts\nfunction addRelays(event, relays) {\n  const tags = [];\n  if (!relays || relays.length === 0) {\n    const poolRelays = event.ndk?.pool.relays;\n    relays = poolRelays ? Object.keys(poolRelays) : void 0;\n  }\n  if (relays && relays.length > 0)\n    tags.push([\"relays\", ...relays]);\n  return tags;\n}\nasync function dvmSchedule(event, dvm, relays, encrypted = true, waitForConfirmationForMs) {\n  if (!event.ndk)\n    throw new Error(\"NDK not set\");\n  if (!event.sig)\n    throw new Error(\"Event not signed\");\n  if (!event.created_at)\n    throw new Error(\"Event has no date\");\n  if (!dvm)\n    throw new Error(\"No DVM specified\");\n  if (event.created_at <= Date.now() / 1e3)\n    throw new Error(\"Event needs to be in the future\");\n  const scheduleEvent = new NDKDVMRequest(event.ndk, {\n    kind: 5905 /* DVMEventSchedule */\n  });\n  scheduleEvent.addInput(JSON.stringify(event.rawEvent()), \"text\");\n  scheduleEvent.tags.push(...addRelays(event, relays));\n  if (encrypted) {\n    await scheduleEvent.encryption(dvm);\n  } else {\n    scheduleEvent.dvm = dvm;\n  }\n  await scheduleEvent.sign();\n  let res;\n  if (waitForConfirmationForMs) {\n    res = event.ndk.subscribe(\n      {\n        kinds: [5905 /* DVMEventSchedule */ + 1e3, 7e3 /* DVMJobFeedback */],\n        ...scheduleEvent.filter()\n      },\n      { groupable: false, closeOnEose: false }\n    );\n  }\n  const timeoutPromise = new Promise((reject) => {\n    setTimeout(() => {\n      res?.stop();\n      reject(\"Timeout waiting for an answer from the DVM\");\n    }, waitForConfirmationForMs);\n  });\n  const schedulePromise = new Promise(\n    (resolve, reject) => {\n      if (waitForConfirmationForMs) {\n        res?.on(\"event\", async (e) => {\n          res?.stop();\n          if (e.kind === 7e3 /* DVMJobFeedback */) {\n            const feedback = await NDKDVMJobFeedback.from(e);\n            if (feedback.status === \"error\") {\n              const statusTag = feedback.getMatchingTags(\"status\");\n              reject(statusTag?.[2] ?? feedback);\n            } else {\n              resolve(feedback);\n            }\n          }\n          resolve(e);\n        });\n      }\n      scheduleEvent.publish().then(() => {\n        if (!waitForConfirmationForMs)\n          resolve();\n      });\n    }\n  );\n  return new Promise((resolve, reject) => {\n    if (waitForConfirmationForMs) {\n      Promise.race([timeoutPromise, schedulePromise]).then((e) => {\n        resolve(e);\n      }).catch(reject);\n    } else {\n      schedulePromise.then(resolve);\n    }\n  });\n}\n\n// src/ndk/index.ts\nimport debug6 from \"debug\";\nimport { EventEmitter as EventEmitter11 } from \"tseep\";\n\n// src/events/dedup.ts\nfunction dedup(event1, event2) {\n  if (event1.created_at > event2.created_at) {\n    return event1;\n  }\n  return event2;\n}\n\n// src/outbox/tracker.ts\nimport { EventEmitter as EventEmitter9 } from \"tseep\";\nimport { LRUCache } from \"typescript-lru-cache\";\nvar OutboxItem = class {\n  /**\n   * Type of item\n   */\n  type;\n  /**\n   * The relay URLs that are of interest to this item\n   */\n  relayUrlScores;\n  readRelays;\n  writeRelays;\n  constructor(type) {\n    this.type = type;\n    this.relayUrlScores = /* @__PURE__ */ new Map();\n    this.readRelays = /* @__PURE__ */ new Set();\n    this.writeRelays = /* @__PURE__ */ new Set();\n  }\n};\nvar OutboxTracker = class extends EventEmitter9 {\n  data;\n  ndk;\n  debug;\n  constructor(ndk) {\n    super();\n    this.ndk = ndk;\n    this.debug = ndk.debug.extend(\"outbox-tracker\");\n    this.data = new LRUCache({\n      maxSize: 1e5,\n      entryExpirationTimeInMS: 5e3\n    });\n  }\n  trackUsers(items) {\n    for (let i = 0; i < items.length; i += 400) {\n      const slice = items.slice(i, i + 400);\n      let pubkeys = slice.map((item) => getKeyFromItem(item));\n      pubkeys = pubkeys.filter((pubkey) => !this.data.has(pubkey));\n      if (pubkeys.length === 0)\n        continue;\n      const outboxItems = /* @__PURE__ */ new Map();\n      for (const pubkey of pubkeys) {\n        outboxItems.set(pubkey, this.track(pubkey, \"user\"));\n      }\n      NDKRelayList.forUsers(pubkeys, this.ndk).then(\n        (relayLists) => {\n          for (const [pubkey, relayList] of relayLists) {\n            const outboxItem = outboxItems.get(pubkey);\n            const user = new NDKUser({ pubkey });\n            user.ndk = this.ndk;\n            if (relayList) {\n              outboxItem.readRelays = new Set(normalize(relayList.readRelayUrls));\n              outboxItem.writeRelays = new Set(normalize(relayList.writeRelayUrls));\n              for (const relayUrl of outboxItem.readRelays) {\n                if (this.ndk.pool.blacklistRelayUrls.has(relayUrl)) {\n                  this.debug(\n                    `removing blacklisted relay ${relayUrl} from read relays`\n                  );\n                  outboxItem.readRelays.delete(relayUrl);\n                }\n              }\n              for (const relayUrl of outboxItem.writeRelays) {\n                if (this.ndk.pool.blacklistRelayUrls.has(relayUrl)) {\n                  this.debug(\n                    `removing blacklisted relay ${relayUrl} from write relays`\n                  );\n                  outboxItem.writeRelays.delete(relayUrl);\n                }\n              }\n              this.data.set(pubkey, outboxItem);\n            }\n          }\n        }\n      );\n    }\n  }\n  /**\n   *\n   * @param key\n   * @param score\n   */\n  track(item, type) {\n    const key = getKeyFromItem(item);\n    type ??= getTypeFromItem(item);\n    let outboxItem = this.data.get(key);\n    if (!outboxItem)\n      outboxItem = new OutboxItem(type);\n    this.data.set(key, outboxItem);\n    return outboxItem;\n  }\n};\nfunction getKeyFromItem(item) {\n  if (item instanceof NDKUser) {\n    return item.pubkey;\n  } else {\n    return item;\n  }\n}\nfunction getTypeFromItem(item) {\n  if (item instanceof NDKUser) {\n    return \"user\";\n  } else {\n    return \"kind\";\n  }\n}\n\n// src/relay/pool/index.ts\nimport { EventEmitter as EventEmitter10 } from \"tseep\";\nvar NDKPool = class extends EventEmitter10 {\n  // TODO: This should probably be an LRU cache\n  relays = /* @__PURE__ */ new Map();\n  blacklistRelayUrls;\n  debug;\n  temporaryRelayTimers = /* @__PURE__ */ new Map();\n  flappingRelays = /* @__PURE__ */ new Set();\n  // A map to store timeouts for each flapping relay.\n  backoffTimes = /* @__PURE__ */ new Map();\n  constructor(relayUrls = [], blacklistedRelayUrls = [], ndk, debug7) {\n    super();\n    this.debug = debug7 ?? ndk.debug.extend(\"pool\");\n    for (const relayUrl of relayUrls) {\n      const relay = new NDKRelay(relayUrl);\n      this.addRelay(relay, false);\n    }\n    this.blacklistRelayUrls = new Set(blacklistedRelayUrls);\n  }\n  /**\n   * Adds a relay to the pool, and sets a timer to remove it if it is not used within the specified time.\n   * @param relay - The relay to add to the pool.\n   * @param removeIfUnusedAfter - The time in milliseconds to wait before removing the relay from the pool after it is no longer used.\n   */\n  useTemporaryRelay(relay, removeIfUnusedAfter = 6e5) {\n    const relayAlreadyInPool = this.relays.has(relay.url);\n    if (!relayAlreadyInPool) {\n      this.addRelay(relay);\n    }\n    const existingTimer = this.temporaryRelayTimers.get(relay.url);\n    if (existingTimer) {\n      clearTimeout(existingTimer);\n    }\n    if (!relayAlreadyInPool || existingTimer) {\n      const timer = setTimeout(() => {\n        this.removeRelay(relay.url);\n      }, removeIfUnusedAfter);\n      this.temporaryRelayTimers.set(relay.url, timer);\n    }\n  }\n  /**\n   * Adds a relay to the pool.\n   *\n   * @param relay - The relay to add to the pool.\n   * @param connect - Whether or not to connect to the relay.\n   */\n  addRelay(relay, connect = true) {\n    const relayUrl = relay.url;\n    if (this.blacklistRelayUrls?.has(relayUrl)) {\n      this.debug(`Relay ${relayUrl} is blacklisted`);\n      return;\n    }\n    relay.on(\"notice\", async (relay2, notice) => this.emit(\"notice\", relay2, notice));\n    relay.on(\"connect\", () => this.handleRelayConnect(relayUrl));\n    relay.on(\"ready\", () => this.handleRelayReady(relay));\n    relay.on(\"disconnect\", async () => this.emit(\"relay:disconnect\", relay));\n    relay.on(\"flapping\", () => this.handleFlapping(relay));\n    relay.on(\"auth\", async (challenge) => this.emit(\"relay:auth\", relay, challenge));\n    relay.on(\"authed\", async () => this.emit(\"relay:authed\", relay));\n    this.relays.set(relayUrl, relay);\n    if (connect) {\n      this.emit(\"relay:connecting\", relay);\n      relay.connect().catch((e) => {\n        this.debug(`Failed to connect to relay ${relayUrl}`, e);\n      });\n    }\n  }\n  /**\n   * Removes a relay from the pool.\n   * @param relayUrl - The URL of the relay to remove.\n   * @returns {boolean} True if the relay was removed, false if it was not found.\n   */\n  removeRelay(relayUrl) {\n    const relay = this.relays.get(relayUrl);\n    if (relay) {\n      relay.disconnect();\n      this.relays.delete(relayUrl);\n      this.emit(\"relay:disconnect\", relay);\n      return true;\n    }\n    const existingTimer = this.temporaryRelayTimers.get(relayUrl);\n    if (existingTimer) {\n      clearTimeout(existingTimer);\n      this.temporaryRelayTimers.delete(relayUrl);\n    }\n    return false;\n  }\n  /**\n   * Fetches a relay from the pool, or creates a new one if it does not exist.\n   *\n   * New relays will be attempted to be connected.\n   */\n  getRelay(url, connect = true) {\n    let relay = this.relays.get(url);\n    if (!relay) {\n      relay = new NDKRelay(url);\n      this.addRelay(relay, connect);\n    }\n    return relay;\n  }\n  handleRelayConnect(relayUrl) {\n    this.debug(`Relay ${relayUrl} connected`);\n    this.emit(\"relay:connect\", this.relays.get(relayUrl));\n    if (this.stats().connected === this.relays.size) {\n      this.emit(\"connect\");\n    }\n  }\n  handleRelayReady(relay) {\n    this.debug(`Relay ${relay.url} ready`);\n    this.emit(\"relay:ready\", relay);\n  }\n  /**\n   * Attempts to establish a connection to each relay in the pool.\n   *\n   * @async\n   * @param {number} [timeoutMs] - Optional timeout in milliseconds for each connection attempt.\n   * @returns {Promise<void>} A promise that resolves when all connection attempts have completed.\n   * @throws {Error} If any of the connection attempts result in an error or timeout.\n   */\n  async connect(timeoutMs) {\n    const promises = [];\n    this.debug(\n      `Connecting to ${this.relays.size} relays${timeoutMs ? `, timeout ${timeoutMs}...` : \"\"}`\n    );\n    for (const relay of this.relays.values()) {\n      const connectPromise = new Promise((resolve, reject) => {\n        this.emit(\"relay:connecting\", relay);\n        return relay.connect(timeoutMs).then(resolve).catch(reject);\n      });\n      if (timeoutMs) {\n        const timeoutPromise = new Promise((_, reject) => {\n          setTimeout(() => reject(`Timed out after ${timeoutMs}ms`), timeoutMs);\n        });\n        promises.push(\n          Promise.race([connectPromise, timeoutPromise]).catch((e) => {\n            this.debug(\n              `Failed to connect to relay ${relay.url}: ${e ?? \"No reason specified\"}`\n            );\n          })\n        );\n      } else {\n        promises.push(connectPromise);\n      }\n    }\n    if (timeoutMs) {\n      setTimeout(() => {\n        const allConnected = this.stats().connected === this.relays.size;\n        const someConnected = this.stats().connected > 0;\n        if (!allConnected && someConnected) {\n          this.emit(\"connect\");\n        }\n      }, timeoutMs);\n    }\n    await Promise.all(promises);\n  }\n  checkOnFlappingRelays() {\n    const flappingRelaysCount = this.flappingRelays.size;\n    const totalRelays = this.relays.size;\n    if (flappingRelaysCount / totalRelays >= 0.8) {\n      for (const relayUrl of this.flappingRelays) {\n        this.backoffTimes.set(relayUrl, 0);\n      }\n    }\n  }\n  handleFlapping(relay) {\n    this.debug(`Relay ${relay.url} is flapping`);\n    let currentBackoff = this.backoffTimes.get(relay.url) || 5e3;\n    currentBackoff = currentBackoff * 2;\n    this.backoffTimes.set(relay.url, currentBackoff);\n    this.debug(`Backoff time for ${relay.url} is ${currentBackoff}ms`);\n    setTimeout(() => {\n      this.debug(`Attempting to reconnect to ${relay.url}`);\n      this.emit(\"relay:connecting\", relay);\n      relay.connect();\n      this.checkOnFlappingRelays();\n    }, currentBackoff);\n    relay.disconnect();\n    this.emit(\"flapping\", relay);\n  }\n  size() {\n    return this.relays.size;\n  }\n  /**\n   * Returns the status of each relay in the pool.\n   * @returns {NDKPoolStats} An object containing the number of relays in each status.\n   */\n  stats() {\n    const stats = {\n      total: 0,\n      connected: 0,\n      disconnected: 0,\n      connecting: 0\n    };\n    for (const relay of this.relays.values()) {\n      stats.total++;\n      if (relay.status === 1 /* CONNECTED */) {\n        stats.connected++;\n      } else if (relay.status === 3 /* DISCONNECTED */) {\n        stats.disconnected++;\n      } else if (relay.status === 0 /* CONNECTING */) {\n        stats.connecting++;\n      }\n    }\n    return stats;\n  }\n  connectedRelays() {\n    return Array.from(this.relays.values()).filter(\n      (relay) => relay.status === 1 /* CONNECTED */\n    );\n  }\n  /**\n   * Get a list of all relay urls in the pool.\n   */\n  urls() {\n    return Array.from(this.relays.keys());\n  }\n};\n\n// src/relay/sets/utils.ts\nfunction correctRelaySet(relaySet, pool) {\n  const connectedRelays = pool.connectedRelays();\n  const includesConnectedRelay = Array.from(relaySet.relays).some((relay) => {\n    return connectedRelays.map((r) => r.url).includes(relay.url);\n  });\n  if (!includesConnectedRelay) {\n    for (const relay of connectedRelays) {\n      relaySet.addRelay(relay);\n    }\n  }\n  if (connectedRelays.length === 0) {\n    for (const relay of pool.relays.values()) {\n      relaySet.addRelay(relay);\n    }\n  }\n  return relaySet;\n}\n\n// src/media/index.ts\nvar SPEC_PATH = \"/.well-known/nostr/nip96.json\";\nvar Nip96 = class {\n  ndk;\n  spec;\n  url;\n  nip98Required = false;\n  /**\n   * @param domain domain of the NIP96 service\n   */\n  constructor(domain, ndk) {\n    this.url = `https://${domain}${SPEC_PATH}`;\n    this.ndk = ndk;\n  }\n  async prepareUpload(blob, httpVerb = \"POST\") {\n    this.validateHttpFetch();\n    if (!this.spec)\n      await this.fetchSpec();\n    if (!this.spec)\n      throw new Error(\"Failed to fetch NIP96 spec\");\n    let headers = {};\n    if (this.nip98Required) {\n      const authorizationHeader = await this.generateNip98Header(\n        this.spec.api_url,\n        httpVerb,\n        blob\n      );\n      headers = { Authorization: authorizationHeader };\n    }\n    return {\n      url: this.spec.api_url,\n      headers\n    };\n  }\n  /**\n   * Provides an XMLHttpRequest-based upload method for browsers.\n   * @example\n   * const xhr = new XMLHttpRequest();\n   * xhr.upload.addEventListener(\"progress\", function(e) {\n   *    const percentComplete = e.loaded / e.total;\n   *    console.log(percentComplete);\n   * });\n   * const nip96 = ndk.getNip96(\"nostrcheck.me\");\n   * const blob = new Blob([\"Hello, world!\"], { type: \"text/plain\" });\n   * const response = await nip96.xhrUpload(xhr, blob);\n   * console.log(response);\n   * @returns Promise that resolves to the upload response\n   */\n  async xhrUpload(xhr, blob) {\n    const httpVerb = \"POST\";\n    const { url, headers } = await this.prepareUpload(blob, httpVerb);\n    xhr.open(httpVerb, url, true);\n    if (headers[\"Authorization\"]) {\n      xhr.setRequestHeader(\"Authorization\", headers[\"Authorization\"]);\n    }\n    const formData = new FormData();\n    formData.append(\"file\", blob);\n    return new Promise((resolve, reject) => {\n      xhr.onload = function() {\n        if (xhr.status >= 200 && xhr.status < 300) {\n          resolve(JSON.parse(xhr.responseText));\n        } else {\n          reject(new Error(xhr.statusText));\n        }\n      };\n      xhr.onerror = function() {\n        reject(new Error(\"Network Error\"));\n      };\n      xhr.send(formData);\n    });\n  }\n  /**\n   * Fetch-based upload method. Note that this will use NDK's httpFetch\n   * @param blob\n   * @returns Promise that resolves to the upload response\n   *\n   * @example\n   * const nip96 = ndk.getNip96(\"nostrcheck.me\");\n   * const blob = new Blob([\"Hello, world!\"], { type: \"text/plain\" });\n   * const response = await nip96.upload(blob);\n   * console.log(response);\n   */\n  async upload(blob) {\n    const httpVerb = \"POST\";\n    const { url, headers } = await this.prepareUpload(blob, httpVerb);\n    const formData = new FormData();\n    formData.append(\"file\", blob);\n    const res = await this.ndk.httpFetch(this.spec.api_url, {\n      method: httpVerb,\n      headers,\n      body: formData\n    });\n    if (res.status !== 200)\n      throw new Error(`Failed to upload file to ${url}`);\n    const json = await res.json();\n    if (json.status !== \"success\")\n      throw new Error(json.message);\n    return json;\n  }\n  validateHttpFetch() {\n    if (!this.ndk)\n      throw new Error(\"NDK is required to fetch NIP96 spec\");\n    if (!this.ndk.httpFetch)\n      throw new Error(\"NDK must have an httpFetch method to fetch NIP96 spec\");\n  }\n  async fetchSpec() {\n    this.validateHttpFetch();\n    const res = await this.ndk.httpFetch(this.url);\n    if (res.status !== 200)\n      throw new Error(`Failed to fetch NIP96 spec from ${this.url}`);\n    const spec = await res.json();\n    if (!spec)\n      throw new Error(`Failed to parse NIP96 spec from ${this.url}`);\n    this.spec = spec;\n    this.nip98Required = this.spec.plans.free.is_nip98_required;\n  }\n  async generateNip98Header(requestUrl, httpMethod, blob) {\n    const event = new NDKEvent(this.ndk, {\n      kind: 27235 /* HttpAuth */,\n      tags: [\n        [\"u\", requestUrl],\n        [\"method\", httpMethod]\n      ]\n    });\n    if ([\"POST\", \"PUT\", \"PATCH\"].includes(httpMethod)) {\n      const sha256Hash = await this.calculateSha256(blob);\n      event.tags.push([\"payload\", sha256Hash]);\n    }\n    await event.sign();\n    const encodedEvent = btoa(JSON.stringify(event.rawEvent()));\n    return `Nostr ${encodedEvent}`;\n  }\n  async calculateSha256(blob) {\n    const buffer = await blob.arrayBuffer();\n    const hashBuffer = await crypto.subtle.digest(\"SHA-256\", buffer);\n    const hashArray = Array.from(new Uint8Array(hashBuffer));\n    const hashHex = hashArray.map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n    return hashHex;\n  }\n};\n\n// src/ndk/queue/index.ts\nvar Queue = class {\n  queue = [];\n  maxConcurrency;\n  processing = /* @__PURE__ */ new Set();\n  promises = /* @__PURE__ */ new Map();\n  constructor(name, maxConcurrency) {\n    this.maxConcurrency = maxConcurrency;\n  }\n  add(item) {\n    if (this.promises.has(item.id)) {\n      return this.promises.get(item.id);\n    } else {\n    }\n    const promise = new Promise((resolve, reject) => {\n      this.queue.push({\n        ...item,\n        func: () => item.func().then(\n          (result) => {\n            resolve(result);\n            return result;\n          },\n          (error) => {\n            reject(error);\n            throw error;\n          }\n        )\n      });\n      this.process();\n    });\n    this.promises.set(item.id, promise);\n    promise.finally(() => {\n      this.promises.delete(item.id);\n      this.processing.delete(item.id);\n    });\n    return promise;\n  }\n  process() {\n    if (this.processing.size >= this.maxConcurrency || this.queue.length === 0) {\n      return;\n    }\n    const item = this.queue.shift();\n    if (!item || this.processing.has(item.id)) {\n      return;\n    }\n    this.processing.add(item.id);\n    item.func();\n  }\n  clear() {\n    this.queue = [];\n  }\n  clearProcessing() {\n    this.processing.clear();\n  }\n  clearAll() {\n    this.clear();\n    this.clearProcessing();\n  }\n  length() {\n    return this.queue.length;\n  }\n};\n\n// src/ndk/index.ts\nvar DEFAULT_OUTBOX_RELAYS = [\"wss://purplepag.es/\", \"wss://profiles.nos.social/\"];\nvar DEFAULT_BLACKLISTED_RELAYS = [\n  \"wss://brb.io/\",\n  // BRB\n  \"wss://nostr.mutinywallet.com/\",\n  // Don't try to read from this relay since it's a write-only relay\n  \"wss://purplepag.es/\"\n  // This is a hack, since this is a mostly read-only relay, but not fully. Once we have relay routing this can be removed so it only receives the supported kinds\n];\nvar NDK = class extends EventEmitter11 {\n  explicitRelayUrls;\n  pool;\n  outboxPool;\n  _signer;\n  _activeUser;\n  cacheAdapter;\n  debug;\n  devWriteRelaySet;\n  outboxTracker;\n  mutedIds;\n  clientName;\n  clientNip89;\n  queuesZapConfig;\n  queuesNip05;\n  /**\n   * Default relay-auth policy that will be used when a relay requests authentication,\n   * if no other policy is specified for that relay.\n   *\n   * @example Disconnect from relays that request authentication:\n   * ```typescript\n   * ndk.relayAuthDefaultPolicy = NDKAuthPolicies.disconnect(ndk.pool);\n   * ```\n   *\n   * @example Sign in to relays that request authentication:\n   * ```typescript\n   * ndk.relayAuthDefaultPolicy = NDKAuthPolicies.signIn({ndk})\n   * ```\n   *\n   * @example Sign in to relays that request authentication, asking the user for confirmation:\n   * ```typescript\n   * ndk.relayAuthDefaultPolicy = (relay: NDKRelay) => {\n   *     const signIn = NDKAuthPolicies.signIn({ndk});\n   *     if (confirm(`Relay ${relay.url} is requesting authentication, do you want to sign in?`)) {\n   *        signIn(relay);\n   *     }\n   * }\n   * ```\n   */\n  relayAuthDefaultPolicy;\n  /**\n   * Fetch function to use for HTTP requests.\n   *\n   * @example\n   * ```typescript\n   * import fetch from \"node-fetch\";\n   *\n   * ndk.httpFetch = fetch;\n   * ```\n   */\n  httpFetch;\n  autoConnectUserRelays = true;\n  autoFetchUserMutelist = true;\n  constructor(opts = {}) {\n    super();\n    this.debug = opts.debug || debug6(\"ndk\");\n    this.explicitRelayUrls = opts.explicitRelayUrls || [];\n    this.pool = new NDKPool(\n      opts.explicitRelayUrls || [],\n      opts.blacklistRelayUrls || DEFAULT_BLACKLISTED_RELAYS,\n      this\n    );\n    this.debug(`Starting with explicit relays: ${JSON.stringify(this.explicitRelayUrls)}`);\n    this.pool.on(\"relay:auth\", async (relay, challenge) => {\n      if (this.relayAuthDefaultPolicy) {\n        await this.relayAuthDefaultPolicy(relay, challenge);\n      }\n    });\n    this.autoConnectUserRelays = opts.autoConnectUserRelays ?? true;\n    this.autoFetchUserMutelist = opts.autoFetchUserMutelist ?? true;\n    this.clientName = opts.clientName;\n    this.clientNip89 = opts.clientNip89;\n    this.relayAuthDefaultPolicy = opts.relayAuthDefaultPolicy;\n    if (opts.enableOutboxModel) {\n      this.outboxPool = new NDKPool(\n        opts.outboxRelayUrls || DEFAULT_OUTBOX_RELAYS,\n        opts.blacklistRelayUrls || DEFAULT_BLACKLISTED_RELAYS,\n        this,\n        this.debug.extend(\"outbox-pool\")\n      );\n      this.outboxTracker = new OutboxTracker(this);\n    }\n    this.signer = opts.signer;\n    this.cacheAdapter = opts.cacheAdapter;\n    this.mutedIds = opts.mutedIds || /* @__PURE__ */ new Map();\n    if (opts.devWriteRelayUrls) {\n      this.devWriteRelaySet = NDKRelaySet.fromRelayUrls(opts.devWriteRelayUrls, this);\n    }\n    this.queuesZapConfig = new Queue(\"zaps\", 3);\n    this.queuesNip05 = new Queue(\"nip05\", 10);\n    try {\n      this.httpFetch = fetch;\n    } catch {\n    }\n  }\n  /**\n   * Adds an explicit relay to the pool.\n   * @param url\n   * @param relayAuthPolicy Authentication policy to use if different from the default\n   * @param connect Whether to connect to the relay automatically\n   * @returns\n   */\n  addExplicitRelay(urlOrRelay, relayAuthPolicy, connect = true) {\n    let relay;\n    if (typeof urlOrRelay === \"string\") {\n      relay = new NDKRelay(urlOrRelay, relayAuthPolicy);\n    } else {\n      relay = urlOrRelay;\n    }\n    this.pool.addRelay(relay, connect);\n    this.explicitRelayUrls.push(relay.url);\n    return relay;\n  }\n  toJSON() {\n    return { relayCount: this.pool.relays.size }.toString();\n  }\n  get activeUser() {\n    return this._activeUser;\n  }\n  /**\n   * Sets the active user for this NDK instance, typically this will be\n   * called when assigning a signer to the NDK instance.\n   *\n   * This function will automatically connect to the user's relays if\n   * `autoConnectUserRelays` is set to true.\n   *\n   * It will also fetch the user's mutelist if `autoFetchUserMutelist` is set to true.\n   */\n  set activeUser(user) {\n    const differentUser = this._activeUser?.pubkey !== user?.pubkey;\n    this._activeUser = user;\n    if (user && differentUser) {\n      const connectToUserRelays = async (user2) => {\n        const relayList = await NDKRelayList.forUser(user2.pubkey, this);\n        if (!relayList) {\n          this.debug(\"No relay list found for user\", { npub: user2.npub });\n          return;\n        }\n        this.debug(\"Connecting to user relays\", {\n          npub: user2.npub,\n          relays: relayList.relays\n        });\n        for (const url of relayList.relays) {\n          let relay = this.pool.relays.get(url);\n          if (!relay) {\n            relay = new NDKRelay(url);\n            this.pool.addRelay(relay);\n          }\n        }\n      };\n      const fetchBlockedRelays = async (user2) => {\n        const blockedRelays = await this.fetchEvent({\n          kinds: [10006 /* BlockRelayList */],\n          authors: [user2.pubkey]\n        });\n        if (blockedRelays) {\n          const list = lists_default.from(blockedRelays);\n          for (const item of list.items) {\n            this.pool.blacklistRelayUrls.add(item[0]);\n          }\n        }\n        this.debug(\"Blocked relays\", { blockedRelays });\n      };\n      const fetchUserMuteList = async (user2) => {\n        const muteList = await this.fetchEvent({\n          kinds: [1e4 /* MuteList */],\n          authors: [user2.pubkey]\n        });\n        if (muteList) {\n          const list = lists_default.from(muteList);\n          for (const item of list.items) {\n            this.mutedIds.set(item[1], item[0]);\n          }\n        }\n      };\n      const userFunctions = [fetchBlockedRelays];\n      if (this.autoConnectUserRelays)\n        userFunctions.push(connectToUserRelays);\n      if (this.autoFetchUserMutelist)\n        userFunctions.push(fetchUserMuteList);\n      const runUserFunctions = async (user2) => {\n        for (const fn of userFunctions) {\n          await fn(user2);\n        }\n      };\n      const pool = this.outboxPool || this.pool;\n      if (pool.connectedRelays.length > 0) {\n        runUserFunctions(user);\n      } else {\n        this.debug(\"Waiting for connection to main relays\");\n        pool.once(\"connect\", () => {\n          runUserFunctions(user);\n        });\n      }\n    } else if (!user) {\n      this.mutedIds = /* @__PURE__ */ new Map();\n    }\n  }\n  get signer() {\n    return this._signer;\n  }\n  set signer(newSigner) {\n    this._signer = newSigner;\n    this.emit(\"signer:ready\", newSigner);\n    newSigner?.user().then((user) => {\n      user.ndk = this;\n      this.activeUser = user;\n    });\n  }\n  /**\n   * Connect to relays with optional timeout.\n   * If the timeout is reached, the connection will be continued to be established in the background.\n   */\n  async connect(timeoutMs) {\n    if (this._signer && this.autoConnectUserRelays) {\n      this.debug(\"Attempting to connect to user relays specified by signer\");\n      if (this._signer.relays) {\n        const relays = await this._signer.relays();\n        relays.forEach((relay) => this.pool.addRelay(relay));\n      }\n    }\n    const connections = [this.pool.connect(timeoutMs)];\n    if (this.outboxPool) {\n      connections.push(this.outboxPool.connect(timeoutMs));\n    }\n    this.debug(\"Connecting to relays\", { timeoutMs });\n    return Promise.allSettled(connections).then(() => {\n    });\n  }\n  /**\n   * Get a NDKUser object\n   *\n   * @param opts\n   * @returns\n   */\n  getUser(opts) {\n    const user = new NDKUser(opts);\n    user.ndk = this;\n    return user;\n  }\n  /**\n   * Get a NDKUser from a NIP05\n   * @param nip05 NIP-05 ID\n   * @param skipCache Skip cache\n   * @returns\n   */\n  async getUserFromNip05(nip05, skipCache = false) {\n    return NDKUser.fromNip05(nip05, this, skipCache);\n  }\n  /**\n   * Create a new subscription. Subscriptions automatically start, you can make them automatically close when all relays send back an EOSE by setting `opts.closeOnEose` to `true`)\n   *\n   * @param filters\n   * @param opts\n   * @param relaySet explicit relay set to use\n   * @param autoStart automatically start the subscription\n   * @returns NDKSubscription\n   */\n  subscribe(filters, opts, relaySet, autoStart = true) {\n    const subscription = new NDKSubscription(this, filters, opts, relaySet);\n    if (relaySet) {\n      for (const relay of relaySet.relays) {\n        this.pool.useTemporaryRelay(relay);\n      }\n    }\n    if (this.outboxPool && subscription.hasAuthorsFilter()) {\n      const authors = subscription.filters.filter((filter) => filter.authors && filter.authors?.length > 0).map((filter) => filter.authors).flat();\n      this.outboxTracker?.trackUsers(authors);\n    }\n    if (autoStart)\n      subscription.start();\n    return subscription;\n  }\n  /**\n   * Publish an event to a relay\n   * @param event event to publish\n   * @param relaySet explicit relay set to use\n   * @param timeoutMs timeout in milliseconds to wait for the event to be published\n   * @returns The relays the event was published to\n   *\n   * @deprecated Use `event.publish()` instead\n   */\n  async publish(event, relaySet, timeoutMs) {\n    this.debug(\"Deprecated: Use `event.publish()` instead\");\n    return event.publish(relaySet, timeoutMs);\n  }\n  /**\n   * Fetch a single event.\n   *\n   * @param idOrFilter event id in bech32 format or filter\n   * @param opts subscription options\n   * @param relaySetOrRelay explicit relay set to use\n   */\n  async fetchEvent(idOrFilter, opts, relaySetOrRelay) {\n    let filter;\n    let relaySet;\n    if (relaySetOrRelay instanceof NDKRelay) {\n      relaySet = new NDKRelaySet(/* @__PURE__ */ new Set([relaySetOrRelay]), this);\n    } else if (relaySetOrRelay instanceof NDKRelaySet) {\n      relaySet = relaySetOrRelay;\n    }\n    if (!relaySetOrRelay && typeof idOrFilter === \"string\") {\n      if (!isNip33AValue(idOrFilter)) {\n        const relays = relaysFromBech32(idOrFilter);\n        if (relays.length > 0) {\n          relaySet = new NDKRelaySet(new Set(relays), this);\n          relaySet = correctRelaySet(relaySet, this.pool);\n        }\n      }\n    }\n    if (typeof idOrFilter === \"string\") {\n      filter = filterFromId(idOrFilter);\n    } else {\n      filter = idOrFilter;\n    }\n    if (!filter) {\n      throw new Error(`Invalid filter: ${JSON.stringify(idOrFilter)}`);\n    }\n    return new Promise((resolve) => {\n      let fetchedEvent = null;\n      const s = this.subscribe(\n        filter,\n        { ...opts || {}, closeOnEose: true },\n        relaySet,\n        false\n      );\n      s.on(\"event\", (event) => {\n        event.ndk = this;\n        if (!event.isReplaceable()) {\n          resolve(event);\n        } else if (!fetchedEvent || fetchedEvent.created_at < event.created_at) {\n          fetchedEvent = event;\n        }\n      });\n      s.on(\"eose\", () => {\n        resolve(fetchedEvent);\n      });\n      s.start();\n    });\n  }\n  /**\n   * Fetch events\n   */\n  async fetchEvents(filters, opts, relaySet) {\n    return new Promise((resolve) => {\n      const events = /* @__PURE__ */ new Map();\n      const relaySetSubscription = this.subscribe(\n        filters,\n        { ...opts || {}, closeOnEose: true },\n        relaySet,\n        false\n      );\n      const onEvent = (event) => {\n        const dedupKey = event.deduplicationKey();\n        const existingEvent = events.get(dedupKey);\n        if (existingEvent) {\n          event = dedup(existingEvent, event);\n        }\n        event.ndk = this;\n        events.set(dedupKey, event);\n      };\n      relaySetSubscription.on(\"event\", onEvent);\n      relaySetSubscription.on(\"event:dup\", onEvent);\n      relaySetSubscription.on(\"eose\", () => {\n        resolve(new Set(events.values()));\n      });\n      relaySetSubscription.start();\n    });\n  }\n  /**\n   * Ensures that a signer is available to sign an event.\n   */\n  assertSigner() {\n    if (!this.signer) {\n      this.emit(\"signerRequired\");\n      throw new Error(\"Signer required\");\n    }\n  }\n  /**\n   * Creates a new Nip96 instance for the given domain.\n   * @param domain Domain to use for nip96 uploads\n   * @example Upload a file to a NIP-96 enabled domain:\n   *\n   * ```typescript\n   * const blob = new Blob([\"Hello, world!\"], { type: \"text/plain\" });\n   * const nip96 = ndk.getNip96(\"nostrcheck.me\");\n   * await nip96.upload(blob);\n   * ```\n   */\n  getNip96(domain) {\n    return new Nip96(domain, this);\n  }\n  /**\n   * Creates a new Nostr Wallet Connect instance for the given URI and waits for it to be ready.\n   * @param uri WalletConnect URI\n   * @param connectTimeout Timeout in milliseconds to wait for the NWC to be ready. Set to `false` to avoid connecting.\n   * @example\n   * const nwc = await ndk.nwc(\"nostr+walletconnect://....\")\n   * nwc.payInvoice(\"lnbc...\")\n   */\n  async nwc(uri, connectTimeout = 2e3) {\n    const nwc = await NDKNwc.fromURI(this, uri);\n    if (connectTimeout !== false) {\n      await nwc.blockUntilReady(connectTimeout);\n    }\n    return nwc;\n  }\n};\n\n// src/zap/invoice.ts\nimport { decode } from \"light-bolt11-decoder\";\nfunction zapInvoiceFromEvent(event) {\n  const description = event.getMatchingTags(\"description\")[0];\n  const bolt11 = event.getMatchingTags(\"bolt11\")[0];\n  let decodedInvoice;\n  let zapRequest;\n  if (!description || !bolt11 || !bolt11[1]) {\n    return null;\n  }\n  try {\n    let zapRequestPayload = description[1];\n    if (zapRequestPayload.startsWith(\"%\")) {\n      zapRequestPayload = decodeURIComponent(zapRequestPayload);\n    }\n    if (zapRequestPayload === \"\") {\n      return null;\n    }\n    zapRequest = JSON.parse(zapRequestPayload);\n    decodedInvoice = decode(bolt11[1]);\n  } catch (e) {\n    return null;\n  }\n  const amountSection = decodedInvoice.sections.find((s) => s.name === \"amount\");\n  if (!amountSection) {\n    return null;\n  }\n  const amount = parseInt(amountSection.value);\n  if (!amount) {\n    return null;\n  }\n  const content = zapRequest.content;\n  const sender = zapRequest.pubkey;\n  const recipientTag = event.getMatchingTags(\"p\")[0];\n  const recipient = recipientTag[1];\n  let zappedEvent = event.getMatchingTags(\"e\")[0];\n  if (!zappedEvent) {\n    zappedEvent = event.getMatchingTags(\"a\")[0];\n  }\n  const zappedEventId = zappedEvent ? zappedEvent[1] : void 0;\n  const zapInvoice = {\n    id: event.id,\n    zapper: event.pubkey,\n    zappee: sender,\n    zapped: recipient,\n    zappedEvent: zappedEventId,\n    amount,\n    comment: content\n  };\n  return zapInvoice;\n}\nexport {\n  NDKAppHandlerEvent,\n  NDKArticle,\n  NDKClassified,\n  NDKDVMJobFeedback,\n  NDKDVMJobResult,\n  NDKDVMRequest,\n  NDKDvmJobFeedbackStatus,\n  NDKEvent,\n  NDKHighlight,\n  NDKKind,\n  NDKList,\n  NDKListKinds,\n  NDKNip07Signer,\n  NDKNip46Backend,\n  NDKNip46Signer,\n  NDKNostrRpc,\n  NDKNwc,\n  NDKPrivateKeySigner,\n  NDKRelay,\n  NDKRelayAuthPolicies,\n  NDKRelayList,\n  NDKRelaySet,\n  NDKRelayStatus,\n  NDKRepost,\n  NDKSimpleGroup,\n  NDKSubscription,\n  NDKSubscriptionCacheUsage,\n  NDKSubscriptionReceipt,\n  NDKSubscriptionStart,\n  NDKSubscriptionTier,\n  NDKTranscriptionDVM,\n  NDKUser,\n  NDKVideo,\n  NDKZap,\n  NIP33_A_REGEX,\n  PublishError,\n  calculateGroupableId,\n  calculateTermDurationInSeconds,\n  compareFilter,\n  NDK as default,\n  defaultOpts,\n  dvmSchedule,\n  eventHasETagMarkers,\n  eventIsPartOfThread,\n  eventIsReply,\n  eventReplies,\n  eventThreadIds,\n  eventThreads,\n  eventsBySameAuthor,\n  filterFromId,\n  generateSubId,\n  getEventReplyIds,\n  getRootEventId,\n  isEventOriginalPost,\n  isNip33AValue,\n  mergeFilters,\n  newAmount,\n  parseTagToSubscriptionAmount,\n  pinEvent,\n  possibleIntervalFrequencies,\n  profileFromEvent,\n  queryFullyFilled,\n  relaysFromBech32,\n  serializeProfile,\n  zapInvoiceFromEvent\n};\n","<script>\r\n  import { onMount } from 'svelte';\r\n  import { eventsStore } from './utils/eventsStore';\r\n  import { SimplePool } from 'nostr-tools';\r\n  import NDK, { NDKNip07Signer } from \"@nostr-dev-kit/ndk\";\r\n  import { navigate } from 'svelte-routing';\r\n\r\n  let events = [];\r\n  const RELAYS_URL = [\r\n    'wss://relay.snort.social',\r\n    'wss://relay.primal.net',\r\n    'wss://relay.damus.io'\r\n  ];\r\n\r\n  const nip07signer = new NDKNip07Signer();\r\n  let publicKey = {};\r\n\r\n  async function extlogin() {\r\n    try {\r\n      if (publicKey.pubkey) {\r\n        console.log(\"Permission granted to read their public key:\", publicKey.pubkey);\r\n      }\r\n\r\n      publicKey = await nip07signer.user();\r\n\r\n      const pool = new SimplePool();\r\n      const subEvents = pool.sub(RELAYS_URL, [{\r\n        kinds: [0],\r\n        authors: [publicKey.pubkey]\r\n      }]);\r\n\r\n      subEvents.on('event', (event) => {\r\n        events = [...events, event];\r\n        eventsStore.set(events);\r\n      });\r\n\r\n      navigate('/todoPage');\r\n\r\n    } catch (error) {\r\n      console.error('Login failed:', error.message);\r\n      alert(error.message);\r\n    }\r\n  }\r\n</script>\r\n\r\n<div class=\"wrapper\">\r\n  <img class=\"logo\" src=\"./css/zaplan_logo.png\">\r\n\r\n  <p class=\"title\">\r\n    Welcome to Zaplan! Your Ultimate nostr based To-Do List App!\r\n  </p>\r\n  <p class=\"description\">\r\n    Stay organized and boost your productivity with Zaplan. \r\n  </p>\r\n    <button class=\"btn\" on:click={extlogin}>Login With A Nostr Extension</button>\r\n    <div class=\"register-link\">\r\n        <p>Don't have a nostr extension?</p>\r\n        <p>Check out these nostr extension options:</p>\r\n        <ul>\r\n            <li>\r\n                Chrome: <a href=\"https://chromewebstore.google.com/detail/ampjiinddmggbhpebhaegmjkbbeofoaj\">Nostr Connect</a>\r\n            </li>\r\n            <li>\r\n                FireFox: <a href=\"https://addons.mozilla.org/en-US/firefox/addon/nostr-connect/?utm_source=addons.mozilla.org&utm_medium=referral&utm_content=search\">Nostr Connect</a>\r\n            </li>\r\n            <li>\r\n                Safari (iOS): <a href=\"https://apps.apple.com/us/app/nostore/id1666553677\">Nostore__</a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n","// Import Svelte components\r\nimport App from './App.svelte';\r\nimport Login from './Login.svelte';\r\nimport TodoPage from './routes/TodoPage.svelte'\r\n\r\n// Create the Svelte app instance\r\nconst app = new App({\r\n    target: document.body,\r\n    props: {\r\n        Login,\r\n        TodoPage\r\n          }\r\n});\r\n"],"names":["noop","identity","x","assign","tar","src","k","is_promise","value","then","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","src_url_equal_anchor","src_url_equal","element_src","url","document","createElement","href","is_empty","obj","keys","length","subscribe","store","callbacks","unsub","unsubscribe","component_subscribe","component","callback","$$","on_destroy","push","create_slot","definition","ctx","$$scope","slot_ctx","get_slot_context","slice","get_slot_changes","dirty","lets","undefined","merged","len","Math","max","i","update_slot_base","slot","slot_definition","slot_changes","get_slot_context_fn","slot_context","p","get_all_dirty_from_scope","exclude_internal_props","props","result","is_client","window","now","performance","Date","raf","cb","requestAnimationFrame","tasks","Set","run_tasks","task","c","delete","f","size","loop","promise","Promise","fulfill","add","abort","append","target","node","appendChild","get_root_for_style","root","getRootNode","ownerDocument","host","append_empty_stylesheet","style_element","element","append_stylesheet","sheet","style","head","insert","anchor","insertBefore","detach","parentNode","removeChild","name","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","removeAttribute","getAttribute","setAttribute","children","Array","from","childNodes","custom_event","type","detail","bubbles","cancelable","e","createEvent","initCustomEvent","construct_svelte_component","managed_styles","Map","active","current_component","hash","str","charCodeAt","create_style_information","doc","info","stylesheet","rules","set","create_rule","duration","delay","ease","uid","step","keyframes","t","rule","get","insertRule","cssRules","animation","delete_rule","previous","split","next","filter","anim","indexOf","deleted","join","clear_rules","ownerNode","clear","set_current_component","get_current_component","Error","onMount","on_mount","onDestroy","setContext","key","context","getContext","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","resolve","update_scheduled","schedule_update","flush","add_render_callback","seen_callbacks","flushidx","saved_component","update","pop","has","fragment","before_update","after_update","flush_render_callbacks","filtered","targets","wait","dispatch","direction","kind","dispatchEvent","outroing","outros","group_outros","r","check_outros","transition_in","block","local","transition_out","o","d","null_transition","create_in_transition","params","animation_name","config","running","cleanup","go","easing","tick","css","start_time","end_time","started","start","invalidate","end","create_out_transition","group","reset","handle_promise","token","index","resolved","child_ctx","current","needs_flush","blocks","m","mount","error","catch","hasCatch","pending","update_await_block_branch","get_spread_update","levels","updates","to_null_out","accounted_for","n","get_spread_object","spread_props","create_component","mount_component","customElement","new_on_destroy","map","destroy_component","detaching","make_dirty","fill","init","instance","create_fragment","not_equal","append_styles","parent_component","bound","on_disconnect","skip_bound","ready","ret","rest","hydrate","nodes","l","intro","SvelteComponent","$destroy","this","$on","splice","$set","$$props","$$set","LOCATION","ROUTER","HISTORY","PARAM","SEGMENT_POINTS","STATIC_POINTS","DYNAMIC_POINTS","SPLAT_PENALTY","ROOT_POINTS","segmentize","uri","replace","stripSlashes","string","rankRoute","route","score","default","path","reduce","segment","test","rankRoutes","routes","sort","pick","match","default_","uriPathname","uriSegments","isRootUri","ranked","missed","routeSegments","routeSegment","uriSegment","decodeURIComponent","dynamicMatch","exec","combinePaths","basepath","canUseDOM","switch_instance_spread_levels","if_block","create_if_block","routeParams","routeProps","registerRoute","unregisterRoute","activeRoute","$activeRoute","$$invalidate","toString","startsWith","preserveScroll","scrollTo","subscriber_queue","readable","writable","stop","subscribers","new_value","run_queue","subscriber","derived","stores","initial_value","single","isArray","stores_array","auto","values","sync","unsubscribers","getLocation","source","location","state","history","createHistory","listeners","listener","popstateListener","action","navigate","to","blurActiveElement","replaceState","pushState","activeElement","blur","createMemorySource","initialPathname","stack","pathname","search","states","entries","_","globalHistory","previous_key","div","viewtransition","locationContext","routerContext","hasActiveRoute","base","routerBase","$base","_path","matchingRoute","$location","rs","bestMatch","$routes","vt","eventsStore","getEvents","img","img_src_value","html","body","header","div3","div0","div1","div2","div4","script","profilePicture","content","JSON","parse","picture","TodoPage","main","Login","number","Number","isSafeInteger","bool","bytes","lengths","Uint8Array","includes","outputLen","blockLen","exists","checkFinished","destroyed","finished","output","out","min","assert","crypto","globalThis","u8a","createView","arr","DataView","buffer","byteOffset","byteLength","rotr","word","shift","isLE","Uint32Array","hexes","v","padStart","bytesToHex","hex","hexToBytes","array","j","hexByte","byte","parseInt","isNaN","utf8ToBytes","TextEncoder","encode","toBytes","concatBytes","arrays","sum","pad","Hash$4","clone","_cloneInto","wrapConstructor","hashCons","hashC","msg","digest","tmp","randomBytes","bytesLength","getRandomValues","setBigUint64","view","_32n","BigInt","_u32_max","wh","wl","h","setUint32","Hash","constructor","padOffset","super","pos","take","subarray","process","dataView","roundClean","digestInto","oview","outLen","res","destroy","Chi","Maj","SHA256_K","IV","SHA256_W","SHA2","A","B","C","D","E","F","G","H","offset","getUint32","W15","W2","s0","s1","T1","T2","SHA256","sha256","SHA224","_0n","_1n","_2n","numberToHexUnpadded","num","hexToNumber","bytesToNumberBE","bytesToNumberLE","reverse","numberToBytesBE","numberToBytesLE","numberToVarBytesBE","ensureBytes","title","expectedLength","equalBytes","b1","b2","bitLen","bitGet","bitSet","bitMask","u8n","u8fr","createHmacDrbg","hashLen","qByteLen","hmacFn","reseed","seed","gen","sl","pred","validatorFns","bigint","val","function","boolean","field","object","Fp","isValid","validateObject","validators","optValidators","checkField","fieldName","isOptional","checkVal","String","_3n","_4n","_5n","_8n","mod","pow","power","modulo","pow2","invert","u","tonelliShanks","P","legendreC","Q","S","Z","p1div4","eql","sqr","Q1div2","neg","ONE","g","mul","ZERO","t2","ge","FpSqrt","c1","n2","nv","sub","FIELD_FIELDS","validateField","ORDER","MASK","BYTES","BITS","FpPow","FpInvertBatch","nums","lastMultiplied","acc","is0","inverted","inv","reduceRight","nLength","nBitLength","_nBitLength","nByteLength","ceil","Field","redef","sqrtP","freeze","isOdd","lhs","rhs","sqrN","addN","subN","mulN","sqrt","invertBatch","lst","cmov","fromBytes","hashToPrivateScalar","groupOrder","minLen","wNAF","bits","constTimeNegate","condition","item","negate","opts","W","windows","windowSize","unsafeLadder","elm","double","precomputeWindow","points","precomputes","BASE","mask","maxNumber","shiftBy","wbits","offset1","offset2","abs","cond1","cond2","wNAFCached","precomputesMap","transform","_WINDOW_SIZE","comp","validateBasic","curve","Gx","Gy","validatePointOpts","ut.validateObject","allowedPrivateKeyLengths","wrapPrivateKey","isTorsionFree","clearCofactor","allowInfinityPoint","endo","beta","splitScalar","b2n","h2b","ut","DER","Err","_parseInt","toSig","sBytes","s","rBytesLeft","hexFromSig","sig","shl","rhl","rl","weierstrassPoints","CURVE","point","isCompressed","toAffine","ut.concatBytes","y","tail","weierstrassEquation","x2","x3","isWithinCurveOrder","assertGE","normPrivateKeyToScalar","ut.bytesToHex","ut.bytesToNumberBE","mod.mod","pointPrecomputes","assertPrjPoint","other","Point","px","py","pz","fromAffine","normalizeZ","toInv","fromHex","assertValidity","fromPrivateKey","privateKey","multiply","_setWindowSize","left","right","hasEvenY","equals","X1","Y1","Z1","X2","Y2","Z2","U1","U2","b3","X3","Y3","Z3","t0","t1","t3","t4","t5","subtract","wnaf","multiplyUnsafe","I","k1neg","k1","k2neg","k2","k1p","k2p","scalar","fake","f1p","f2p","multiplyAndAddUnsafe","iz","z","ax","ay","zz","cofactor","toRawBytes","toHex","_bits","ProjectivePoint","validateOpts","hmac","bits2int","bits2int_modN","lowS","weierstrass","curveDef","CURVE_ORDER","compressedLen","uncompressedLen","modN","invN","mod.invert","cat","y2","numToNByteStr","ut.numberToBytesBE","isBiggerThanHalfOrder","slcNum","Signature","recovery","fromCompact","fromDER","addRecoveryBit","recoverPublicKey","msgHash","rec","radj","prefix","R","ir","u1","u2","hasHighS","normalizeS","toDERRawBytes","ut.hexToBytes","toDERHex","toCompactRawBytes","toCompactHex","utils","isValidPrivateKey","randomPrivateKey","mod.hashToPrivateScalar","precompute","isProbPub","delta","ORDER_MASK","ut.bitMask","int2octets","prepSig","defaultSigOpts","some","prehash","extraEntropy","ent","h1int","seedArgs","k2sig","kBytes","ik","q","normS","defaultVerOpts","getPublicKey","getSharedSecret","privateA","publicB","sign","privKey","ut.createHmacDrbg","drbg","verify","signature","publicKey","sg","_sig","derError","message","is","_key","iHash","oHash","buf","getPrototypeOf","HMAC","getHash","msgs","createCurve","defHash","secp256k1P","secp256k1N","divNearest","sqrtMod","_6n","_11n","_22n","_23n","_44n","_88n","b6","b9","b11","b22","b44","b88","b176","b220","b223","secp256k1","a1","a2","POW_2_128","c2","fe","TAGGED_HASH_PREFIXES","taggedHash","tag","messages","tagP","tagH","pointToBytes","numTo32b","modP","GmulAdd","schnorrGetExtPubKey","priv","d_","lift_x","xx","challenge","args","schnorrGetPublicKey","schnorrSign","auxRand","rand","k_","rx","schnorrVerify","pub","schnorr","assertNumber","chain","wrap","decode","alphabet","digits","input","letter","separator","padding","chr","normalize","convertRadix","carry","done","digit","digitBase","floor","gcd","radix2carry","convertRadix2","radix","radix2","revPadding","unsafeWrapper","apply","base16","base32","toUpperCase","base64","base64url","genBase58","abc","base58","XMR_BLOCK_LEN","base58xmr","concat","BECH_ALPHABET","POLYMOD_GENERATORS","bech32Polymod","pre","chk","bechChecksum","words","encodingConst","genBech32","encoding","ENCODING_CONST","_words","fromWords","toWords","fromWordsUnsafe","limit","TypeError","lowered","toLowerCase","sepIndex","lastIndexOf","endsWith","actualLength","decodeToBytes","decodeUnsafe","bech32","utf8","TextDecoder","CODERS","wordlist","isBytes","assert$3","Hash$3","toStr","checkOpts","defaults","call","assertHash","assertExists","assertBytes","pbkdf2Init","_password","_salt","_opts","dkLen","asyncTick","password","salt","DK","PRF","PRFSalt","pbkdf2Output","prfW","pbkdf2","ti","Ti","setInt32","ui","U32_MASK64","fromBig","le","Ah","Al","toBig","shrSH","_l","shrSL","rotrSH","rotrSL","rotrBH","rotrBL","rotr32H","_h","rotr32L","rotlSH","rotlSL","rotlBH","rotlBL","Bh","Bl","add3L","Cl","add3H","low","Ch","add4L","Dl","add4H","Dh","add5L","El","add5H","Eh","u64","u64$3","SHA512_Kh","SHA512_Kl","SHA512_W_H","SHA512_W_L","Fh","Fl","Gh","Gl","Hh","Hl","W15h","W15l","s0h","s0l","W2h","W2l","s1h","s1l","SUMl","SUMh","sigma1h","sigma1l","CHIh","CHIl","T1ll","T1h","T1l","sigma0h","sigma0l","MAJh","MAJl","All","sha512","SHA512","id","rounded","checksum","payload","newChecksum","oldChecksum","createBase58check","base58check","isJapanese","nfkd","norm","assertEntropy","entropy","generateMnemonic","strength","entropyToMnemonic","calcChecksum","bitsLeft","getCoder","baseUtils","mnemonicToEntropy","mnemonic","validateMnemonic","passphrase","mnemonicToSeedSync","asciis","_0","_9","_A","_F","_a","_f","asciiToBase16","char","hl","al","ai","hi","n1","Hash$2","Rho","Id","Pi","idxL","idxR","shifts","shiftsL","idx","shiftsR","Kl","Kr","rotl","BUF","RIPEMD160","h0","h1","h2","h3","h4","ar","bl","br","cl","cr","dl","dr","el","er","rGroup","hbl","hbr","rr","sr","tl","tr","ripemd160","u64$1","Hash$1","secp","base58checker","bytesToNumber","numberToBytes","MASTER_SECRET","BITCOIN_VERSIONS","private","public","HARDENED_OFFSET","hash160","fromU32","toU32","HDKey","fingerprint","pubHash","identifier","pubKeyHash","privKeyBytes","pubKey","privateExtendedKey","serialize","versions","publicExtendedKey","fromMasterSeed","chainCode","fromExtendedKey","base58key","keyBuffer","keyView","version","opt","depth","parentFingerprint","isPriv","fromJSON","json","xpriv","derive","parts","child","deriveChild","childTweak","added","err","wipePrivateData","toJSON","xpub","u32","isPlainObject","prototype","isSame","u8to16","Poly1305","Uint16Array","t6","t7","isLast","hibit","r0","r1","r2","r3","r4","r5","r6","r7","r8","r9","h5","h6","h7","h8","h9","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","finalize","opos","wrapConstructorWithKey","sigma16","sigma32","sigma16_32","sigma32_32","isAligned32","salsaBasic","core","rounds","counterRight","counterLen","allow128bitKeys","extendNonceFn","blockLen32","nonce","counter","toClean","sigma","nonceLen","nc","b32","k32","n32","d32","o32","ctr","pos32","chachaCore","cnt","y00","y01","y02","y03","y04","y05","y06","y07","y08","y09","y10","y11","y12","y13","y14","y15","x00","x01","x02","x03","x04","x05","x06","x07","x08","x09","x10","x11","x12","x13","x14","x15","oi","chacha20","extract","ikm","HKDF_COUNTER","EMPTY_BUFFER","expand","prk","okm","HMACTmp","T","hkdf","__defProp","defineProperty","__export","all","enumerable","utils_exports","MessageNode","MessageQueue","insertEventIntoAscendingList","insertEventIntoDescendingList","normalizeURL","utf8Decoder","utf8Encoder","URL","port","protocol","searchParams","sortedArray","midPoint","position","created_at","_value","_next","_first","_last","first","messageNode","last","_size","enqueue","newNode","dequeue","prev","verifiedSymbol","Symbol","getBlankEvent","tags","finishEvent","pubkey","getEventHash","getSignature","serializeEvent","evt","validateEvent","stringify","bytesToHex2","isRecord","verifySignature","schnorr2","matchFilter","ids","kinds","authors","find","since","until","matchFilters","filters","mergeFilters","property","fakejson_exports","getHex64","getInt","sliced","getSubscriptionId","pstart","pend","matchEventId","matchEventPubkey","matchEventKind","newListeners","connect","disconnect","notice","auth","relayInit","listTimeout","getTimeout","countTimeout","ws","connectionPromise","openSubs","subListeners","pubListeners","connected","readyState","async","trySend","setTimeout","send","console","log","verb","skipVerification","alreadyHaveEvent","random","subid","subscription","newFilters","newOpts","on","count","eose","off","listeners2","events","eventsGenerator","_publishEvent","reject","list","timeout","clearTimeout","publish","WebSocket","onopen","onerror","onclose","handleNextInterval","incomingMessageQueue","handleNext","clearInterval","so","id2","ok","reason","resolve2","reject2","onmessage","setInterval","connectRelay","close","OPEN","status","nextResolve","eventQueue","pushToQueue","SimplePool","_conn","_seenOn","batchedByKey","eoseSubTimeout","seenOnEnabled","batchInterval","relays","relay","ensureRelay","nm","_knownIds","modifiedOpts","subs","eventListeners","eoseListeners","eosesMissing","eoseSent","eoseTimeout","handleEose","greaterSub","filters2","opts2","batchedList","batchKey","batchKey2","batchedRequests","relays2","seenOn","nip19_exports","BECH32_REGEX","naddrEncode","neventEncode","noteEncode","nprofileEncode","npubEncode","nrelayEncode","nsecEncode","Bech32MaxSize","integerToUint8Array","uint8Array","nip19","tlv","parseTLV","bytesToHex3","author","encodeBytes","encodeBech32","profile","encodeTLV","kindArray","addr","ArrayBuffer","vs","entry","nip04_exports","encrypt","privkey","normalizedKey","getNormalizedX","iv","plaintext","cryptoKey","subtle","importKey","ciphertext","decrypt","ctb64","ivb64","webcrypto","nip05_exports","NIP05_REGEX","queryProfile","searchDomain","useFetchImplementation","_fetch","fetch","fetchImplementation","domain","query","names","fullname","parseNIP05Result","_e","nip06_exports","privateKeyFromSeedWords","bytesToHex4","generateSeedWords","validateWords","nip10_exports","reply","mentions","profiles","eTags","eTagIndex","eTag","eTagEventId","eTagRelayUrl","eTagMarker","eventPointer","isFirstETag","isLastETag","nip13_exports","getPow","nibble","clz32","minePow","unsigned","difficulty","getTime","nip18_exports","finishRepostEvent","reposted","relayUrl","getRepostedEventPointer","lastETag","lastPTag","getRepostedEvent","pointer","repostedEvent","nip21_exports","NOSTR_URI_REGEX","parse2","RegExp","decoded","nip25_exports","finishReactionEvent","reacted","inheritedTags","getReactedEventPointer","nip26_exports","createDelegation","parameters","conditions","cond","sighash","sha2562","bytesToHex5","schnorr3","getDelegator","tag2","operator","nip27_exports","matchAll","regex","replaceAll","matches","replacer","nip28_exports","channelCreateEvent","channelHideMessageEvent","channelMessageEvent","channelMetadataEvent","channelMuteUserEvent","channel_create_event_id","relay_url","reply_to_channel_message_event_id","channel_message_event_id","pubkey_to_mute","nip39_exports","_fetch2","useFetchImplementation2","validateGithub","username","proof","nip42_exports","authenticate","nip44_exports","decrypt2","encrypt2","v2","maxPlaintextSize","minCiphertextSize","maxCiphertextSize","getConversationKey","privkeyA","pubkeyB","secp256k12","getMessageKeys","conversationKey","sha2563","encryption","calcPadding","nextpower","log2","chunk","unpadded","unpaddedB","paddedLen","zeros","lenBuf","setUint16","concatBytes2","unpad","padded","unpaddedLen","getUint16","randomBytes2","mac","base642","clen","vers","ciphertext_","nip47_exports","parseConnectionString","connectionString","secret","makeNwcRequestEvent","invoice","method","encryptedContent","round","nip57_exports","_fetch3","getZapEndpoint","makeZapReceipt","makeZapRequest","useFetchImplementation3","validateZapRequest","metadata","lnurl","lud06","lud16","bech322","allowsNostr","nostrPubkey","amount","comment","zr","zapRequestString","zapRequest","preimage","bolt11","paidAt","tagsFromZapRequest","zap","nip98_exports","getToken","unpackEventFromToken","validateEvent2","validateToken","_authorizationScheme","loginUrl","httpMethod","includeAuthorizationScheme","signedEvent","base643","eventB64","urlTag","methodTag","types","exports","bakeCollectionVariadic","bakeCollectionAwait","bakeCollection","BAKED_EMPTY_FUNC","FORLOOP_FALLBACK","generateArgsDefCode","numArgs","argsDefCode","generateBodyPartsCode","collectionLength","funcDefCode","funcCallCode","generateBodyPartsVariadicCode","collection","fixedArgsNum","funcFactoryCode","funcFactory","eval","__spreadArray","pack","arguments","taskCollection","TaskCollection","_fast_remove_single","bake_collection_1","require$$0","push_norebuild","_tasks","newAr","push_rebuild","firstEmitBuildStrategy","rebuild_on_first_call","rebuild","removeLast_norebuild","removeLast_rebuild","insert_norebuild","_b","func","_i","unshift","insert_rebuild","rebuild_noawait","argsNum","rebuild_await","autoRebuild","initialTasks","awaitTasks","bind","setAutoRebuild","__createBinding","__exportStar","fastClear","growArgsNum","newVal","removeLast","tasksAsArray","setTasks","desc","getOwnPropertyDescriptor","__esModule","configurable","hasOwnProperty","nullObj","ee","EventEmitter","task_collection_1","utils_1","require$$1","emit","ev","emitHasOnce","oev","onceEvents","fncs","_symbolKeys","maxListeners","Infinity","eventNames","once","addListener","evtmap","warn","removeListener","evto","addListenerBound","bindTo","boundFuncs","removeListenerBound","hasListeners","prependListener","prependOnceListener","removeAllListeners","setMaxListeners","getMaxListeners","_this","keysO","listenerCount","w","plural","ms","msAbs","isPlural","parseFloat","isFinite","long","fmtLong","fmtShort","setup","env","createDebug","namespace","prevTime","namespacesCache","enabledCache","enableOverride","debug","enabled","self","curr","diff","coerce","format","formatter","formatters","formatArgs","useColors","color","selectColor","extend","namespaces","delimiter","newDebug","toNamespace","regexp","substring","disable","skips","enable","save","humanize","colors","load","common","module","lastC","storage","setItem","removeItem","getItem","DEBUG","__nwjs","navigator","userAgent","documentElement","WebkitAppearance","firebug","exception","table","$1","localStorage","localstorage","warned","abytes","HashMD","SHA256_IV","stringOrUint8Array","getFieldBytesLength","fieldOrder","bitLength","getMinHashLength","mapHashToField","fieldLen","reduced","ut.abytes","_c","_isCompressed","ut.isBytes","sqrtError","suffix","mod.getMinHashLength","mod.mapHashToField","LRUCacheNode_1","LRUCacheNode","entryExpirationTimeInMS","onEntryEvicted","onEntryMarkedAsMostRecentlyUsed","cloneFn","defaultClone","internalValue","created","isExpired","invokeOnEvicted","invokeOnEntryMarkedAsMostRecentlyUsed","LRUCache_1","LRUCache","lookupTable","maxSize","maxSizeInternal","cleanCache","remainingSize","newest","removeNodeFromListAndLookupTable","mapNodeToEntry","oldest","enforceSizeLimit","entryOptions","currentNodeForKey","setNodeAsHead","peek","iterator","removeNodeFromList","expiredNodes","stringToBytes","bytesToString","bech32m","base58xrp","base58flickr","base32hex","base32crockford","coderTypeError","TAGCODES","payment_hash","payment_secret","description","payee","description_hash","expiry","min_final_cltv_expiry","fallback_address","route_hint","feature_bits","runWithTimeout","timeoutMs","timeoutMessage","finally","NDKRelayConnectivity","ndkRelay","_status","connectedAt","_connectionStats","attempts","success","durations","reconnectTimeout","handleNotice","connectHandler","updateConnectionStats","disconnectHandler","disconnected","handleReconnection","authHandler","havePolicy","authPolicy","attempt","isAvailable","isFlapping","avg","variance","reconnectDelay","nextReconnectAt","connectionStats","NDKRelayPublisher","publishWhenConnected","publishEvent","timeoutPromise","onConnectHandler","connectResolve","connectReject","race","nostrEvent","toNostrEvent","connectivity","publishTimeout","publishPromise","isEphemeral","rawEvent","calculateGroupableId","elements","MAX_SUBID_LENGTH","compareFilter","filter1","filter2","valuesInFilter2","valueInFilter2","generateSubId","subscriptions","subIds","subId","Boolean","subIdParts","filterNonKindKeys","filterKinds","NDKGroupedSubscriptions","req","debug7","handleSubscriptionClosure","addSubscription","eventReceived","eoseReceived","findIndex","NDKSubscriptionFilters","eventMatchesLocalFilter","findMatchingActiveSubscriptions","activeSubscriptions","NDKRelaySubscriptions","delayedItems","delayedTimers","activeSubscriptionsByGroupId","executionTimeoutsByGroupId","groupingDebug","conn","groupableId","subscriptionFilters","isGroupable","executeSubscriptions","activeSubscription","delayedItem","groupableDelayType","executeGroup","groupableDelay","triggeredBy","timeouts","filterCount","mergedFilters","allFiltersAtIndex","di","executeSubscriptionsWhenConnected","groupedSubscriptions","readyListener","executeSubscriptionsConnected","subOptions","trusted","every","sub2","NDKEvent","subFilters","executedFilters","NDKRelay","EventEmitter2","scores","publisher","complaining","scoreSlowerEvent","timeDiffInMs","tagReference","marker","referenceTags","PublishError","errors","relayErrors","NDKRelaySet","_NDKRelaySet","ndk","addRelay","fromRelayUrls","relayUrls","pool","temporaryRelay","useTemporaryRelay","publishedToRelays","isEphemeral2","promises","calculateRelaySetFromEvent","mergeTags","tags1","tags2","tagMap","isContained","smaller","larger","existingTag","generateKey","generateContentTags","addTagIfNew","entity","nip192","maybeGetEventRelayUrl","nip19Id","isReplaceable","isParamReplaceable","recipient","signer","assertSigner","pTags","getMatchingTags","getUser","hexpubkey","sender","onRelays","nip193","replaceableDTag","tagId","repost","getKind","PUBKEY_REGEX","validate","persist","signatureVerified","debug2","DEFAULT_RELAYS","NDKZap","_NDKZap","EventEmitter3","zappedEvent","zappedUser","getZapperPubkey","forUser","lnurlspec","getZapSpec","getZapConfiguration","getZapSpecWithoutCache","zapEndpoint","fetchProfile","groupable","httpFetch","response","zapSpec","zapEndpointCallback","createZapRequest","extraTags","generateZapRequest","getInvoice","URLSearchParams","nostr","encodeURIComponent","pr","nip57","nonPTags","urls","_NDKEvent","EventEmitter4","_author","user","userOrTagOrEvent","skipAuthorTag","pTag","generateTags","tagName","tagValue","alt","removeTag","dTag","relaySet","devWriteRelaySet","cacheAdapter","deleteEvent","clientName","clientNip89","clientTag","muted","authorMutedEntry","mutedIds","eventTagReference","eventMutedEntry","deduplicationKey","tagAddress","dTagId","react","follows","outbox","contactListEvent","fetchEvent","pubkeys","outboxTracker","trackUsers","NDKUser","profileFromEvent","displayName","display_name","image","banner","bio","nip05","about","zapService","website","serializeProfile","getNip05For","fetchOpts","queuesNip05","loadNip05","nip46Urls","nip46","saveNip05","_NDKUser","_npub","_pubkey","npub","nip194","queuesZapConfig","loadUsersLNURLDoc","saveUsersLNURLDoc","zapConfig","fromNip05","nip05Id","skipCache","cache","setMetadataEvents","cacheUsage","locking","fetchEvents","closeOnEose","sortedSetMetadataEvents","saveProfile","follow","newFollow","currentFollowList","unfollow","validateNip05","profilePointer","NDKNip07Signer","_userPromise","nip04Queue","nip04Processing","waitTimeout","debug5","blockUntilReady","waitForExtension","signEvent","getRelays","activeRelays","read","write","recipientHexPubKey","queueNip04","senderHexPubKey","counterpartyHexpubkey","processNip04Queue","retries","nip04","timerId","intervalId","p0","p1","button","RELAYS_URL","nip07signer","alert","App"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90]}