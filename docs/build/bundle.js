function noop(){}const identity=e=>e;function assign(e,t){for(const n in t)e[n]=t[n];return e}function is_promise(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then}function run(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run)}function is_function(e){return"function"==typeof e}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let src_url_equal_anchor;function src_url_equal(e,t){return src_url_equal_anchor||(src_url_equal_anchor=document.createElement("a")),src_url_equal_anchor.href=t,e===src_url_equal_anchor.href}function is_empty(e){return 0===Object.keys(e).length}function subscribe(e,...t){if(null==e)return noop;const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function component_subscribe(e,t,n){e.$$.on_destroy.push(subscribe(t,n))}function create_slot(e,t,n,r){if(e){const o=get_slot_context(e,t,n,r);return e[0](o)}}function get_slot_context(e,t,n,r){return e[1]&&r?assign(n.ctx.slice(),e[1](r(t))):n.ctx}function get_slot_changes(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|o[r];return e}return t.dirty|o}return t.dirty}function update_slot_base(e,t,n,r,o,i){if(o){const s=get_slot_context(t,n,r,i);e.p(s,o)}}function get_all_dirty_from_scope(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function exclude_internal_props(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}const is_client="undefined"!=typeof window;let now=is_client?()=>window.performance.now():()=>Date.now(),raf=is_client?e=>requestAnimationFrame(e):noop;const tasks=new Set;function run_tasks(e){tasks.forEach((t=>{t.c(e)||(tasks.delete(t),t.f())})),0!==tasks.size&&raf(run_tasks)}function loop(e){let t;return 0===tasks.size&&raf(run_tasks),{promise:new Promise((n=>{tasks.add(t={c:e,f:n})})),abort(){tasks.delete(t)}}}function append(e,t){e.appendChild(t)}function get_root_for_style(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function append_empty_stylesheet(e){const t=element("style");return append_stylesheet(get_root_for_style(e),t),t.sheet}function append_stylesheet(e,t){return append(e.head||e,t),t.sheet}function insert(e,t,n){e.insertBefore(t,n||null)}function detach(e){e.parentNode&&e.parentNode.removeChild(e)}function element(e){return document.createElement(e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function empty(){return text("")}function listen(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function attr(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function children(e){return Array.from(e.childNodes)}function custom_event(e,t,{bubbles:n=!1,cancelable:r=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(e,n,r,t),o}function construct_svelte_component(e,t){return new e(t)}const managed_styles=new Map;let active=0,current_component;function hash$6(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}function create_style_information(e,t){const n={stylesheet:append_empty_stylesheet(t),rules:{}};return managed_styles.set(e,n),n}function create_rule(e,t,n,r,o,i,s,a=0){const c=16.666/r;let u="{\n";for(let e=0;e<=1;e+=c){const r=t+(n-t)*i(e);u+=100*e+`%{${s(r,1-r)}}\n`}const l=u+`100% {${s(n,1-n)}}\n}`,h=`__svelte_${hash$6(l)}_${a}`,d=get_root_for_style(e),{stylesheet:f,rules:p}=managed_styles.get(d)||create_style_information(d,e);p[h]||(p[h]=!0,f.insertRule(`@keyframes ${h} ${l}`,f.cssRules.length));const y=e.style.animation||"";return e.style.animation=`${y?`${y}, `:""}${h} ${r}ms linear ${o}ms 1 both`,active+=1,h}function delete_rule(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),o=n.length-r.length;o&&(e.style.animation=r.join(", "),active-=o,active||clear_rules())}function clear_rules(){raf((()=>{active||(managed_styles.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&detach(t)})),managed_styles.clear())}))}function set_current_component(e){current_component=e}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(e){get_current_component().$$.on_mount.push(e)}function onDestroy(e){get_current_component().$$.on_destroy.push(e)}function setContext(e,t){return get_current_component().$$.context.set(e,t),t}function getContext(e){return get_current_component().$$.context.get(e)}const dirty_components=[],binding_callbacks=[];let render_callbacks=[];const flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(e){render_callbacks.push(e)}const seen_callbacks=new Set;let flushidx=0,promise;function flush(){if(0!==flushidx)return;const e=current_component;do{try{for(;flushidx<dirty_components.length;){const e=dirty_components[flushidx];flushidx++,set_current_component(e),update(e.$$)}}catch(e){throw dirty_components.length=0,flushidx=0,e}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let e=0;e<render_callbacks.length;e+=1){const t=render_callbacks[e];seen_callbacks.has(t)||(seen_callbacks.add(t),t())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(e)}function update(e){if(null!==e.fragment){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}function flush_render_callbacks(e){const t=[],n=[];render_callbacks.forEach((r=>-1===e.indexOf(r)?t.push(r):n.push(r))),n.forEach((e=>e())),render_callbacks=t}function wait(){return promise||(promise=Promise.resolve(),promise.then((()=>{promise=null}))),promise}function dispatch(e,t,n){e.dispatchEvent(custom_event(`${t?"intro":"outro"}${n}`))}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(e,t){e&&e.i&&(outroing.delete(e),e.i(t))}function transition_out(e,t,n,r){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.c.push((()=>{outroing.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const null_transition={duration:0};function create_in_transition(e,t,n){const r={direction:"in"};let o,i,s=t(e,n,r),a=!1,c=0;function u(){o&&delete_rule(e,o)}function l(){const{delay:t=0,duration:n=300,easing:r=identity,tick:l=noop,css:h}=s||null_transition;h&&(o=create_rule(e,0,1,n,t,r,h,c++)),l(0,1);const d=now()+t,f=d+n;i&&i.abort(),a=!0,add_render_callback((()=>dispatch(e,!0,"start"))),i=loop((t=>{if(a){if(t>=f)return l(1,0),dispatch(e,!0,"end"),u(),a=!1;if(t>=d){const e=r((t-d)/n);l(e,1-e)}}return a}))}let h=!1;return{start(){h||(h=!0,delete_rule(e),is_function(s)?(s=s(r),wait().then(l)):l())},invalidate(){h=!1},end(){a&&(u(),a=!1)}}}function create_out_transition(e,t,n){const r={direction:"out"};let o,i=t(e,n,r),s=!0;const a=outros;function c(){const{delay:t=0,duration:n=300,easing:r=identity,tick:c=noop,css:u}=i||null_transition;u&&(o=create_rule(e,1,0,n,t,r,u));const l=now()+t,h=l+n;add_render_callback((()=>dispatch(e,!1,"start"))),loop((t=>{if(s){if(t>=h)return c(0,1),dispatch(e,!1,"end"),--a.r||run_all(a.c),!1;if(t>=l){const e=r((t-l)/n);c(1-e,e)}}return s}))}return a.r+=1,is_function(i)?wait().then((()=>{i=i(r),c()})):c(),{end(t){t&&i.tick&&i.tick(1,0),s&&(o&&delete_rule(e,o),s=!1)}}}function handle_promise(e,t){const n=t.token={};function r(e,r,o,i){if(t.token!==n)return;t.resolved=i;let s=t.ctx;void 0!==o&&(s=s.slice(),s[o]=i);const a=e&&(t.current=e)(s);let c=!1;t.block&&(t.blocks?t.blocks.forEach(((e,n)=>{n!==r&&e&&(group_outros(),transition_out(e,1,1,(()=>{t.blocks[n]===e&&(t.blocks[n]=null)})),check_outros())})):t.block.d(1),a.c(),transition_in(a,1),a.m(t.mount(),t.anchor),c=!0),t.block=a,t.blocks&&(t.blocks[r]=a),c&&flush()}if(is_promise(e)){const n=get_current_component();if(e.then((e=>{set_current_component(n),r(t.then,1,t.value,e),set_current_component(null)}),(e=>{if(set_current_component(n),r(t.catch,2,t.error,e),set_current_component(null),!t.hasCatch)throw e})),t.current!==t.pending)return r(t.pending,0),!0}else{if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}}function update_await_block_branch(e,t,n){const r=t.slice(),{resolved:o}=e;e.current===e.then&&(r[e.value]=o),e.current===e.catch&&(r[e.error]=o),e.block.p(r,n)}function get_spread_update(e,t){const n={},r={},o={$$scope:1};let i=e.length;for(;i--;){const s=e[i],a=t[i];if(a){for(const e in s)e in a||(r[e]=1);for(const e in a)o[e]||(n[e]=a[e],o[e]=1);e[i]=a}else for(const e in s)o[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}function get_spread_object(e){return"object"==typeof e&&null!==e?e:{}}function create_component(e){e&&e.c()}function mount_component(e,t,n,r){const{fragment:o,after_update:i}=e.$$;o&&o.m(t,n),r||add_render_callback((()=>{const t=e.$$.on_mount.map(run).filter(is_function);e.$$.on_destroy?e.$$.on_destroy.push(...t):run_all(t),e.$$.on_mount=[]})),i.forEach(add_render_callback)}function destroy_component(e,t){const n=e.$$;null!==n.fragment&&(flush_render_callbacks(n.after_update),run_all(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function make_dirty(e,t){-1===e.$$.dirty[0]&&(dirty_components.push(e),schedule_update(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,n,r,o,i,s,a=[-1]){const c=current_component;set_current_component(e);const u=e.$$={fragment:null,ctx:[],props:i,update:noop,not_equal:o,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:blank_object(),dirty:a,skip_bound:!1,root:t.target||c.$$.root};s&&s(u.root);let l=!1;if(u.ctx=n?n(e,t.props||{},((t,n,...r)=>{const i=r.length?r[0]:n;return u.ctx&&o(u.ctx[t],u.ctx[t]=i)&&(!u.skip_bound&&u.bound[t]&&u.bound[t](i),l&&make_dirty(e,t)),n})):[],u.update(),l=!0,run_all(u.before_update),u.fragment=!!r&&r(u.ctx),t.target){if(t.hydrate){const e=children(t.target);u.fragment&&u.fragment.l(e),e.forEach(detach)}else u.fragment&&u.fragment.c();t.intro&&transition_in(e.$$.fragment),mount_component(e,t.target,t.anchor,t.customElement),flush()}set_current_component(c)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop}$on(e,t){if(!is_function(t))return noop;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!is_empty(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const LOCATION={},ROUTER={},HISTORY={},PARAM=/^:(.+)/,SEGMENT_POINTS=4,STATIC_POINTS=3,DYNAMIC_POINTS=2,SPLAT_PENALTY=1,ROOT_POINTS=1,segmentize=e=>e.replace(/(^\/+|\/+$)/g,"").split("/"),stripSlashes=e=>e.replace(/(^\/+|\/+$)/g,""),rankRoute=(e,t)=>({route:e,score:e.default?0:segmentize(e.path).reduce(((e,t)=>(e+=SEGMENT_POINTS,""===t?e+=ROOT_POINTS:PARAM.test(t)?e+=DYNAMIC_POINTS:"*"===t[0]?e-=SEGMENT_POINTS+SPLAT_PENALTY:e+=STATIC_POINTS,e)),0),index:t}),rankRoutes=e=>e.map(rankRoute).sort(((e,t)=>e.score<t.score?1:e.score>t.score?-1:e.index-t.index)),pick=(e,t)=>{let n,r;const[o]=t.split("?"),i=segmentize(o),s=""===i[0],a=rankRoutes(e);for(let e=0,o=a.length;e<o;e++){const o=a[e].route;let c=!1;if(o.default){r={route:o,params:{},uri:t};continue}const u=segmentize(o.path),l={},h=Math.max(i.length,u.length);let d=0;for(;d<h;d++){const e=u[d],t=i[d];if(e&&"*"===e[0]){l["*"===e?"*":e.slice(1)]=i.slice(d).map(decodeURIComponent).join("/");break}if(void 0===t){c=!0;break}const n=PARAM.exec(e);if(n&&!s){const e=decodeURIComponent(t);l[n[1]]=e}else if(e!==t){c=!0;break}}if(!c){n={route:o,params:l,uri:"/"+i.slice(0,d).join("/")};break}}return n||r||null},combinePaths=(e,t)=>`${stripSlashes("/"===t?e:`${stripSlashes(e)}/${stripSlashes(t)}`)}/`,canUseDOM=()=>"undefined"!=typeof window&&"document"in window&&"location"in window,get_default_slot_changes$1=e=>({params:4&e}),get_default_slot_context$1=e=>({params:e[2]});function create_if_block$1(e){let t,n,r,o;const i=[create_if_block_1,create_else_block$1],s=[];function a(e,t){return e[0]?0:1}return t=a(e),n=s[t]=i[t](e),{c(){n.c(),r=empty()},m(e,n){s[t].m(e,n),insert(e,r,n),o=!0},p(e,o){let c=t;t=a(e),t===c?s[t].p(e,o):(group_outros(),transition_out(s[c],1,1,(()=>{s[c]=null})),check_outros(),n=s[t],n?n.p(e,o):(n=s[t]=i[t](e),n.c()),transition_in(n,1),n.m(r.parentNode,r))},i(e){o||(transition_in(n),o=!0)},o(e){transition_out(n),o=!1},d(e){s[t].d(e),e&&detach(r)}}}function create_else_block$1(e){let t;const n=e[8].default,r=create_slot(n,e,e[7],get_default_slot_context$1);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,o){r&&r.p&&(!t||132&o)&&update_slot_base(r,n,e,e[7],t?get_slot_changes(n,e[7],o,get_default_slot_changes$1):get_all_dirty_from_scope(e[7]),get_default_slot_context$1)},i(e){t||(transition_in(r,e),t=!0)},o(e){transition_out(r,e),t=!1},d(e){r&&r.d(e)}}}function create_if_block_1(e){let t,n,r,o={ctx:e,current:null,token:null,hasCatch:!1,pending:create_pending_block,then:create_then_block,catch:create_catch_block,value:12,blocks:[,,,]};return handle_promise(n=e[0],o),{c(){t=empty(),o.block.c()},m(e,n){insert(e,t,n),o.block.m(e,o.anchor=n),o.mount=()=>t.parentNode,o.anchor=t,r=!0},p(t,r){e=t,o.ctx=e,1&r&&n!==(n=e[0])&&handle_promise(n,o)||update_await_block_branch(o,e,r)},i(e){r||(transition_in(o.block),r=!0)},o(e){for(let e=0;e<3;e+=1){transition_out(o.blocks[e])}r=!1},d(e){e&&detach(t),o.block.d(e),o.token=null,o=null}}}function create_catch_block(e){return{c:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_then_block(e){let t,n,r;const o=[e[2],e[3]];var i=e[12]?.default||e[12];function s(e){let t={};for(let e=0;e<o.length;e+=1)t=assign(t,o[e]);return{props:t}}return i&&(t=construct_svelte_component(i,s())),{c(){t&&create_component(t.$$.fragment),n=empty()},m(e,o){t&&mount_component(t,e,o),insert(e,n,o),r=!0},p(e,r){const a=12&r?get_spread_update(o,[4&r&&get_spread_object(e[2]),8&r&&get_spread_object(e[3])]):{};if(1&r&&i!==(i=e[12]?.default||e[12])){if(t){group_outros();const e=t;transition_out(e.$$.fragment,1,0,(()=>{destroy_component(e,1)})),check_outros()}i?(t=construct_svelte_component(i,s()),create_component(t.$$.fragment),transition_in(t.$$.fragment,1),mount_component(t,n.parentNode,n)):t=null}else i&&t.$set(a)},i(e){r||(t&&transition_in(t.$$.fragment,e),r=!0)},o(e){t&&transition_out(t.$$.fragment,e),r=!1},d(e){e&&detach(n),t&&destroy_component(t,e)}}}function create_pending_block(e){return{c:noop,m:noop,p:noop,i:noop,o:noop,d:noop}}function create_fragment$4(e){let t,n,r=e[1]&&e[1].route===e[5]&&create_if_block$1(e);return{c(){r&&r.c(),t=empty()},m(e,o){r&&r.m(e,o),insert(e,t,o),n=!0},p(e,[n]){e[1]&&e[1].route===e[5]?r?(r.p(e,n),2&n&&transition_in(r,1)):(r=create_if_block$1(e),r.c(),transition_in(r,1),r.m(t.parentNode,t)):r&&(group_outros(),transition_out(r,1,1,(()=>{r=null})),check_outros())},i(e){n||(transition_in(r),n=!0)},o(e){transition_out(r),n=!1},d(e){r&&r.d(e),e&&detach(t)}}}function instance$4(e,t,n){let r,{$$slots:o={},$$scope:i}=t,{path:s=""}=t,{component:a=null}=t,c={},u={};const{registerRoute:l,unregisterRoute:h,activeRoute:d}=getContext(ROUTER);component_subscribe(e,d,(e=>n(1,r=e)));const f={path:s,default:""===s};return l(f),onDestroy((()=>{h(f)})),e.$$set=e=>{n(11,t=assign(assign({},t),exclude_internal_props(e))),"path"in e&&n(6,s=e.path),"component"in e&&n(0,a=e.component),"$$scope"in e&&n(7,i=e.$$scope)},e.$$.update=()=>{if(r&&r.route===f){n(2,c=r.params);const{component:e,path:o,...i}=t;n(3,u=i),e&&(e.toString().startsWith("class ")?n(0,a=e):n(0,a=e())),canUseDOM()&&!r.preserveScroll&&window?.scrollTo(0,0)}},t=exclude_internal_props(t),[a,r,c,u,d,f,s,i,o]}class Route extends SvelteComponent{constructor(e){super(),init(this,e,instance$4,create_fragment$4,safe_not_equal,{path:6,component:0})}}const subscriber_queue=[];function readable(e,t){return{subscribe:writable(e,t).subscribe}}function writable(e,t=noop){let n;const r=new Set;function o(t){if(safe_not_equal(e,t)&&(e=t,n)){const t=!subscriber_queue.length;for(const t of r)t[1](),subscriber_queue.push(t,e);if(t){for(let e=0;e<subscriber_queue.length;e+=2)subscriber_queue[e][0](subscriber_queue[e+1]);subscriber_queue.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(i,s=noop){const a=[i,s];return r.add(a),1===r.size&&(n=t(o)||noop),i(e),()=>{r.delete(a),0===r.size&&n&&(n(),n=null)}}}}function derived(e,t,n){const r=!Array.isArray(e),o=r?[e]:e,i=t.length<2;return readable(n,(e=>{let n=!1;const s=[];let a=0,c=noop;const u=()=>{if(a)return;c();const n=t(r?s[0]:s,e);i?e(n):c=is_function(n)?n:noop},l=o.map(((e,t)=>subscribe(e,(e=>{s[t]=e,a&=~(1<<t),n&&u()}),(()=>{a|=1<<t}))));return n=!0,u(),function(){run_all(l),c(),n=!1}}))}const getLocation=e=>({...e.location,state:e.history.state,key:e.history.state&&e.history.state.key||"initial"}),createHistory=e=>{const t=[];let n=getLocation(e);return{get location(){return n},listen(r){t.push(r);const o=()=>{n=getLocation(e),r({location:n,action:"POP"})};return e.addEventListener("popstate",o),()=>{e.removeEventListener("popstate",o);const n=t.indexOf(r);t.splice(n,1)}},navigate(r,{state:o,replace:i=!1,preserveScroll:s=!1,blurActiveElement:a=!0}={}){o={...o,key:Date.now()+""};try{i?e.history.replaceState(o,"",r):e.history.pushState(o,"",r)}catch(t){e.location[i?"replace":"assign"](r)}n=getLocation(e),t.forEach((e=>e({location:n,action:"PUSH",preserveScroll:s}))),a&&document.activeElement.blur()}}},createMemorySource=(e="/")=>{let t=0;const n=[{pathname:e,search:""}],r=[];return{get location(){return n[t]},addEventListener(e,t){},removeEventListener(e,t){},history:{get entries(){return n},get index(){return t},get state(){return r[t]},pushState(e,o,i){const[s,a=""]=i.split("?");t++,n.push({pathname:s,search:a}),r.push(e)},replaceState(e,o,i){const[s,a=""]=i.split("?");n[t]={pathname:s,search:a},r[t]=e}}}},globalHistory=createHistory(canUseDOM()?window:createMemorySource()),{navigate:navigate}=globalHistory,get_default_slot_changes_1=e=>({route:4&e,location:2&e}),get_default_slot_context_1=e=>({route:e[2]&&e[2].uri,location:e[1]}),get_default_slot_changes=e=>({route:4&e,location:2&e}),get_default_slot_context=e=>({route:e[2]&&e[2].uri,location:e[1]});function create_else_block(e){let t;const n=e[15].default,r=create_slot(n,e,e[14],get_default_slot_context_1);return{c(){r&&r.c()},m(e,n){r&&r.m(e,n),t=!0},p(e,o){r&&r.p&&(!t||16390&o)&&update_slot_base(r,n,e,e[14],t?get_slot_changes(n,e[14],o,get_default_slot_changes_1):get_all_dirty_from_scope(e[14]),get_default_slot_context_1)},i(e){t||(transition_in(r,e),t=!0)},o(e){transition_out(r,e),t=!1},d(e){r&&r.d(e)}}}function create_if_block(e){let t,n,r=e[1].pathname,o=create_key_block(e);return{c(){o.c(),t=empty()},m(e,r){o.m(e,r),insert(e,t,r),n=!0},p(e,n){2&n&&safe_not_equal(r,r=e[1].pathname)?(group_outros(),transition_out(o,1,1,noop),check_outros(),o=create_key_block(e),o.c(),transition_in(o,1),o.m(t.parentNode,t)):o.p(e,n)},i(e){n||(transition_in(o),n=!0)},o(e){transition_out(o),n=!1},d(e){e&&detach(t),o.d(e)}}}function create_key_block(e){let t,n,r,o;const i=e[15].default,s=create_slot(i,e,e[14],get_default_slot_context);return{c(){t=element("div"),s&&s.c()},m(e,n){insert(e,t,n),s&&s.m(t,null),o=!0},p(e,t){s&&s.p&&(!o||16390&t)&&update_slot_base(s,i,e,e[14],o?get_slot_changes(i,e[14],t,get_default_slot_changes):get_all_dirty_from_scope(e[14]),get_default_slot_context)},i(i){o||(transition_in(s,i),add_render_callback((()=>{o&&(r&&r.end(1),n=create_in_transition(t,e[3],{}),n.start())})),o=!0)},o(i){transition_out(s,i),n&&n.invalidate(),r=create_out_transition(t,e[3],{}),o=!1},d(e){e&&detach(t),s&&s.d(e),e&&r&&r.end()}}}function create_fragment$3(e){let t,n,r,o;const i=[create_if_block,create_else_block],s=[];function a(e,t){return e[0]?0:1}return t=a(e),n=s[t]=i[t](e),{c(){n.c(),r=empty()},m(e,n){s[t].m(e,n),insert(e,r,n),o=!0},p(e,[o]){let c=t;t=a(e),t===c?s[t].p(e,o):(group_outros(),transition_out(s[c],1,1,(()=>{s[c]=null})),check_outros(),n=s[t],n?n.p(e,o):(n=s[t]=i[t](e),n.c()),transition_in(n,1),n.m(r.parentNode,r))},i(e){o||(transition_in(n),o=!0)},o(e){transition_out(n),o=!1},d(e){s[t].d(e),e&&detach(r)}}}function instance$3(e,t,n){let r,o,i,s,{$$slots:a={},$$scope:c}=t,{basepath:u="/"}=t,{url:l=null}=t,{viewtransition:h=null}=t,{history:d=globalHistory}=t;setContext(HISTORY,d);const f=getContext(LOCATION),p=getContext(ROUTER),y=writable([]);component_subscribe(e,y,(e=>n(12,o=e)));const g=writable(null);component_subscribe(e,g,(e=>n(2,s=e)));let b=!1;const m=f||writable(l?{pathname:l}:d.location);component_subscribe(e,m,(e=>n(1,r=e)));const w=p?p.routerBase:writable({path:u,uri:u});component_subscribe(e,w,(e=>n(13,i=e)));const $=derived([w,g],(([e,t])=>{if(!t)return e;const{path:n}=e,{route:r,uri:o}=t;return{path:r.default?n:r.path.replace(/\*.*$/,""),uri:o}}));let _=!1;return f||(onMount((()=>d.listen((e=>{n(11,_=e.preserveScroll||!1),m.set(e.location)})))),setContext(LOCATION,m)),setContext(ROUTER,{activeRoute:g,base:w,routerBase:$,registerRoute:e=>{const{path:t}=i;let{path:n}=e;if(e._path=n,e.path=combinePaths(t,n),"undefined"==typeof window){if(b)return;const t=pick([e],r.pathname);t&&(g.set(t),b=!0)}else y.update((t=>[...t,e]))},unregisterRoute:e=>{y.update((t=>t.filter((t=>t!==e))))}}),e.$$set=e=>{"basepath"in e&&n(8,u=e.basepath),"url"in e&&n(9,l=e.url),"viewtransition"in e&&n(0,h=e.viewtransition),"history"in e&&n(10,d=e.history),"$$scope"in e&&n(14,c=e.$$scope)},e.$$.update=()=>{if(8192&e.$$.dirty){const{path:e}=i;y.update((t=>t.map((t=>Object.assign(t,{path:combinePaths(e,t._path)})))))}if(6146&e.$$.dirty){const e=pick(o,r.pathname);g.set(e?{...e,preserveScroll:_}:e)}},[h,r,s,(e,t,n)=>{const r=h(n);return"function"==typeof r?.fn?r.fn(e,r):r},y,g,m,w,u,l,d,_,o,i,c,a]}class Router extends SvelteComponent{constructor(e){super(),init(this,e,instance$3,create_fragment$3,safe_not_equal,{basepath:8,url:9,viewtransition:0,history:10})}}const eventsStore=writable([]);function getEvents(){return eventsStore}function create_fragment$2(e){let t,n,r,o,i,s,a,c,u,l,h,d,f,p,y,g,b,m;return{c(){t=element("html"),n=element("head"),n.innerHTML='<meta charset="UTF-8"/> \n    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/> \n    <title>ZAPLAN</title> \n    \n    <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700" rel="stylesheet"/> \n    \n    <link rel="stylesheet" type="text/css" href="/css/reset.min.css"/> \n    <link rel="stylesheet" type="text/css" href="/css/style.css"/>',r=space(),o=element("body"),i=element("header"),s=element("div"),a=element("div"),c=element("img"),l=space(),h=element("div"),h.innerHTML='<input type="text" placeholder="Enter an activity.." id="item"/>',d=space(),f=element("div"),f.innerHTML='<button id="add" class="add-todo-button"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" style="enable-background:new 0 0 16 16;" xml:space="preserve"><g><path class="fill" d="M16,8c0,0.5-0.5,1-1,1H9v6c0,0.5-0.5,1-1,1s-1-0.5-1-1V9H1C0.5,9,0,8.5,0,8s0.5-1,1-1h6V1c0-0.5,0.5-1,1-1s1,0.5,1,1v6h6C15.5,7,16,7.5,16,8z"></path></g></svg></button>',p=space(),y=element("div"),y.innerHTML='<ul class="todo" id="todo"></ul> \n        \n        <ul class="todo" id="completed"></ul>',g=space(),b=element("script"),attr(c,"class","js-profile-element"),attr(c,"id","pPicture"),src_url_equal(c.src,u=e[0])||attr(c,"src",u),attr(s,"class","header"),attr(y,"class","container"),attr(b,"type","module"),src_url_equal(b.src,m="/js/main.js")||attr(b,"src","/js/main.js")},m(e,u){insert(e,t,u),append(t,n),append(t,r),append(t,o),append(o,i),append(i,s),append(s,a),append(a,c),append(s,l),append(s,h),append(s,d),append(s,f),append(o,p),append(o,y),append(o,g),append(o,b)},p(e,[t]){1&t&&!src_url_equal(c.src,u=e[0])&&attr(c,"src",u)},i:noop,o:noop,d(e){e&&detach(t)}}}function instance$2(e,t,n){let r;return getEvents().subscribe((e=>{if(e.length>0){const t=JSON.parse(e[0].content);n(0,r=t.picture)}})),[r]}class TodoPage extends SvelteComponent{constructor(e){super(),init(this,e,instance$2,create_fragment$2,safe_not_equal,{})}}function create_default_slot(e){let t,n,r,o,i;return n=new Route({props:{path:"/",component:e[0]}}),o=new Route({props:{path:"/todoPage",component:TodoPage}}),{c(){t=element("main"),create_component(n.$$.fragment),r=space(),create_component(o.$$.fragment)},m(e,s){insert(e,t,s),mount_component(n,t,null),append(t,r),mount_component(o,t,null),i=!0},p(e,t){const r={};1&t&&(r.component=e[0]),n.$set(r)},i(e){i||(transition_in(n.$$.fragment,e),transition_in(o.$$.fragment,e),i=!0)},o(e){transition_out(n.$$.fragment,e),transition_out(o.$$.fragment,e),i=!1},d(e){e&&detach(t),destroy_component(n),destroy_component(o)}}}function create_fragment$1(e){let t,n;return t=new Router({props:{$$slots:{default:[create_default_slot]},$$scope:{ctx:e}}}),{c(){create_component(t.$$.fragment)},m(e,r){mount_component(t,e,r),n=!0},p(e,[n]){const r={};3&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(transition_in(t.$$.fragment,e),n=!0)},o(e){transition_out(t.$$.fragment,e),n=!1},d(e){destroy_component(t,e)}}}function instance$1(e,t,n){let{Login:r}=t;return e.$$set=e=>{"Login"in e&&n(0,r=e.Login)},[r]}class App extends SvelteComponent{constructor(e){super(),init(this,e,instance$1,create_fragment$1,safe_not_equal,{Login:0})}}function number$5(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bool$3(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)}function bytes$5(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$5(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");number$5(e.outputLen),number$5(e.blockLen)}function exists$5(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$5(e,t){bytes$5(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const assert$4={number:number$5,bool:bool$3,bytes:bytes$5,hash:hash$5,exists:exists$5,output:output$5},crypto$4="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,u8a$4=e=>e instanceof Uint8Array,createView$4=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$4=(e,t)=>e<<32-t|e>>>t,isLE$4=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];if(!isLE$4)throw new Error("Non little-endian hardware is not supported");const hexes$5=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function bytesToHex$5(e){if(!u8a$4(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=hexes$5[e[n]];return t}function hexToBytes$4(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let t=0;t<n.length;t++){const r=2*t,o=e.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[t]=i}return n}function utf8ToBytes$8(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function toBytes$5(e){if("string"==typeof e&&(e=utf8ToBytes$8(e)),!u8a$4(e))throw new Error("expected Uint8Array, got "+typeof e);return e}function concatBytes$6(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;return e.forEach((e=>{if(!u8a$4(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length})),t}let Hash$4=class{clone(){return this._cloneInto()}};function wrapConstructor$4(e){const t=t=>e().update(toBytes$5(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function randomBytes$3(e=32){if(crypto$4&&"function"==typeof crypto$4.getRandomValues)return crypto$4.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$4(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}let SHA2$3=class extends Hash$4{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=createView$4(this.buffer)}update(e){assert$4.exists(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=toBytes$5(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=createView$4(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){assert$4.exists(this),assert$4.output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;setBigUint64$4(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=createView$4(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}};const Chi$4=(e,t,n)=>e&t^~e&n,Maj$4=(e,t,n)=>e&t^e&n^t&n,SHA256_K$4=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$3=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$4=new Uint32Array(64);let SHA256$4=class extends SHA2$3{constructor(){super(64,32,8,!1),this.A=0|IV$3[0],this.B=0|IV$3[1],this.C=0|IV$3[2],this.D=0|IV$3[3],this.E=0|IV$3[4],this.F=0|IV$3[5],this.G=0|IV$3[6],this.H=0|IV$3[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)SHA256_W$4[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=SHA256_W$4[e-15],n=SHA256_W$4[e-2],r=rotr$4(t,7)^rotr$4(t,18)^t>>>3,o=rotr$4(n,17)^rotr$4(n,19)^n>>>10;SHA256_W$4[e]=o+SHA256_W$4[e-7]+r+SHA256_W$4[e-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(rotr$4(s,6)^rotr$4(s,11)^rotr$4(s,25))+Chi$4(s,a,c)+SHA256_K$4[e]+SHA256_W$4[e]|0,l=(rotr$4(n,2)^rotr$4(n,13)^rotr$4(n,22))+Maj$4(n,r,o)|0;u=c,c=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+l|0}n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){SHA256_W$4.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},SHA224$1=class extends SHA256$4{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};const sha256$4=wrapConstructor$4((()=>new SHA256$4));wrapConstructor$4((()=>new SHA224$1));
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const _0n$d=BigInt(0),_1n$e=BigInt(1),_2n$8=BigInt(2),u8a$3=e=>e instanceof Uint8Array,hexes$4=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function bytesToHex$4(e){if(!u8a$3(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=hexes$4[e[n]];return t}function numberToHexUnpadded$2(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function hexToNumber$2(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}function hexToBytes$3(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let t=0;t<n.length;t++){const r=2*t,o=e.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[t]=i}return n}function bytesToNumberBE$2(e){return hexToNumber$2(bytesToHex$4(e))}function bytesToNumberLE$2(e){if(!u8a$3(e))throw new Error("Uint8Array expected");return hexToNumber$2(bytesToHex$4(Uint8Array.from(e).reverse()))}function numberToBytesBE$2(e,t){return hexToBytes$3(e.toString(16).padStart(2*t,"0"))}function numberToBytesLE$2(e,t){return numberToBytesBE$2(e,t).reverse()}function numberToVarBytesBE$2(e){return hexToBytes$3(numberToHexUnpadded$2(e))}function ensureBytes$3(e,t,n){let r;if("string"==typeof t)try{r=hexToBytes$3(t)}catch(n){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${n}`)}else{if(!u8a$3(t))throw new Error(`${e} must be hex string or Uint8Array`);r=Uint8Array.from(t)}const o=r.length;if("number"==typeof n&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function concatBytes$5(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;return e.forEach((e=>{if(!u8a$3(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length})),t}function equalBytes$3(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function utf8ToBytes$7(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function bitLen$2(e){let t;for(t=0;e>_0n$d;e>>=_1n$e,t+=1);return t}function bitGet$2(e,t){return e>>BigInt(t)&_1n$e}const bitSet$2=(e,t,n)=>e|(n?_1n$e:_0n$d)<<BigInt(t),bitMask$2=e=>(_2n$8<<BigInt(e-1))-_1n$e,u8n$2=e=>new Uint8Array(e),u8fr$2=e=>Uint8Array.from(e);function createHmacDrbg$2(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=u8n$2(e),o=u8n$2(e),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...e)=>n(o,r,...e),c=(e=u8n$2())=>{o=a(u8fr$2([0]),e),r=a(),0!==e.length&&(o=a(u8fr$2([1]),e),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return concatBytes$5(...n)};return(e,t)=>{let n;for(s(),c(e);!(n=t(u()));)c();return s(),n}}const validatorFns$2={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function validateObject$2(e,t,n={}){const r=(t,n,r)=>{const o=validatorFns$2[n];if("function"!=typeof o)throw new Error(`Invalid validator "${n}", expected function`);const i=e[t];if(!(r&&void 0===i||o(i,e)))throw new Error(`Invalid param ${String(t)}=${i} (${typeof i}), expected ${n}`)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e}var ut$2=Object.freeze({__proto__:null,bitGet:bitGet$2,bitLen:bitLen$2,bitMask:bitMask$2,bitSet:bitSet$2,bytesToHex:bytesToHex$4,bytesToNumberBE:bytesToNumberBE$2,bytesToNumberLE:bytesToNumberLE$2,concatBytes:concatBytes$5,createHmacDrbg:createHmacDrbg$2,ensureBytes:ensureBytes$3,equalBytes:equalBytes$3,hexToBytes:hexToBytes$3,hexToNumber:hexToNumber$2,numberToBytesBE:numberToBytesBE$2,numberToBytesLE:numberToBytesLE$2,numberToHexUnpadded:numberToHexUnpadded$2,numberToVarBytesBE:numberToVarBytesBE$2,utf8ToBytes:utf8ToBytes$7,validateObject:validateObject$2});
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$c=BigInt(0),_1n$d=BigInt(1),_2n$7=BigInt(2),_3n$5=BigInt(3),_4n$2=BigInt(4),_5n$2=BigInt(5),_8n$2=BigInt(8);function mod$2(e,t){const n=e%t;return n>=_0n$c?n:t+n}function pow$2(e,t,n){if(n<=_0n$c||t<_0n$c)throw new Error("Expected power/modulo > 0");if(n===_1n$d)return _0n$c;let r=_1n$d;for(;t>_0n$c;)t&_1n$d&&(r=r*e%n),e=e*e%n,t>>=_1n$d;return r}function pow2$2(e,t,n){let r=e;for(;t-- >_0n$c;)r*=r,r%=n;return r}function invert$2(e,t){if(e===_0n$c||t<=_0n$c)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=mod$2(e,t),r=t,o=_0n$c,i=_1n$d;for(;n!==_0n$c;){const e=r%n,t=o-i*(r/n);r=n,n=e,o=i,i=t}if(r!==_1n$d)throw new Error("invert: does not exist");return mod$2(o,t)}function tonelliShanks$2(e){const t=(e-_1n$d)/_2n$7;let n,r,o;for(n=e-_1n$d,r=0;n%_2n$7===_0n$c;n/=_2n$7,r++);for(o=_2n$7;o<e&&pow$2(o,t,e)!==e-_1n$d;o++);if(1===r){const t=(e+_1n$d)/_4n$2;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const i=(n+_1n$d)/_2n$7;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,o),n),u=e.pow(s,i),l=e.pow(s,n);for(;!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;let t=1;for(let n=e.sqr(l);t<a&&!e.eql(n,e.ONE);t++)n=e.sqr(n);const n=e.pow(c,_1n$d<<BigInt(a-t-1));c=e.sqr(n),u=e.mul(u,n),l=e.mul(l,c),a=t}return u}}function FpSqrt$2(e){if(e%_4n$2===_3n$5){const t=(e+_1n$d)/_4n$2;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%_8n$2===_5n$2){const t=(e-_5n$2)/_8n$2;return function(e,n){const r=e.mul(n,_2n$7),o=e.pow(r,t),i=e.mul(n,o),s=e.mul(e.mul(i,_2n$7),o),a=e.mul(i,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),n))throw new Error("Cannot find square root");return a}}return tonelliShanks$2(e)}BigInt(9),BigInt(16);const FIELD_FIELDS$2=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$2(e){return validateObject$2(e,FIELD_FIELDS$2.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function FpPow$2(e,t,n){if(n<_0n$c)throw new Error("Expected power > 0");if(n===_0n$c)return e.ONE;if(n===_1n$d)return t;let r=e.ONE,o=t;for(;n>_0n$c;)n&_1n$d&&(r=e.mul(r,o)),o=e.sqr(o),n>>=_1n$d;return r}function FpInvertBatch$2(e,t){const n=new Array(t.length),r=t.reduce(((t,r,o)=>e.is0(r)?t:(n[o]=t,e.mul(t,r))),e.ONE),o=e.inv(r);return t.reduceRight(((t,r,o)=>e.is0(r)?t:(n[o]=e.mul(t,n[o]),e.mul(t,r))),o),n}function nLength$2(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Field$2(e,t,n=!1,r={}){if(e<=_0n$c)throw new Error(`Expected Fp ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:i}=nLength$2(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=FpSqrt$2(e),a=Object.freeze({ORDER:e,BITS:o,BYTES:i,MASK:bitMask$2(o),ZERO:_0n$c,ONE:_1n$d,create:t=>mod$2(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("Invalid field element: expected bigint, got "+typeof t);return _0n$c<=t&&t<e},is0:e=>e===_0n$c,isOdd:e=>(e&_1n$d)===_1n$d,neg:t=>mod$2(-t,e),eql:(e,t)=>e===t,sqr:t=>mod$2(t*t,e),add:(t,n)=>mod$2(t+n,e),sub:(t,n)=>mod$2(t-n,e),mul:(t,n)=>mod$2(t*n,e),pow:(e,t)=>FpPow$2(a,e,t),div:(t,n)=>mod$2(t*invert$2(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>invert$2(t,e),sqrt:r.sqrt||(e=>s(a,e)),invertBatch:e=>FpInvertBatch$2(a,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?numberToBytesLE$2(e,i):numberToBytesBE$2(e,i),fromBytes:e=>{if(e.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${e.length}`);return n?bytesToNumberLE$2(e):bytesToNumberBE$2(e)}});return Object.freeze(a)}function hashToPrivateScalar$1(e,t,n=!1){const r=(e=ensureBytes$3("privateHash",e)).length,o=nLength$2(t).nByteLength+8;if(o<24||r<o||r>1024)throw new Error(`hashToPrivateScalar: expected ${o}-1024 bytes of input, got ${r}`);return mod$2(n?bytesToNumberLE$2(e):bytesToNumberBE$2(e),t-_1n$d)+_1n$d}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$b=BigInt(0),_1n$c=BigInt(1);function wNAF$2(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,o=t;for(;n>_0n$b;)n&_1n$c&&(r=r.add(o)),o=o.double(),n>>=_1n$c;return r},precomputeWindow(e,t){const{windows:n,windowSize:o}=r(t),i=[];let s=e,a=s;for(let e=0;e<n;e++){a=s,i.push(a);for(let e=1;e<o;e++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(t,o,i){const{windows:s,windowSize:a}=r(t);let c=e.ZERO,u=e.BASE;const l=BigInt(2**t-1),h=2**t,d=BigInt(t);for(let e=0;e<s;e++){const t=e*a;let r=Number(i&l);i>>=d,r>a&&(r-=h,i+=_1n$c);const s=t,f=t+Math.abs(r)-1,p=e%2!=0,y=r<0;0===r?u=u.add(n(p,o[s])):c=c.add(n(y,o[f]))}return{p:c,f:u}},wNAFCached(e,t,n,r){const o=e._WINDOW_SIZE||1;let i=t.get(e);return i||(i=this.precomputeWindow(e,o),1!==o&&t.set(e,r(i))),this.wNAF(o,i,n)}}}function validateBasic$2(e){return validateField$2(e.Fp),validateObject$2(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength$2(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validatePointOpts$2(e){const t=validateBasic$2(e);validateObject$2(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:b2n$2,hexToBytes:h2b$2}=ut$2,DER$2={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){const{Err:t}=DER$2;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(128&r[0])throw new t("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:b2n$2(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=DER$2,n="string"==typeof e?h2b$2(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:o,l:i}=DER$2._parseInt(n.subarray(2)),{d:s,l:a}=DER$2._parseInt(i);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:s}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?`0${t}`:t},r=t(n(e.s)),o=t(n(e.r)),i=r.length/2,s=o.length/2,a=n(i),c=n(s);return`30${n(s+i+4)}02${c}${o}02${a}${r}`}},_0n$a=BigInt(0),_1n$b=BigInt(1);BigInt(2);const _3n$4=BigInt(3);function weierstrassPoints$2(e){const t=validatePointOpts$2(e),{Fp:n}=t,r=t.toBytes||((e,t,r)=>{const o=t.toAffine();return concatBytes$5(Uint8Array.from([4]),n.toBytes(o.x),n.toBytes(o.y))}),o=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function i(e){const{a:r,b:o}=t,i=n.sqr(e),s=n.mul(i,e);return n.add(n.add(s,n.mul(e,r)),o)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"==typeof e&&_0n$a<e&&e<t.n}function a(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:o,n:i}=t;if(n&&"bigint"!=typeof e){if(e instanceof Uint8Array&&(e=bytesToHex$4(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*r,"0")}let s;try{s="bigint"==typeof e?e:bytesToNumberBE$2(ensureBytes$3("private key",e,r))}catch(t){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof e}`)}return o&&(s=mod$2(s,i)),a(s),s}const u=new Map;function l(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof h)throw new Error("projective point not allowed");const o=e=>n.eql(e,n.ZERO);return o(t)&&o(r)?h.ZERO:new h(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}static fromHex(e){const t=h.fromAffine(o(ensureBytes$3("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return h.BASE.multiply(c(e))}_setWindowSize(e){this._WINDOW_SIZE=e,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const o=n.sqr(r),s=i(e);if(!n.eql(o,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){l(e);const{px:t,py:r,pz:o}=this,{px:i,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(i,o)),u=n.eql(n.mul(r,a),n.mul(s,o));return c&&u}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,o=n.mul(r,_3n$4),{px:i,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,d=n.mul(i,i),f=n.mul(s,s),p=n.mul(a,a),y=n.mul(i,s);return y=n.add(y,y),l=n.mul(i,a),l=n.add(l,l),c=n.mul(e,l),u=n.mul(o,p),u=n.add(c,u),c=n.sub(f,u),u=n.add(f,u),u=n.mul(c,u),c=n.mul(y,c),l=n.mul(o,l),p=n.mul(e,p),y=n.sub(d,p),y=n.mul(e,y),y=n.add(y,l),l=n.add(d,d),d=n.add(l,d),d=n.add(d,p),d=n.mul(d,y),u=n.add(u,d),p=n.mul(s,a),p=n.add(p,p),d=n.mul(p,y),c=n.sub(c,d),l=n.mul(p,f),l=n.add(l,l),l=n.add(l,l),new h(c,u,l)}add(e){l(e);const{px:r,py:o,pz:i}=this,{px:s,py:a,pz:c}=e;let u=n.ZERO,d=n.ZERO,f=n.ZERO;const p=t.a,y=n.mul(t.b,_3n$4);let g=n.mul(r,s),b=n.mul(o,a),m=n.mul(i,c),w=n.add(r,o),$=n.add(s,a);w=n.mul(w,$),$=n.add(g,b),w=n.sub(w,$),$=n.add(r,i);let _=n.add(s,c);return $=n.mul($,_),_=n.add(g,m),$=n.sub($,_),_=n.add(o,i),u=n.add(a,c),_=n.mul(_,u),u=n.add(b,m),_=n.sub(_,u),f=n.mul(p,$),u=n.mul(y,m),f=n.add(u,f),u=n.sub(b,f),f=n.add(b,f),d=n.mul(u,f),b=n.add(g,g),b=n.add(b,g),m=n.mul(p,m),$=n.mul(y,$),b=n.add(b,m),m=n.sub(g,m),m=n.mul(p,m),$=n.add($,m),g=n.mul(b,$),d=n.add(d,g),g=n.mul(_,$),u=n.mul(w,u),u=n.sub(u,g),g=n.mul(w,b),f=n.mul(_,f),f=n.add(f,g),new h(u,d,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(h.ZERO)}wNAF(e){return f.wNAFCached(this,u,e,(e=>{const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}))}multiplyUnsafe(e){const r=h.ZERO;if(e===_0n$a)return r;if(a(e),e===_1n$b)return this;const{endo:o}=t;if(!o)return f.unsafeLadder(this,e);let{k1neg:i,k1:s,k2neg:c,k2:u}=o.splitScalar(e),l=r,d=r,p=this;for(;s>_0n$a||u>_0n$a;)s&_1n$b&&(l=l.add(p)),u&_1n$b&&(d=d.add(p)),p=p.double(),s>>=_1n$b,u>>=_1n$b;return i&&(l=l.negate()),c&&(d=d.negate()),d=new h(n.mul(d.px,o.beta),d.py,d.pz),l.add(d)}multiply(e){a(e);let r,o,i=e;const{endo:s}=t;if(s){const{k1neg:e,k1:t,k2neg:a,k2:c}=s.splitScalar(i);let{p:u,f:l}=this.wNAF(t),{p:d,f:p}=this.wNAF(c);u=f.constTimeNegate(e,u),d=f.constTimeNegate(a,d),d=new h(n.mul(d.px,s.beta),d.py,d.pz),r=u.add(d),o=l.add(p)}else{const{p:e,f:t}=this.wNAF(i);r=e,o=t}return h.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(e,t,n){const r=h.BASE,o=(e,t)=>t!==_0n$a&&t!==_1n$b&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),i=o(this,t).add(o(e,n));return i.is0()?void 0:i}toAffine(e){const{px:t,py:r,pz:o}=this,i=this.is0();null==e&&(e=i?n.ONE:n.inv(o));const s=n.mul(t,e),a=n.mul(r,e),c=n.mul(o,e);if(i)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===_1n$b)return!0;if(n)return n(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===_1n$b?this:n?n(h,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return this.assertValidity(),r(h,this,e)}toHex(e=!0){return bytesToHex$4(this.toRawBytes(e))}}h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const d=t.nBitLength,f=wNAF$2(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:s}}function validateOpts$2(e){const t=validateBasic$2(e);return validateObject$2(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function weierstrass$2(e){const t=validateOpts$2(e),{Fp:n,n:r}=t,o=n.BYTES+1,i=2*n.BYTES+1;function s(e){return mod$2(e,r)}function a(e){return invert$2(e,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:h}=weierstrassPoints$2({...t,toBytes(e,t,r){const o=t.toAffine(),i=n.toBytes(o.x),s=concatBytes$5;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),i):s(Uint8Array.from([4]),i,n.toBytes(o.y))},fromBytes(e){const t=e.length,r=e[0],s=e.subarray(1);if(t!==o||2!==r&&3!==r){if(t===i&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error(`Point of length ${t} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}{const e=bytesToNumberBE$2(s);if(!(_0n$a<(a=e)&&a<n.ORDER))throw new Error("Point is not on curve");const t=l(e);let o=n.sqrt(t);return!(1&~r)!==((o&_1n$b)===_1n$b)&&(o=n.neg(o)),{x:e,y:o}}var a}}),d=e=>bytesToHex$4(numberToBytesBE$2(e,t.nByteLength));function f(e){return e>r>>_1n$b}const p=(e,t,n)=>bytesToNumberBE$2(e.slice(t,n));class y{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=ensureBytes$3("compactSignature",e,2*n),new y(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=DER$2.toSig(ensureBytes$3("DER",e));return new y(t,n)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:o,recovery:i}=this,u=w(ensureBytes$3("msgHash",e));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const l=2===i||3===i?r+t.n:r;if(l>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=1&i?"03":"02",f=c.fromHex(h+d(l)),p=a(l),y=s(-u*p),g=s(o*p),b=c.BASE.multiplyAndAddUnsafe(f,y,g);if(!b)throw new Error("point at infinify");return b.assertValidity(),b}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$3(this.toDERHex())}toDERHex(){return DER$2.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$3(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const g={isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>numberToBytesBE$2(hashToPrivateScalar$1(t.randomBytes(n.BYTES+8),r),t.nByteLength),precompute:(e=8,t=c.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function b(e){const t=e instanceof Uint8Array,n="string"==typeof e,r=(t||n)&&e.length;return t?r===o||r===i:n?r===2*o||r===2*i:e instanceof c}const m=t.bits2int||function(e){const n=bytesToNumberBE$2(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},w=t.bits2int_modN||function(e){return s(m(e))},$=bitMask$2(t.nBitLength);function _(e){if("bigint"!=typeof e)throw new Error("bigint expected");if(!(_0n$a<=e&&e<$))throw new Error(`bigint expected < 2^${t.nBitLength}`);return numberToBytesBE$2(e,t.nByteLength)}function E(e,r,o=v){if(["recovered","canonical"].some((e=>e in o)))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:l}=t;let{lowS:d,prehash:p,extraEntropy:g}=o;null==d&&(d=!0),e=ensureBytes$3("msgHash",e),p&&(e=ensureBytes$3("prehashed msgHash",i(e)));const b=w(e),$=u(r),E=[_($),_(b)];if(null!=g){const e=!0===g?l(n.BYTES):g;E.push(ensureBytes$3("extraEntropy",e,n.BYTES))}const x=concatBytes$5(...E),k=b;return{seed:x,k2sig:function(e){const t=m(e);if(!h(t))return;const n=a(t),r=c.BASE.multiply(t).toAffine(),o=s(r.x);if(o===_0n$a)return;const i=s(n*s(k+o*$));if(i===_0n$a)return;let u=(r.x===o?0:2)|Number(r.y&_1n$b),l=i;return d&&f(i)&&(l=function(e){return f(e)?s(-e):e}(i),u^=1),new y(o,l,u)}}}const v={lowS:t.lowS,prehash:!1},x={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,n=!0){if(b(e))throw new Error("first arg must be private key");if(!b(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(u(e)).toRawBytes(n)},sign:function(e,n,r=v){const{seed:o,k2sig:i}=E(e,n,r),s=t;return createHmacDrbg$2(s.hash.outputLen,s.nByteLength,s.hmac)(o,i)},verify:function(e,n,r,o=x){const i=e;if(n=ensureBytes$3("msgHash",n),r=ensureBytes$3("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:l}=o;let h,d;try{if("string"==typeof i||i instanceof Uint8Array)try{h=y.fromDER(i)}catch(e){if(!(e instanceof DER$2.Err))throw e;h=y.fromCompact(i)}else{if("object"!=typeof i||"bigint"!=typeof i.r||"bigint"!=typeof i.s)throw new Error("PARSE");{const{r:e,s:t}=i;h=new y(e,t)}}d=c.fromHex(r)}catch(e){if("PARSE"===e.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&h.hasHighS())return!1;l&&(n=t.hash(n));const{r:f,s:p}=h,g=w(n),b=a(p),m=s(g*b),$=s(f*b),_=c.BASE.multiplyAndAddUnsafe(d,m,$)?.toAffine();return!!_&&s(_.x)===f},ProjectivePoint:c,Signature:y,utils:g}}BigInt(4);let HMAC$4=class extends Hash$4{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,assert$4.hash(e);const n=toBytes$5(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<o.length;e++)o[e]^=54;this.iHash.update(o),this.oHash=e.create();for(let e=0;e<o.length;e++)o[e]^=106;this.oHash.update(o),o.fill(0)}update(e){return assert$4.exists(this),this.iHash.update(e),this}digestInto(e){assert$4.exists(this),assert$4.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return e.finished=r,e.destroyed=o,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$4=(e,t,n)=>new HMAC$4(e,t).update(n).digest();
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function getHash$2(e){return{hash:e,hmac:(t,...n)=>hmac$4(e,t,concatBytes$6(...n)),randomBytes:randomBytes$3}}function createCurve$2(e,t){const n=t=>weierstrass$2({...e,...getHash$2(t)});return Object.freeze({...n(t),create:n})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */hmac$4.create=(e,t)=>new HMAC$4(e,t);const secp256k1P$2=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N$2=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n$a=BigInt(1),_2n$6=BigInt(2),divNearest$2=(e,t)=>(e+t/_2n$6)/t;function sqrtMod$2(e){const t=secp256k1P$2,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),u=e*e*e%t,l=u*u*e%t,h=pow2$2(l,n,t)*l%t,d=pow2$2(h,n,t)*l%t,f=pow2$2(d,_2n$6,t)*u%t,p=pow2$2(f,o,t)*f%t,y=pow2$2(p,i,t)*p%t,g=pow2$2(y,a,t)*y%t,b=pow2$2(g,c,t)*g%t,m=pow2$2(b,a,t)*y%t,w=pow2$2(m,n,t)*l%t,$=pow2$2(w,s,t)*p%t,_=pow2$2($,r,t)*u%t,E=pow2$2(_,_2n$6,t);if(!Fp$2.eql(Fp$2.sqr(E),e))throw new Error("Cannot find square root");return E}const Fp$2=Field$2(secp256k1P$2,void 0,void 0,{sqrt:sqrtMod$2}),secp256k1$2=createCurve$2({a:BigInt(0),b:BigInt(7),Fp:Fp$2,n:secp256k1N$2,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=secp256k1N$2,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-_1n$a*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=divNearest$2(i*e,t),c=divNearest$2(-r*e,t);let u=mod$2(e-a*n-c*o,t),l=mod$2(-a*r-c*i,t);const h=u>s,d=l>s;if(h&&(u=t-u),d&&(l=t-l),u>s||l>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:d,k2:l}}}},sha256$4),_0n$9=BigInt(0),fe$1=e=>"bigint"==typeof e&&_0n$9<e&&e<secp256k1P$2,ge$1=e=>"bigint"==typeof e&&_0n$9<e&&e<secp256k1N$2,TAGGED_HASH_PREFIXES$1={};function taggedHash$1(e,...t){let n=TAGGED_HASH_PREFIXES$1[e];if(void 0===n){const t=sha256$4(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=concatBytes$5(t,t),TAGGED_HASH_PREFIXES$1[e]=n}return sha256$4(concatBytes$5(n,...t))}const pointToBytes$1=e=>e.toRawBytes(!0).slice(1),numTo32b$1=e=>numberToBytesBE$2(e,32),modP$1=e=>mod$2(e,secp256k1P$2),modN$1=e=>mod$2(e,secp256k1N$2),Point$2=secp256k1$2.ProjectivePoint,GmulAdd$1=(e,t,n)=>Point$2.BASE.multiplyAndAddUnsafe(e,t,n);function schnorrGetExtPubKey$1(e){let t=secp256k1$2.utils.normPrivateKeyToScalar(e),n=Point$2.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:modN$1(-t),bytes:pointToBytes$1(n)}}function lift_x$1(e){if(!fe$1(e))throw new Error("bad x: need 0 < x < p");const t=modP$1(e*e);let n=sqrtMod$2(modP$1(t*e+BigInt(7)));n%_2n$6!==_0n$9&&(n=modP$1(-n));const r=new Point$2(e,n,_1n$a);return r.assertValidity(),r}function challenge$1(...e){return modN$1(bytesToNumberBE$2(taggedHash$1("BIP0340/challenge",...e)))}function schnorrGetPublicKey$1(e){return schnorrGetExtPubKey$1(e).bytes}function schnorrSign$1(e,t,n=randomBytes$3(32)){const r=ensureBytes$3("message",e),{bytes:o,scalar:i}=schnorrGetExtPubKey$1(t),s=ensureBytes$3("auxRand",n,32),a=numTo32b$1(i^bytesToNumberBE$2(taggedHash$1("BIP0340/aux",s))),c=taggedHash$1("BIP0340/nonce",a,o,r),u=modN$1(bytesToNumberBE$2(c));if(u===_0n$9)throw new Error("sign failed: k is zero");const{bytes:l,scalar:h}=schnorrGetExtPubKey$1(u),d=challenge$1(l,o,r),f=new Uint8Array(64);if(f.set(l,0),f.set(numTo32b$1(modN$1(h+d*i)),32),!schnorrVerify$1(f,r,o))throw new Error("sign: Invalid signature produced");return f}function schnorrVerify$1(e,t,n){const r=ensureBytes$3("signature",e,64),o=ensureBytes$3("message",t),i=ensureBytes$3("publicKey",n,32);try{const e=lift_x$1(bytesToNumberBE$2(i)),t=bytesToNumberBE$2(r.subarray(0,32));if(!fe$1(t))return!1;const n=bytesToNumberBE$2(r.subarray(32,64));if(!ge$1(n))return!1;const s=challenge$1(numTo32b$1(t),pointToBytes$1(e),o),a=GmulAdd$1(e,n,modN$1(-s));return!(!a||!a.hasEvenY()||a.toAffine().x!==t)}catch(e){return!1}}const schnorr$1=(()=>({getPublicKey:schnorrGetPublicKey$1,sign:schnorrSign$1,verify:schnorrVerify$1,utils:{randomPrivateKey:secp256k1$2.utils.randomPrivateKey,lift_x:lift_x$1,pointToBytes:pointToBytes$1,numberToBytesBE:numberToBytesBE$2,bytesToNumberBE:bytesToNumberBE$2,taggedHash:taggedHash$1,mod:mod$2}}))();
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function assertNumber(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function chain$1(...e){const t=(e,t)=>n=>e(t(n));return{encode:Array.from(e).reverse().reduce(((e,n)=>e?t(e,n.encode):n.encode),void 0),decode:e.reduce(((e,n)=>e?t(e,n.decode):n.decode),void 0)}}function alphabet$1(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("alphabet.encode input should be an array of numbers");return t.map((t=>{if(assertNumber(t),t<0||t>=e.length)throw new Error(`Digit index outside alphabet: ${t} (alphabet: ${e.length})`);return e[t]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const n=e.indexOf(t);if(-1===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}}function join$1(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function padding$1(e,t="="){if(assertNumber(e),"string"!=typeof t)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function normalize$1(e){if("function"!=typeof e)throw new Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function convertRadix$1(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const o=[],i=Array.from(e);for(i.forEach((e=>{if(assertNumber(e),e<0||e>=t)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,s=!0;for(let o=r;o<i.length;o++){const a=i[o],c=t*e+a;if(!Number.isSafeInteger(c)||t*e/t!==e||c-a!=t*e)throw new Error("convertRadix: carry overflow");if(e=c%n,i[o]=Math.floor(c/n),!Number.isSafeInteger(i[o])||i[o]*n+e!==c)throw new Error("convertRadix: carry overflow");s&&(i[o]?s=!1:r=o)}if(o.push(e),s)break}for(let t=0;t<e.length-1&&0===e[t];t++)o.push(0);return o.reverse()}const gcd$1=(e,t)=>t?gcd$1(t,e%t):e,radix2carry$1=(e,t)=>e+(t-gcd$1(e,t));function convertRadix2$1(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(radix2carry$1(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${radix2carry$1(t,n)}`);let o=0,i=0;const s=2**n-1,a=[];for(const r of e){if(assertNumber(r),r>=2**t)throw new Error(`convertRadix2: invalid data word=${r} from=${t}`);if(o=o<<t|r,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)a.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=t)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&a.push(o>>>0),a}function radix$1(e){return assertNumber(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return convertRadix$1(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(convertRadix$1(t,e,256))}}}function radix2$1(e,t=!1){if(assertNumber(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry$1(8,e)>32||radix2carry$1(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!(n instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2$1(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(convertRadix2$1(n,e,8,t))}}}function unsafeWrapper$1(e){if("function"!=typeof e)throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch(e){}}}const base16=chain$1(radix2$1(4),alphabet$1("0123456789ABCDEF"),join$1("")),base32=chain$1(radix2$1(5),alphabet$1("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),padding$1(5),join$1(""));chain$1(radix2$1(5),alphabet$1("0123456789ABCDEFGHIJKLMNOPQRSTUV"),padding$1(5),join$1("")),chain$1(radix2$1(5),alphabet$1("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),join$1(""),normalize$1((e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1"))));const base64=chain$1(radix2$1(6),alphabet$1("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),padding$1(6),join$1("")),base64url=chain$1(radix2$1(6),alphabet$1("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),padding$1(6),join$1("")),genBase58$1=e=>chain$1(radix$1(58),alphabet$1(e),join$1("")),base58$1=genBase58$1("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");genBase58$1("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),genBase58$1("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const XMR_BLOCK_LEN=[0,2,3,5,6,7,9,10,11],base58xmr={encode(e){let t="";for(let n=0;n<e.length;n+=8){const r=e.subarray(n,n+8);t+=base58$1.encode(r).padStart(XMR_BLOCK_LEN[r.length],"1")}return t},decode(e){let t=[];for(let n=0;n<e.length;n+=11){const r=e.slice(n,n+11),o=XMR_BLOCK_LEN.indexOf(r.length),i=base58$1.decode(r);for(let e=0;e<i.length-o;e++)if(0!==i[e])throw new Error("base58xmr: wrong padding");t=t.concat(Array.from(i.slice(i.length-o)))}return Uint8Array.from(t)}},BECH_ALPHABET$1=chain$1(alphabet$1("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),join$1("")),POLYMOD_GENERATORS$1=[996825010,642813549,513874426,1027748829,705979059];function bech32Polymod$1(e){const t=e>>25;let n=(33554431&e)<<5;for(let e=0;e<POLYMOD_GENERATORS$1.length;e++)1==(t>>e&1)&&(n^=POLYMOD_GENERATORS$1[e]);return n}function bechChecksum$1(e,t,n=1){const r=e.length;let o=1;for(let t=0;t<r;t++){const n=e.charCodeAt(t);if(n<33||n>126)throw new Error(`Invalid prefix (${e})`);o=bech32Polymod$1(o)^n>>5}o=bech32Polymod$1(o);for(let t=0;t<r;t++)o=bech32Polymod$1(o)^31&e.charCodeAt(t);for(let e of t)o=bech32Polymod$1(o)^e;for(let e=0;e<6;e++)o=bech32Polymod$1(o);return o^=n,BECH_ALPHABET$1.encode(convertRadix2$1([o%2**30],30,5,!1))}function genBech32$1(e){const t="bech32"===e?1:734539939,n=radix2$1(5),r=n.decode,o=n.encode,i=unsafeWrapper$1(r);function s(e,n=90){if("string"!=typeof e)throw new Error("bech32.decode input should be string, not "+typeof e);if(e.length<8||!1!==n&&e.length>n)throw new TypeError(`Wrong string length: ${e.length} (${e}). Expected (8..${n})`);const r=e.toLowerCase();if(e!==r&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=(e=r).lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=e.slice(0,o),s=e.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=BECH_ALPHABET$1.decode(s).slice(0,-6),c=bechChecksum$1(i,a,t);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${e}: expected "${c}"`);return{prefix:i,words:a}}return{encode:function(e,n,r=90){if("string"!=typeof e)throw new Error("bech32.encode prefix should be string, not "+typeof e);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);const o=e.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);return`${e=e.toLowerCase()}1${BECH_ALPHABET$1.encode(n)}${bechChecksum$1(e,n,t)}`},decode:s,decodeToBytes:function(e){const{prefix:t,words:n}=s(e,!1);return{prefix:t,words:n,bytes:r(n)}},decodeUnsafe:unsafeWrapper$1(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}const bech32$1=genBech32$1("bech32");genBech32$1("bech32m");const utf8={encode:e=>(new TextDecoder).decode(e),decode:e=>(new TextEncoder).encode(e)},hex=chain$1(radix2$1(4),alphabet$1("0123456789abcdef"),join$1(""),normalize$1((e=>{if("string"!=typeof e||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()}))),CODERS={utf8:utf8,hex:hex,base16:base16,base32:base32,base64:base64,base64url:base64url,base58:base58$1,base58xmr:base58xmr};Object.keys(CODERS).join(", ");const wordlist="abandon\nability\nable\nabout\nabove\nabsent\nabsorb\nabstract\nabsurd\nabuse\naccess\naccident\naccount\naccuse\nachieve\nacid\nacoustic\nacquire\nacross\nact\naction\nactor\nactress\nactual\nadapt\nadd\naddict\naddress\nadjust\nadmit\nadult\nadvance\nadvice\naerobic\naffair\nafford\nafraid\nagain\nage\nagent\nagree\nahead\naim\nair\nairport\naisle\nalarm\nalbum\nalcohol\nalert\nalien\nall\nalley\nallow\nalmost\nalone\nalpha\nalready\nalso\nalter\nalways\namateur\namazing\namong\namount\namused\nanalyst\nanchor\nancient\nanger\nangle\nangry\nanimal\nankle\nannounce\nannual\nanother\nanswer\nantenna\nantique\nanxiety\nany\napart\napology\nappear\napple\napprove\napril\narch\narctic\narea\narena\nargue\narm\narmed\narmor\narmy\naround\narrange\narrest\narrive\narrow\nart\nartefact\nartist\nartwork\nask\naspect\nassault\nasset\nassist\nassume\nasthma\nathlete\natom\nattack\nattend\nattitude\nattract\nauction\naudit\naugust\naunt\nauthor\nauto\nautumn\naverage\navocado\navoid\nawake\naware\naway\nawesome\nawful\nawkward\naxis\nbaby\nbachelor\nbacon\nbadge\nbag\nbalance\nbalcony\nball\nbamboo\nbanana\nbanner\nbar\nbarely\nbargain\nbarrel\nbase\nbasic\nbasket\nbattle\nbeach\nbean\nbeauty\nbecause\nbecome\nbeef\nbefore\nbegin\nbehave\nbehind\nbelieve\nbelow\nbelt\nbench\nbenefit\nbest\nbetray\nbetter\nbetween\nbeyond\nbicycle\nbid\nbike\nbind\nbiology\nbird\nbirth\nbitter\nblack\nblade\nblame\nblanket\nblast\nbleak\nbless\nblind\nblood\nblossom\nblouse\nblue\nblur\nblush\nboard\nboat\nbody\nboil\nbomb\nbone\nbonus\nbook\nboost\nborder\nboring\nborrow\nboss\nbottom\nbounce\nbox\nboy\nbracket\nbrain\nbrand\nbrass\nbrave\nbread\nbreeze\nbrick\nbridge\nbrief\nbright\nbring\nbrisk\nbroccoli\nbroken\nbronze\nbroom\nbrother\nbrown\nbrush\nbubble\nbuddy\nbudget\nbuffalo\nbuild\nbulb\nbulk\nbullet\nbundle\nbunker\nburden\nburger\nburst\nbus\nbusiness\nbusy\nbutter\nbuyer\nbuzz\ncabbage\ncabin\ncable\ncactus\ncage\ncake\ncall\ncalm\ncamera\ncamp\ncan\ncanal\ncancel\ncandy\ncannon\ncanoe\ncanvas\ncanyon\ncapable\ncapital\ncaptain\ncar\ncarbon\ncard\ncargo\ncarpet\ncarry\ncart\ncase\ncash\ncasino\ncastle\ncasual\ncat\ncatalog\ncatch\ncategory\ncattle\ncaught\ncause\ncaution\ncave\nceiling\ncelery\ncement\ncensus\ncentury\ncereal\ncertain\nchair\nchalk\nchampion\nchange\nchaos\nchapter\ncharge\nchase\nchat\ncheap\ncheck\ncheese\nchef\ncherry\nchest\nchicken\nchief\nchild\nchimney\nchoice\nchoose\nchronic\nchuckle\nchunk\nchurn\ncigar\ncinnamon\ncircle\ncitizen\ncity\ncivil\nclaim\nclap\nclarify\nclaw\nclay\nclean\nclerk\nclever\nclick\nclient\ncliff\nclimb\nclinic\nclip\nclock\nclog\nclose\ncloth\ncloud\nclown\nclub\nclump\ncluster\nclutch\ncoach\ncoast\ncoconut\ncode\ncoffee\ncoil\ncoin\ncollect\ncolor\ncolumn\ncombine\ncome\ncomfort\ncomic\ncommon\ncompany\nconcert\nconduct\nconfirm\ncongress\nconnect\nconsider\ncontrol\nconvince\ncook\ncool\ncopper\ncopy\ncoral\ncore\ncorn\ncorrect\ncost\ncotton\ncouch\ncountry\ncouple\ncourse\ncousin\ncover\ncoyote\ncrack\ncradle\ncraft\ncram\ncrane\ncrash\ncrater\ncrawl\ncrazy\ncream\ncredit\ncreek\ncrew\ncricket\ncrime\ncrisp\ncritic\ncrop\ncross\ncrouch\ncrowd\ncrucial\ncruel\ncruise\ncrumble\ncrunch\ncrush\ncry\ncrystal\ncube\nculture\ncup\ncupboard\ncurious\ncurrent\ncurtain\ncurve\ncushion\ncustom\ncute\ncycle\ndad\ndamage\ndamp\ndance\ndanger\ndaring\ndash\ndaughter\ndawn\nday\ndeal\ndebate\ndebris\ndecade\ndecember\ndecide\ndecline\ndecorate\ndecrease\ndeer\ndefense\ndefine\ndefy\ndegree\ndelay\ndeliver\ndemand\ndemise\ndenial\ndentist\ndeny\ndepart\ndepend\ndeposit\ndepth\ndeputy\nderive\ndescribe\ndesert\ndesign\ndesk\ndespair\ndestroy\ndetail\ndetect\ndevelop\ndevice\ndevote\ndiagram\ndial\ndiamond\ndiary\ndice\ndiesel\ndiet\ndiffer\ndigital\ndignity\ndilemma\ndinner\ndinosaur\ndirect\ndirt\ndisagree\ndiscover\ndisease\ndish\ndismiss\ndisorder\ndisplay\ndistance\ndivert\ndivide\ndivorce\ndizzy\ndoctor\ndocument\ndog\ndoll\ndolphin\ndomain\ndonate\ndonkey\ndonor\ndoor\ndose\ndouble\ndove\ndraft\ndragon\ndrama\ndrastic\ndraw\ndream\ndress\ndrift\ndrill\ndrink\ndrip\ndrive\ndrop\ndrum\ndry\nduck\ndumb\ndune\nduring\ndust\ndutch\nduty\ndwarf\ndynamic\neager\neagle\nearly\nearn\nearth\neasily\neast\neasy\necho\necology\neconomy\nedge\nedit\neducate\neffort\negg\neight\neither\nelbow\nelder\nelectric\nelegant\nelement\nelephant\nelevator\nelite\nelse\nembark\nembody\nembrace\nemerge\nemotion\nemploy\nempower\nempty\nenable\nenact\nend\nendless\nendorse\nenemy\nenergy\nenforce\nengage\nengine\nenhance\nenjoy\nenlist\nenough\nenrich\nenroll\nensure\nenter\nentire\nentry\nenvelope\nepisode\nequal\nequip\nera\nerase\nerode\nerosion\nerror\nerupt\nescape\nessay\nessence\nestate\neternal\nethics\nevidence\nevil\nevoke\nevolve\nexact\nexample\nexcess\nexchange\nexcite\nexclude\nexcuse\nexecute\nexercise\nexhaust\nexhibit\nexile\nexist\nexit\nexotic\nexpand\nexpect\nexpire\nexplain\nexpose\nexpress\nextend\nextra\neye\neyebrow\nfabric\nface\nfaculty\nfade\nfaint\nfaith\nfall\nfalse\nfame\nfamily\nfamous\nfan\nfancy\nfantasy\nfarm\nfashion\nfat\nfatal\nfather\nfatigue\nfault\nfavorite\nfeature\nfebruary\nfederal\nfee\nfeed\nfeel\nfemale\nfence\nfestival\nfetch\nfever\nfew\nfiber\nfiction\nfield\nfigure\nfile\nfilm\nfilter\nfinal\nfind\nfine\nfinger\nfinish\nfire\nfirm\nfirst\nfiscal\nfish\nfit\nfitness\nfix\nflag\nflame\nflash\nflat\nflavor\nflee\nflight\nflip\nfloat\nflock\nfloor\nflower\nfluid\nflush\nfly\nfoam\nfocus\nfog\nfoil\nfold\nfollow\nfood\nfoot\nforce\nforest\nforget\nfork\nfortune\nforum\nforward\nfossil\nfoster\nfound\nfox\nfragile\nframe\nfrequent\nfresh\nfriend\nfringe\nfrog\nfront\nfrost\nfrown\nfrozen\nfruit\nfuel\nfun\nfunny\nfurnace\nfury\nfuture\ngadget\ngain\ngalaxy\ngallery\ngame\ngap\ngarage\ngarbage\ngarden\ngarlic\ngarment\ngas\ngasp\ngate\ngather\ngauge\ngaze\ngeneral\ngenius\ngenre\ngentle\ngenuine\ngesture\nghost\ngiant\ngift\ngiggle\nginger\ngiraffe\ngirl\ngive\nglad\nglance\nglare\nglass\nglide\nglimpse\nglobe\ngloom\nglory\nglove\nglow\nglue\ngoat\ngoddess\ngold\ngood\ngoose\ngorilla\ngospel\ngossip\ngovern\ngown\ngrab\ngrace\ngrain\ngrant\ngrape\ngrass\ngravity\ngreat\ngreen\ngrid\ngrief\ngrit\ngrocery\ngroup\ngrow\ngrunt\nguard\nguess\nguide\nguilt\nguitar\ngun\ngym\nhabit\nhair\nhalf\nhammer\nhamster\nhand\nhappy\nharbor\nhard\nharsh\nharvest\nhat\nhave\nhawk\nhazard\nhead\nhealth\nheart\nheavy\nhedgehog\nheight\nhello\nhelmet\nhelp\nhen\nhero\nhidden\nhigh\nhill\nhint\nhip\nhire\nhistory\nhobby\nhockey\nhold\nhole\nholiday\nhollow\nhome\nhoney\nhood\nhope\nhorn\nhorror\nhorse\nhospital\nhost\nhotel\nhour\nhover\nhub\nhuge\nhuman\nhumble\nhumor\nhundred\nhungry\nhunt\nhurdle\nhurry\nhurt\nhusband\nhybrid\nice\nicon\nidea\nidentify\nidle\nignore\nill\nillegal\nillness\nimage\nimitate\nimmense\nimmune\nimpact\nimpose\nimprove\nimpulse\ninch\ninclude\nincome\nincrease\nindex\nindicate\nindoor\nindustry\ninfant\ninflict\ninform\ninhale\ninherit\ninitial\ninject\ninjury\ninmate\ninner\ninnocent\ninput\ninquiry\ninsane\ninsect\ninside\ninspire\ninstall\nintact\ninterest\ninto\ninvest\ninvite\ninvolve\niron\nisland\nisolate\nissue\nitem\nivory\njacket\njaguar\njar\njazz\njealous\njeans\njelly\njewel\njob\njoin\njoke\njourney\njoy\njudge\njuice\njump\njungle\njunior\njunk\njust\nkangaroo\nkeen\nkeep\nketchup\nkey\nkick\nkid\nkidney\nkind\nkingdom\nkiss\nkit\nkitchen\nkite\nkitten\nkiwi\nknee\nknife\nknock\nknow\nlab\nlabel\nlabor\nladder\nlady\nlake\nlamp\nlanguage\nlaptop\nlarge\nlater\nlatin\nlaugh\nlaundry\nlava\nlaw\nlawn\nlawsuit\nlayer\nlazy\nleader\nleaf\nlearn\nleave\nlecture\nleft\nleg\nlegal\nlegend\nleisure\nlemon\nlend\nlength\nlens\nleopard\nlesson\nletter\nlevel\nliar\nliberty\nlibrary\nlicense\nlife\nlift\nlight\nlike\nlimb\nlimit\nlink\nlion\nliquid\nlist\nlittle\nlive\nlizard\nload\nloan\nlobster\nlocal\nlock\nlogic\nlonely\nlong\nloop\nlottery\nloud\nlounge\nlove\nloyal\nlucky\nluggage\nlumber\nlunar\nlunch\nluxury\nlyrics\nmachine\nmad\nmagic\nmagnet\nmaid\nmail\nmain\nmajor\nmake\nmammal\nman\nmanage\nmandate\nmango\nmansion\nmanual\nmaple\nmarble\nmarch\nmargin\nmarine\nmarket\nmarriage\nmask\nmass\nmaster\nmatch\nmaterial\nmath\nmatrix\nmatter\nmaximum\nmaze\nmeadow\nmean\nmeasure\nmeat\nmechanic\nmedal\nmedia\nmelody\nmelt\nmember\nmemory\nmention\nmenu\nmercy\nmerge\nmerit\nmerry\nmesh\nmessage\nmetal\nmethod\nmiddle\nmidnight\nmilk\nmillion\nmimic\nmind\nminimum\nminor\nminute\nmiracle\nmirror\nmisery\nmiss\nmistake\nmix\nmixed\nmixture\nmobile\nmodel\nmodify\nmom\nmoment\nmonitor\nmonkey\nmonster\nmonth\nmoon\nmoral\nmore\nmorning\nmosquito\nmother\nmotion\nmotor\nmountain\nmouse\nmove\nmovie\nmuch\nmuffin\nmule\nmultiply\nmuscle\nmuseum\nmushroom\nmusic\nmust\nmutual\nmyself\nmystery\nmyth\nnaive\nname\nnapkin\nnarrow\nnasty\nnation\nnature\nnear\nneck\nneed\nnegative\nneglect\nneither\nnephew\nnerve\nnest\nnet\nnetwork\nneutral\nnever\nnews\nnext\nnice\nnight\nnoble\nnoise\nnominee\nnoodle\nnormal\nnorth\nnose\nnotable\nnote\nnothing\nnotice\nnovel\nnow\nnuclear\nnumber\nnurse\nnut\noak\nobey\nobject\noblige\nobscure\nobserve\nobtain\nobvious\noccur\nocean\noctober\nodor\noff\noffer\noffice\noften\noil\nokay\nold\nolive\nolympic\nomit\nonce\none\nonion\nonline\nonly\nopen\nopera\nopinion\noppose\noption\norange\norbit\norchard\norder\nordinary\norgan\norient\noriginal\norphan\nostrich\nother\noutdoor\nouter\noutput\noutside\noval\noven\nover\nown\nowner\noxygen\noyster\nozone\npact\npaddle\npage\npair\npalace\npalm\npanda\npanel\npanic\npanther\npaper\nparade\nparent\npark\nparrot\nparty\npass\npatch\npath\npatient\npatrol\npattern\npause\npave\npayment\npeace\npeanut\npear\npeasant\npelican\npen\npenalty\npencil\npeople\npepper\nperfect\npermit\nperson\npet\nphone\nphoto\nphrase\nphysical\npiano\npicnic\npicture\npiece\npig\npigeon\npill\npilot\npink\npioneer\npipe\npistol\npitch\npizza\nplace\nplanet\nplastic\nplate\nplay\nplease\npledge\npluck\nplug\nplunge\npoem\npoet\npoint\npolar\npole\npolice\npond\npony\npool\npopular\nportion\nposition\npossible\npost\npotato\npottery\npoverty\npowder\npower\npractice\npraise\npredict\nprefer\nprepare\npresent\npretty\nprevent\nprice\npride\nprimary\nprint\npriority\nprison\nprivate\nprize\nproblem\nprocess\nproduce\nprofit\nprogram\nproject\npromote\nproof\nproperty\nprosper\nprotect\nproud\nprovide\npublic\npudding\npull\npulp\npulse\npumpkin\npunch\npupil\npuppy\npurchase\npurity\npurpose\npurse\npush\nput\npuzzle\npyramid\nquality\nquantum\nquarter\nquestion\nquick\nquit\nquiz\nquote\nrabbit\nraccoon\nrace\nrack\nradar\nradio\nrail\nrain\nraise\nrally\nramp\nranch\nrandom\nrange\nrapid\nrare\nrate\nrather\nraven\nraw\nrazor\nready\nreal\nreason\nrebel\nrebuild\nrecall\nreceive\nrecipe\nrecord\nrecycle\nreduce\nreflect\nreform\nrefuse\nregion\nregret\nregular\nreject\nrelax\nrelease\nrelief\nrely\nremain\nremember\nremind\nremove\nrender\nrenew\nrent\nreopen\nrepair\nrepeat\nreplace\nreport\nrequire\nrescue\nresemble\nresist\nresource\nresponse\nresult\nretire\nretreat\nreturn\nreunion\nreveal\nreview\nreward\nrhythm\nrib\nribbon\nrice\nrich\nride\nridge\nrifle\nright\nrigid\nring\nriot\nripple\nrisk\nritual\nrival\nriver\nroad\nroast\nrobot\nrobust\nrocket\nromance\nroof\nrookie\nroom\nrose\nrotate\nrough\nround\nroute\nroyal\nrubber\nrude\nrug\nrule\nrun\nrunway\nrural\nsad\nsaddle\nsadness\nsafe\nsail\nsalad\nsalmon\nsalon\nsalt\nsalute\nsame\nsample\nsand\nsatisfy\nsatoshi\nsauce\nsausage\nsave\nsay\nscale\nscan\nscare\nscatter\nscene\nscheme\nschool\nscience\nscissors\nscorpion\nscout\nscrap\nscreen\nscript\nscrub\nsea\nsearch\nseason\nseat\nsecond\nsecret\nsection\nsecurity\nseed\nseek\nsegment\nselect\nsell\nseminar\nsenior\nsense\nsentence\nseries\nservice\nsession\nsettle\nsetup\nseven\nshadow\nshaft\nshallow\nshare\nshed\nshell\nsheriff\nshield\nshift\nshine\nship\nshiver\nshock\nshoe\nshoot\nshop\nshort\nshoulder\nshove\nshrimp\nshrug\nshuffle\nshy\nsibling\nsick\nside\nsiege\nsight\nsign\nsilent\nsilk\nsilly\nsilver\nsimilar\nsimple\nsince\nsing\nsiren\nsister\nsituate\nsix\nsize\nskate\nsketch\nski\nskill\nskin\nskirt\nskull\nslab\nslam\nsleep\nslender\nslice\nslide\nslight\nslim\nslogan\nslot\nslow\nslush\nsmall\nsmart\nsmile\nsmoke\nsmooth\nsnack\nsnake\nsnap\nsniff\nsnow\nsoap\nsoccer\nsocial\nsock\nsoda\nsoft\nsolar\nsoldier\nsolid\nsolution\nsolve\nsomeone\nsong\nsoon\nsorry\nsort\nsoul\nsound\nsoup\nsource\nsouth\nspace\nspare\nspatial\nspawn\nspeak\nspecial\nspeed\nspell\nspend\nsphere\nspice\nspider\nspike\nspin\nspirit\nsplit\nspoil\nsponsor\nspoon\nsport\nspot\nspray\nspread\nspring\nspy\nsquare\nsqueeze\nsquirrel\nstable\nstadium\nstaff\nstage\nstairs\nstamp\nstand\nstart\nstate\nstay\nsteak\nsteel\nstem\nstep\nstereo\nstick\nstill\nsting\nstock\nstomach\nstone\nstool\nstory\nstove\nstrategy\nstreet\nstrike\nstrong\nstruggle\nstudent\nstuff\nstumble\nstyle\nsubject\nsubmit\nsubway\nsuccess\nsuch\nsudden\nsuffer\nsugar\nsuggest\nsuit\nsummer\nsun\nsunny\nsunset\nsuper\nsupply\nsupreme\nsure\nsurface\nsurge\nsurprise\nsurround\nsurvey\nsuspect\nsustain\nswallow\nswamp\nswap\nswarm\nswear\nsweet\nswift\nswim\nswing\nswitch\nsword\nsymbol\nsymptom\nsyrup\nsystem\ntable\ntackle\ntag\ntail\ntalent\ntalk\ntank\ntape\ntarget\ntask\ntaste\ntattoo\ntaxi\nteach\nteam\ntell\nten\ntenant\ntennis\ntent\nterm\ntest\ntext\nthank\nthat\ntheme\nthen\ntheory\nthere\nthey\nthing\nthis\nthought\nthree\nthrive\nthrow\nthumb\nthunder\nticket\ntide\ntiger\ntilt\ntimber\ntime\ntiny\ntip\ntired\ntissue\ntitle\ntoast\ntobacco\ntoday\ntoddler\ntoe\ntogether\ntoilet\ntoken\ntomato\ntomorrow\ntone\ntongue\ntonight\ntool\ntooth\ntop\ntopic\ntopple\ntorch\ntornado\ntortoise\ntoss\ntotal\ntourist\ntoward\ntower\ntown\ntoy\ntrack\ntrade\ntraffic\ntragic\ntrain\ntransfer\ntrap\ntrash\ntravel\ntray\ntreat\ntree\ntrend\ntrial\ntribe\ntrick\ntrigger\ntrim\ntrip\ntrophy\ntrouble\ntruck\ntrue\ntruly\ntrumpet\ntrust\ntruth\ntry\ntube\ntuition\ntumble\ntuna\ntunnel\nturkey\nturn\nturtle\ntwelve\ntwenty\ntwice\ntwin\ntwist\ntwo\ntype\ntypical\nugly\numbrella\nunable\nunaware\nuncle\nuncover\nunder\nundo\nunfair\nunfold\nunhappy\nuniform\nunique\nunit\nuniverse\nunknown\nunlock\nuntil\nunusual\nunveil\nupdate\nupgrade\nuphold\nupon\nupper\nupset\nurban\nurge\nusage\nuse\nused\nuseful\nuseless\nusual\nutility\nvacant\nvacuum\nvague\nvalid\nvalley\nvalve\nvan\nvanish\nvapor\nvarious\nvast\nvault\nvehicle\nvelvet\nvendor\nventure\nvenue\nverb\nverify\nversion\nvery\nvessel\nveteran\nviable\nvibrant\nvicious\nvictory\nvideo\nview\nvillage\nvintage\nviolin\nvirtual\nvirus\nvisa\nvisit\nvisual\nvital\nvivid\nvocal\nvoice\nvoid\nvolcano\nvolume\nvote\nvoyage\nwage\nwagon\nwait\nwalk\nwall\nwalnut\nwant\nwarfare\nwarm\nwarrior\nwash\nwasp\nwaste\nwater\nwave\nway\nwealth\nweapon\nwear\nweasel\nweather\nweb\nwedding\nweekend\nweird\nwelcome\nwest\nwet\nwhale\nwhat\nwheat\nwheel\nwhen\nwhere\nwhip\nwhisper\nwide\nwidth\nwife\nwild\nwill\nwin\nwindow\nwine\nwing\nwink\nwinner\nwinter\nwire\nwisdom\nwise\nwish\nwitness\nwolf\nwoman\nwonder\nwood\nwool\nword\nwork\nworld\nworry\nworth\nwrap\nwreck\nwrestle\nwrist\nwrite\nwrong\nyard\nyear\nyellow\nyou\nyoung\nyouth\nzebra\nzero\nzone\nzoo".split("\n");function number$4(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bool$2(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)}function isBytes$6(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function bytes$4(e,...t){if(!isBytes$6(e))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$4(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");number$4(e.outputLen),number$4(e.blockLen)}function exists$4(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$4(e,t){bytes$4(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const assert$2={number:number$4,bool:bool$2,bytes:bytes$4,hash:hash$4,exists:exists$4,output:output$4};var assert$3=assert$2;const crypto$3="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes$5(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}const createView$3=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$3=(e,t)=>e<<32-t|e>>>t,isLE$3=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];if(!isLE$3)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$6(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function toBytes$4(e){if("string"==typeof e&&(e=utf8ToBytes$6(e)),!isBytes$5(e))throw new Error("expected Uint8Array, got "+typeof e);return e}let Hash$3=class{clone(){return this._cloneInto()}};const toStr={}.toString;function checkOpts$1(e,t){if(void 0!==t&&"[object Object]"!==toStr.call(t))throw new Error("Options should be object or undefined");return Object.assign(e,t)}function wrapConstructor$3(e){const t=t=>e().update(toBytes$4(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function randomBytes$2(e=32){if(crypto$3&&"function"==typeof crypto$3.getRandomValues)return crypto$3.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}let HMAC$3=class extends Hash$3{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,hash$4(e);const n=toBytes$4(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<o.length;e++)o[e]^=54;this.iHash.update(o),this.oHash=e.create();for(let e=0;e<o.length;e++)o[e]^=106;this.oHash.update(o),o.fill(0)}update(e){return exists$4(this),this.iHash.update(e),this}digestInto(e){exists$4(this),bytes$4(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return e.finished=r,e.destroyed=o,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$3=(e,t,n)=>new HMAC$3(e,t).update(n).digest();function pbkdf2Init(e,t,n,r){hash$4(e);const o=checkOpts$1({dkLen:32,asyncTick:10},r),{c:i,dkLen:s,asyncTick:a}=o;if(number$4(i),number$4(s),number$4(a),i<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const c=toBytes$4(t),u=toBytes$4(n),l=new Uint8Array(s),h=hmac$3.create(e,c),d=h._cloneInto().update(u);return{c:i,dkLen:s,asyncTick:a,DK:l,PRF:h,PRFSalt:d}}function pbkdf2Output(e,t,n,r,o){return e.destroy(),t.destroy(),r&&r.destroy(),o.fill(0),n}function pbkdf2(e,t,n,r){const{c:o,dkLen:i,DK:s,PRF:a,PRFSalt:c}=pbkdf2Init(e,t,n,r);let u;const l=new Uint8Array(4),h=createView$3(l),d=new Uint8Array(a.outputLen);for(let e=1,t=0;t<i;e++,t+=a.outputLen){const n=s.subarray(t,t+a.outputLen);h.setInt32(0,e,!1),(u=c._cloneInto(u)).update(l).digestInto(d),n.set(d.subarray(0,n.length));for(let e=1;e<o;e++){a._cloneInto(u).update(d).digestInto(d);for(let e=0;e<n.length;e++)n[e]^=d[e]}}return pbkdf2Output(a,c,s,u,d)}function setBigUint64$3(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}hmac$3.create=(e,t)=>new HMAC$3(e,t);let SHA2$2=class extends Hash$3{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=createView$3(this.buffer)}update(e){exists$4(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=toBytes$4(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=createView$3(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){exists$4(this),output$4(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;setBigUint64$3(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=createView$3(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}};const Chi$3=(e,t,n)=>e&t^~e&n,Maj$3=(e,t,n)=>e&t^e&n^t&n,SHA256_K$3=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$2=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$3=new Uint32Array(64);let SHA256$3=class extends SHA2$2{constructor(){super(64,32,8,!1),this.A=0|IV$2[0],this.B=0|IV$2[1],this.C=0|IV$2[2],this.D=0|IV$2[3],this.E=0|IV$2[4],this.F=0|IV$2[5],this.G=0|IV$2[6],this.H=0|IV$2[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)SHA256_W$3[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=SHA256_W$3[e-15],n=SHA256_W$3[e-2],r=rotr$3(t,7)^rotr$3(t,18)^t>>>3,o=rotr$3(n,17)^rotr$3(n,19)^n>>>10;SHA256_W$3[e]=o+SHA256_W$3[e-7]+r+SHA256_W$3[e-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(rotr$3(s,6)^rotr$3(s,11)^rotr$3(s,25))+Chi$3(s,a,c)+SHA256_K$3[e]+SHA256_W$3[e]|0,l=(rotr$3(n,2)^rotr$3(n,13)^rotr$3(n,22))+Maj$3(n,r,o)|0;u=c,c=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+l|0}n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){SHA256_W$3.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const sha256$3=wrapConstructor$3((()=>new SHA256$3)),U32_MASK64$1=BigInt(2**32-1),_32n$1=BigInt(32);function fromBig$1(e,t=!1){return t?{h:Number(e&U32_MASK64$1),l:Number(e>>_32n$1&U32_MASK64$1)}:{h:0|Number(e>>_32n$1&U32_MASK64$1),l:0|Number(e&U32_MASK64$1)}}function split$1(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let o=0;o<e.length;o++){const{h:i,l:s}=fromBig$1(e[o],t);[n[o],r[o]]=[i,s]}return[n,r]}const toBig$1=(e,t)=>BigInt(e>>>0)<<_32n$1|BigInt(t>>>0),shrSH$1=(e,t,n)=>e>>>n,shrSL$1=(e,t,n)=>e<<32-n|t>>>n,rotrSH$1=(e,t,n)=>e>>>n|t<<32-n,rotrSL$1=(e,t,n)=>e<<32-n|t>>>n,rotrBH$1=(e,t,n)=>e<<64-n|t>>>n-32,rotrBL$1=(e,t,n)=>e>>>n-32|t<<64-n,rotr32H$1=(e,t)=>t,rotr32L$1=(e,t)=>e,rotlSH$1=(e,t,n)=>e<<n|t>>>32-n,rotlSL$1=(e,t,n)=>t<<n|e>>>32-n,rotlBH$1=(e,t,n)=>t<<n-32|e>>>64-n,rotlBL$1=(e,t,n)=>e<<n-32|t>>>64-n;function add$1(e,t,n,r){const o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:0|o}}const add3L$1=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H$1=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L$1=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H$1=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,add5L$1=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),add5H$1=(e,t,n,r,o,i)=>t+n+r+o+i+(e/2**32|0)|0,u64$2={fromBig:fromBig$1,split:split$1,toBig:toBig$1,shrSH:shrSH$1,shrSL:shrSL$1,rotrSH:rotrSH$1,rotrSL:rotrSL$1,rotrBH:rotrBH$1,rotrBL:rotrBL$1,rotr32H:rotr32H$1,rotr32L:rotr32L$1,rotlSH:rotlSH$1,rotlSL:rotlSL$1,rotlBH:rotlBH$1,rotlBL:rotlBL$1,add:add$1,add3L:add3L$1,add3H:add3H$1,add4L:add4L$1,add4H:add4H$1,add5H:add5H$1,add5L:add5L$1};var u64$3=u64$2;const[SHA512_Kh$1,SHA512_Kl$1]=(()=>u64$3.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),SHA512_W_H$1=new Uint32Array(80),SHA512_W_L$1=new Uint32Array(80);let SHA512$1=class extends SHA2$2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:o,Cl:i,Dh:s,Dl:a,Eh:c,El:u,Fh:l,Fl:h,Gh:d,Gl:f,Hh:p,Hl:y}=this;return[e,t,n,r,o,i,s,a,c,u,l,h,d,f,p,y]}set(e,t,n,r,o,i,s,a,c,u,l,h,d,f,p,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|o,this.Cl=0|i,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|h,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|y}process(e,t){for(let n=0;n<16;n++,t+=4)SHA512_W_H$1[n]=e.getUint32(t),SHA512_W_L$1[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|SHA512_W_H$1[e-15],n=0|SHA512_W_L$1[e-15],r=u64$3.rotrSH(t,n,1)^u64$3.rotrSH(t,n,8)^u64$3.shrSH(t,n,7),o=u64$3.rotrSL(t,n,1)^u64$3.rotrSL(t,n,8)^u64$3.shrSL(t,n,7),i=0|SHA512_W_H$1[e-2],s=0|SHA512_W_L$1[e-2],a=u64$3.rotrSH(i,s,19)^u64$3.rotrBH(i,s,61)^u64$3.shrSH(i,s,6),c=u64$3.rotrSL(i,s,19)^u64$3.rotrBL(i,s,61)^u64$3.shrSL(i,s,6),u=u64$3.add4L(o,c,SHA512_W_L$1[e-7],SHA512_W_L$1[e-16]),l=u64$3.add4H(u,r,a,SHA512_W_H$1[e-7],SHA512_W_H$1[e-16]);SHA512_W_H$1[e]=0|l,SHA512_W_L$1[e]=0|u}let{Ah:n,Al:r,Bh:o,Bl:i,Ch:s,Cl:a,Dh:c,Dl:u,Eh:l,El:h,Fh:d,Fl:f,Gh:p,Gl:y,Hh:g,Hl:b}=this;for(let e=0;e<80;e++){const t=u64$3.rotrSH(l,h,14)^u64$3.rotrSH(l,h,18)^u64$3.rotrBH(l,h,41),m=u64$3.rotrSL(l,h,14)^u64$3.rotrSL(l,h,18)^u64$3.rotrBL(l,h,41),w=l&d^~l&p,$=h&f^~h&y,_=u64$3.add5L(b,m,$,SHA512_Kl$1[e],SHA512_W_L$1[e]),E=u64$3.add5H(_,g,t,w,SHA512_Kh$1[e],SHA512_W_H$1[e]),v=0|_,x=u64$3.rotrSH(n,r,28)^u64$3.rotrBH(n,r,34)^u64$3.rotrBH(n,r,39),k=u64$3.rotrSL(n,r,28)^u64$3.rotrBL(n,r,34)^u64$3.rotrBL(n,r,39),B=n&o^n&s^o&s,A=r&i^r&a^i&a;g=0|p,b=0|y,p=0|d,y=0|f,d=0|l,f=0|h,({h:l,l:h}=u64$3.add(0|c,0|u,0|E,0|v)),c=0|s,u=0|a,s=0|o,a=0|i,o=0|n,i=0|r;const S=u64$3.add3L(v,k,A);n=u64$3.add3H(S,E,x,B),r=0|S}({h:n,l:r}=u64$3.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:o,l:i}=u64$3.add(0|this.Bh,0|this.Bl,0|o,0|i)),({h:s,l:a}=u64$3.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=u64$3.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h:l,l:h}=u64$3.add(0|this.Eh,0|this.El,0|l,0|h)),({h:d,l:f}=u64$3.add(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:y}=u64$3.add(0|this.Gh,0|this.Gl,0|p,0|y)),({h:g,l:b}=u64$3.add(0|this.Hh,0|this.Hl,0|g,0|b)),this.set(n,r,o,i,s,a,c,u,l,h,d,f,p,y,g,b)}roundClean(){SHA512_W_H$1.fill(0),SHA512_W_L$1.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const sha512$1=wrapConstructor$3((()=>new SHA512$1));
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes$4(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function chain(...e){const t=e=>e,n=(e,t)=>n=>e(t(n));return{encode:e.map((e=>e.encode)).reduceRight(n,t),decode:e.map((e=>e.decode)).reduce(n,t)}}function alphabet(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("alphabet.encode input should be an array of numbers");return t.map((t=>{if(t<0||t>=e.length)throw new Error(`Digit index outside alphabet: ${t} (alphabet: ${e.length})`);return e[t]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const n=e.indexOf(t);if(-1===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}}function join(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function padding(e,t="="){if("string"!=typeof t)throw new Error("padding chr should be string");return{encode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;n.length*e%8;)n.push(t);return n},decode(n){if(!Array.isArray(n)||n.length&&"string"!=typeof n[0])throw new Error("padding.encode input should be array of strings");for(let e of n)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let r=n.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return n.slice(0,r)}}}function convertRadix(e,t,n){if(t<2)throw new Error(`convertRadix: wrong from=${t}, base cannot be less than 2`);if(n<2)throw new Error(`convertRadix: wrong to=${n}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let r=0;const o=[],i=Array.from(e);for(i.forEach((e=>{if(e<0||e>=t)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,s=!0;for(let o=r;o<i.length;o++){const a=i[o],c=t*e+a;if(!Number.isSafeInteger(c)||t*e/t!==e||c-a!=t*e)throw new Error("convertRadix: carry overflow");e=c%n;const u=Math.floor(c/n);if(i[o]=u,!Number.isSafeInteger(u)||u*n+e!==c)throw new Error("convertRadix: carry overflow");s&&(u?s=!1:r=o)}if(o.push(e),s)break}for(let t=0;t<e.length-1&&0===e[t];t++)o.push(0);return o.reverse()}const gcd=(e,t)=>t?gcd(t,e%t):e,radix2carry=(e,t)=>e+(t-gcd(e,t));function convertRadix2(e,t,n,r){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(radix2carry(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${radix2carry(t,n)}`);let o=0,i=0;const s=2**n-1,a=[];for(const r of e){if(r>=2**t)throw new Error(`convertRadix2: invalid data word=${r} from=${t}`);if(o=o<<t|r,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)a.push((o>>i-n&s)>>>0);o&=2**i-1}if(o=o<<n-i&s,!r&&i>=t)throw new Error("Excess padding");if(!r&&o)throw new Error(`Non-zero padding: ${o}`);return r&&i>0&&a.push(o>>>0),a}function radix(e){return{encode:t=>{if(!isBytes$4(t))throw new Error("radix.encode input should be Uint8Array");return convertRadix(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of numbers");return Uint8Array.from(convertRadix(t,e,256))}}}function radix2(e,t=!1){if(e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(radix2carry(8,e)>32||radix2carry(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!isBytes$4(n))throw new Error("radix2.encode input should be Uint8Array");return convertRadix2(Array.from(n),8,e,!t)},decode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("radix2.decode input should be array of numbers");return Uint8Array.from(convertRadix2(n,e,8,t))}}}function unsafeWrapper(e){if("function"!=typeof e)throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch(e){}}}function checksum(e,t){if("function"!=typeof t)throw new Error("checksum fn should be function");return{encode(n){if(!isBytes$4(n))throw new Error("checksum.encode: input should be Uint8Array");const r=t(n).slice(0,e),o=new Uint8Array(n.length+e);return o.set(n),o.set(r,n.length),o},decode(n){if(!isBytes$4(n))throw new Error("checksum.decode: input should be Uint8Array");const r=n.slice(0,-e),o=t(r).slice(0,e),i=n.slice(-e);for(let t=0;t<e;t++)if(o[t]!==i[t])throw new Error("Invalid checksum");return r}}}const utils$2={alphabet:alphabet,chain:chain,checksum:checksum,convertRadix:convertRadix,convertRadix2:convertRadix2,radix:radix,radix2:radix2,join:join,padding:padding},genBase58=e=>chain(radix(58),alphabet(e),join("")),base58=genBase58("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),createBase58check=e=>chain(checksum(4,(t=>e(e(t)))),base58),base58check$1=createBase58check,BECH_ALPHABET=chain(alphabet("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),join("")),POLYMOD_GENERATORS=[996825010,642813549,513874426,1027748829,705979059];function bech32Polymod(e){const t=e>>25;let n=(33554431&e)<<5;for(let e=0;e<POLYMOD_GENERATORS.length;e++)1==(t>>e&1)&&(n^=POLYMOD_GENERATORS[e]);return n}function bechChecksum(e,t,n=1){const r=e.length;let o=1;for(let t=0;t<r;t++){const n=e.charCodeAt(t);if(n<33||n>126)throw new Error(`Invalid prefix (${e})`);o=bech32Polymod(o)^n>>5}o=bech32Polymod(o);for(let t=0;t<r;t++)o=bech32Polymod(o)^31&e.charCodeAt(t);for(let e of t)o=bech32Polymod(o)^e;for(let e=0;e<6;e++)o=bech32Polymod(o);return o^=n,BECH_ALPHABET.encode(convertRadix2([o%2**30],30,5,!1))}function genBech32(e){const t="bech32"===e?1:734539939,n=radix2(5),r=n.decode,o=n.encode,i=unsafeWrapper(r);function s(e,n=90){if("string"!=typeof e)throw new Error("bech32.decode input should be string, not "+typeof e);if(e.length<8||!1!==n&&e.length>n)throw new TypeError(`Wrong string length: ${e.length} (${e}). Expected (8..${n})`);const r=e.toLowerCase();if(e!==r&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=r.lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=r.slice(0,o),s=r.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=BECH_ALPHABET.decode(s).slice(0,-6),c=bechChecksum(i,a,t);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${e}: expected "${c}"`);return{prefix:i,words:a}}return{encode:function(e,n,r=90){if("string"!=typeof e)throw new Error("bech32.encode prefix should be string, not "+typeof e);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);if(0===e.length)throw new TypeError(`Invalid prefix length ${e.length}`);const o=e.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);const i=e.toLowerCase(),s=bechChecksum(i,n,t);return`${i}1${BECH_ALPHABET.encode(n)}${s}`},decode:s,decodeToBytes:function(e){const{prefix:t,words:n}=s(e,!1);return{prefix:t,words:n,bytes:r(n)}},decodeUnsafe:unsafeWrapper(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}const bech32=genBech32("bech32"),isJapanese=e=>"あいこくしん"===e[0];function nfkd(e){if("string"!=typeof e)throw new TypeError("Invalid mnemonic type: "+typeof e);return e.normalize("NFKD")}function normalize(e){const t=nfkd(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}function assertEntropy(e){assert$3.bytes(e,16,20,24,28,32)}function generateMnemonic(e,t=128){if(assert$3.number(t),t%32!=0||t>256)throw new TypeError("Invalid entropy");return entropyToMnemonic(randomBytes$2(t/8),e)}const calcChecksum=e=>{const t=8-e.length/4;return new Uint8Array([sha256$3(e)[0]>>t<<t])};function getCoder(e){if(!Array.isArray(e)||2048!==e.length||"string"!=typeof e[0])throw new Error("Worlist: expected array of 2048 strings");return e.forEach((e=>{if("string"!=typeof e)throw new Error(`Wordlist: non-string element: ${e}`)})),utils$2.chain(utils$2.checksum(1,calcChecksum),utils$2.radix2(11,!0),utils$2.alphabet(e))}function mnemonicToEntropy(e,t){const{words:n}=normalize(e),r=getCoder(t).decode(n);return assertEntropy(r),r}function entropyToMnemonic(e,t){assertEntropy(e);return getCoder(t).encode(e).join(isJapanese(t)?"　":" ")}function validateMnemonic(e,t){try{mnemonicToEntropy(e,t)}catch(e){return!1}return!0}const salt=e=>nfkd(`mnemonic${e}`);function mnemonicToSeedSync(e,t=""){return pbkdf2(sha512$1,normalize(e).nfkd,salt(t),{c:2048,dkLen:64})}function number$3(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function isBytes$3(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function bytes$3(e,...t){if(!isBytes$3(e))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$3(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");number$3(e.outputLen),number$3(e.blockLen)}function exists$3(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$3(e,t){bytes$3(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes$2(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}const createView$2=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$2=(e,t)=>e<<32-t|e>>>t,isLE$2=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];if(!isLE$2)throw new Error("Non little-endian hardware is not supported");const hexes$3=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function bytesToHex$3(e){if(!isBytes$2(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=hexes$3[e[n]];return t}const asciis$1={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16$1(e){return e>=asciis$1._0&&e<=asciis$1._9?e-asciis$1._0:e>=asciis$1._A&&e<=asciis$1._F?e-(asciis$1._A-10):e>=asciis$1._a&&e<=asciis$1._f?e-(asciis$1._a-10):void 0}function hexToBytes$2(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,o=0;t<n;t++,o+=2){const n=asciiToBase16$1(e.charCodeAt(o)),i=asciiToBase16$1(e.charCodeAt(o+1));if(void 0===n||void 0===i){const t=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+o)}r[t]=16*n+i}return r}function utf8ToBytes$5(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function toBytes$3(e){if("string"==typeof e&&(e=utf8ToBytes$5(e)),!isBytes$2(e))throw new Error("expected Uint8Array, got "+typeof e);return e}function concatBytes$4(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];if(!isBytes$2(r))throw new Error("Uint8Array expected");t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const o=e[t];n.set(o,r),r+=o.length}return n}let Hash$2=class{clone(){return this._cloneInto()}};function wrapConstructor$2(e){const t=t=>e().update(toBytes$3(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}let HMAC$2=class extends Hash$2{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,hash$3(e);const n=toBytes$3(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<o.length;e++)o[e]^=54;this.iHash.update(o),this.oHash=e.create();for(let e=0;e<o.length;e++)o[e]^=106;this.oHash.update(o),o.fill(0)}update(e){return exists$3(this),this.iHash.update(e),this}digestInto(e){exists$3(this),bytes$3(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return e.finished=r,e.destroyed=o,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$2=(e,t,n)=>new HMAC$2(e,t).update(n).digest();function setBigUint64$2(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}hmac$2.create=(e,t)=>new HMAC$2(e,t);let SHA2$1=class extends Hash$2{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=createView$2(this.buffer)}update(e){exists$3(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=toBytes$3(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=createView$2(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){exists$3(this),output$3(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;setBigUint64$2(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=createView$2(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}};const Rho=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Id=Uint8Array.from({length:16},((e,t)=>t)),Pi=Id.map((e=>(9*e+5)%16));let idxL=[Id],idxR=[Pi];for(let e=0;e<4;e++)for(let t of[idxL,idxR])t.push(t[e].map((e=>Rho[e])));const shifts=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((e=>new Uint8Array(e))),shiftsL=idxL.map(((e,t)=>e.map((e=>shifts[t][e])))),shiftsR=idxR.map(((e,t)=>e.map((e=>shifts[t][e])))),Kl=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),Kr=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),rotl$1=(e,t)=>e<<t|e>>>32-t;function f(e,t,n,r){return 0===e?t^n^r:1===e?t&n|~t&r:2===e?(t|~n)^r:3===e?t&r|n&~r:t^(n|~r)}const BUF=new Uint32Array(16);class RIPEMD160 extends SHA2$1{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:e,h1:t,h2:n,h3:r,h4:o}=this;return[e,t,n,r,o]}set(e,t,n,r,o){this.h0=0|e,this.h1=0|t,this.h2=0|n,this.h3=0|r,this.h4=0|o}process(e,t){for(let n=0;n<16;n++,t+=4)BUF[n]=e.getUint32(t,!0);let n=0|this.h0,r=n,o=0|this.h1,i=o,s=0|this.h2,a=s,c=0|this.h3,u=c,l=0|this.h4,h=l;for(let e=0;e<5;e++){const t=4-e,d=Kl[e],p=Kr[e],y=idxL[e],g=idxR[e],b=shiftsL[e],m=shiftsR[e];for(let t=0;t<16;t++){const r=rotl$1(n+f(e,o,s,c)+BUF[y[t]]+d,b[t])+l|0;n=l,l=c,c=0|rotl$1(s,10),s=o,o=r}for(let e=0;e<16;e++){const n=rotl$1(r+f(t,i,a,u)+BUF[g[e]]+p,m[e])+h|0;r=h,h=u,u=0|rotl$1(a,10),a=i,i=n}}this.set(this.h1+s+u|0,this.h2+c+h|0,this.h3+l+r|0,this.h4+n+i|0,this.h0+o+a|0)}roundClean(){BUF.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const ripemd160=wrapConstructor$2((()=>new RIPEMD160)),Chi$2=(e,t,n)=>e&t^~e&n,Maj$2=(e,t,n)=>e&t^e&n^t&n,SHA256_K$2=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV$1=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$2=new Uint32Array(64);let SHA256$2=class extends SHA2$1{constructor(){super(64,32,8,!1),this.A=0|IV$1[0],this.B=0|IV$1[1],this.C=0|IV$1[2],this.D=0|IV$1[3],this.E=0|IV$1[4],this.F=0|IV$1[5],this.G=0|IV$1[6],this.H=0|IV$1[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)SHA256_W$2[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=SHA256_W$2[e-15],n=SHA256_W$2[e-2],r=rotr$2(t,7)^rotr$2(t,18)^t>>>3,o=rotr$2(n,17)^rotr$2(n,19)^n>>>10;SHA256_W$2[e]=o+SHA256_W$2[e-7]+r+SHA256_W$2[e-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(rotr$2(s,6)^rotr$2(s,11)^rotr$2(s,25))+Chi$2(s,a,c)+SHA256_K$2[e]+SHA256_W$2[e]|0,l=(rotr$2(n,2)^rotr$2(n,13)^rotr$2(n,22))+Maj$2(n,r,o)|0;u=c,c=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+l|0}n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){SHA256_W$2.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const sha256$2=wrapConstructor$2((()=>new SHA256$2)),U32_MASK64=BigInt(2**32-1),_32n=BigInt(32);function fromBig(e,t=!1){return t?{h:Number(e&U32_MASK64),l:Number(e>>_32n&U32_MASK64)}:{h:0|Number(e>>_32n&U32_MASK64),l:0|Number(e&U32_MASK64)}}function split(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let o=0;o<e.length;o++){const{h:i,l:s}=fromBig(e[o],t);[n[o],r[o]]=[i,s]}return[n,r]}const toBig=(e,t)=>BigInt(e>>>0)<<_32n|BigInt(t>>>0),shrSH=(e,t,n)=>e>>>n,shrSL=(e,t,n)=>e<<32-n|t>>>n,rotrSH=(e,t,n)=>e>>>n|t<<32-n,rotrSL=(e,t,n)=>e<<32-n|t>>>n,rotrBH=(e,t,n)=>e<<64-n|t>>>n-32,rotrBL=(e,t,n)=>e>>>n-32|t<<64-n,rotr32H=(e,t)=>t,rotr32L=(e,t)=>e,rotlSH=(e,t,n)=>e<<n|t>>>32-n,rotlSL=(e,t,n)=>t<<n|e>>>32-n,rotlBH=(e,t,n)=>t<<n-32|e>>>64-n,rotlBL=(e,t,n)=>e<<n-32|t>>>64-n;function add(e,t,n,r){const o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:0|o}}const add3L=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),add3H=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,add4L=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),add4H=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,add5L=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),add5H=(e,t,n,r,o,i)=>t+n+r+o+i+(e/2**32|0)|0,u64={fromBig:fromBig,split:split,toBig:toBig,shrSH:shrSH,shrSL:shrSL,rotrSH:rotrSH,rotrSL:rotrSL,rotrBH:rotrBH,rotrBL:rotrBL,rotr32H:rotr32H,rotr32L:rotr32L,rotlSH:rotlSH,rotlSL:rotlSL,rotlBH:rotlBH,rotlBL:rotlBL,add:add,add3L:add3L,add3H:add3H,add4L:add4L,add4H:add4H,add5H:add5H,add5L:add5L};var u64$1=u64;const[SHA512_Kh,SHA512_Kl]=(()=>u64$1.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((e=>BigInt(e)))))(),SHA512_W_H=new Uint32Array(80),SHA512_W_L=new Uint32Array(80);class SHA512 extends SHA2$1{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:t,Bh:n,Bl:r,Ch:o,Cl:i,Dh:s,Dl:a,Eh:c,El:u,Fh:l,Fl:h,Gh:d,Gl:f,Hh:p,Hl:y}=this;return[e,t,n,r,o,i,s,a,c,u,l,h,d,f,p,y]}set(e,t,n,r,o,i,s,a,c,u,l,h,d,f,p,y){this.Ah=0|e,this.Al=0|t,this.Bh=0|n,this.Bl=0|r,this.Ch=0|o,this.Cl=0|i,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|h,this.Gh=0|d,this.Gl=0|f,this.Hh=0|p,this.Hl=0|y}process(e,t){for(let n=0;n<16;n++,t+=4)SHA512_W_H[n]=e.getUint32(t),SHA512_W_L[n]=e.getUint32(t+=4);for(let e=16;e<80;e++){const t=0|SHA512_W_H[e-15],n=0|SHA512_W_L[e-15],r=u64$1.rotrSH(t,n,1)^u64$1.rotrSH(t,n,8)^u64$1.shrSH(t,n,7),o=u64$1.rotrSL(t,n,1)^u64$1.rotrSL(t,n,8)^u64$1.shrSL(t,n,7),i=0|SHA512_W_H[e-2],s=0|SHA512_W_L[e-2],a=u64$1.rotrSH(i,s,19)^u64$1.rotrBH(i,s,61)^u64$1.shrSH(i,s,6),c=u64$1.rotrSL(i,s,19)^u64$1.rotrBL(i,s,61)^u64$1.shrSL(i,s,6),u=u64$1.add4L(o,c,SHA512_W_L[e-7],SHA512_W_L[e-16]),l=u64$1.add4H(u,r,a,SHA512_W_H[e-7],SHA512_W_H[e-16]);SHA512_W_H[e]=0|l,SHA512_W_L[e]=0|u}let{Ah:n,Al:r,Bh:o,Bl:i,Ch:s,Cl:a,Dh:c,Dl:u,Eh:l,El:h,Fh:d,Fl:f,Gh:p,Gl:y,Hh:g,Hl:b}=this;for(let e=0;e<80;e++){const t=u64$1.rotrSH(l,h,14)^u64$1.rotrSH(l,h,18)^u64$1.rotrBH(l,h,41),m=u64$1.rotrSL(l,h,14)^u64$1.rotrSL(l,h,18)^u64$1.rotrBL(l,h,41),w=l&d^~l&p,$=h&f^~h&y,_=u64$1.add5L(b,m,$,SHA512_Kl[e],SHA512_W_L[e]),E=u64$1.add5H(_,g,t,w,SHA512_Kh[e],SHA512_W_H[e]),v=0|_,x=u64$1.rotrSH(n,r,28)^u64$1.rotrBH(n,r,34)^u64$1.rotrBH(n,r,39),k=u64$1.rotrSL(n,r,28)^u64$1.rotrBL(n,r,34)^u64$1.rotrBL(n,r,39),B=n&o^n&s^o&s,A=r&i^r&a^i&a;g=0|p,b=0|y,p=0|d,y=0|f,d=0|l,f=0|h,({h:l,l:h}=u64$1.add(0|c,0|u,0|E,0|v)),c=0|s,u=0|a,s=0|o,a=0|i,o=0|n,i=0|r;const S=u64$1.add3L(v,k,A);n=u64$1.add3H(S,E,x,B),r=0|S}({h:n,l:r}=u64$1.add(0|this.Ah,0|this.Al,0|n,0|r)),({h:o,l:i}=u64$1.add(0|this.Bh,0|this.Bl,0|o,0|i)),({h:s,l:a}=u64$1.add(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:u}=u64$1.add(0|this.Dh,0|this.Dl,0|c,0|u)),({h:l,l:h}=u64$1.add(0|this.Eh,0|this.El,0|l,0|h)),({h:d,l:f}=u64$1.add(0|this.Fh,0|this.Fl,0|d,0|f)),({h:p,l:y}=u64$1.add(0|this.Gh,0|this.Gl,0|p,0|y)),({h:g,l:b}=u64$1.add(0|this.Hh,0|this.Hl,0|g,0|b)),this.set(n,r,o,i,s,a,c,u,l,h,d,f,p,y,g,b)}roundClean(){SHA512_W_H.fill(0),SHA512_W_L.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const sha512=wrapConstructor$2((()=>new SHA512));function number$2(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bool$1(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)}function bytes$2(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$2(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");number$2(e.outputLen),number$2(e.blockLen)}function exists$2(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$2(e,t){bytes$2(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const assert$1={number:number$2,bool:bool$1,bytes:bytes$2,hash:hash$2,exists:exists$2,output:output$2},crypto$2="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,u8a$2=e=>e instanceof Uint8Array,createView$1=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr$1=(e,t)=>e<<32-t|e>>>t,isLE$1=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];if(!isLE$1)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$4(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function toBytes$2(e){if("string"==typeof e&&(e=utf8ToBytes$4(e)),!u8a$2(e))throw new Error("expected Uint8Array, got "+typeof e);return e}function concatBytes$3(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;return e.forEach((e=>{if(!u8a$2(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length})),t}Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));let Hash$1=class{clone(){return this._cloneInto()}};function wrapConstructor$1(e){const t=t=>e().update(toBytes$2(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function randomBytes$1(e=32){if(crypto$2&&"function"==typeof crypto$2.getRandomValues)return crypto$2.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$1(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}class SHA2 extends Hash$1{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=createView$1(this.buffer)}update(e){assert$1.exists(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=toBytes$2(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=createView$1(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){assert$1.exists(this),assert$1.output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;setBigUint64$1(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=createView$1(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}}const Chi$1=(e,t,n)=>e&t^~e&n,Maj$1=(e,t,n)=>e&t^e&n^t&n,SHA256_K$1=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W$1=new Uint32Array(64);let SHA256$1=class extends SHA2{constructor(){super(64,32,8,!1),this.A=0|IV[0],this.B=0|IV[1],this.C=0|IV[2],this.D=0|IV[3],this.E=0|IV[4],this.F=0|IV[5],this.G=0|IV[6],this.H=0|IV[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)SHA256_W$1[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=SHA256_W$1[e-15],n=SHA256_W$1[e-2],r=rotr$1(t,7)^rotr$1(t,18)^t>>>3,o=rotr$1(n,17)^rotr$1(n,19)^n>>>10;SHA256_W$1[e]=o+SHA256_W$1[e-7]+r+SHA256_W$1[e-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(rotr$1(s,6)^rotr$1(s,11)^rotr$1(s,25))+Chi$1(s,a,c)+SHA256_K$1[e]+SHA256_W$1[e]|0,l=(rotr$1(n,2)^rotr$1(n,13)^rotr$1(n,22))+Maj$1(n,r,o)|0;u=c,c=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+l|0}n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){SHA256_W$1.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};class SHA224 extends SHA256$1{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const sha256$1=wrapConstructor$1((()=>new SHA256$1));wrapConstructor$1((()=>new SHA224));
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const _0n$8=BigInt(0),_1n$9=BigInt(1),_2n$5=BigInt(2),u8a$1=e=>e instanceof Uint8Array,hexes$2=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function bytesToHex$2(e){if(!u8a$1(e))throw new Error("Uint8Array expected");let t="";for(let n=0;n<e.length;n++)t+=hexes$2[e[n]];return t}function numberToHexUnpadded$1(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function hexToNumber$1(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}function hexToBytes$1(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(t/2);for(let t=0;t<n.length;t++){const r=2*t,o=e.slice(r,r+2),i=Number.parseInt(o,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");n[t]=i}return n}function bytesToNumberBE$1(e){return hexToNumber$1(bytesToHex$2(e))}function bytesToNumberLE$1(e){if(!u8a$1(e))throw new Error("Uint8Array expected");return hexToNumber$1(bytesToHex$2(Uint8Array.from(e).reverse()))}function numberToBytesBE$1(e,t){return hexToBytes$1(e.toString(16).padStart(2*t,"0"))}function numberToBytesLE$1(e,t){return numberToBytesBE$1(e,t).reverse()}function numberToVarBytesBE$1(e){return hexToBytes$1(numberToHexUnpadded$1(e))}function ensureBytes$2(e,t,n){let r;if("string"==typeof t)try{r=hexToBytes$1(t)}catch(n){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${n}`)}else{if(!u8a$1(t))throw new Error(`${e} must be hex string or Uint8Array`);r=Uint8Array.from(t)}const o=r.length;if("number"==typeof n&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function concatBytes$2(...e){const t=new Uint8Array(e.reduce(((e,t)=>e+t.length),0));let n=0;return e.forEach((e=>{if(!u8a$1(e))throw new Error("Uint8Array expected");t.set(e,n),n+=e.length})),t}function equalBytes$2(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function utf8ToBytes$3(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function bitLen$1(e){let t;for(t=0;e>_0n$8;e>>=_1n$9,t+=1);return t}function bitGet$1(e,t){return e>>BigInt(t)&_1n$9}const bitSet$1=(e,t,n)=>e|(n?_1n$9:_0n$8)<<BigInt(t),bitMask$1=e=>(_2n$5<<BigInt(e-1))-_1n$9,u8n$1=e=>new Uint8Array(e),u8fr$1=e=>Uint8Array.from(e);function createHmacDrbg$1(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=u8n$1(e),o=u8n$1(e),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...e)=>n(o,r,...e),c=(e=u8n$1())=>{o=a(u8fr$1([0]),e),r=a(),0!==e.length&&(o=a(u8fr$1([1]),e),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return concatBytes$2(...n)};return(e,t)=>{let n;for(s(),c(e);!(n=t(u()));)c();return s(),n}}const validatorFns$1={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function validateObject$1(e,t,n={}){const r=(t,n,r)=>{const o=validatorFns$1[n];if("function"!=typeof o)throw new Error(`Invalid validator "${n}", expected function`);const i=e[t];if(!(r&&void 0===i||o(i,e)))throw new Error(`Invalid param ${String(t)}=${i} (${typeof i}), expected ${n}`)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e}var ut$1=Object.freeze({__proto__:null,bitGet:bitGet$1,bitLen:bitLen$1,bitMask:bitMask$1,bitSet:bitSet$1,bytesToHex:bytesToHex$2,bytesToNumberBE:bytesToNumberBE$1,bytesToNumberLE:bytesToNumberLE$1,concatBytes:concatBytes$2,createHmacDrbg:createHmacDrbg$1,ensureBytes:ensureBytes$2,equalBytes:equalBytes$2,hexToBytes:hexToBytes$1,hexToNumber:hexToNumber$1,numberToBytesBE:numberToBytesBE$1,numberToBytesLE:numberToBytesLE$1,numberToHexUnpadded:numberToHexUnpadded$1,numberToVarBytesBE:numberToVarBytesBE$1,utf8ToBytes:utf8ToBytes$3,validateObject:validateObject$1});
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$7=BigInt(0),_1n$8=BigInt(1),_2n$4=BigInt(2),_3n$3=BigInt(3),_4n$1=BigInt(4),_5n$1=BigInt(5),_8n$1=BigInt(8);function mod$1(e,t){const n=e%t;return n>=_0n$7?n:t+n}function pow$1(e,t,n){if(n<=_0n$7||t<_0n$7)throw new Error("Expected power/modulo > 0");if(n===_1n$8)return _0n$7;let r=_1n$8;for(;t>_0n$7;)t&_1n$8&&(r=r*e%n),e=e*e%n,t>>=_1n$8;return r}function pow2$1(e,t,n){let r=e;for(;t-- >_0n$7;)r*=r,r%=n;return r}function invert$1(e,t){if(e===_0n$7||t<=_0n$7)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=mod$1(e,t),r=t,o=_0n$7,i=_1n$8;for(;n!==_0n$7;){const e=r%n,t=o-i*(r/n);r=n,n=e,o=i,i=t}if(r!==_1n$8)throw new Error("invert: does not exist");return mod$1(o,t)}function tonelliShanks$1(e){const t=(e-_1n$8)/_2n$4;let n,r,o;for(n=e-_1n$8,r=0;n%_2n$4===_0n$7;n/=_2n$4,r++);for(o=_2n$4;o<e&&pow$1(o,t,e)!==e-_1n$8;o++);if(1===r){const t=(e+_1n$8)/_4n$1;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const i=(n+_1n$8)/_2n$4;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,o),n),u=e.pow(s,i),l=e.pow(s,n);for(;!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;let t=1;for(let n=e.sqr(l);t<a&&!e.eql(n,e.ONE);t++)n=e.sqr(n);const n=e.pow(c,_1n$8<<BigInt(a-t-1));c=e.sqr(n),u=e.mul(u,n),l=e.mul(l,c),a=t}return u}}function FpSqrt$1(e){if(e%_4n$1===_3n$3){const t=(e+_1n$8)/_4n$1;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%_8n$1===_5n$1){const t=(e-_5n$1)/_8n$1;return function(e,n){const r=e.mul(n,_2n$4),o=e.pow(r,t),i=e.mul(n,o),s=e.mul(e.mul(i,_2n$4),o),a=e.mul(i,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),n))throw new Error("Cannot find square root");return a}}return tonelliShanks$1(e)}BigInt(9),BigInt(16);const FIELD_FIELDS$1=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField$1(e){return validateObject$1(e,FIELD_FIELDS$1.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function FpPow$1(e,t,n){if(n<_0n$7)throw new Error("Expected power > 0");if(n===_0n$7)return e.ONE;if(n===_1n$8)return t;let r=e.ONE,o=t;for(;n>_0n$7;)n&_1n$8&&(r=e.mul(r,o)),o=e.sqr(o),n>>=_1n$8;return r}function FpInvertBatch$1(e,t){const n=new Array(t.length),r=t.reduce(((t,r,o)=>e.is0(r)?t:(n[o]=t,e.mul(t,r))),e.ONE),o=e.inv(r);return t.reduceRight(((t,r,o)=>e.is0(r)?t:(n[o]=e.mul(t,n[o]),e.mul(t,r))),o),n}function nLength$1(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Field$1(e,t,n=!1,r={}){if(e<=_0n$7)throw new Error(`Expected Fp ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:i}=nLength$1(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=FpSqrt$1(e),a=Object.freeze({ORDER:e,BITS:o,BYTES:i,MASK:bitMask$1(o),ZERO:_0n$7,ONE:_1n$8,create:t=>mod$1(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("Invalid field element: expected bigint, got "+typeof t);return _0n$7<=t&&t<e},is0:e=>e===_0n$7,isOdd:e=>(e&_1n$8)===_1n$8,neg:t=>mod$1(-t,e),eql:(e,t)=>e===t,sqr:t=>mod$1(t*t,e),add:(t,n)=>mod$1(t+n,e),sub:(t,n)=>mod$1(t-n,e),mul:(t,n)=>mod$1(t*n,e),pow:(e,t)=>FpPow$1(a,e,t),div:(t,n)=>mod$1(t*invert$1(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>invert$1(t,e),sqrt:r.sqrt||(e=>s(a,e)),invertBatch:e=>FpInvertBatch$1(a,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?numberToBytesLE$1(e,i):numberToBytesBE$1(e,i),fromBytes:e=>{if(e.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${e.length}`);return n?bytesToNumberLE$1(e):bytesToNumberBE$1(e)}});return Object.freeze(a)}function hashToPrivateScalar(e,t,n=!1){const r=(e=ensureBytes$2("privateHash",e)).length,o=nLength$1(t).nByteLength+8;if(o<24||r<o||r>1024)throw new Error(`hashToPrivateScalar: expected ${o}-1024 bytes of input, got ${r}`);return mod$1(n?bytesToNumberLE$1(e):bytesToNumberBE$1(e),t-_1n$8)+_1n$8}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$6=BigInt(0),_1n$7=BigInt(1);function wNAF$1(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,o=t;for(;n>_0n$6;)n&_1n$7&&(r=r.add(o)),o=o.double(),n>>=_1n$7;return r},precomputeWindow(e,t){const{windows:n,windowSize:o}=r(t),i=[];let s=e,a=s;for(let e=0;e<n;e++){a=s,i.push(a);for(let e=1;e<o;e++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(t,o,i){const{windows:s,windowSize:a}=r(t);let c=e.ZERO,u=e.BASE;const l=BigInt(2**t-1),h=2**t,d=BigInt(t);for(let e=0;e<s;e++){const t=e*a;let r=Number(i&l);i>>=d,r>a&&(r-=h,i+=_1n$7);const s=t,f=t+Math.abs(r)-1,p=e%2!=0,y=r<0;0===r?u=u.add(n(p,o[s])):c=c.add(n(y,o[f]))}return{p:c,f:u}},wNAFCached(e,t,n,r){const o=e._WINDOW_SIZE||1;let i=t.get(e);return i||(i=this.precomputeWindow(e,o),1!==o&&t.set(e,r(i))),this.wNAF(o,i,n)}}}function validateBasic$1(e){return validateField$1(e.Fp),validateObject$1(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength$1(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validatePointOpts$1(e){const t=validateBasic$1(e);validateObject$1(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:b2n$1,hexToBytes:h2b$1}=ut$1,DER$1={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){const{Err:t}=DER$1;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(128&r[0])throw new t("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:b2n$1(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=DER$1,n="string"==typeof e?h2b$1(e):e;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");let r=n.length;if(r<2||48!=n[0])throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:o,l:i}=DER$1._parseInt(n.subarray(2)),{d:s,l:a}=DER$1._parseInt(i);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:s}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?`0${t}`:t},r=t(n(e.s)),o=t(n(e.r)),i=r.length/2,s=o.length/2,a=n(i),c=n(s);return`30${n(s+i+4)}02${c}${o}02${a}${r}`}},_0n$5=BigInt(0),_1n$6=BigInt(1);BigInt(2);const _3n$2=BigInt(3);function weierstrassPoints$1(e){const t=validatePointOpts$1(e),{Fp:n}=t,r=t.toBytes||((e,t,r)=>{const o=t.toAffine();return concatBytes$2(Uint8Array.from([4]),n.toBytes(o.x),n.toBytes(o.y))}),o=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function i(e){const{a:r,b:o}=t,i=n.sqr(e),s=n.mul(i,e);return n.add(n.add(s,n.mul(e,r)),o)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"==typeof e&&_0n$5<e&&e<t.n}function a(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:o,n:i}=t;if(n&&"bigint"!=typeof e){if(e instanceof Uint8Array&&(e=bytesToHex$2(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*r,"0")}let s;try{s="bigint"==typeof e?e:bytesToNumberBE$1(ensureBytes$2("private key",e,r))}catch(t){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof e}`)}return o&&(s=mod$1(s,i)),a(s),s}const u=new Map;function l(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof h)throw new Error("projective point not allowed");const o=e=>n.eql(e,n.ZERO);return o(t)&&o(r)?h.ZERO:new h(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}static fromHex(e){const t=h.fromAffine(o(ensureBytes$2("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return h.BASE.multiply(c(e))}_setWindowSize(e){this._WINDOW_SIZE=e,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const o=n.sqr(r),s=i(e);if(!n.eql(o,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){l(e);const{px:t,py:r,pz:o}=this,{px:i,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(i,o)),u=n.eql(n.mul(r,a),n.mul(s,o));return c&&u}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,o=n.mul(r,_3n$2),{px:i,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,d=n.mul(i,i),f=n.mul(s,s),p=n.mul(a,a),y=n.mul(i,s);return y=n.add(y,y),l=n.mul(i,a),l=n.add(l,l),c=n.mul(e,l),u=n.mul(o,p),u=n.add(c,u),c=n.sub(f,u),u=n.add(f,u),u=n.mul(c,u),c=n.mul(y,c),l=n.mul(o,l),p=n.mul(e,p),y=n.sub(d,p),y=n.mul(e,y),y=n.add(y,l),l=n.add(d,d),d=n.add(l,d),d=n.add(d,p),d=n.mul(d,y),u=n.add(u,d),p=n.mul(s,a),p=n.add(p,p),d=n.mul(p,y),c=n.sub(c,d),l=n.mul(p,f),l=n.add(l,l),l=n.add(l,l),new h(c,u,l)}add(e){l(e);const{px:r,py:o,pz:i}=this,{px:s,py:a,pz:c}=e;let u=n.ZERO,d=n.ZERO,f=n.ZERO;const p=t.a,y=n.mul(t.b,_3n$2);let g=n.mul(r,s),b=n.mul(o,a),m=n.mul(i,c),w=n.add(r,o),$=n.add(s,a);w=n.mul(w,$),$=n.add(g,b),w=n.sub(w,$),$=n.add(r,i);let _=n.add(s,c);return $=n.mul($,_),_=n.add(g,m),$=n.sub($,_),_=n.add(o,i),u=n.add(a,c),_=n.mul(_,u),u=n.add(b,m),_=n.sub(_,u),f=n.mul(p,$),u=n.mul(y,m),f=n.add(u,f),u=n.sub(b,f),f=n.add(b,f),d=n.mul(u,f),b=n.add(g,g),b=n.add(b,g),m=n.mul(p,m),$=n.mul(y,$),b=n.add(b,m),m=n.sub(g,m),m=n.mul(p,m),$=n.add($,m),g=n.mul(b,$),d=n.add(d,g),g=n.mul(_,$),u=n.mul(w,u),u=n.sub(u,g),g=n.mul(w,b),f=n.mul(_,f),f=n.add(f,g),new h(u,d,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(h.ZERO)}wNAF(e){return f.wNAFCached(this,u,e,(e=>{const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}))}multiplyUnsafe(e){const r=h.ZERO;if(e===_0n$5)return r;if(a(e),e===_1n$6)return this;const{endo:o}=t;if(!o)return f.unsafeLadder(this,e);let{k1neg:i,k1:s,k2neg:c,k2:u}=o.splitScalar(e),l=r,d=r,p=this;for(;s>_0n$5||u>_0n$5;)s&_1n$6&&(l=l.add(p)),u&_1n$6&&(d=d.add(p)),p=p.double(),s>>=_1n$6,u>>=_1n$6;return i&&(l=l.negate()),c&&(d=d.negate()),d=new h(n.mul(d.px,o.beta),d.py,d.pz),l.add(d)}multiply(e){a(e);let r,o,i=e;const{endo:s}=t;if(s){const{k1neg:e,k1:t,k2neg:a,k2:c}=s.splitScalar(i);let{p:u,f:l}=this.wNAF(t),{p:d,f:p}=this.wNAF(c);u=f.constTimeNegate(e,u),d=f.constTimeNegate(a,d),d=new h(n.mul(d.px,s.beta),d.py,d.pz),r=u.add(d),o=l.add(p)}else{const{p:e,f:t}=this.wNAF(i);r=e,o=t}return h.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(e,t,n){const r=h.BASE,o=(e,t)=>t!==_0n$5&&t!==_1n$6&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),i=o(this,t).add(o(e,n));return i.is0()?void 0:i}toAffine(e){const{px:t,py:r,pz:o}=this,i=this.is0();null==e&&(e=i?n.ONE:n.inv(o));const s=n.mul(t,e),a=n.mul(r,e),c=n.mul(o,e);if(i)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===_1n$6)return!0;if(n)return n(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===_1n$6?this:n?n(h,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return this.assertValidity(),r(h,this,e)}toHex(e=!0){return bytesToHex$2(this.toRawBytes(e))}}h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const d=t.nBitLength,f=wNAF$1(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:s}}function validateOpts$1(e){const t=validateBasic$1(e);return validateObject$1(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function weierstrass$1(e){const t=validateOpts$1(e),{Fp:n,n:r}=t,o=n.BYTES+1,i=2*n.BYTES+1;function s(e){return mod$1(e,r)}function a(e){return invert$1(e,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:h}=weierstrassPoints$1({...t,toBytes(e,t,r){const o=t.toAffine(),i=n.toBytes(o.x),s=concatBytes$2;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),i):s(Uint8Array.from([4]),i,n.toBytes(o.y))},fromBytes(e){const t=e.length,r=e[0],s=e.subarray(1);if(t!==o||2!==r&&3!==r){if(t===i&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error(`Point of length ${t} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}{const e=bytesToNumberBE$1(s);if(!(_0n$5<(a=e)&&a<n.ORDER))throw new Error("Point is not on curve");const t=l(e);let o=n.sqrt(t);return!(1&~r)!==((o&_1n$6)===_1n$6)&&(o=n.neg(o)),{x:e,y:o}}var a}}),d=e=>bytesToHex$2(numberToBytesBE$1(e,t.nByteLength));function f(e){return e>r>>_1n$6}const p=(e,t,n)=>bytesToNumberBE$1(e.slice(t,n));class y{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=ensureBytes$2("compactSignature",e,2*n),new y(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=DER$1.toSig(ensureBytes$2("DER",e));return new y(t,n)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:o,recovery:i}=this,u=w(ensureBytes$2("msgHash",e));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const l=2===i||3===i?r+t.n:r;if(l>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=1&i?"03":"02",f=c.fromHex(h+d(l)),p=a(l),y=s(-u*p),g=s(o*p),b=c.BASE.multiplyAndAddUnsafe(f,y,g);if(!b)throw new Error("point at infinify");return b.assertValidity(),b}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes$1(this.toDERHex())}toDERHex(){return DER$1.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes$1(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const g={isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>numberToBytesBE$1(hashToPrivateScalar(t.randomBytes(n.BYTES+8),r),t.nByteLength),precompute:(e=8,t=c.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function b(e){const t=e instanceof Uint8Array,n="string"==typeof e,r=(t||n)&&e.length;return t?r===o||r===i:n?r===2*o||r===2*i:e instanceof c}const m=t.bits2int||function(e){const n=bytesToNumberBE$1(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},w=t.bits2int_modN||function(e){return s(m(e))},$=bitMask$1(t.nBitLength);function _(e){if("bigint"!=typeof e)throw new Error("bigint expected");if(!(_0n$5<=e&&e<$))throw new Error(`bigint expected < 2^${t.nBitLength}`);return numberToBytesBE$1(e,t.nByteLength)}function E(e,r,o=v){if(["recovered","canonical"].some((e=>e in o)))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:l}=t;let{lowS:d,prehash:p,extraEntropy:g}=o;null==d&&(d=!0),e=ensureBytes$2("msgHash",e),p&&(e=ensureBytes$2("prehashed msgHash",i(e)));const b=w(e),$=u(r),E=[_($),_(b)];if(null!=g){const e=!0===g?l(n.BYTES):g;E.push(ensureBytes$2("extraEntropy",e,n.BYTES))}const x=concatBytes$2(...E),k=b;return{seed:x,k2sig:function(e){const t=m(e);if(!h(t))return;const n=a(t),r=c.BASE.multiply(t).toAffine(),o=s(r.x);if(o===_0n$5)return;const i=s(n*s(k+o*$));if(i===_0n$5)return;let u=(r.x===o?0:2)|Number(r.y&_1n$6),l=i;return d&&f(i)&&(l=function(e){return f(e)?s(-e):e}(i),u^=1),new y(o,l,u)}}}const v={lowS:t.lowS,prehash:!1},x={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,n=!0){if(b(e))throw new Error("first arg must be private key");if(!b(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(u(e)).toRawBytes(n)},sign:function(e,n,r=v){const{seed:o,k2sig:i}=E(e,n,r),s=t;return createHmacDrbg$1(s.hash.outputLen,s.nByteLength,s.hmac)(o,i)},verify:function(e,n,r,o=x){const i=e;if(n=ensureBytes$2("msgHash",n),r=ensureBytes$2("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:l}=o;let h,d;try{if("string"==typeof i||i instanceof Uint8Array)try{h=y.fromDER(i)}catch(e){if(!(e instanceof DER$1.Err))throw e;h=y.fromCompact(i)}else{if("object"!=typeof i||"bigint"!=typeof i.r||"bigint"!=typeof i.s)throw new Error("PARSE");{const{r:e,s:t}=i;h=new y(e,t)}}d=c.fromHex(r)}catch(e){if("PARSE"===e.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&h.hasHighS())return!1;l&&(n=t.hash(n));const{r:f,s:p}=h,g=w(n),b=a(p),m=s(g*b),$=s(f*b),_=c.BASE.multiplyAndAddUnsafe(d,m,$)?.toAffine();return!!_&&s(_.x)===f},ProjectivePoint:c,Signature:y,utils:g}}BigInt(4);let HMAC$1=class extends Hash$1{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,assert$1.hash(e);const n=toBytes$2(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<o.length;e++)o[e]^=54;this.iHash.update(o),this.oHash=e.create();for(let e=0;e<o.length;e++)o[e]^=106;this.oHash.update(o),o.fill(0)}update(e){return assert$1.exists(this),this.iHash.update(e),this}digestInto(e){assert$1.exists(this),assert$1.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return e.finished=r,e.destroyed=o,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const hmac$1=(e,t,n)=>new HMAC$1(e,t).update(n).digest();
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function getHash$1(e){return{hash:e,hmac:(t,...n)=>hmac$1(e,t,concatBytes$3(...n)),randomBytes:randomBytes$1}}function createCurve$1(e,t){const n=t=>weierstrass$1({...e,...getHash$1(t)});return Object.freeze({...n(t),create:n})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */hmac$1.create=(e,t)=>new HMAC$1(e,t);const secp256k1P$1=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N$1=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n$5=BigInt(1),_2n$3=BigInt(2),divNearest$1=(e,t)=>(e+t/_2n$3)/t;function sqrtMod$1(e){const t=secp256k1P$1,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),u=e*e*e%t,l=u*u*e%t,h=pow2$1(l,n,t)*l%t,d=pow2$1(h,n,t)*l%t,f=pow2$1(d,_2n$3,t)*u%t,p=pow2$1(f,o,t)*f%t,y=pow2$1(p,i,t)*p%t,g=pow2$1(y,a,t)*y%t,b=pow2$1(g,c,t)*g%t,m=pow2$1(b,a,t)*y%t,w=pow2$1(m,n,t)*l%t,$=pow2$1(w,s,t)*p%t,_=pow2$1($,r,t)*u%t,E=pow2$1(_,_2n$3,t);if(!Fp$1.eql(Fp$1.sqr(E),e))throw new Error("Cannot find square root");return E}const Fp$1=Field$1(secp256k1P$1,void 0,void 0,{sqrt:sqrtMod$1}),secp256k1$1=createCurve$1({a:BigInt(0),b:BigInt(7),Fp:Fp$1,n:secp256k1N$1,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=secp256k1N$1,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-_1n$5*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=divNearest$1(i*e,t),c=divNearest$1(-r*e,t);let u=mod$1(e-a*n-c*o,t),l=mod$1(-a*r-c*i,t);const h=u>s,d=l>s;if(h&&(u=t-u),d&&(l=t-l),u>s||l>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:d,k2:l}}}},sha256$1);BigInt(0),secp256k1$1.ProjectivePoint;const Point$1=secp256k1$1.ProjectivePoint,base58check=base58check$1(sha256$2);function bytesToNumber(e){return BigInt(`0x${bytesToHex$3(e)}`)}function numberToBytes(e){return hexToBytes$2(e.toString(16).padStart(64,"0"))}const MASTER_SECRET=utf8ToBytes$5("Bitcoin seed"),BITCOIN_VERSIONS={private:76066276,public:76067358},HARDENED_OFFSET=2147483648,hash160=e=>ripemd160(sha256$2(e)),fromU32=e=>createView$2(e).getUint32(0,!1),toU32=e=>{if(!Number.isSafeInteger(e)||e<0||e>2**32-1)throw new Error(`Invalid number=${e}. Should be from 0 to 2 ** 32 - 1`);const t=new Uint8Array(4);return createView$2(t).setUint32(0,e,!1),t};class HDKey{get fingerprint(){if(!this.pubHash)throw new Error("No publicKey set!");return fromU32(this.pubHash)}get identifier(){return this.pubHash}get pubKeyHash(){return this.pubHash}get privateKey(){return this.privKeyBytes||null}get publicKey(){return this.pubKey||null}get privateExtendedKey(){const e=this.privateKey;if(!e)throw new Error("No private key");return base58check.encode(this.serialize(this.versions.private,concatBytes$4(new Uint8Array([0]),e)))}get publicExtendedKey(){if(!this.pubKey)throw new Error("No public key");return base58check.encode(this.serialize(this.versions.public,this.pubKey))}static fromMasterSeed(e,t=BITCOIN_VERSIONS){if(bytes$3(e),8*e.length<128||8*e.length>512)throw new Error(`HDKey: wrong seed length=${e.length}. Should be between 128 and 512 bits; 256 bits is advised)`);const n=hmac$2(sha512,MASTER_SECRET,e);return new HDKey({versions:t,chainCode:n.slice(32),privateKey:n.slice(0,32)})}static fromExtendedKey(e,t=BITCOIN_VERSIONS){const n=base58check.decode(e),r=createView$2(n),o=r.getUint32(0,!1),i={versions:t,depth:n[4],parentFingerprint:r.getUint32(5,!1),index:r.getUint32(9,!1),chainCode:n.slice(13,45)},s=n.slice(45),a=0===s[0];if(o!==t[a?"private":"public"])throw new Error("Version mismatch");return new HDKey(a?{...i,privateKey:s.slice(1)}:{...i,publicKey:s})}static fromJSON(e){return HDKey.fromExtendedKey(e.xpriv)}constructor(e){if(this.depth=0,this.index=0,this.chainCode=null,this.parentFingerprint=0,!e||"object"!=typeof e)throw new Error("HDKey.constructor must not be called directly");if(this.versions=e.versions||BITCOIN_VERSIONS,this.depth=e.depth||0,this.chainCode=e.chainCode,this.index=e.index||0,this.parentFingerprint=e.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");if(e.publicKey&&e.privateKey)throw new Error("HDKey: publicKey and privateKey at same time.");if(e.privateKey){if(!secp256k1$1.utils.isValidPrivateKey(e.privateKey))throw new Error("Invalid private key");this.privKey="bigint"==typeof e.privateKey?e.privateKey:bytesToNumber(e.privateKey),this.privKeyBytes=numberToBytes(this.privKey),this.pubKey=secp256k1$1.getPublicKey(e.privateKey,!0)}else{if(!e.publicKey)throw new Error("HDKey: no public or private key provided");this.pubKey=Point$1.fromHex(e.publicKey).toRawBytes(!0)}this.pubHash=hash160(this.pubKey)}derive(e){if(!/^[mM]'?/.test(e))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(e))return this;const t=e.replace(/^[mM]'?\//,"").split("/");let n=this;for(const e of t){const t=/^(\d+)('?)$/.exec(e);if(!t||3!==t.length)throw new Error(`Invalid child index: ${e}`);let r=+t[1];if(!Number.isSafeInteger(r)||r>=HARDENED_OFFSET)throw new Error("Invalid index");"'"===t[2]&&(r+=HARDENED_OFFSET),n=n.deriveChild(r)}return n}deriveChild(e){if(!this.pubKey||!this.chainCode)throw new Error("No publicKey or chainCode set");let t=toU32(e);if(e>=HARDENED_OFFSET){const e=this.privateKey;if(!e)throw new Error("Could not derive hardened child key");t=concatBytes$4(new Uint8Array([0]),e,t)}else t=concatBytes$4(this.pubKey,t);const n=hmac$2(sha512,this.chainCode,t),r=bytesToNumber(n.slice(0,32)),o=n.slice(32);if(!secp256k1$1.utils.isValidPrivateKey(r))throw new Error("Tweak bigger than curve order");const i={versions:this.versions,chainCode:o,depth:this.depth+1,parentFingerprint:this.fingerprint,index:e};try{if(this.privateKey){const e=mod$1(this.privKey+r,secp256k1$1.CURVE.n);if(!secp256k1$1.utils.isValidPrivateKey(e))throw new Error("The tweak was out of range or the resulted private key is invalid");i.privateKey=e}else{const e=Point$1.fromHex(this.pubKey).add(Point$1.fromPrivateKey(r));if(e.equals(Point$1.ZERO))throw new Error("The tweak was equal to negative P, which made the result key invalid");i.publicKey=e.toRawBytes(!0)}return new HDKey(i)}catch(t){return this.deriveChild(e+1)}}sign(e){if(!this.privateKey)throw new Error("No privateKey set!");return bytes$3(e,32),secp256k1$1.sign(e,this.privKey).toCompactRawBytes()}verify(e,t){if(bytes$3(e,32),bytes$3(t,64),!this.publicKey)throw new Error("No publicKey set!");let n;try{n=secp256k1$1.Signature.fromCompact(t)}catch(e){return!1}return secp256k1$1.verify(n,e,this.publicKey)}wipePrivateData(){return this.privKey=void 0,this.privKeyBytes&&(this.privKeyBytes.fill(0),this.privKeyBytes=void 0),this}toJSON(){return{xpriv:this.privateExtendedKey,xpub:this.publicExtendedKey}}serialize(e,t){if(!this.chainCode)throw new Error("No chainCode set");return bytes$3(t,33),concatBytes$4(toU32(e),new Uint8Array([this.depth]),toU32(this.parentFingerprint),toU32(this.index),this.chainCode,t)}}
/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const u8a=e=>e instanceof Uint8Array,u32=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),isLE=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];if(!isLE)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes$2(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function toBytes$1(e){if("string"==typeof e&&(e=utf8ToBytes$2(e)),!u8a(e))throw new Error("expected Uint8Array, got "+typeof e);return e}const isPlainObject=e=>"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object;function checkOpts(e,t){if(void 0!==t&&("object"!=typeof t||!isPlainObject(t)))throw new Error("options must be object or undefined");return Object.assign(e,t)}function ensureBytes$1(e,t){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");if("number"==typeof t&&e.length!==t)throw new Error(`Uint8Array length ${t} expected`)}function equalBytes$1(e,t){if(e.length!==t.length)throw new Error("equalBytes: Different size of Uint8Arrays");let n=!0;for(let r=0;r<e.length;r++)n&&(n=e[r]===t[r]);return n}function number$1(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function bool(e){if("boolean"!=typeof e)throw new Error(`Expected boolean, not ${e}`)}function bytes$1(e,...t){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hash$1(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("hash must be wrapped by utils.wrapConstructor");number$1(e.outputLen),number$1(e.blockLen)}function exists$1(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output$1(e,t){bytes$1(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const assert={number:number$1,bool:bool,bytes:bytes$1,hash:hash$1,exists:exists$1,output:output$1},u8to16=(e,t)=>255&e[t++]|(255&e[t++])<<8;class Poly1305{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,ensureBytes$1(e=toBytes$1(e),32);const t=u8to16(e,0),n=u8to16(e,2),r=u8to16(e,4),o=u8to16(e,6),i=u8to16(e,8),s=u8to16(e,10),a=u8to16(e,12),c=u8to16(e,14);this.r[0]=8191&t,this.r[1]=8191&(t>>>13|n<<3),this.r[2]=7939&(n>>>10|r<<6),this.r[3]=8191&(r>>>7|o<<9),this.r[4]=255&(o>>>4|i<<12),this.r[5]=i>>>1&8190,this.r[6]=8191&(i>>>14|s<<2),this.r[7]=8065&(s>>>11|a<<5),this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=u8to16(e,16+2*t)}process(e,t,n=!1){const r=n?0:2048,{h:o,r:i}=this,s=i[0],a=i[1],c=i[2],u=i[3],l=i[4],h=i[5],d=i[6],f=i[7],p=i[8],y=i[9],g=u8to16(e,t+0),b=u8to16(e,t+2),m=u8to16(e,t+4),w=u8to16(e,t+6),$=u8to16(e,t+8),_=u8to16(e,t+10),E=u8to16(e,t+12),v=u8to16(e,t+14);let x=o[0]+(8191&g),k=o[1]+(8191&(g>>>13|b<<3)),B=o[2]+(8191&(b>>>10|m<<6)),A=o[3]+(8191&(m>>>7|w<<9)),S=o[4]+(8191&(w>>>4|$<<12)),T=o[5]+($>>>1&8191),L=o[6]+(8191&($>>>14|_<<2)),H=o[7]+(8191&(_>>>11|E<<5)),C=o[8]+(8191&(E>>>8|v<<8)),N=o[9]+(v>>>5|r),I=0,R=I+x*s+k*(5*y)+B*(5*p)+A*(5*f)+S*(5*d);I=R>>>13,R&=8191,R+=T*(5*h)+L*(5*l)+H*(5*u)+C*(5*c)+N*(5*a),I+=R>>>13,R&=8191;let U=I+x*a+k*s+B*(5*y)+A*(5*p)+S*(5*f);I=U>>>13,U&=8191,U+=T*(5*d)+L*(5*h)+H*(5*l)+C*(5*u)+N*(5*c),I+=U>>>13,U&=8191;let O=I+x*c+k*a+B*s+A*(5*y)+S*(5*p);I=O>>>13,O&=8191,O+=T*(5*f)+L*(5*d)+H*(5*h)+C*(5*l)+N*(5*u),I+=O>>>13,O&=8191;let F=I+x*u+k*c+B*a+A*s+S*(5*y);I=F>>>13,F&=8191,F+=T*(5*p)+L*(5*f)+H*(5*d)+C*(5*h)+N*(5*l),I+=F>>>13,F&=8191;let P=I+x*l+k*u+B*c+A*a+S*s;I=P>>>13,P&=8191,P+=T*(5*y)+L*(5*p)+H*(5*f)+C*(5*d)+N*(5*h),I+=P>>>13,P&=8191;let D=I+x*h+k*l+B*u+A*c+S*a;I=D>>>13,D&=8191,D+=T*s+L*(5*y)+H*(5*p)+C*(5*f)+N*(5*d),I+=D>>>13,D&=8191;let j=I+x*d+k*h+B*l+A*u+S*c;I=j>>>13,j&=8191,j+=T*a+L*s+H*(5*y)+C*(5*p)+N*(5*f),I+=j>>>13,j&=8191;let M=I+x*f+k*d+B*h+A*l+S*u;I=M>>>13,M&=8191,M+=T*c+L*a+H*s+C*(5*y)+N*(5*p),I+=M>>>13,M&=8191;let K=I+x*p+k*f+B*d+A*h+S*l;I=K>>>13,K&=8191,K+=T*u+L*c+H*a+C*s+N*(5*y),I+=K>>>13,K&=8191;let q=I+x*y+k*p+B*f+A*d+S*h;I=q>>>13,q&=8191,q+=T*l+L*u+H*c+C*a+N*s,I+=q>>>13,q&=8191,I=(I<<2)+I|0,I=I+R|0,R=8191&I,I>>>=13,U+=I,o[0]=R,o[1]=U,o[2]=O,o[3]=F,o[4]=P,o[5]=D,o[6]=j,o[7]=M,o[8]=K,o[9]=q}finalize(){const{h:e,pad:t}=this,n=new Uint16Array(10);let r=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=r,r=e[t]>>>13,e[t]&=8191;e[0]+=5*r,r=e[0]>>>13,e[0]&=8191,e[1]+=r,r=e[1]>>>13,e[1]&=8191,e[2]+=r,n[0]=e[0]+5,r=n[0]>>>13,n[0]&=8191;for(let t=1;t<10;t++)n[t]=e[t]+r,r=n[t]>>>13,n[t]&=8191;n[9]-=8192;let o=(1^r)-1;for(let e=0;e<10;e++)n[e]&=o;o=~o;for(let t=0;t<10;t++)e[t]=e[t]&o|n[t];e[0]=65535&(e[0]|e[1]<<13),e[1]=65535&(e[1]>>>3|e[2]<<10),e[2]=65535&(e[2]>>>6|e[3]<<7),e[3]=65535&(e[3]>>>9|e[4]<<4),e[4]=65535&(e[4]>>>12|e[5]<<1|e[6]<<14),e[5]=65535&(e[6]>>>2|e[7]<<11),e[6]=65535&(e[7]>>>5|e[8]<<8),e[7]=65535&(e[8]>>>8|e[9]<<5);let i=e[0]+t[0];e[0]=65535&i;for(let n=1;n<8;n++)i=(e[n]+t[n]|0)+(i>>>16)|0,e[n]=65535&i}update(e){assert.exists(this);const{buffer:t,blockLen:n}=this,r=(e=toBytes$1(e)).length;for(let o=0;o<r;){const i=Math.min(n-this.pos,r-o);if(i!==n)t.set(e.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===n&&(this.process(t,0,!1),this.pos=0);else for(;n<=r-o;o+=n)this.process(e,o)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){assert.exists(this),assert.output(e,this),this.finished=!0;const{buffer:t,h:n}=this;let{pos:r}=this;if(r){for(t[r++]=1;r<16;r++)t[r]=0;this.process(t,0,!0)}this.finalize();let o=0;for(let t=0;t<8;t++)e[o++]=n[t]>>>0,e[o++]=n[t]>>>8;return e}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}}function wrapConstructorWithKey(e){const t=(t,n)=>e(n).update(toBytes$1(t)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=t=>e(t),t}wrapConstructorWithKey((e=>new Poly1305(e)));const sigma16=utf8ToBytes$2("expand 16-byte k"),sigma32=utf8ToBytes$2("expand 32-byte k"),sigma16_32=u32(sigma16),sigma32_32=u32(sigma32),isAligned32=e=>!(e.byteOffset%4),salsaBasic=e=>{const{core:t,rounds:n,counterRight:r,counterLen:o,allow128bitKeys:i,extendNonceFn:s,blockLen:a}=checkOpts({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},e);assert.number(o),assert.number(n),assert.number(a),assert.bool(r),assert.bool(i);const c=a/4;if(a%4!=0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(e,u,l,h,d=0)=>{if(assert.bytes(e),assert.bytes(u),assert.bytes(l),h||(h=new Uint8Array(l.length)),assert.bytes(h),assert.number(d),d<0||d>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(h.length<l.length)throw new Error(`Salsa/ChaCha: output (${h.length}) is shorter than data (${l.length})`);const f=[];let p,y;if(32===e.length)p=e,y=sigma32_32;else{if(16!==e.length||!i)throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${e.length}`);p=new Uint8Array(32),p.set(e),p.set(e,16),y=sigma16_32,f.push(p)}if(s){if(u.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");p=s(y,p,u.subarray(0,16),new Uint8Array(32)),f.push(p),u=u.subarray(16)}const g=16-o;if(u.length!==g)throw new Error(`Salsa/ChaCha: nonce must be ${g} or 16 bytes`);if(12!==g){const e=new Uint8Array(12);e.set(u,r?0:12-u.length),f.push(u=e)}const b=new Uint8Array(a),m=u32(b),w=u32(p),$=u32(u),_=isAligned32(l)&&u32(l),E=isAligned32(h)&&u32(h);f.push(m);const v=l.length;for(let e=0,r=d;e<v;r++){if(t(y,w,$,m,r,n),r>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");const o=Math.min(a,v-e);if(o===a&&E&&_){const t=e/4;if(e%4!=0)throw new Error("Salsa/ChaCha: invalid block position");for(let e=0;e<c;e++)E[t+e]=_[t+e]^m[e];e+=a}else{for(let t=0;t<o;t++)h[e+t]=l[e+t]^b[t];e+=o}}for(let e=0;e<f.length;e++)f[e].fill(0);return h}},rotl=(e,t)=>e<<t|e>>>32-t;function chachaCore(e,t,n,r,o,i=20){let s=e[0],a=e[1],c=e[2],u=e[3],l=t[0],h=t[1],d=t[2],f=t[3],p=t[4],y=t[5],g=t[6],b=t[7],m=o,w=n[0],$=n[1],_=n[2],E=s,v=a,x=c,k=u,B=l,A=h,S=d,T=f,L=p,H=y,C=g,N=b,I=m,R=w,U=$,O=_;for(let e=0;e<i;e+=2)E=E+B|0,I=rotl(I^E,16),L=L+I|0,B=rotl(B^L,12),E=E+B|0,I=rotl(I^E,8),L=L+I|0,B=rotl(B^L,7),v=v+A|0,R=rotl(R^v,16),H=H+R|0,A=rotl(A^H,12),v=v+A|0,R=rotl(R^v,8),H=H+R|0,A=rotl(A^H,7),x=x+S|0,U=rotl(U^x,16),C=C+U|0,S=rotl(S^C,12),x=x+S|0,U=rotl(U^x,8),C=C+U|0,S=rotl(S^C,7),k=k+T|0,O=rotl(O^k,16),N=N+O|0,T=rotl(T^N,12),k=k+T|0,O=rotl(O^k,8),N=N+O|0,T=rotl(T^N,7),E=E+A|0,O=rotl(O^E,16),C=C+O|0,A=rotl(A^C,12),E=E+A|0,O=rotl(O^E,8),C=C+O|0,A=rotl(A^C,7),v=v+S|0,I=rotl(I^v,16),N=N+I|0,S=rotl(S^N,12),v=v+S|0,I=rotl(I^v,8),N=N+I|0,S=rotl(S^N,7),x=x+T|0,R=rotl(R^x,16),L=L+R|0,T=rotl(T^L,12),x=x+T|0,R=rotl(R^x,8),L=L+R|0,T=rotl(T^L,7),k=k+B|0,U=rotl(U^k,16),H=H+U|0,B=rotl(B^H,12),k=k+B|0,U=rotl(U^k,8),H=H+U|0,B=rotl(B^H,7);let F=0;r[F++]=s+E|0,r[F++]=a+v|0,r[F++]=c+x|0,r[F++]=u+k|0,r[F++]=l+B|0,r[F++]=h+A|0,r[F++]=d+S|0,r[F++]=f+T|0,r[F++]=p+L|0,r[F++]=y+H|0,r[F++]=g+C|0,r[F++]=b+N|0,r[F++]=m+I|0,r[F++]=w+R|0,r[F++]=$+U|0,r[F++]=_+O|0}const chacha20=salsaBasic({core:chachaCore,counterRight:!1,counterLen:4,allow128bitKeys:!1});function extract(e,t,n){return assert$4.hash(e),void 0===n&&(n=new Uint8Array(e.outputLen)),hmac$4(e,toBytes$5(n),toBytes$5(t))}const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER=new Uint8Array;function expand(e,t,n,r=32){if(assert$4.hash(e),assert$4.number(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(r/e.outputLen);void 0===n&&(n=EMPTY_BUFFER);const i=new Uint8Array(o*e.outputLen),s=hmac$4.create(e,t),a=s._cloneInto(),c=new Uint8Array(s.outputLen);for(let t=0;t<o;t++)HKDF_COUNTER[0]=t+1,a.update(0===t?EMPTY_BUFFER:c).update(n).update(HKDF_COUNTER).digestInto(c),i.set(c,e.outputLen*t),s._cloneInto(a);return s.destroy(),a.destroy(),c.fill(0),HKDF_COUNTER.fill(0),i.slice(0,r)}const hkdf=(e,t,n,r,o)=>expand(e,extract(e,t,n),r,o);var __defProp=Object.defineProperty,__export=(e,t)=>{for(var n in t)__defProp(e,n,{get:t[n],enumerable:!0})};function getPublicKey(e){return bytesToHex$5(schnorr$1.getPublicKey(e))}var utils_exports={};__export(utils_exports,{MessageNode:()=>MessageNode,MessageQueue:()=>MessageQueue,insertEventIntoAscendingList:()=>insertEventIntoAscendingList,insertEventIntoDescendingList:()=>insertEventIntoDescendingList,normalizeURL:()=>normalizeURL,utf8Decoder:()=>utf8Decoder,utf8Encoder:()=>utf8Encoder});var utf8Decoder=new TextDecoder("utf-8"),utf8Encoder=new TextEncoder;function normalizeURL(e){let t=new URL(e);return t.pathname=t.pathname.replace(/\/+/g,"/"),t.pathname.endsWith("/")&&(t.pathname=t.pathname.slice(0,-1)),("80"===t.port&&"ws:"===t.protocol||"443"===t.port&&"wss:"===t.protocol)&&(t.port=""),t.searchParams.sort(),t.hash="",t.toString()}function insertEventIntoDescendingList(e,t){let n,r=0,o=e.length-1,i=r;if(o<0)i=0;else if(t.created_at<e[o].created_at)i=o+1;else if(t.created_at>=e[r].created_at)i=r;else for(;;){if(o<=r+1){i=o;break}if(n=Math.floor(r+(o-r)/2),e[n].created_at>t.created_at)r=n;else{if(!(e[n].created_at<t.created_at)){i=n;break}o=n}}return e[i]?.id!==t.id?[...e.slice(0,i),t,...e.slice(i)]:e}function insertEventIntoAscendingList(e,t){let n,r=0,o=e.length-1,i=r;if(o<0)i=0;else if(t.created_at>e[o].created_at)i=o+1;else if(t.created_at<=e[r].created_at)i=r;else for(;;){if(o<=r+1){i=o;break}if(n=Math.floor(r+(o-r)/2),e[n].created_at<t.created_at)r=n;else{if(!(e[n].created_at>t.created_at)){i=n;break}o=n}}return e[i]?.id!==t.id?[...e.slice(0,i),t,...e.slice(i)]:e}var MessageNode=class{_value;_next;get value(){return this._value}set value(e){this._value=e}get next(){return this._next}set next(e){this._next=e}constructor(e){this._value=e,this._next=null}},MessageQueue=class{_first;_last;get first(){return this._first}set first(e){this._first=e}get last(){return this._last}set last(e){this._last=e}_size;get size(){return this._size}set size(e){this._size=e}constructor(){this._first=null,this._last=null,this._size=0}enqueue(e){const t=new MessageNode(e);return 0!==this._size&&this._last?(this._last.next=t,this._last=t):(this._first=t,this._last=t),this._size++,!0}dequeue(){if(0===this._size||!this._first)return null;let e=this._first;return this._first=e.next,e.next=null,this._size--,e.value}},verifiedSymbol=Symbol("verified");function getBlankEvent(e=255){return{kind:e,content:"",tags:[],created_at:0}}function finishEvent(e,t){const n=e;return n.pubkey=getPublicKey(t),n.id=getEventHash$1(n),n.sig=getSignature(n,t),n[verifiedSymbol]=!0,n}function serializeEvent(e){if(!validateEvent(e))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,e.pubkey,e.created_at,e.kind,e.tags,e.content])}function getEventHash$1(e){return bytesToHex$5(sha256$4(utf8Encoder.encode(serializeEvent(e))))}var isRecord=e=>e instanceof Object;function validateEvent(e){if(!isRecord(e))return!1;if("number"!=typeof e.kind)return!1;if("string"!=typeof e.content)return!1;if("number"!=typeof e.created_at)return!1;if("string"!=typeof e.pubkey)return!1;if(!e.pubkey.match(/^[a-f0-9]{64}$/))return!1;if(!Array.isArray(e.tags))return!1;for(let t=0;t<e.tags.length;t++){let n=e.tags[t];if(!Array.isArray(n))return!1;for(let e=0;e<n.length;e++)if("object"==typeof n[e])return!1}return!0}function verifySignature$1(e){if("boolean"==typeof e[verifiedSymbol])return e[verifiedSymbol];const t=getEventHash$1(e);if(t!==e.id)return e[verifiedSymbol]=!1;try{return e[verifiedSymbol]=schnorr$1.verify(e.sig,t,e.pubkey)}catch(t){return e[verifiedSymbol]=!1}}function getSignature(e,t){return bytesToHex$5(schnorr$1.sign(getEventHash$1(e),t))}function matchFilter(e,t){if(e.ids&&-1===e.ids.indexOf(t.id)&&!e.ids.some((e=>t.id.startsWith(e))))return!1;if(e.kinds&&-1===e.kinds.indexOf(t.kind))return!1;if(e.authors&&-1===e.authors.indexOf(t.pubkey)&&!e.authors.some((e=>t.pubkey.startsWith(e))))return!1;for(let n in e)if("#"===n[0]){let r=e[`#${n.slice(1)}`];if(r&&!t.tags.find((([e,t])=>e===n.slice(1)&&-1!==r.indexOf(t))))return!1}return!(e.since&&t.created_at<e.since)&&!(e.until&&t.created_at>e.until)}function matchFilters(e,t){for(let n=0;n<e.length;n++)if(matchFilter(e[n],t))return!0;return!1}function mergeFilters$1(...e){let t={};for(let n=0;n<e.length;n++){let r=e[n];Object.entries(r).forEach((([e,n])=>{if("kinds"===e||"ids"===e||"authors"===e||"#"===e[0]){t[e]=t[e]||[];for(let r=0;r<n.length;r++){let o=n[r];t[e].includes(o)||t[e].push(o)}}})),r.limit&&(!t.limit||r.limit>t.limit)&&(t.limit=r.limit),r.until&&(!t.until||r.until>t.until)&&(t.until=r.until),r.since&&(!t.since||r.since<t.since)&&(t.since=r.since)}return t}var fakejson_exports={};function getHex64(e,t){let n=t.length+3,r=e.indexOf(`"${t}":`)+n,o=e.slice(r).indexOf('"')+r+1;return e.slice(o,o+64)}function getInt(e,t){let n=t.length,r=e.indexOf(`"${t}":`)+n+3,o=e.slice(r),i=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,i),10)}function getSubscriptionId(e){let t=e.slice(0,22).indexOf('"EVENT"');if(-1===t)return null;let n=e.slice(t+7+1).indexOf('"');if(-1===n)return null;let r=t+7+1+n,o=e.slice(r+1,80).indexOf('"');if(-1===o)return null;let i=r+1+o;return e.slice(r+1,i)}function matchEventId(e,t){return t===getHex64(e,"id")}function matchEventPubkey(e,t){return t===getHex64(e,"pubkey")}function matchEventKind(e,t){return t===getInt(e,"kind")}__export(fakejson_exports,{getHex64:()=>getHex64,getInt:()=>getInt,getSubscriptionId:()=>getSubscriptionId,matchEventId:()=>matchEventId,matchEventKind:()=>matchEventKind,matchEventPubkey:()=>matchEventPubkey});var newListeners=()=>({connect:[],disconnect:[],error:[],notice:[],auth:[]});function relayInit(e,t={}){let{listTimeout:n=3e3,getTimeout:r=3e3,countTimeout:o=3e3}=t;var i,s,a={},c=newListeners(),u={},l={};function h(){return 1===i?.readyState}async function d(e){let t=JSON.stringify(e);if(h()||(await new Promise((e=>setTimeout(e,1e3))),h()))try{i.send(t)}catch(e){console.log(e)}}const f=(e,{verb:t="REQ",skipVerification:n=!1,alreadyHaveEvent:r=null,id:o=Math.random().toString().slice(2)}={})=>{let i=o;a[i]={id:i,filters:e,skipVerification:n,alreadyHaveEvent:r},d([t,i,...e]);let s={sub:(t,o={})=>f(t||e,{skipVerification:o.skipVerification||n,alreadyHaveEvent:o.alreadyHaveEvent||r,id:i}),unsub:()=>{delete a[i],delete u[i],d(["CLOSE",i])},on:(e,t)=>{u[i]=u[i]||{event:[],count:[],eose:[]},u[i][e].push(t)},off:(e,t)=>{let n=u[i],r=n[e].indexOf(t);r>=0&&n[e].splice(r,1)},get events(){return eventsGenerator(s)}};return s};function p(e,t){return new Promise(((n,r)=>{if(!e.id)return void r(new Error(`event ${e} has no id`));let o=e.id;d([t,e]),l[o]={resolve:n,reject:r}}))}return{url:e,sub:f,on:(e,t)=>{c[e].push(t),"connect"===e&&1===i?.readyState&&t()},off:(e,t)=>{let n=c[e].indexOf(t);-1!==n&&c[e].splice(n,1)},list:(e,t)=>new Promise((r=>{let o=f(e,t),i=[],s=setTimeout((()=>{o.unsub(),r(i)}),n);o.on("eose",(()=>{o.unsub(),clearTimeout(s),r(i)})),o.on("event",(e=>{i.push(e)}))})),get:(e,t)=>new Promise((n=>{let o=f([e],t),i=setTimeout((()=>{o.unsub(),n(null)}),r);o.on("event",(e=>{o.unsub(),clearTimeout(i),n(e)}))})),count:e=>new Promise((t=>{let n=f(e,{...f,verb:"COUNT"}),r=setTimeout((()=>{n.unsub(),t(null)}),o);n.on("count",(e=>{n.unsub(),clearTimeout(r),t(e)}))})),async publish(e){await p(e,"EVENT")},async auth(e){await p(e,"AUTH")},connect:async function(){h()||await async function(){return s||(s=new Promise(((t,n)=>{try{i=new WebSocket(e)}catch(e){n(e)}i.onopen=()=>{c.connect.forEach((e=>e())),t()},i.onerror=()=>{s=void 0,c.error.forEach((e=>e())),n()},i.onclose=async()=>{s=void 0,c.disconnect.forEach((e=>e()))};let r,o=new MessageQueue;function h(){if(0===o.size)return clearInterval(r),void(r=null);var t=o.dequeue();if(!t)return;let n=getSubscriptionId(t);if(n){let r=a[n];if(r&&r.alreadyHaveEvent&&r.alreadyHaveEvent(getHex64(t,"id"),e))return}try{let e=JSON.parse(t);switch(e[0]){case"EVENT":{let t=e[1],n=e[2];return void(validateEvent(n)&&a[t]&&(a[t].skipVerification||verifySignature$1(n))&&matchFilters(a[t].filters,n)&&(a[t],(u[t]?.event||[]).forEach((e=>e(n)))))}case"COUNT":let t=e[1],n=e[2];return void(a[t]&&(u[t]?.count||[]).forEach((e=>e(n))));case"EOSE":{let t=e[1];return void(t in u&&(u[t].eose.forEach((e=>e())),u[t].eose=[]))}case"OK":{let t=e[1],n=e[2],r=e[3]||"";if(t in l){let{resolve:e,reject:o}=l[t];n?e(null):o(new Error(r))}return}case"NOTICE":let r=e[1];return void c.notice.forEach((e=>e(r)));case"AUTH":{let t=e[1];return void c.auth?.forEach((e=>e(t)))}}}catch(e){return}}i.onmessage=e=>{o.enqueue(e.data),r||(r=setInterval(h,0))}})),s)}()},close(){c=newListeners(),u={},l={},i?.readyState===WebSocket.OPEN&&i.close()},get status(){return i?.readyState??3}}}async function*eventsGenerator(e){let t;const n=[],r=e=>{t?(t(e),t=void 0):n.push(e)};e.on("event",r);try{for(;;)if(n.length>0)yield n.shift();else{const e=await new Promise((e=>{t=e}));yield e}}finally{e.off("event",r)}}var SimplePool=class{_conn;_seenOn={};batchedByKey={};eoseSubTimeout;getTimeout;seenOnEnabled=!0;batchInterval=100;constructor(e={}){this._conn={},this.eoseSubTimeout=e.eoseSubTimeout||3400,this.getTimeout=e.getTimeout||3400,this.seenOnEnabled=!1!==e.seenOnEnabled,this.batchInterval=e.batchInterval||100}close(e){e.forEach((e=>{let t=this._conn[normalizeURL(e)];t&&t.close()}))}async ensureRelay(e){const t=normalizeURL(e);this._conn[t]||(this._conn[t]=relayInit(t,{getTimeout:.9*this.getTimeout,listTimeout:.9*this.getTimeout}));const n=this._conn[t];return await n.connect(),n}sub(e,t,n){let r=new Set,o={...n||{}};o.alreadyHaveEvent=(e,t)=>{if(n?.alreadyHaveEvent?.(e,t))return!0;if(this.seenOnEnabled){let n=this._seenOn[e]||new Set;n.add(t),this._seenOn[e]=n}return r.has(e)};let i=[],s=new Set,a=new Set,c=e.length,u=!1,l=setTimeout((()=>{u=!0;for(let e of a.values())e()}),n?.eoseSubTimeout||this.eoseSubTimeout);e.filter(((e,t,n)=>n.indexOf(e)===t)).forEach((async e=>{let n;try{n=await this.ensureRelay(e)}catch(e){return void d()}if(!n)return;let h=n.sub(t,o);function d(){if(c--,0===c){clearTimeout(l);for(let e of a.values())e()}}h.on("event",(e=>{r.add(e.id);for(let t of s.values())t(e)})),h.on("eose",(()=>{u||d()})),i.push(h)}));let h={sub:(e,t)=>(i.forEach((n=>n.sub(e,t))),h),unsub(){i.forEach((e=>e.unsub()))},on(e,t){"event"===e?s.add(t):"eose"===e&&a.add(t)},off(e,t){"event"===e?s.delete(t):"eose"===e&&a.delete(t)},get events(){return eventsGenerator(h)}};return h}get(e,t,n){return new Promise((r=>{let o=this.sub(e,[t],n),i=setTimeout((()=>{o.unsub(),r(null)}),this.getTimeout);o.on("event",(e=>{r(e),clearTimeout(i),o.unsub()}))}))}list(e,t,n){return new Promise((r=>{let o=[],i=this.sub(e,t,n);i.on("event",(e=>{o.push(e)})),i.on("eose",(()=>{i.unsub(),r(o)}))}))}batchedList(e,t,n){return new Promise((r=>{this.batchedByKey[e]?this.batchedByKey[e].push({filters:n,relays:t,resolve:r,events:[]}):(this.batchedByKey[e]=[{filters:n,relays:t,resolve:r,events:[]}],setTimeout((()=>{Object.keys(this.batchedByKey).forEach((async e=>{const t=this.batchedByKey[e],n=[],r=[];t.forEach((e=>{n.push(...e.filters),r.push(...e.relays)}));const o=this.sub(r,[mergeFilters$1(...n)]);o.on("event",(e=>{t.forEach((t=>matchFilters(t.filters,e)&&t.events.push(e)))})),o.on("eose",(()=>{o.unsub(),t.forEach((e=>e.resolve(e.events)))})),delete this.batchedByKey[e]}))}),this.batchInterval))}))}publish(e,t){return e.map((async e=>(await this.ensureRelay(e)).publish(t)))}seenOn(e){return Array.from(this._seenOn[e]?.values?.()||[])}},nip19_exports={};__export(nip19_exports,{BECH32_REGEX:()=>BECH32_REGEX,decode:()=>decode,naddrEncode:()=>naddrEncode,neventEncode:()=>neventEncode,noteEncode:()=>noteEncode,nprofileEncode:()=>nprofileEncode,npubEncode:()=>npubEncode,nrelayEncode:()=>nrelayEncode,nsecEncode:()=>nsecEncode});var Bech32MaxSize=5e3,BECH32_REGEX=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function integerToUint8Array(e){const t=new Uint8Array(4);return t[0]=e>>24&255,t[1]=e>>16&255,t[2]=e>>8&255,t[3]=255&e,t}function decode(e){let{prefix:t,words:n}=bech32$1.decode(e,Bech32MaxSize),r=new Uint8Array(bech32$1.fromWords(n));switch(t){case"nprofile":{let e=parseTLV(r);if(!e[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:bytesToHex$5(e[0][0]),relays:e[1]?e[1].map((e=>utf8Decoder.decode(e))):[]}}}case"nevent":{let e=parseTLV(r);if(!e[0]?.[0])throw new Error("missing TLV 0 for nevent");if(32!==e[0][0].length)throw new Error("TLV 0 should be 32 bytes");if(e[2]&&32!==e[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(e[3]&&4!==e[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:bytesToHex$5(e[0][0]),relays:e[1]?e[1].map((e=>utf8Decoder.decode(e))):[],author:e[2]?.[0]?bytesToHex$5(e[2][0]):void 0,kind:e[3]?.[0]?parseInt(bytesToHex$5(e[3][0]),16):void 0}}}case"naddr":{let e=parseTLV(r);if(!e[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!e[2]?.[0])throw new Error("missing TLV 2 for naddr");if(32!==e[2][0].length)throw new Error("TLV 2 should be 32 bytes");if(!e[3]?.[0])throw new Error("missing TLV 3 for naddr");if(4!==e[3][0].length)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:utf8Decoder.decode(e[0][0]),pubkey:bytesToHex$5(e[2][0]),kind:parseInt(bytesToHex$5(e[3][0]),16),relays:e[1]?e[1].map((e=>utf8Decoder.decode(e))):[]}}}case"nrelay":{let e=parseTLV(r);if(!e[0]?.[0])throw new Error("missing TLV 0 for nrelay");return{type:"nrelay",data:utf8Decoder.decode(e[0][0])}}case"nsec":case"npub":case"note":return{type:t,data:bytesToHex$5(r)};default:throw new Error(`unknown prefix ${t}`)}}function parseTLV(e){let t={},n=e;for(;n.length>0;){let e=n[0],r=n[1];if(!r)throw new Error(`malformed TLV ${e}`);let o=n.slice(2,2+r);if(n=n.slice(2+r),o.length<r)throw new Error(`not enough data to read on TLV ${e}`);t[e]=t[e]||[],t[e].push(o)}return t}function nsecEncode(e){return encodeBytes("nsec",e)}function npubEncode(e){return encodeBytes("npub",e)}function noteEncode(e){return encodeBytes("note",e)}function encodeBech32(e,t){let n=bech32$1.toWords(t);return bech32$1.encode(e,n,Bech32MaxSize)}function encodeBytes(e,t){return encodeBech32(e,hexToBytes$4(t))}function nprofileEncode(e){return encodeBech32("nprofile",encodeTLV({0:[hexToBytes$4(e.pubkey)],1:(e.relays||[]).map((e=>utf8Encoder.encode(e)))}))}function neventEncode(e){let t;return null!=e.kind&&(t=integerToUint8Array(e.kind)),encodeBech32("nevent",encodeTLV({0:[hexToBytes$4(e.id)],1:(e.relays||[]).map((e=>utf8Encoder.encode(e))),2:e.author?[hexToBytes$4(e.author)]:[],3:t?[new Uint8Array(t)]:[]}))}function naddrEncode(e){let t=new ArrayBuffer(4);return new DataView(t).setUint32(0,e.kind,!1),encodeBech32("naddr",encodeTLV({0:[utf8Encoder.encode(e.identifier)],1:(e.relays||[]).map((e=>utf8Encoder.encode(e))),2:[hexToBytes$4(e.pubkey)],3:[new Uint8Array(t)]}))}function nrelayEncode(e){return encodeBech32("nrelay",encodeTLV({0:[utf8Encoder.encode(e)]}))}function encodeTLV(e){let t=[];return Object.entries(e).forEach((([e,n])=>{n.forEach((n=>{let r=new Uint8Array(n.length+2);r.set([parseInt(e)],0),r.set([n.length],1),r.set(n,2),t.push(r)}))})),concatBytes$6(...t)}var nip04_exports={};async function encrypt$1(e,t,n){const r=getNormalizedX(secp256k1$2.getSharedSecret(e,"02"+t));let o=Uint8Array.from(randomBytes$3(16)),i=utf8Encoder.encode(n),s=await crypto.subtle.importKey("raw",r,{name:"AES-CBC"},!1,["encrypt"]),a=await crypto.subtle.encrypt({name:"AES-CBC",iv:o},s,i);return`${base64.encode(new Uint8Array(a))}?iv=${base64.encode(new Uint8Array(o.buffer))}`}async function decrypt$1(e,t,n){let[r,o]=n.split("?iv="),i=getNormalizedX(secp256k1$2.getSharedSecret(e,"02"+t)),s=await crypto.subtle.importKey("raw",i,{name:"AES-CBC"},!1,["decrypt"]),a=base64.decode(r),c=base64.decode(o),u=await crypto.subtle.decrypt({name:"AES-CBC",iv:c},s,a);return utf8Decoder.decode(u)}function getNormalizedX(e){return e.slice(1,33)}__export(nip04_exports,{decrypt:()=>decrypt$1,encrypt:()=>encrypt$1}),"undefined"!=typeof crypto&&!crypto.subtle&&crypto.webcrypto&&(crypto.subtle=crypto.webcrypto.subtle);var nip05_exports={};__export(nip05_exports,{NIP05_REGEX:()=>NIP05_REGEX$1,queryProfile:()=>queryProfile,searchDomain:()=>searchDomain,useFetchImplementation:()=>useFetchImplementation});var NIP05_REGEX$1=/^(?:([\w.+-]+)@)?([\w.-]+)$/,_fetch;try{_fetch=fetch}catch{}function useFetchImplementation(e){_fetch=e}async function searchDomain(e,t=""){try{return(await(await _fetch(`https://${e}/.well-known/nostr.json?name=${t}`)).json()).names}catch(e){return{}}}async function queryProfile(e){const t=e.match(NIP05_REGEX$1);if(!t)return null;const[n,r="_",o]=t;try{const e=await _fetch(`https://${o}/.well-known/nostr.json?name=${r}`),{names:t,relays:n}=parseNIP05Result$1(await e.json()),i=t[r];return i?{pubkey:i,relays:n?.[i]}:null}catch(e){return null}}function parseNIP05Result$1(e){const t={names:{}};for(const[n,r]of Object.entries(e.names))"string"==typeof n&&"string"==typeof r&&(t.names[n]=r);if(e.relays){t.relays={};for(const[n,r]of Object.entries(e.relays))"string"==typeof n&&Array.isArray(r)&&(t.relays[n]=r.filter((e=>"string"==typeof e)))}return t}var nip06_exports={};function privateKeyFromSeedWords(e,t){let n=HDKey.fromMasterSeed(mnemonicToSeedSync(e,t)).derive("m/44'/1237'/0'/0/0").privateKey;if(!n)throw new Error("could not derive private key");return bytesToHex$5(n)}function generateSeedWords(){return generateMnemonic(wordlist)}function validateWords(e){return validateMnemonic(e,wordlist)}__export(nip06_exports,{generateSeedWords:()=>generateSeedWords,privateKeyFromSeedWords:()=>privateKeyFromSeedWords,validateWords:()=>validateWords});var nip10_exports={};function parse(e){const t={reply:void 0,root:void 0,mentions:[],profiles:[]},n=[];for(const r of e.tags)"e"===r[0]&&r[1]&&n.push(r),"p"===r[0]&&r[1]&&t.profiles.push({pubkey:r[1],relays:r[2]?[r[2]]:[]});for(let e=0;e<n.length;e++){const r=n[e],[o,i,s,a]=r,c={id:i,relays:s?[s]:[]},u=0===e,l=e===n.length-1;"root"!==a?"reply"!==a?"mention"!==a?u?t.root=c:l?t.reply=c:t.mentions.push(c):t.mentions.push(c):t.reply=c:t.root=c}return t}__export(nip10_exports,{parse:()=>parse});var nip13_exports={};function getPow(e){let t=0;for(let n=0;n<e.length;n++){const r=parseInt(e[n],16);if(0!==r){t+=Math.clz32(r)-28;break}t+=4}return t}function minePow(e,t){let n=0;const r=e,o=["nonce",n.toString(),t.toString()];for(r.tags.push(o);;){const e=Math.floor((new Date).getTime()/1e3);if(e!==r.created_at&&(n=0,r.created_at=e),o[1]=(++n).toString(),r.id=getEventHash$1(r),getPow(r.id)>=t)break}return r}__export(nip13_exports,{getPow:()=>getPow,minePow:()=>minePow});var nip18_exports={};function finishRepostEvent(e,t,n,r){return finishEvent({kind:6,tags:[...e.tags??[],["e",t.id,n],["p",t.pubkey]],content:""===e.content?"":JSON.stringify(t),created_at:e.created_at},r)}function getRepostedEventPointer(e){if(6!==e.kind)return;let t,n;for(let r=e.tags.length-1;r>=0&&(void 0===t||void 0===n);r--){const o=e.tags[r];o.length>=2&&("e"===o[0]&&void 0===t?t=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==t?{id:t[1],relays:[t[2],n?.[2]].filter((e=>"string"==typeof e)),author:n?.[1]}:void 0}function getRepostedEvent(e,{skipVerification:t}={}){const n=getRepostedEventPointer(e);if(void 0===n||""===e.content)return;let r;try{r=JSON.parse(e.content)}catch(e){return}return r.id===n.id&&(t||verifySignature$1(r))?r:void 0}__export(nip18_exports,{finishRepostEvent:()=>finishRepostEvent,getRepostedEvent:()=>getRepostedEvent,getRepostedEventPointer:()=>getRepostedEventPointer});var nip21_exports={};__export(nip21_exports,{NOSTR_URI_REGEX:()=>NOSTR_URI_REGEX,parse:()=>parse2,test:()=>test});var NOSTR_URI_REGEX=new RegExp(`nostr:(${BECH32_REGEX.source})`);function test(e){return"string"==typeof e&&new RegExp(`^${NOSTR_URI_REGEX.source}$`).test(e)}function parse2(e){const t=e.match(new RegExp(`^${NOSTR_URI_REGEX.source}$`));if(!t)throw new Error(`Invalid Nostr URI: ${e}`);return{uri:t[0],value:t[1],decoded:decode(t[1])}}var nip25_exports={};function finishReactionEvent(e,t,n){const r=t.tags.filter((e=>e.length>=2&&("e"===e[0]||"p"===e[0])));return finishEvent({...e,kind:7,tags:[...e.tags??[],...r,["e",t.id],["p",t.pubkey]],content:e.content??"+"},n)}function getReactedEventPointer(e){if(7!==e.kind)return;let t,n;for(let r=e.tags.length-1;r>=0&&(void 0===t||void 0===n);r--){const o=e.tags[r];o.length>=2&&("e"===o[0]&&void 0===t?t=o:"p"===o[0]&&void 0===n&&(n=o))}return void 0!==t&&void 0!==n?{id:t[1],relays:[t[2],n[2]].filter((e=>void 0!==e)),author:n[1]}:void 0}__export(nip25_exports,{finishReactionEvent:()=>finishReactionEvent,getReactedEventPointer:()=>getReactedEventPointer});var nip26_exports={};function createDelegation(e,t){let n=[];(t.kind||-1)>=0&&n.push(`kind=${t.kind}`),t.until&&n.push(`created_at<${t.until}`),t.since&&n.push(`created_at>${t.since}`);let r=n.join("&");if(""===r)throw new Error("refusing to create a delegation without any conditions");let o=sha256$4(utf8Encoder.encode(`nostr:delegation:${t.pubkey}:${r}`)),i=bytesToHex$5(schnorr$1.sign(o,e));return{from:getPublicKey(e),to:t.pubkey,cond:r,sig:i}}function getDelegator(e){let t=e.tags.find((e=>"delegation"===e[0]&&e.length>=4));if(!t)return null;let n=t[1],r=t[2],o=t[3],i=r.split("&");for(let t=0;t<i.length;t++){let[n,r,o]=i[t].split(/\b/);if(("kind"!==n||"="!==r||e.kind!==parseInt(o))&&!("created_at"===n&&"<"===r&&e.created_at<parseInt(o)||"created_at"===n&&">"===r&&e.created_at>parseInt(o)))return null}let s=sha256$4(utf8Encoder.encode(`nostr:delegation:${e.pubkey}:${r}`));return schnorr$1.verify(o,s,n)?n:null}__export(nip26_exports,{createDelegation:()=>createDelegation,getDelegator:()=>getDelegator});var nip27_exports={};__export(nip27_exports,{matchAll:()=>matchAll,regex:()=>regex,replaceAll:()=>replaceAll});var regex=()=>new RegExp(`\\b${NOSTR_URI_REGEX.source}\\b`,"g");function*matchAll(e){const t=e.matchAll(regex());for(const e of t)try{const[t,n]=e;yield{uri:t,value:n,decoded:decode(n),start:e.index,end:e.index+t.length}}catch(e){}}function replaceAll(e,t){return e.replaceAll(regex(),((e,n)=>t({uri:e,value:n,decoded:decode(n)})))}var nip28_exports={};__export(nip28_exports,{channelCreateEvent:()=>channelCreateEvent,channelHideMessageEvent:()=>channelHideMessageEvent,channelMessageEvent:()=>channelMessageEvent,channelMetadataEvent:()=>channelMetadataEvent,channelMuteUserEvent:()=>channelMuteUserEvent});var channelCreateEvent=(e,t)=>{let n;if("object"==typeof e.content)n=JSON.stringify(e.content);else{if("string"!=typeof e.content)return;n=e.content}return finishEvent({kind:40,tags:[...e.tags??[]],content:n,created_at:e.created_at},t)},channelMetadataEvent=(e,t)=>{let n;if("object"==typeof e.content)n=JSON.stringify(e.content);else{if("string"!=typeof e.content)return;n=e.content}return finishEvent({kind:41,tags:[["e",e.channel_create_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},channelMessageEvent=(e,t)=>{const n=[["e",e.channel_create_event_id,e.relay_url,"root"]];return e.reply_to_channel_message_event_id&&n.push(["e",e.reply_to_channel_message_event_id,e.relay_url,"reply"]),finishEvent({kind:42,tags:[...n,...e.tags??[]],content:e.content,created_at:e.created_at},t)},channelHideMessageEvent=(e,t)=>{let n;if("object"==typeof e.content)n=JSON.stringify(e.content);else{if("string"!=typeof e.content)return;n=e.content}return finishEvent({kind:43,tags:[["e",e.channel_message_event_id],...e.tags??[]],content:n,created_at:e.created_at},t)},channelMuteUserEvent=(e,t)=>{let n;if("object"==typeof e.content)n=JSON.stringify(e.content);else{if("string"!=typeof e.content)return;n=e.content}return finishEvent({kind:44,tags:[["p",e.pubkey_to_mute],...e.tags??[]],content:n,created_at:e.created_at},t)},nip39_exports={},_fetch2;__export(nip39_exports,{useFetchImplementation:()=>useFetchImplementation2,validateGithub:()=>validateGithub});try{_fetch2=fetch}catch{}function useFetchImplementation2(e){_fetch2=e}async function validateGithub(e,t,n){try{return await(await _fetch2(`https://gist.github.com/${t}/${n}/raw`)).text()===`Verifying that I control the following Nostr public key: ${e}`}catch(e){return!1}}var nip42_exports={};__export(nip42_exports,{authenticate:()=>authenticate});var authenticate=async({challenge:e,relay:t,sign:n})=>{const r={kind:22242,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t.url],["challenge",e]],content:""};return t.auth(await n(r))},nip44_exports={};__export(nip44_exports,{decrypt:()=>decrypt2,encrypt:()=>encrypt2,utils:()=>utils$1});var utils$1={v2:{maxPlaintextSize:65408,minCiphertextSize:100,maxCiphertextSize:102400,getConversationKey:(e,t)=>secp256k1$2.getSharedSecret(e,"02"+t).subarray(1,33),getMessageKeys(e,t){const n=hkdf(sha256$4,e,t,"nip44-v2",76);return{encryption:n.subarray(0,32),nonce:n.subarray(32,44),auth:n.subarray(44,76)}},calcPadding(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("expected positive integer");if(e<=32)return 32;const t=1<<Math.floor(Math.log2(e-1))+1,n=t<=256?32:t/8;return n*(Math.floor((e-1)/n)+1)},pad(e){const t=utf8Encoder.encode(e),n=t.length;if(n<1||n>=utils$1.v2.maxPlaintextSize)throw new Error("invalid plaintext length: must be between 1b and 64KB");const r=utils$1.v2.calcPadding(n),o=new Uint8Array(r-n),i=new Uint8Array(2);return new DataView(i.buffer).setUint16(0,n),concatBytes$6(i,t,o)},unpad(e){const t=new DataView(e.buffer).getUint16(0),n=e.subarray(2,2+t);if(0===t||n.length!==t||e.length!==2+utils$1.v2.calcPadding(t))throw new Error("invalid padding");return utf8Decoder.decode(n)}}};function encrypt2(e,t,n={}){const r=n.version??2;if(2!==r)throw new Error("unknown encryption version "+r);const o=n.salt??randomBytes$3(32);ensureBytes$1(o,32);const i=utils$1.v2.getMessageKeys(e,o),s=utils$1.v2.pad(t),a=chacha20(i.encryption,i.nonce,s),c=hmac$4(sha256$4,i.auth,a);return base64.encode(concatBytes$6(new Uint8Array([r]),o,a,c))}function decrypt2(e,t){const n=utils$1.v2;ensureBytes$1(e,32);const r=t.length;if(r<n.minCiphertextSize||r>=n.maxCiphertextSize)throw new Error("invalid ciphertext length: "+r);if("#"===t[0])throw new Error("unknown encryption version");let o;try{o=base64.decode(t)}catch(e){throw new Error("invalid base64: "+e.message)}const i=o.subarray(0,1)[0];if(2!==i)throw new Error("unknown encryption version "+i);const s=o.subarray(1,33),a=o.subarray(33,-32),c=o.subarray(-32),u=n.getMessageKeys(e,s);if(!equalBytes$1(hmac$4(sha256$4,u.auth,a),c))throw new Error("invalid MAC");const l=chacha20(u.encryption,u.nonce,a);return n.unpad(l)}var nip47_exports={};function parseConnectionString(e){const{pathname:t,searchParams:n}=new URL(e),r=t,o=n.get("relay"),i=n.get("secret");if(!r||!o||!i)throw new Error("invalid connection string");return{pubkey:r,relay:o,secret:i}}async function makeNwcRequestEvent({pubkey:e,secret:t,invoice:n}){const r={method:"pay_invoice",params:{invoice:n}},o=await encrypt$1(t,e,JSON.stringify(r));return finishEvent({kind:23194,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",e]]},t)}__export(nip47_exports,{makeNwcRequestEvent:()=>makeNwcRequestEvent,parseConnectionString:()=>parseConnectionString});var nip57_exports={},_fetch3;__export(nip57_exports,{getZapEndpoint:()=>getZapEndpoint,makeZapReceipt:()=>makeZapReceipt,makeZapRequest:()=>makeZapRequest,useFetchImplementation:()=>useFetchImplementation3,validateZapRequest:()=>validateZapRequest});try{_fetch3=fetch}catch{}function useFetchImplementation3(e){_fetch3=e}async function getZapEndpoint(e){try{let t="",{lud06:n,lud16:r}=JSON.parse(e.content);if(n){let{words:e}=bech32$1.decode(n,1e3),r=bech32$1.fromWords(e);t=utf8Decoder.decode(r)}else{if(!r)return null;{let[e,n]=r.split("@");t=`https://${n}/.well-known/lnurlp/${e}`}}let o=await _fetch3(t),i=await o.json();if(i.allowsNostr&&i.nostrPubkey)return i.callback}catch(e){}return null}function makeZapRequest({profile:e,event:t,amount:n,relays:r,comment:o=""}){if(!n)throw new Error("amount not given");if(!e)throw new Error("profile not given");let i={kind:9734,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",e],["amount",n.toString()],["relays",...r]]};return t&&i.tags.push(["e",t]),i}function validateZapRequest(e){let t;try{t=JSON.parse(e)}catch(e){return"Invalid zap request JSON."}if(!validateEvent(t))return"Zap request is not a valid Nostr event.";if(!verifySignature$1(t))return"Invalid signature on zap request.";let n=t.tags.find((([e,t])=>"p"===e&&t));if(!n)return"Zap request doesn't have a 'p' tag.";if(!n[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let r=t.tags.find((([e,t])=>"e"===e&&t));return r&&!r[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":t.tags.find((([e,t])=>"relays"===e&&t))?null:"Zap request doesn't have a 'relays' tag."}function makeZapReceipt({zapRequest:e,preimage:t,bolt11:n,paidAt:r}){let o=JSON.parse(e).tags.filter((([e])=>"e"===e||"p"===e||"a"===e)),i={kind:9735,created_at:Math.round(r.getTime()/1e3),content:"",tags:[...o,["bolt11",n],["description",e]]};return t&&i.tags.push(["preimage",t]),i}var nip98_exports={};__export(nip98_exports,{getToken:()=>getToken,unpackEventFromToken:()=>unpackEventFromToken,validateEvent:()=>validateEvent2,validateToken:()=>validateToken});var _authorizationScheme="Nostr ";async function getToken(e,t,n,r=!1){if(!e||!t)throw new Error("Missing loginUrl or httpMethod");const o=getBlankEvent(27235);o.tags=[["u",e],["method",t]],o.created_at=Math.round((new Date).getTime()/1e3);const i=await n(o);return(r?_authorizationScheme:"")+base64.encode(utf8Encoder.encode(JSON.stringify(i)))}async function validateToken(e,t,n){const r=await unpackEventFromToken(e).catch((e=>{throw e}));return await validateEvent2(r,t,n).catch((e=>{throw e}))}async function unpackEventFromToken(e){if(!e)throw new Error("Missing token");e=e.replace(_authorizationScheme,"");const t=utf8Decoder.decode(base64.decode(e));if(!t||0===t.length||!t.startsWith("{"))throw new Error("Invalid token");return JSON.parse(t)}async function validateEvent2(e,t,n){if(!e)throw new Error("Invalid nostr event");if(!verifySignature$1(e))throw new Error("Invalid nostr event, signature invalid");if(27235!==e.kind)throw new Error("Invalid nostr event, kind invalid");if(!e.created_at)throw new Error("Invalid nostr event, created_at invalid");if(Math.round((new Date).getTime()/1e3)-e.created_at>60)throw new Error("Invalid nostr event, expired");const r=e.tags.find((e=>"u"===e[0]));if(1!==r?.length&&r?.[1]!==t)throw new Error("Invalid nostr event, url tag invalid");const o=e.tags.find((e=>"method"===e[0]));if(1!==o?.length&&o?.[1].toLowerCase()!==n.toLowerCase())throw new Error("Invalid nostr event, method tag invalid");return!0}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lib$1={},types={};Object.defineProperty(types,"__esModule",{value:!0});var ee={},taskCollection$1={},taskCollection={},bakeCollection={};(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.bakeCollectionVariadic=exports.bakeCollectionAwait=exports.bakeCollection=exports.BAKED_EMPTY_FUNC=void 0,exports.BAKED_EMPTY_FUNC=function(){};var FORLOOP_FALLBACK=1500;function generateArgsDefCode(e){var t="";if(0===e)return t;for(var n=0;n<e-1;++n)t+="arg"+String(n)+", ";return t+="arg"+String(e-1)}function generateBodyPartsCode(e,t){for(var n="",r="",o=0;o<t;++o)n+="var f".concat(o," = collection[").concat(o,"];\n"),r+="f".concat(o,"(").concat(e,")\n");return{funcDefCode:n,funcCallCode:r}}function generateBodyPartsVariadicCode(e){for(var t="",n="",r=0;r<e;++r)t+="var f".concat(r," = collection[").concat(r,"];\n"),n+="f".concat(r,".apply(undefined, arguments)\n");return{funcDefCode:t,funcCallCode:n}}function bakeCollection(collection,fixedArgsNum){if(0===collection.length)return exports.BAKED_EMPTY_FUNC;if(1===collection.length)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode="(function(collection) {\n            ".concat(funcDefCode,"\n            collection = undefined;\n            return (function(").concat(argsDefCode,") {\n                ").concat(funcCallCode,"\n            });\n        })")}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode=collection.length%10==0?"(function(collection) {\n                return (function(".concat(argsDefCode,") {\n                    for (var i = 0; i < collection.length; i += 10) {\n                        collection[i](").concat(argsDefCode,");\n                        collection[i+1](").concat(argsDefCode,");\n                        collection[i+2](").concat(argsDefCode,");\n                        collection[i+3](").concat(argsDefCode,");\n                        collection[i+4](").concat(argsDefCode,");\n                        collection[i+5](").concat(argsDefCode,");\n                        collection[i+6](").concat(argsDefCode,");\n                        collection[i+7](").concat(argsDefCode,");\n                        collection[i+8](").concat(argsDefCode,");\n                        collection[i+9](").concat(argsDefCode,");\n                    }\n                });\n            })"):collection.length%4==0?"(function(collection) {\n                return (function(".concat(argsDefCode,") {\n                    for (var i = 0; i < collection.length; i += 4) {\n                        collection[i](").concat(argsDefCode,");\n                        collection[i+1](").concat(argsDefCode,");\n                        collection[i+2](").concat(argsDefCode,");\n                        collection[i+3](").concat(argsDefCode,");\n                    }\n                });\n            })"):collection.length%3==0?"(function(collection) {\n                return (function(".concat(argsDefCode,") {\n                    for (var i = 0; i < collection.length; i += 3) {\n                        collection[i](").concat(argsDefCode,");\n                        collection[i+1](").concat(argsDefCode,");\n                        collection[i+2](").concat(argsDefCode,");\n                    }\n                });\n            })"):"(function(collection) {\n                return (function(".concat(argsDefCode,") {\n                    for (var i = 0; i < collection.length; ++i) {\n                        collection[i](").concat(argsDefCode,");\n                    }\n                });\n            })")}var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}function bakeCollectionAwait(collection,fixedArgsNum){if(0===collection.length)return exports.BAKED_EMPTY_FUNC;if(1===collection.length)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var argsDefCode=generateArgsDefCode(fixedArgsNum),_a=generateBodyPartsCode(argsDefCode,collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode="(function(collection) {\n            ".concat(funcDefCode,"\n            collection = undefined;\n            return (function(").concat(argsDefCode,") {\n                return Promise.all([ ").concat(funcCallCode," ]);\n            });\n        })")}else{var argsDefCode=generateArgsDefCode(fixedArgsNum);funcFactoryCode="(function(collection) {\n            return (function(".concat(argsDefCode,") {\n                var promises = Array(collection.length);\n                for (var i = 0; i < collection.length; ++i) {\n                    promises[i] = collection[i](").concat(argsDefCode,");\n                }\n                return Promise.all(promises);\n            });\n        })")}var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}function bakeCollectionVariadic(collection){if(0===collection.length)return exports.BAKED_EMPTY_FUNC;if(1===collection.length)return collection[0];var funcFactoryCode;if(collection.length<FORLOOP_FALLBACK){var _a=generateBodyPartsVariadicCode(collection.length),funcDefCode=_a.funcDefCode,funcCallCode=_a.funcCallCode;funcFactoryCode="(function(collection) {\n            ".concat(funcDefCode,"\n            collection = undefined;\n            return (function() {\n                ").concat(funcCallCode,"\n            });\n        })")}else funcFactoryCode="(function(collection) {\n            return (function() {\n                for (var i = 0; i < collection.length; ++i) {\n                    collection[i].apply(undefined, arguments);\n                }\n            });\n        })";var funcFactory=eval(funcFactoryCode);return funcFactory(collection)}exports.bakeCollection=bakeCollection,exports.bakeCollectionAwait=bakeCollectionAwait,exports.bakeCollectionVariadic=bakeCollectionVariadic})(bakeCollection);var __spreadArray$1=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(taskCollection,"__esModule",{value:!0}),taskCollection.TaskCollection=taskCollection._fast_remove_single=void 0;var bake_collection_1=bakeCollection;function push_norebuild(e,t){var n,r=this.length;if(r>1)t?((n=this._tasks).push.apply(n,arguments),this.length+=arguments.length):(this._tasks.push(e),this.length++);else if(t){var o;if(1===r)(o=Array(1+arguments.length)).push(o),o.push.apply(o,arguments),this._tasks=o;else(o=Array(arguments.length)).push.apply(o,arguments),this._tasks=o;this.length+=arguments.length}else this._tasks=1===r?[this._tasks,e]:e,this.length++}function push_rebuild(e,t){var n,r=this.length;if(r>1)t?((n=this._tasks).push.apply(n,arguments),this.length+=arguments.length):(this._tasks.push(e),this.length++);else if(t){var o;if(1===r)(o=Array(1+arguments.length)).push(o),o.push.apply(o,arguments),this._tasks=o;else(o=Array(arguments.length)).push.apply(o,arguments),this._tasks=o;this.length+=arguments.length}else this._tasks=1===r?[this._tasks,e]:e,this.length++;this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild()}function _fast_remove_single(e,t){-1!==t&&(0===t?e.shift():t===e.length-1?e.length=e.length-1:e.splice(t,1))}function removeLast_norebuild(e){0!==this.length&&(1===this.length?this._tasks===e&&(this.length=0):(_fast_remove_single(this._tasks,this._tasks.lastIndexOf(e)),1===this._tasks.length?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length))}function removeLast_rebuild(e){if(0!==this.length){if(1===this.length)return this._tasks===e&&(this.length=0),this.firstEmitBuildStrategy?void(this.call=bake_collection_1.BAKED_EMPTY_FUNC):void this.rebuild();_fast_remove_single(this._tasks,this._tasks.lastIndexOf(e)),1===this._tasks.length?(this._tasks=this._tasks[0],this.length=1):this.length=this._tasks.length,this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild()}}function insert_norebuild(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===this.length?(this._tasks=n,this.length=1):1===this.length?(n.unshift(this._tasks),this._tasks=n,this.length=this._tasks.length):((t=this._tasks).splice.apply(t,__spreadArray$1([e,0],n,!1)),this.length=this._tasks.length)}function insert_rebuild(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===this.length?(this._tasks=n,this.length=1):1===this.length?(n.unshift(this._tasks),this._tasks=n,this.length=this._tasks.length):((t=this._tasks).splice.apply(t,__spreadArray$1([e,0],n,!1)),this.length=this._tasks.length),this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild()}function rebuild_noawait(){0===this.length?this.call=bake_collection_1.BAKED_EMPTY_FUNC:1===this.length?this.call=this._tasks:this.call=(0,bake_collection_1.bakeCollection)(this._tasks,this.argsNum)}function rebuild_await(){0===this.length?this.call=bake_collection_1.BAKED_EMPTY_FUNC:1===this.length?this.call=this._tasks:this.call=(0,bake_collection_1.bakeCollectionAwait)(this._tasks,this.argsNum)}function rebuild_on_first_call(){this.rebuild(),this.call.apply(void 0,arguments)}taskCollection._fast_remove_single=_fast_remove_single;var TaskCollection=function(e,t,n,r){void 0===t&&(t=!0),void 0===n&&(n=null),void 0===r&&(r=!1),this.awaitTasks=r,this.call=bake_collection_1.BAKED_EMPTY_FUNC,this.argsNum=e,this.firstEmitBuildStrategy=!0,this.rebuild=r?rebuild_await.bind(this):rebuild_noawait.bind(this),this.setAutoRebuild(t),n?"function"==typeof n?(this._tasks=n,this.length=1):(this._tasks=n,this.length=n.length):(this._tasks=null,this.length=0),t&&this.rebuild()},exports,__createBinding,__exportStar;function fastClear(){this._tasks=null,this.length=0,this.call=bake_collection_1.BAKED_EMPTY_FUNC}function clear(){this._tasks=null,this.length=0,this.call=bake_collection_1.BAKED_EMPTY_FUNC}function growArgsNum(e){this.argsNum<e&&(this.argsNum=e,this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild())}function setAutoRebuild(e){e?(this.push=push_rebuild.bind(this),this.insert=insert_rebuild.bind(this),this.removeLast=removeLast_rebuild.bind(this)):(this.push=push_norebuild.bind(this),this.insert=insert_norebuild.bind(this),this.removeLast=removeLast_norebuild.bind(this))}function tasksAsArray(){return 0===this.length?[]:1===this.length?[this._tasks]:this._tasks}function setTasks(e){0===e.length?(this.length=0,this.call=bake_collection_1.BAKED_EMPTY_FUNC):1===e.length?(this.length=1,this.call=e[0],this._tasks=e[0]):(this.length=e.length,this._tasks=e,this.firstEmitBuildStrategy?this.call=rebuild_on_first_call:this.rebuild())}taskCollection.TaskCollection=TaskCollection,TaskCollection.prototype.fastClear=fastClear,TaskCollection.prototype.clear=clear,TaskCollection.prototype.growArgsNum=growArgsNum,TaskCollection.prototype.setAutoRebuild=setAutoRebuild,TaskCollection.prototype.tasksAsArray=tasksAsArray,TaskCollection.prototype.setTasks=setTasks,exports=taskCollection$1,__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),__exportStar=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||__createBinding(t,e,n)},Object.defineProperty(exports,"__esModule",{value:!0}),__exportStar(taskCollection,exports);var utils={};function nullObj(){var e={__proto__:null,prototype:null};return e}Object.defineProperty(utils,"__esModule",{value:!0}),utils.nullObj=void 0,utils.nullObj=nullObj;var __spreadArray=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(ee,"__esModule",{value:!0}),ee.EventEmitter=void 0;var task_collection_1=taskCollection$1,utils_1=utils;function emit(e,t,n,r,o,i){var s=this.events[e];return!!s&&(0!==s.length&&(s.argsNum<6?s.call(t,n,r,o,i):s.call.apply(void 0,arguments),!0))}function emitHasOnce(e,t,n,r,o,i){var s=this.events[e];if(s){if(0===s.length)return!1;s.argsNum<6?s.call(t,n,r,o,i):s.call.apply(void 0,arguments)}var a=this.onceEvents[e];if(a){if("function"==typeof a)this.onceEvents[e]=void 0,arguments.length<6?a(t,n,r,o,i):a.apply(void 0,arguments);else{var c=a;if(this.onceEvents[e]=void 0,arguments.length<6)for(var u=0;u<c.length;++u)c[u](t,n,r,o,i);else for(u=0;u<c.length;++u)c[u].apply(void 0,arguments)}return!0}return!!s}var EventEmitter=function(){function e(){this.events=(0,utils_1.nullObj)(),this.onceEvents=(0,utils_1.nullObj)(),this._symbolKeys=new Set,this.maxListeners=1/0}return Object.defineProperty(e.prototype,"_eventsCount",{get:function(){return this.eventNames().length},enumerable:!1,configurable:!0}),e}();function once(e,t){switch(this.emit===emit&&(this.emit=emitHasOnce),typeof this.onceEvents[e]){case"undefined":this.onceEvents[e]=t,"symbol"==typeof e&&this._symbolKeys.add(e);break;case"function":this.onceEvents[e]=[this.onceEvents[e],t];break;case"object":this.onceEvents[e].push(t)}return this}function addListener(e,t,n){if(void 0===n&&(n=t.length),"function"!=typeof t)throw new TypeError("The listener must be a function");var r=this.events[e];return r?(r.push(t),r.growArgsNum(n),this.maxListeners!==1/0&&this.maxListeners<=r.length&&console.warn('Maximum event listeners for "'.concat(String(e),'" event!'))):(this.events[e]=new task_collection_1.TaskCollection(n,!0,t,!1),"symbol"==typeof e&&this._symbolKeys.add(e)),this}function removeListener(e,t){var n=this.events[e];n&&n.removeLast(t);var r=this.onceEvents[e];return r&&("function"==typeof r?this.onceEvents[e]=void 0:"object"==typeof r&&(1===r.length&&r[0]===t?this.onceEvents[e]=void 0:(0,task_collection_1._fast_remove_single)(r,r.lastIndexOf(t)))),this}function addListenerBound(e,t,n,r){void 0===n&&(n=this),void 0===r&&(r=t.length),this.boundFuncs||(this.boundFuncs=new Map);var o=t.bind(n);return this.boundFuncs.set(t,o),this.addListener(e,o,r)}function removeListenerBound(e,t){var n,r,o=null===(n=this.boundFuncs)||void 0===n?void 0:n.get(t);return null===(r=this.boundFuncs)||void 0===r||r.delete(t),this.removeListener(e,o)}function hasListeners(e){return this.events[e]&&!!this.events[e].length}function prependListener(e,t,n){if(void 0===n&&(n=t.length),"function"!=typeof t)throw new TypeError("The listener must be a function");var r=this.events[e];return r&&r instanceof task_collection_1.TaskCollection?(r.insert(0,t),r.growArgsNum(n),this.maxListeners!==1/0&&this.maxListeners<=r.length&&console.warn('Maximum event listeners for "'.concat(String(e),'" event!'))):(r=this.events[e]=new task_collection_1.TaskCollection(n,!0,t,!1),"symbol"==typeof e&&this._symbolKeys.add(e)),this}function prependOnceListener(e,t){this.emit===emit&&(this.emit=emitHasOnce);var n=this.onceEvents[e];return n?"object"!=typeof n?(this.onceEvents[e]=[t,n],"symbol"==typeof e&&this._symbolKeys.add(e)):(n.unshift(t),this.maxListeners!==1/0&&this.maxListeners<=n.length&&console.warn('Maximum event listeners for "'.concat(String(e),'" once event!'))):(this.onceEvents[e]=[t],"symbol"==typeof e&&this._symbolKeys.add(e)),this}function removeAllListeners(e){return void 0===e?(this.events=(0,utils_1.nullObj)(),this.onceEvents=(0,utils_1.nullObj)(),this._symbolKeys=new Set):(this.events[e]=void 0,this.onceEvents[e]=void 0,"symbol"==typeof e&&this._symbolKeys.delete(e)),this}function setMaxListeners(e){return this.maxListeners=e,this}function getMaxListeners(){return this.maxListeners}function listeners(e){return this.emit===emit?this.events[e]?this.events[e].tasksAsArray().slice():[]:this.events[e]&&this.onceEvents[e]?__spreadArray(__spreadArray([],this.events[e].tasksAsArray(),!0),"function"==typeof this.onceEvents[e]?[this.onceEvents[e]]:this.onceEvents[e],!0):this.events[e]?this.events[e].tasksAsArray():this.onceEvents[e]?"function"==typeof this.onceEvents[e]?[this.onceEvents[e]]:this.onceEvents[e]:[]}function eventNames(){var e=this;if(this.emit===emit){var t=Object.keys(this.events);return __spreadArray(__spreadArray([],t,!0),Array.from(this._symbolKeys),!0).filter((function(t){return t in e.events&&e.events[t]&&e.events[t].length}))}t=Object.keys(this.events).filter((function(t){return e.events[t]&&e.events[t].length}));var n=Object.keys(this.onceEvents).filter((function(t){return e.onceEvents[t]&&e.onceEvents[t].length}));return __spreadArray(__spreadArray(__spreadArray([],t,!0),n,!0),Array.from(this._symbolKeys).filter((function(t){return t in e.events&&e.events[t]&&e.events[t].length||t in e.onceEvents&&e.onceEvents[t]&&e.onceEvents[t].length})),!0)}function listenerCount(e){return this.emit===emit?this.events[e]&&this.events[e].length||0:(this.events[e]&&this.events[e].length||0)+(this.onceEvents[e]&&this.onceEvents[e].length||0)}ee.EventEmitter=EventEmitter,EventEmitter.prototype.emit=emit,EventEmitter.prototype.on=addListener,EventEmitter.prototype.once=once,EventEmitter.prototype.addListener=addListener,EventEmitter.prototype.removeListener=removeListener,EventEmitter.prototype.addListenerBound=addListenerBound,EventEmitter.prototype.removeListenerBound=removeListenerBound,EventEmitter.prototype.hasListeners=hasListeners,EventEmitter.prototype.prependListener=prependListener,EventEmitter.prototype.prependOnceListener=prependOnceListener,EventEmitter.prototype.off=removeListener,EventEmitter.prototype.removeAllListeners=removeAllListeners,EventEmitter.prototype.setMaxListeners=setMaxListeners,EventEmitter.prototype.getMaxListeners=getMaxListeners,EventEmitter.prototype.listeners=listeners,EventEmitter.prototype.eventNames=eventNames,EventEmitter.prototype.listenerCount=listenerCount,function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(types,e),n(ee,e)}(lib$1);var browser={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var e=1e3,t=60*e,n=60*t,r=24*n,o=7*r,i=365.25*r;function s(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}return ms=function(a,c){c=c||{};var u=typeof a;if("string"===u&&a.length>0)return function(s){if((s=String(s)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*i;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*r;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*t;case"seconds":case"second":case"secs":case"sec":case"s":return c*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(a);if("number"===u&&isFinite(a))return c.long?function(o){var i=Math.abs(o);if(i>=r)return s(o,i,r,"day");if(i>=n)return s(o,i,n,"hour");if(i>=t)return s(o,i,t,"minute");if(i>=e)return s(o,i,e,"second");return o+" ms"}(a):function(o){var i=Math.abs(o);if(i>=r)return Math.round(o/r)+"d";if(i>=n)return Math.round(o/n)+"h";if(i>=t)return Math.round(o/t)+"m";if(i>=e)return Math.round(o/e)+"s";return o+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}}function setup(e){function t(e){let r,o,i,s=null;function a(...e){if(!a.enabled)return;const n=a,o=Number(new Date),i=o-(r||o);n.diff=i,n.prev=r,n.curr=o,r=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,o)=>{if("%%"===r)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];r=i.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=requireMs(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}var common=setup;!function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=common(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(browser,browser.exports);var browserExports=browser.exports,debug6=getDefaultExportFromCjs(browserExports);function number(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`positive integer expected, not ${e}`)}function isBytes$1(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function bytes(e,...t){if(!isBytes$1(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error(`Uint8Array expected of length ${t}, not of length=${e.length}`)}function hash(e){if("function"!=typeof e||"function"!=typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");number(e.outputLen),number(e.blockLen)}function exists(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function output(e,t){bytes(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const crypto$1="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,createView=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),rotr=(e,t)=>e<<32-t|e>>>t;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */new Uint8Array(new Uint32Array([287454020]).buffer)[0];const hexes$1=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function bytesToHex$1(e){bytes(e);let t="";for(let n=0;n<e.length;n++)t+=hexes$1[e[n]];return t}function utf8ToBytes$1(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function toBytes(e){return"string"==typeof e&&(e=utf8ToBytes$1(e)),bytes(e),e}function concatBytes$1(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];bytes(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const o=e[t];n.set(o,r),r+=o.length}return n}class Hash{clone(){return this._cloneInto()}}function wrapConstructor(e){const t=t=>e().update(toBytes(t)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function randomBytes(e=32){if(crypto$1&&"function"==typeof crypto$1.getRandomValues)return crypto$1.getRandomValues(new Uint8Array(e));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64(e,t,n,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,n,r);const o=BigInt(32),i=BigInt(4294967295),s=Number(n>>o&i),a=Number(n&i),c=r?4:0,u=r?0:4;e.setUint32(t+c,s,r),e.setUint32(t+u,a,r)}const Chi=(e,t,n)=>e&t^~e&n,Maj=(e,t,n)=>e&t^e&n^t&n;class HashMD extends Hash{constructor(e,t,n,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=createView(this.buffer)}update(e){exists(this);const{view:t,buffer:n,blockLen:r}=this,o=(e=toBytes(e)).length;for(let i=0;i<o;){const s=Math.min(r-this.pos,o-i);if(s!==r)n.set(e.subarray(i,i+s),this.pos),this.pos+=s,i+=s,this.pos===r&&(this.process(t,0),this.pos=0);else{const t=createView(e);for(;r<=o-i;i+=r)this.process(t,i)}}return this.length+=e.length,this.roundClean(),this}digestInto(e){exists(this),output(e,this),this.finished=!0;const{buffer:t,view:n,blockLen:r,isLE:o}=this;let{pos:i}=this;t[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>r-i&&(this.process(n,0),i=0);for(let e=i;e<r;e++)t[e]=0;setBigUint64(n,r-8,BigInt(8*this.length),o),this.process(n,0);const s=createView(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)s.setUint32(4*e,u[e],o)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:n,length:r,finished:o,destroyed:i,pos:s}=this;return e.length=r,e.pos=s,e.finished=o,e.destroyed=i,r%t&&e.buffer.set(n),e}}const SHA256_K=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor(){super(64,32,8,!1),this.A=0|SHA256_IV[0],this.B=0|SHA256_IV[1],this.C=0|SHA256_IV[2],this.D=0|SHA256_IV[3],this.E=0|SHA256_IV[4],this.F=0|SHA256_IV[5],this.G=0|SHA256_IV[6],this.H=0|SHA256_IV[7]}get(){const{A:e,B:t,C:n,D:r,E:o,F:i,G:s,H:a}=this;return[e,t,n,r,o,i,s,a]}set(e,t,n,r,o,i,s,a){this.A=0|e,this.B=0|t,this.C=0|n,this.D=0|r,this.E=0|o,this.F=0|i,this.G=0|s,this.H=0|a}process(e,t){for(let n=0;n<16;n++,t+=4)SHA256_W[n]=e.getUint32(t,!1);for(let e=16;e<64;e++){const t=SHA256_W[e-15],n=SHA256_W[e-2],r=rotr(t,7)^rotr(t,18)^t>>>3,o=rotr(n,17)^rotr(n,19)^n>>>10;SHA256_W[e]=o+SHA256_W[e-7]+r+SHA256_W[e-16]|0}let{A:n,B:r,C:o,D:i,E:s,F:a,G:c,H:u}=this;for(let e=0;e<64;e++){const t=u+(rotr(s,6)^rotr(s,11)^rotr(s,25))+Chi(s,a,c)+SHA256_K[e]+SHA256_W[e]|0,l=(rotr(n,2)^rotr(n,13)^rotr(n,22))+Maj(n,r,o)|0;u=c,c=a,a=s,s=i+t|0,i=o,o=r,r=n,n=t+l|0}n=n+this.A|0,r=r+this.B|0,o=o+this.C|0,i=i+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(n,r,o,i,s,a,c,u)}roundClean(){SHA256_W.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const sha256=wrapConstructor((()=>new SHA256)),_0n$4=BigInt(0),_1n$4=BigInt(1),_2n$2=BigInt(2);
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes(e){return e instanceof Uint8Array||null!=e&&"object"==typeof e&&"Uint8Array"===e.constructor.name}function abytes(e){if(!isBytes(e))throw new Error("Uint8Array expected")}const hexes=Array.from({length:256},((e,t)=>t.toString(16).padStart(2,"0")));function bytesToHex(e){abytes(e);let t="";for(let n=0;n<e.length;n++)t+=hexes[e[n]];return t}function numberToHexUnpadded(e){const t=e.toString(16);return 1&t.length?`0${t}`:t}function hexToNumber(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);return BigInt(""===e?"0":`0x${e}`)}const asciis={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16(e){return e>=asciis._0&&e<=asciis._9?e-asciis._0:e>=asciis._A&&e<=asciis._F?e-(asciis._A-10):e>=asciis._a&&e<=asciis._f?e-(asciis._a-10):void 0}function hexToBytes(e){if("string"!=typeof e)throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("padded hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let t=0,o=0;t<n;t++,o+=2){const n=asciiToBase16(e.charCodeAt(o)),i=asciiToBase16(e.charCodeAt(o+1));if(void 0===n||void 0===i){const t=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+t+'" at index '+o)}r[t]=16*n+i}return r}function bytesToNumberBE(e){return hexToNumber(bytesToHex(e))}function bytesToNumberLE(e){return abytes(e),hexToNumber(bytesToHex(Uint8Array.from(e).reverse()))}function numberToBytesBE(e,t){return hexToBytes(e.toString(16).padStart(2*t,"0"))}function numberToBytesLE(e,t){return numberToBytesBE(e,t).reverse()}function numberToVarBytesBE(e){return hexToBytes(numberToHexUnpadded(e))}function ensureBytes(e,t,n){let r;if("string"==typeof t)try{r=hexToBytes(t)}catch(n){throw new Error(`${e} must be valid hex string, got "${t}". Cause: ${n}`)}else{if(!isBytes(t))throw new Error(`${e} must be hex string or Uint8Array`);r=Uint8Array.from(t)}const o=r.length;if("number"==typeof n&&o!==n)throw new Error(`${e} expected ${n} bytes, got ${o}`);return r}function concatBytes(...e){let t=0;for(let n=0;n<e.length;n++){const r=e[n];abytes(r),t+=r.length}const n=new Uint8Array(t);for(let t=0,r=0;t<e.length;t++){const o=e[t];n.set(o,r),r+=o.length}return n}function equalBytes(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return 0===n}function utf8ToBytes(e){if("string"!=typeof e)throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function bitLen(e){let t;for(t=0;e>_0n$4;e>>=_1n$4,t+=1);return t}function bitGet(e,t){return e>>BigInt(t)&_1n$4}function bitSet(e,t,n){return e|(n?_1n$4:_0n$4)<<BigInt(t)}const bitMask=e=>(_2n$2<<BigInt(e-1))-_1n$4,u8n=e=>new Uint8Array(e),u8fr=e=>Uint8Array.from(e);function createHmacDrbg(e,t,n){if("number"!=typeof e||e<2)throw new Error("hashLen must be a number");if("number"!=typeof t||t<2)throw new Error("qByteLen must be a number");if("function"!=typeof n)throw new Error("hmacFn must be a function");let r=u8n(e),o=u8n(e),i=0;const s=()=>{r.fill(1),o.fill(0),i=0},a=(...e)=>n(o,r,...e),c=(e=u8n())=>{o=a(u8fr([0]),e),r=a(),0!==e.length&&(o=a(u8fr([1]),e),r=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let e=0;const n=[];for(;e<t;){r=a();const t=r.slice();n.push(t),e+=r.length}return concatBytes(...n)};return(e,t)=>{let n;for(s(),c(e);!(n=t(u()));)c();return s(),n}}const validatorFns={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||isBytes(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function validateObject(e,t,n={}){const r=(t,n,r)=>{const o=validatorFns[n];if("function"!=typeof o)throw new Error(`Invalid validator "${n}", expected function`);const i=e[t];if(!(r&&void 0===i||o(i,e)))throw new Error(`Invalid param ${String(t)}=${i} (${typeof i}), expected ${n}`)};for(const[e,n]of Object.entries(t))r(e,n,!1);for(const[e,t]of Object.entries(n))r(e,t,!0);return e}var ut=Object.freeze({__proto__:null,abytes:abytes,bitGet:bitGet,bitLen:bitLen,bitMask:bitMask,bitSet:bitSet,bytesToHex:bytesToHex,bytesToNumberBE:bytesToNumberBE,bytesToNumberLE:bytesToNumberLE,concatBytes:concatBytes,createHmacDrbg:createHmacDrbg,ensureBytes:ensureBytes,equalBytes:equalBytes,hexToBytes:hexToBytes,hexToNumber:hexToNumber,isBytes:isBytes,numberToBytesBE:numberToBytesBE,numberToBytesLE:numberToBytesLE,numberToHexUnpadded:numberToHexUnpadded,numberToVarBytesBE:numberToVarBytesBE,utf8ToBytes:utf8ToBytes,validateObject:validateObject});
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$3=BigInt(0),_1n$3=BigInt(1),_2n$1=BigInt(2),_3n$1=BigInt(3),_4n=BigInt(4),_5n=BigInt(5),_8n=BigInt(8);function mod(e,t){const n=e%t;return n>=_0n$3?n:t+n}function pow(e,t,n){if(n<=_0n$3||t<_0n$3)throw new Error("Expected power/modulo > 0");if(n===_1n$3)return _0n$3;let r=_1n$3;for(;t>_0n$3;)t&_1n$3&&(r=r*e%n),e=e*e%n,t>>=_1n$3;return r}function pow2(e,t,n){let r=e;for(;t-- >_0n$3;)r*=r,r%=n;return r}function invert(e,t){if(e===_0n$3||t<=_0n$3)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=mod(e,t),r=t,o=_0n$3,i=_1n$3;for(;n!==_0n$3;){const e=r%n,t=o-i*(r/n);r=n,n=e,o=i,i=t}if(r!==_1n$3)throw new Error("invert: does not exist");return mod(o,t)}function tonelliShanks(e){const t=(e-_1n$3)/_2n$1;let n,r,o;for(n=e-_1n$3,r=0;n%_2n$1===_0n$3;n/=_2n$1,r++);for(o=_2n$1;o<e&&pow(o,t,e)!==e-_1n$3;o++);if(1===r){const t=(e+_1n$3)/_4n;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}const i=(n+_1n$3)/_2n$1;return function(e,s){if(e.pow(s,t)===e.neg(e.ONE))throw new Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,o),n),u=e.pow(s,i),l=e.pow(s,n);for(;!e.eql(l,e.ONE);){if(e.eql(l,e.ZERO))return e.ZERO;let t=1;for(let n=e.sqr(l);t<a&&!e.eql(n,e.ONE);t++)n=e.sqr(n);const n=e.pow(c,_1n$3<<BigInt(a-t-1));c=e.sqr(n),u=e.mul(u,n),l=e.mul(l,c),a=t}return u}}function FpSqrt(e){if(e%_4n===_3n$1){const t=(e+_1n$3)/_4n;return function(e,n){const r=e.pow(n,t);if(!e.eql(e.sqr(r),n))throw new Error("Cannot find square root");return r}}if(e%_8n===_5n){const t=(e-_5n)/_8n;return function(e,n){const r=e.mul(n,_2n$1),o=e.pow(r,t),i=e.mul(n,o),s=e.mul(e.mul(i,_2n$1),o),a=e.mul(i,e.sub(s,e.ONE));if(!e.eql(e.sqr(a),n))throw new Error("Cannot find square root");return a}}return tonelliShanks(e)}BigInt(9),BigInt(16);const FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(e){return validateObject(e,FIELD_FIELDS.reduce(((e,t)=>(e[t]="function",e)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function FpPow(e,t,n){if(n<_0n$3)throw new Error("Expected power > 0");if(n===_0n$3)return e.ONE;if(n===_1n$3)return t;let r=e.ONE,o=t;for(;n>_0n$3;)n&_1n$3&&(r=e.mul(r,o)),o=e.sqr(o),n>>=_1n$3;return r}function FpInvertBatch(e,t){const n=new Array(t.length),r=t.reduce(((t,r,o)=>e.is0(r)?t:(n[o]=t,e.mul(t,r))),e.ONE),o=e.inv(r);return t.reduceRight(((t,r,o)=>e.is0(r)?t:(n[o]=e.mul(t,n[o]),e.mul(t,r))),o),n}function nLength(e,t){const n=void 0!==t?t:e.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function Field(e,t,n=!1,r={}){if(e<=_0n$3)throw new Error(`Expected Field ORDER > 0, got ${e}`);const{nBitLength:o,nByteLength:i}=nLength(e,t);if(i>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=FpSqrt(e),a=Object.freeze({ORDER:e,BITS:o,BYTES:i,MASK:bitMask(o),ZERO:_0n$3,ONE:_1n$3,create:t=>mod(t,e),isValid:t=>{if("bigint"!=typeof t)throw new Error("Invalid field element: expected bigint, got "+typeof t);return _0n$3<=t&&t<e},is0:e=>e===_0n$3,isOdd:e=>(e&_1n$3)===_1n$3,neg:t=>mod(-t,e),eql:(e,t)=>e===t,sqr:t=>mod(t*t,e),add:(t,n)=>mod(t+n,e),sub:(t,n)=>mod(t-n,e),mul:(t,n)=>mod(t*n,e),pow:(e,t)=>FpPow(a,e,t),div:(t,n)=>mod(t*invert(n,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>invert(t,e),sqrt:r.sqrt||(e=>s(a,e)),invertBatch:e=>FpInvertBatch(a,e),cmov:(e,t,n)=>n?t:e,toBytes:e=>n?numberToBytesLE(e,i):numberToBytesBE(e,i),fromBytes:e=>{if(e.length!==i)throw new Error(`Fp.fromBytes: expected ${i}, got ${e.length}`);return n?bytesToNumberLE(e):bytesToNumberBE(e)}});return Object.freeze(a)}function getFieldBytesLength(e){if("bigint"!=typeof e)throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function getMinHashLength(e){const t=getFieldBytesLength(e);return t+Math.ceil(t/2)}function mapHashToField(e,t,n=!1){const r=e.length,o=getFieldBytesLength(t),i=getMinHashLength(t);if(r<16||r<i||r>1024)throw new Error(`expected ${i}-1024 bytes of input, got ${r}`);const s=mod(n?bytesToNumberBE(e):bytesToNumberLE(e),t-_1n$3)+_1n$3;return n?numberToBytesLE(s,o):numberToBytesBE(s,o)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$2=BigInt(0),_1n$2=BigInt(1);function wNAF(e,t){const n=(e,t)=>{const n=t.negate();return e?n:t},r=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:n,unsafeLadder(t,n){let r=e.ZERO,o=t;for(;n>_0n$2;)n&_1n$2&&(r=r.add(o)),o=o.double(),n>>=_1n$2;return r},precomputeWindow(e,t){const{windows:n,windowSize:o}=r(t),i=[];let s=e,a=s;for(let e=0;e<n;e++){a=s,i.push(a);for(let e=1;e<o;e++)a=a.add(s),i.push(a);s=a.double()}return i},wNAF(t,o,i){const{windows:s,windowSize:a}=r(t);let c=e.ZERO,u=e.BASE;const l=BigInt(2**t-1),h=2**t,d=BigInt(t);for(let e=0;e<s;e++){const t=e*a;let r=Number(i&l);i>>=d,r>a&&(r-=h,i+=_1n$2);const s=t,f=t+Math.abs(r)-1,p=e%2!=0,y=r<0;0===r?u=u.add(n(p,o[s])):c=c.add(n(y,o[f]))}return{p:c,f:u}},wNAFCached(e,t,n,r){const o=e._WINDOW_SIZE||1;let i=t.get(e);return i||(i=this.precomputeWindow(e,o),1!==o&&t.set(e,r(i))),this.wNAF(o,i,n)}}}function validateBasic(e){return validateField(e.Fp),validateObject(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validatePointOpts(e){const t=validateBasic(e);validateObject(t,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:n,Fp:r,a:o}=t;if(n){if(!r.eql(o,r.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof n||"bigint"!=typeof n.beta||"function"!=typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...t})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut,DER={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(e){const{Err:t}=DER;if(e.length<2||2!==e[0])throw new t("Invalid signature integer tag");const n=e[1],r=e.subarray(2,n+2);if(!n||r.length!==n)throw new t("Invalid signature integer: wrong length");if(128&r[0])throw new t("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new t("Invalid signature integer: unnecessary leading zero");return{d:b2n(r),l:e.subarray(n+2)}},toSig(e){const{Err:t}=DER,n="string"==typeof e?h2b(e):e;abytes(n);let r=n.length;if(r<2||48!=n[0])throw new t("Invalid signature tag");if(n[1]!==r-2)throw new t("Invalid signature: incorrect length");const{d:o,l:i}=DER._parseInt(n.subarray(2)),{d:s,l:a}=DER._parseInt(i);if(a.length)throw new t("Invalid signature: left bytes after parsing");return{r:o,s:s}},hexFromSig(e){const t=e=>8&Number.parseInt(e[0],16)?"00"+e:e,n=e=>{const t=e.toString(16);return 1&t.length?`0${t}`:t},r=t(n(e.s)),o=t(n(e.r)),i=r.length/2,s=o.length/2,a=n(i),c=n(s);return`30${n(s+i+4)}02${c}${o}02${a}${r}`}},_0n$1=BigInt(0),_1n$1=BigInt(1);BigInt(2);const _3n=BigInt(3);function weierstrassPoints(e){const t=validatePointOpts(e),{Fp:n}=t,r=t.toBytes||((e,t,r)=>{const o=t.toAffine();return concatBytes(Uint8Array.from([4]),n.toBytes(o.x),n.toBytes(o.y))}),o=t.fromBytes||(e=>{const t=e.subarray(1);return{x:n.fromBytes(t.subarray(0,n.BYTES)),y:n.fromBytes(t.subarray(n.BYTES,2*n.BYTES))}});function i(e){const{a:r,b:o}=t,i=n.sqr(e),s=n.mul(i,e);return n.add(n.add(s,n.mul(e,r)),o)}if(!n.eql(n.sqr(t.Gy),i(t.Gx)))throw new Error("bad generator point: equation left != right");function s(e){return"bigint"==typeof e&&_0n$1<e&&e<t.n}function a(e){if(!s(e))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(e){const{allowedPrivateKeyLengths:n,nByteLength:r,wrapPrivateKey:o,n:i}=t;if(n&&"bigint"!=typeof e){if(isBytes(e)&&(e=bytesToHex(e)),"string"!=typeof e||!n.includes(e.length))throw new Error("Invalid key");e=e.padStart(2*r,"0")}let s;try{s="bigint"==typeof e?e:bytesToNumberBE(ensureBytes("private key",e,r))}catch(t){throw new Error(`private key must be ${r} bytes, hex or bigint, not ${typeof e}`)}return o&&(s=mod(s,i)),a(s),s}const u=new Map;function l(e){if(!(e instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(e,t,r){if(this.px=e,this.py=t,this.pz=r,null==e||!n.isValid(e))throw new Error("x required");if(null==t||!n.isValid(t))throw new Error("y required");if(null==r||!n.isValid(r))throw new Error("z required")}static fromAffine(e){const{x:t,y:r}=e||{};if(!e||!n.isValid(t)||!n.isValid(r))throw new Error("invalid affine point");if(e instanceof h)throw new Error("projective point not allowed");const o=e=>n.eql(e,n.ZERO);return o(t)&&o(r)?h.ZERO:new h(t,r,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}static fromHex(e){const t=h.fromAffine(o(ensureBytes("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return h.BASE.multiply(c(e))}_setWindowSize(e){this._WINDOW_SIZE=e,u.delete(this)}assertValidity(){if(this.is0()){if(t.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:e,y:r}=this.toAffine();if(!n.isValid(e)||!n.isValid(r))throw new Error("bad point: x or y not FE");const o=n.sqr(r),s=i(e);if(!n.eql(o,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:e}=this.toAffine();if(n.isOdd)return!n.isOdd(e);throw new Error("Field doesn't support isOdd")}equals(e){l(e);const{px:t,py:r,pz:o}=this,{px:i,py:s,pz:a}=e,c=n.eql(n.mul(t,a),n.mul(i,o)),u=n.eql(n.mul(r,a),n.mul(s,o));return c&&u}negate(){return new h(this.px,n.neg(this.py),this.pz)}double(){const{a:e,b:r}=t,o=n.mul(r,_3n),{px:i,py:s,pz:a}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,d=n.mul(i,i),f=n.mul(s,s),p=n.mul(a,a),y=n.mul(i,s);return y=n.add(y,y),l=n.mul(i,a),l=n.add(l,l),c=n.mul(e,l),u=n.mul(o,p),u=n.add(c,u),c=n.sub(f,u),u=n.add(f,u),u=n.mul(c,u),c=n.mul(y,c),l=n.mul(o,l),p=n.mul(e,p),y=n.sub(d,p),y=n.mul(e,y),y=n.add(y,l),l=n.add(d,d),d=n.add(l,d),d=n.add(d,p),d=n.mul(d,y),u=n.add(u,d),p=n.mul(s,a),p=n.add(p,p),d=n.mul(p,y),c=n.sub(c,d),l=n.mul(p,f),l=n.add(l,l),l=n.add(l,l),new h(c,u,l)}add(e){l(e);const{px:r,py:o,pz:i}=this,{px:s,py:a,pz:c}=e;let u=n.ZERO,d=n.ZERO,f=n.ZERO;const p=t.a,y=n.mul(t.b,_3n);let g=n.mul(r,s),b=n.mul(o,a),m=n.mul(i,c),w=n.add(r,o),$=n.add(s,a);w=n.mul(w,$),$=n.add(g,b),w=n.sub(w,$),$=n.add(r,i);let _=n.add(s,c);return $=n.mul($,_),_=n.add(g,m),$=n.sub($,_),_=n.add(o,i),u=n.add(a,c),_=n.mul(_,u),u=n.add(b,m),_=n.sub(_,u),f=n.mul(p,$),u=n.mul(y,m),f=n.add(u,f),u=n.sub(b,f),f=n.add(b,f),d=n.mul(u,f),b=n.add(g,g),b=n.add(b,g),m=n.mul(p,m),$=n.mul(y,$),b=n.add(b,m),m=n.sub(g,m),m=n.mul(p,m),$=n.add($,m),g=n.mul(b,$),d=n.add(d,g),g=n.mul(_,$),u=n.mul(w,u),u=n.sub(u,g),g=n.mul(w,b),f=n.mul(_,f),f=n.add(f,g),new h(u,d,f)}subtract(e){return this.add(e.negate())}is0(){return this.equals(h.ZERO)}wNAF(e){return f.wNAFCached(this,u,e,(e=>{const t=n.invertBatch(e.map((e=>e.pz)));return e.map(((e,n)=>e.toAffine(t[n]))).map(h.fromAffine)}))}multiplyUnsafe(e){const r=h.ZERO;if(e===_0n$1)return r;if(a(e),e===_1n$1)return this;const{endo:o}=t;if(!o)return f.unsafeLadder(this,e);let{k1neg:i,k1:s,k2neg:c,k2:u}=o.splitScalar(e),l=r,d=r,p=this;for(;s>_0n$1||u>_0n$1;)s&_1n$1&&(l=l.add(p)),u&_1n$1&&(d=d.add(p)),p=p.double(),s>>=_1n$1,u>>=_1n$1;return i&&(l=l.negate()),c&&(d=d.negate()),d=new h(n.mul(d.px,o.beta),d.py,d.pz),l.add(d)}multiply(e){a(e);let r,o,i=e;const{endo:s}=t;if(s){const{k1neg:e,k1:t,k2neg:a,k2:c}=s.splitScalar(i);let{p:u,f:l}=this.wNAF(t),{p:d,f:p}=this.wNAF(c);u=f.constTimeNegate(e,u),d=f.constTimeNegate(a,d),d=new h(n.mul(d.px,s.beta),d.py,d.pz),r=u.add(d),o=l.add(p)}else{const{p:e,f:t}=this.wNAF(i);r=e,o=t}return h.normalizeZ([r,o])[0]}multiplyAndAddUnsafe(e,t,n){const r=h.BASE,o=(e,t)=>t!==_0n$1&&t!==_1n$1&&e.equals(r)?e.multiply(t):e.multiplyUnsafe(t),i=o(this,t).add(o(e,n));return i.is0()?void 0:i}toAffine(e){const{px:t,py:r,pz:o}=this,i=this.is0();null==e&&(e=i?n.ONE:n.inv(o));const s=n.mul(t,e),a=n.mul(r,e),c=n.mul(o,e);if(i)return{x:n.ZERO,y:n.ZERO};if(!n.eql(c,n.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:e,isTorsionFree:n}=t;if(e===_1n$1)return!0;if(n)return n(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:e,clearCofactor:n}=t;return e===_1n$1?this:n?n(h,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return this.assertValidity(),r(h,this,e)}toHex(e=!0){return bytesToHex(this.toRawBytes(e))}}h.BASE=new h(t.Gx,t.Gy,n.ONE),h.ZERO=new h(n.ZERO,n.ONE,n.ZERO);const d=t.nBitLength,f=wNAF(h,t.endo?Math.ceil(d/2):d);return{CURVE:t,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:i,isWithinCurveOrder:s}}function validateOpts(e){const t=validateBasic(e);return validateObject(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}function weierstrass(e){const t=validateOpts(e),{Fp:n,n:r}=t,o=n.BYTES+1,i=2*n.BYTES+1;function s(e){return mod(e,r)}function a(e){return invert(e,r)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:h}=weierstrassPoints({...t,toBytes(e,t,r){const o=t.toAffine(),i=n.toBytes(o.x),s=concatBytes;return r?s(Uint8Array.from([t.hasEvenY()?2:3]),i):s(Uint8Array.from([4]),i,n.toBytes(o.y))},fromBytes(e){const t=e.length,r=e[0],s=e.subarray(1);if(t!==o||2!==r&&3!==r){if(t===i&&4===r){return{x:n.fromBytes(s.subarray(0,n.BYTES)),y:n.fromBytes(s.subarray(n.BYTES,2*n.BYTES))}}throw new Error(`Point of length ${t} was invalid. Expected ${o} compressed bytes or ${i} uncompressed bytes`)}{const e=bytesToNumberBE(s);if(!(_0n$1<(a=e)&&a<n.ORDER))throw new Error("Point is not on curve");const t=l(e);let o;try{o=n.sqrt(t)}catch(e){const t=e instanceof Error?": "+e.message:"";throw new Error("Point is not on curve"+t)}return!(1&~r)!==((o&_1n$1)===_1n$1)&&(o=n.neg(o)),{x:e,y:o}}var a}}),d=e=>bytesToHex(numberToBytesBE(e,t.nByteLength));function f(e){return e>r>>_1n$1}const p=(e,t,n)=>bytesToNumberBE(e.slice(t,n));class y{constructor(e,t,n){this.r=e,this.s=t,this.recovery=n,this.assertValidity()}static fromCompact(e){const n=t.nByteLength;return e=ensureBytes("compactSignature",e,2*n),new y(p(e,0,n),p(e,n,2*n))}static fromDER(e){const{r:t,s:n}=DER.toSig(ensureBytes("DER",e));return new y(t,n)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(e){const{r:r,s:o,recovery:i}=this,u=w(ensureBytes("msgHash",e));if(null==i||![0,1,2,3].includes(i))throw new Error("recovery id invalid");const l=2===i||3===i?r+t.n:r;if(l>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");const h=1&i?"03":"02",f=c.fromHex(h+d(l)),p=a(l),y=s(-u*p),g=s(o*p),b=c.BASE.multiplyAndAddUnsafe(f,y,g);if(!b)throw new Error("point at infinify");return b.assertValidity(),b}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes(this.toDERHex())}toDERHex(){return DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const g={isValidPrivateKey(e){try{return u(e),!0}catch(e){return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const e=getMinHashLength(t.n);return mapHashToField(t.randomBytes(e),t.n)},precompute:(e=8,t=c.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)};function b(e){const t=isBytes(e),n="string"==typeof e,r=(t||n)&&e.length;return t?r===o||r===i:n?r===2*o||r===2*i:e instanceof c}const m=t.bits2int||function(e){const n=bytesToNumberBE(e),r=8*e.length-t.nBitLength;return r>0?n>>BigInt(r):n},w=t.bits2int_modN||function(e){return s(m(e))},$=bitMask(t.nBitLength);function _(e){if("bigint"!=typeof e)throw new Error("bigint expected");if(!(_0n$1<=e&&e<$))throw new Error(`bigint expected < 2^${t.nBitLength}`);return numberToBytesBE(e,t.nByteLength)}function E(e,r,o=v){if(["recovered","canonical"].some((e=>e in o)))throw new Error("sign() legacy options not supported");const{hash:i,randomBytes:l}=t;let{lowS:d,prehash:p,extraEntropy:g}=o;null==d&&(d=!0),e=ensureBytes("msgHash",e),p&&(e=ensureBytes("prehashed msgHash",i(e)));const b=w(e),$=u(r),E=[_($),_(b)];if(null!=g&&!1!==g){const e=!0===g?l(n.BYTES):g;E.push(ensureBytes("extraEntropy",e))}const x=concatBytes(...E),k=b;return{seed:x,k2sig:function(e){const t=m(e);if(!h(t))return;const n=a(t),r=c.BASE.multiply(t).toAffine(),o=s(r.x);if(o===_0n$1)return;const i=s(n*s(k+o*$));if(i===_0n$1)return;let u=(r.x===o?0:2)|Number(r.y&_1n$1),l=i;return d&&f(i)&&(l=function(e){return f(e)?s(-e):e}(i),u^=1),new y(o,l,u)}}}const v={lowS:t.lowS,prehash:!1},x={lowS:t.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return c.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,n=!0){if(b(e))throw new Error("first arg must be private key");if(!b(t))throw new Error("second arg must be public key");return c.fromHex(t).multiply(u(e)).toRawBytes(n)},sign:function(e,n,r=v){const{seed:o,k2sig:i}=E(e,n,r),s=t;return createHmacDrbg(s.hash.outputLen,s.nByteLength,s.hmac)(o,i)},verify:function(e,n,r,o=x){const i=e;if(n=ensureBytes("msgHash",n),r=ensureBytes("publicKey",r),"strict"in o)throw new Error("options.strict was renamed to lowS");const{lowS:u,prehash:l}=o;let h,d;try{if("string"==typeof i||isBytes(i))try{h=y.fromDER(i)}catch(e){if(!(e instanceof DER.Err))throw e;h=y.fromCompact(i)}else{if("object"!=typeof i||"bigint"!=typeof i.r||"bigint"!=typeof i.s)throw new Error("PARSE");{const{r:e,s:t}=i;h=new y(e,t)}}d=c.fromHex(r)}catch(e){if("PARSE"===e.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(u&&h.hasHighS())return!1;l&&(n=t.hash(n));const{r:f,s:p}=h,g=w(n),b=a(p),m=s(g*b),$=s(f*b),_=c.BASE.multiplyAndAddUnsafe(d,m,$)?.toAffine();return!!_&&s(_.x)===f},ProjectivePoint:c,Signature:y,utils:g}}BigInt(4);class HMAC extends Hash{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,hash(e);const n=toBytes(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?e.create().update(n).digest():n);for(let e=0;e<o.length;e++)o[e]^=54;this.iHash.update(o),this.oHash=e.create();for(let e=0;e<o.length;e++)o[e]^=106;this.oHash.update(o),o.fill(0)}update(e){return exists(this),this.iHash.update(e),this}digestInto(e){exists(this),bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:n,finished:r,destroyed:o,blockLen:i,outputLen:s}=this;return e.finished=r,e.destroyed=o,e.blockLen=i,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac=(e,t,n)=>new HMAC(e,t).update(n).digest();
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
function getHash(e){return{hash:e,hmac:(t,...n)=>hmac(e,t,concatBytes$1(...n)),randomBytes:randomBytes}}function createCurve(e,t){const n=t=>weierstrass({...e,...getHash(t)});return Object.freeze({...n(t),create:n})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */hmac.create=(e,t)=>new HMAC(e,t);const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n=BigInt(1),_2n=BigInt(2),divNearest=(e,t)=>(e+t/_2n)/t;function sqrtMod(e){const t=secp256k1P,n=BigInt(3),r=BigInt(6),o=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),u=e*e*e%t,l=u*u*e%t,h=pow2(l,n,t)*l%t,d=pow2(h,n,t)*l%t,f=pow2(d,_2n,t)*u%t,p=pow2(f,o,t)*f%t,y=pow2(p,i,t)*p%t,g=pow2(y,a,t)*y%t,b=pow2(g,c,t)*g%t,m=pow2(b,a,t)*y%t,w=pow2(m,n,t)*l%t,$=pow2(w,s,t)*p%t,_=pow2($,r,t)*u%t,E=pow2(_,_2n,t);if(!Fp.eql(Fp.sqr(E),e))throw new Error("Cannot find square root");return E}const Fp=Field(secp256k1P,void 0,void 0,{sqrt:sqrtMod}),secp256k1=createCurve({a:BigInt(0),b:BigInt(7),Fp:Fp,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{const t=secp256k1N,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-_1n*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,s=BigInt("0x100000000000000000000000000000000"),a=divNearest(i*e,t),c=divNearest(-r*e,t);let u=mod(e-a*n-c*o,t),l=mod(-a*r-c*i,t);const h=u>s,d=l>s;if(h&&(u=t-u),d&&(l=t-l),u>s||l>s)throw new Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:h,k1:u,k2neg:d,k2:l}}}},sha256),_0n=BigInt(0),fe=e=>"bigint"==typeof e&&_0n<e&&e<secp256k1P,ge=e=>"bigint"==typeof e&&_0n<e&&e<secp256k1N,TAGGED_HASH_PREFIXES={};function taggedHash(e,...t){let n=TAGGED_HASH_PREFIXES[e];if(void 0===n){const t=sha256(Uint8Array.from(e,(e=>e.charCodeAt(0))));n=concatBytes(t,t),TAGGED_HASH_PREFIXES[e]=n}return sha256(concatBytes(n,...t))}const pointToBytes=e=>e.toRawBytes(!0).slice(1),numTo32b=e=>numberToBytesBE(e,32),modP=e=>mod(e,secp256k1P),modN=e=>mod(e,secp256k1N),Point=secp256k1.ProjectivePoint,GmulAdd=(e,t,n)=>Point.BASE.multiplyAndAddUnsafe(e,t,n);function schnorrGetExtPubKey(e){let t=secp256k1.utils.normPrivateKeyToScalar(e),n=Point.fromPrivateKey(t);return{scalar:n.hasEvenY()?t:modN(-t),bytes:pointToBytes(n)}}function lift_x(e){if(!fe(e))throw new Error("bad x: need 0 < x < p");const t=modP(e*e);let n=sqrtMod(modP(t*e+BigInt(7)));n%_2n!==_0n&&(n=modP(-n));const r=new Point(e,n,_1n);return r.assertValidity(),r}function challenge(...e){return modN(bytesToNumberBE(taggedHash("BIP0340/challenge",...e)))}function schnorrGetPublicKey(e){return schnorrGetExtPubKey(e).bytes}function schnorrSign(e,t,n=randomBytes(32)){const r=ensureBytes("message",e),{bytes:o,scalar:i}=schnorrGetExtPubKey(t),s=ensureBytes("auxRand",n,32),a=numTo32b(i^bytesToNumberBE(taggedHash("BIP0340/aux",s))),c=taggedHash("BIP0340/nonce",a,o,r),u=modN(bytesToNumberBE(c));if(u===_0n)throw new Error("sign failed: k is zero");const{bytes:l,scalar:h}=schnorrGetExtPubKey(u),d=challenge(l,o,r),f=new Uint8Array(64);if(f.set(l,0),f.set(numTo32b(modN(h+d*i)),32),!schnorrVerify(f,r,o))throw new Error("sign: Invalid signature produced");return f}function schnorrVerify(e,t,n){const r=ensureBytes("signature",e,64),o=ensureBytes("message",t),i=ensureBytes("publicKey",n,32);try{const e=lift_x(bytesToNumberBE(i)),t=bytesToNumberBE(r.subarray(0,32));if(!fe(t))return!1;const n=bytesToNumberBE(r.subarray(32,64));if(!ge(n))return!1;const s=challenge(numTo32b(t),pointToBytes(e),o),a=GmulAdd(e,n,modN(-s));return!(!a||!a.hasEvenY()||a.toAffine().x!==t)}catch(e){return!1}}const schnorr=(()=>({getPublicKey:schnorrGetPublicKey,sign:schnorrSign,verify:schnorrVerify,utils:{randomPrivateKey:secp256k1.utils.randomPrivateKey,lift_x:lift_x,pointToBytes:pointToBytes,numberToBytesBE:numberToBytesBE,bytesToNumberBE:bytesToNumberBE,taggedHash:taggedHash,mod:mod}}))();var dist={},LRUCache$1={},LRUCacheNode$1={};Object.defineProperty(LRUCacheNode$1,"__esModule",{value:!0}),LRUCacheNode$1.LRUCacheNode=void 0;class LRUCacheNode{constructor(e,t,n){const{entryExpirationTimeInMS:r=null,next:o=null,prev:i=null,onEntryEvicted:s,onEntryMarkedAsMostRecentlyUsed:a,clone:c,cloneFn:u}=null!=n?n:{};if("number"==typeof r&&(r<=0||Number.isNaN(r)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.clone=null!=c&&c,this.cloneFn=null!=u?u:this.defaultClone,this.key=e,this.internalValue=this.clone?this.cloneFn(t):t,this.created=Date.now(),this.entryExpirationTimeInMS=r,this.next=o,this.prev=i,this.onEntryEvicted=s,this.onEntryMarkedAsMostRecentlyUsed=a}get value(){return this.clone?this.cloneFn(this.internalValue):this.internalValue}get isExpired(){return"number"==typeof this.entryExpirationTimeInMS&&Date.now()-this.created>this.entryExpirationTimeInMS}invokeOnEvicted(){if(this.onEntryEvicted){const{key:e,value:t,isExpired:n}=this;this.onEntryEvicted({key:e,value:t,isExpired:n})}}invokeOnEntryMarkedAsMostRecentlyUsed(){if(this.onEntryMarkedAsMostRecentlyUsed){const{key:e,value:t}=this;this.onEntryMarkedAsMostRecentlyUsed({key:e,value:t})}}defaultClone(e){return"boolean"==typeof e||"string"==typeof e||"number"==typeof e?e:JSON.parse(JSON.stringify(e))}}LRUCacheNode$1.LRUCacheNode=LRUCacheNode,Object.defineProperty(LRUCache$1,"__esModule",{value:!0}),LRUCache$1.LRUCache=void 0;const LRUCacheNode_1=LRUCacheNode$1;class LRUCache{constructor(e){this.lookupTable=new Map,this.head=null,this.tail=null;const{maxSize:t=25,entryExpirationTimeInMS:n=null,onEntryEvicted:r,onEntryMarkedAsMostRecentlyUsed:o,cloneFn:i,clone:s}=null!=e?e:{};if(Number.isNaN(t)||t<=0)throw new Error("maxSize must be greater than 0.");if("number"==typeof n&&(n<=0||Number.isNaN(n)))throw new Error("entryExpirationTimeInMS must either be null (no expiry) or greater than 0");this.maxSizeInternal=t,this.entryExpirationTimeInMS=n,this.onEntryEvicted=r,this.onEntryMarkedAsMostRecentlyUsed=o,this.clone=s,this.cloneFn=i}get size(){return this.cleanCache(),this.lookupTable.size}get remainingSize(){return this.maxSizeInternal-this.size}get newest(){return this.head?this.head.isExpired?(this.removeNodeFromListAndLookupTable(this.head),this.newest):this.mapNodeToEntry(this.head):null}get oldest(){return this.tail?this.tail.isExpired?(this.removeNodeFromListAndLookupTable(this.tail),this.oldest):this.mapNodeToEntry(this.tail):null}get maxSize(){return this.maxSizeInternal}set maxSize(e){if(Number.isNaN(e)||e<=0)throw new Error("maxSize must be greater than 0.");this.maxSizeInternal=e,this.enforceSizeLimit()}set(e,t,n){const r=this.lookupTable.get(e);r&&this.removeNodeFromListAndLookupTable(r);const o=new LRUCacheNode_1.LRUCacheNode(e,t,{entryExpirationTimeInMS:this.entryExpirationTimeInMS,onEntryEvicted:this.onEntryEvicted,onEntryMarkedAsMostRecentlyUsed:this.onEntryMarkedAsMostRecentlyUsed,clone:this.clone,cloneFn:this.cloneFn,...n});return this.setNodeAsHead(o),this.lookupTable.set(e,o),this.enforceSizeLimit(),this}get(e){const t=this.lookupTable.get(e);return t?t.isExpired?(this.removeNodeFromListAndLookupTable(t),null):(this.setNodeAsHead(t),t.value):null}peek(e){const t=this.lookupTable.get(e);return t?t.isExpired?(this.removeNodeFromListAndLookupTable(t),null):t.value:null}delete(e){const t=this.lookupTable.get(e);return!!t&&this.removeNodeFromListAndLookupTable(t)}has(e){const t=this.lookupTable.get(e);return!!t&&(!t.isExpired||(this.removeNodeFromListAndLookupTable(t),!1))}clear(){this.head=null,this.tail=null,this.lookupTable.clear()}find(e){let t=this.head;for(;t;){if(t.isExpired){const e=t.next;this.removeNodeFromListAndLookupTable(t),t=e;continue}const n=this.mapNodeToEntry(t);if(e(n))return this.setNodeAsHead(t),n;t=t.next}return null}forEach(e){let t=this.head,n=0;for(;t;)if(t.isExpired){const e=t.next;this.removeNodeFromListAndLookupTable(t),t=e}else e(t.value,t.key,n),t=t.next,n++}*values(){let e=this.head;for(;e;)if(e.isExpired){const t=e.next;this.removeNodeFromListAndLookupTable(e),e=t}else yield e.value,e=e.next}*keys(){let e=this.head;for(;e;)if(e.isExpired){const t=e.next;this.removeNodeFromListAndLookupTable(e),e=t}else yield e.key,e=e.next}*entries(){let e=this.head;for(;e;)if(e.isExpired){const t=e.next;this.removeNodeFromListAndLookupTable(e),e=t}else yield this.mapNodeToEntry(e),e=e.next}*[Symbol.iterator](){let e=this.head;for(;e;)if(e.isExpired){const t=e.next;this.removeNodeFromListAndLookupTable(e),e=t}else yield this.mapNodeToEntry(e),e=e.next}enforceSizeLimit(){let e=this.tail;for(;null!==e&&this.size>this.maxSizeInternal;){const t=e.prev;this.removeNodeFromListAndLookupTable(e),e=t}}mapNodeToEntry({key:e,value:t}){return{key:e,value:t}}setNodeAsHead(e){this.removeNodeFromList(e),this.head?(e.next=this.head,this.head.prev=e,this.head=e):(this.head=e,this.tail=e),e.invokeOnEntryMarkedAsMostRecentlyUsed()}removeNodeFromList(e){null!==e.prev&&(e.prev.next=e.next),null!==e.next&&(e.next.prev=e.prev),this.head===e&&(this.head=e.next),this.tail===e&&(this.tail=e.prev),e.next=null,e.prev=null}removeNodeFromListAndLookupTable(e){return e.invokeOnEvicted(),this.removeNodeFromList(e),this.lookupTable.delete(e.key)}cleanCache(){if(!this.entryExpirationTimeInMS)return;const e=[];for(const t of this.lookupTable.values())t.isExpired&&e.push(t);e.forEach((e=>this.removeNodeFromListAndLookupTable(e)))}}LRUCache$1.LRUCache=LRUCache,function(e){var t=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,n){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(n,r)||t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),n(LRUCache$1,e)}(dist);var lib={};!function(e){function t(e){if(!Number.isSafeInteger(e))throw new Error(`Wrong integer: ${e}`)}function n(...e){const t=(e,t)=>n=>e(t(n));return{encode:Array.from(e).reverse().reduce(((e,n)=>e?t(e,n.encode):n.encode),void 0),decode:e.reduce(((e,n)=>e?t(e,n.decode):n.decode),void 0)}}function r(e){return{encode:n=>{if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("alphabet.encode input should be an array of numbers");return n.map((n=>{if(t(n),n<0||n>=e.length)throw new Error(`Digit index outside alphabet: ${n} (alphabet: ${e.length})`);return e[n]}))},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("alphabet.decode input should be array of strings");return t.map((t=>{if("string"!=typeof t)throw new Error(`alphabet.decode: not string element=${t}`);const n=e.indexOf(t);if(-1===n)throw new Error(`Unknown letter: "${t}". Allowed: ${e}`);return n}))}}}function o(e=""){if("string"!=typeof e)throw new Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw new Error("join.decode input should be string");return t.split(e)}}}function i(e,n="="){if(t(e),"string"!=typeof n)throw new Error("padding chr should be string");return{encode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`padding.encode: non-string input=${e}`);for(;t.length*e%8;)t.push(n);return t},decode(t){if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw new Error("padding.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw new Error(`padding.decode: non-string input=${e}`);let r=t.length;if(r*e%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;r>0&&t[r-1]===n;r--)if(!((r-1)*e%8))throw new Error("Invalid padding: string has too much padding");return t.slice(0,r)}}}function s(e){if("function"!=typeof e)throw new Error("normalize fn should be function");return{encode:e=>e,decode:t=>e(t)}}function a(e,n,r){if(n<2)throw new Error(`convertRadix: wrong from=${n}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(e))throw new Error("convertRadix: data should be array");if(!e.length)return[];let o=0;const i=[],s=Array.from(e);for(s.forEach((e=>{if(t(e),e<0||e>=n)throw new Error(`Wrong integer: ${e}`)}));;){let e=0,t=!0;for(let i=o;i<s.length;i++){const a=s[i],c=n*e+a;if(!Number.isSafeInteger(c)||n*e/n!==e||c-a!=n*e)throw new Error("convertRadix: carry overflow");if(e=c%r,s[i]=Math.floor(c/r),!Number.isSafeInteger(s[i])||s[i]*r+e!==c)throw new Error("convertRadix: carry overflow");t&&(s[i]?t=!1:o=i)}if(i.push(e),t)break}for(let t=0;t<e.length-1&&0===e[t];t++)i.push(0);return i.reverse()}
/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */
Object.defineProperty(e,"__esModule",{value:!0}),e.bytes=e.stringToBytes=e.str=e.bytesToString=e.hex=e.utf8=e.bech32m=e.bech32=e.base58check=e.base58xmr=e.base58xrp=e.base58flickr=e.base58=e.base64url=e.base64=e.base32crockford=e.base32hex=e.base32=e.base16=e.utils=e.assertNumber=void 0,e.assertNumber=t;const c=(e,t)=>t?c(t,e%t):e,u=(e,t)=>e+(t-c(e,t));function l(e,n,r,o){if(!Array.isArray(e))throw new Error("convertRadix2: data should be array");if(n<=0||n>32)throw new Error(`convertRadix2: wrong from=${n}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(u(n,r)>32)throw new Error(`convertRadix2: carry overflow from=${n} to=${r} carryBits=${u(n,r)}`);let i=0,s=0;const a=2**r-1,c=[];for(const o of e){if(t(o),o>=2**n)throw new Error(`convertRadix2: invalid data word=${o} from=${n}`);if(i=i<<n|o,s+n>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${n}`);for(s+=n;s>=r;s-=r)c.push((i>>s-r&a)>>>0);i&=2**s-1}if(i=i<<r-s&a,!o&&s>=n)throw new Error("Excess padding");if(!o&&i)throw new Error(`Non-zero padding: ${i}`);return o&&s>0&&c.push(i>>>0),c}function h(e){return t(e),{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return a(Array.from(t),256,e)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix.decode input should be array of strings");return Uint8Array.from(a(t,e,256))}}}function d(e,n=!1){if(t(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(u(8,e)>32||u(e,8)>32)throw new Error("radix2: carry overflow");return{encode:t=>{if(!(t instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return l(Array.from(t),8,e,!n)},decode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(l(t,e,8,n))}}}function f(e){if("function"!=typeof e)throw new Error("unsafeWrapper fn should be function");return function(...t){try{return e.apply(null,t)}catch(e){}}}function p(e,n){if(t(e),"function"!=typeof n)throw new Error("checksum fn should be function");return{encode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.encode: input should be Uint8Array");const r=n(t).slice(0,e),o=new Uint8Array(t.length+e);return o.set(t),o.set(r,t.length),o},decode(t){if(!(t instanceof Uint8Array))throw new Error("checksum.decode: input should be Uint8Array");const r=t.slice(0,-e),o=n(r).slice(0,e),i=t.slice(-e);for(let t=0;t<e;t++)if(o[t]!==i[t])throw new Error("Invalid checksum");return r}}}e.utils={alphabet:r,chain:n,checksum:p,radix:h,radix2:d,join:o,padding:i},e.base16=n(d(4),r("0123456789ABCDEF"),o("")),e.base32=n(d(5),r("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),i(5),o("")),e.base32hex=n(d(5),r("0123456789ABCDEFGHIJKLMNOPQRSTUV"),i(5),o("")),e.base32crockford=n(d(5),r("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),o(""),s((e=>e.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")))),e.base64=n(d(6),r("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),i(6),o("")),e.base64url=n(d(6),r("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),i(6),o(""));const y=e=>n(h(58),r(e),o(""));e.base58=y("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),e.base58flickr=y("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"),e.base58xrp=y("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const g=[0,2,3,5,6,7,9,10,11];e.base58xmr={encode(t){let n="";for(let r=0;r<t.length;r+=8){const o=t.subarray(r,r+8);n+=e.base58.encode(o).padStart(g[o.length],"1")}return n},decode(t){let n=[];for(let r=0;r<t.length;r+=11){const o=t.slice(r,r+11),i=g.indexOf(o.length),s=e.base58.decode(o);for(let e=0;e<s.length-i;e++)if(0!==s[e])throw new Error("base58xmr: wrong padding");n=n.concat(Array.from(s.slice(s.length-i)))}return Uint8Array.from(n)}};e.base58check=t=>n(p(4,(e=>t(t(e)))),e.base58);const b=n(r("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),o("")),m=[996825010,642813549,513874426,1027748829,705979059];function w(e){const t=e>>25;let n=(33554431&e)<<5;for(let e=0;e<m.length;e++)1==(t>>e&1)&&(n^=m[e]);return n}function $(e,t,n=1){const r=e.length;let o=1;for(let t=0;t<r;t++){const n=e.charCodeAt(t);if(n<33||n>126)throw new Error(`Invalid prefix (${e})`);o=w(o)^n>>5}o=w(o);for(let t=0;t<r;t++)o=w(o)^31&e.charCodeAt(t);for(let e of t)o=w(o)^e;for(let e=0;e<6;e++)o=w(o);return o^=n,b.encode(l([o%2**30],30,5,!1))}function _(e){const t="bech32"===e?1:734539939,n=d(5),r=n.decode,o=n.encode,i=f(r);function s(e,n=90){if("string"!=typeof e)throw new Error("bech32.decode input should be string, not "+typeof e);if(e.length<8||!1!==n&&e.length>n)throw new TypeError(`Wrong string length: ${e.length} (${e}). Expected (8..${n})`);const r=e.toLowerCase();if(e!==r&&e!==e.toUpperCase())throw new Error("String must be lowercase or uppercase");const o=(e=r).lastIndexOf("1");if(0===o||-1===o)throw new Error('Letter "1" must be present between prefix and data only');const i=e.slice(0,o),s=e.slice(o+1);if(s.length<6)throw new Error("Data must be at least 6 characters long");const a=b.decode(s).slice(0,-6),c=$(i,a,t);if(!s.endsWith(c))throw new Error(`Invalid checksum in ${e}: expected "${c}"`);return{prefix:i,words:a}}return{encode:function(e,n,r=90){if("string"!=typeof e)throw new Error("bech32.encode prefix should be string, not "+typeof e);if(!Array.isArray(n)||n.length&&"number"!=typeof n[0])throw new Error("bech32.encode words should be array of numbers, not "+typeof n);const o=e.length+7+n.length;if(!1!==r&&o>r)throw new TypeError(`Length ${o} exceeds limit ${r}`);return`${e=e.toLowerCase()}1${b.encode(n)}${$(e,n,t)}`},decode:s,decodeToBytes:function(e){const{prefix:t,words:n}=s(e,!1);return{prefix:t,words:n,bytes:r(n)}},decodeUnsafe:f(s),fromWords:r,fromWordsUnsafe:i,toWords:o}}e.bech32=_("bech32"),e.bech32m=_("bech32m"),e.utf8={encode:e=>(new TextDecoder).decode(e),decode:e=>(new TextEncoder).encode(e)},e.hex=n(d(4),r("0123456789abcdef"),o(""),s((e=>{if("string"!=typeof e||e.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof e} with length ${e.length}`);return e.toLowerCase()})));const E={utf8:e.utf8,hex:e.hex,base16:e.base16,base32:e.base32,base64:e.base64,base64url:e.base64url,base58:e.base58,base58xmr:e.base58xmr},v=`Invalid encoding type. Available types: ${Object.keys(E).join(", ")}`;e.bytesToString=(e,t)=>{if("string"!=typeof e||!E.hasOwnProperty(e))throw new TypeError(v);if(!(t instanceof Uint8Array))throw new TypeError("bytesToString() expects Uint8Array");return E[e].encode(t)},e.str=e.bytesToString;e.stringToBytes=(e,t)=>{if(!E.hasOwnProperty(e))throw new TypeError(v);if("string"!=typeof t)throw new TypeError("stringToBytes() expects string");return E[e].decode(t)},e.bytes=e.stringToBytes}(lib),BigInt(1e3),BigInt(1e6),BigInt(1e9),BigInt(1e12),BigInt("2100000000000000000"),BigInt(1e11);const TAGCODES={payment_hash:1,payment_secret:16,description:13,payee:19,description_hash:23,expiry:6,min_final_cltv_expiry:24,fallback_address:9,route_hint:3,feature_bits:5,metadata:27};for(let e=0,t=Object.keys(TAGCODES);e<t.length;e++)t[e],TAGCODES[t[e]].toString();async function runWithTimeout(e,t,n){return t?new Promise(((r,o)=>{const i=setTimeout((()=>{o(new Error(n||`Timed out after ${t}ms`))}),t);e().then(r,o).finally((()=>clearTimeout(i)))})):e()}var NDKRelayConnectivity=class{ndkRelay;_status;relay;timeoutMs;connectedAt;_connectionStats={attempts:0,success:0,durations:[]};debug;reconnectTimeout;constructor(e){this.ndkRelay=e,this._status=3,this.relay=relayInit(this.ndkRelay.url),this.debug=this.ndkRelay.debug.extend("connectivity"),this.relay.on("notice",(e=>this.handleNotice(e)))}async connect(e){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0),e??=this.timeoutMs,!this.timeoutMs&&e&&(this.timeoutMs=e);const t=()=>{this.updateConnectionStats.connected(),this._status=1,this.ndkRelay.emit("connect"),this.ndkRelay.emit("ready")},n=()=>{this.updateConnectionStats.disconnected(),1===this._status&&(this._status=3,this.handleReconnection()),this.ndkRelay.emit("disconnect")},r=async e=>{this.debug("Relay requested authentication",{havePolicy:!!this.ndkRelay.authPolicy}),this.ndkRelay.authPolicy?7!==this._status&&(this._status=7,await this.ndkRelay.authPolicy(this.ndkRelay,e),7===this._status&&(this.debug("Authentication policy finished"),this._status=1,this.ndkRelay.emit("authed"))):await this.ndkRelay.emit("auth",e)};try{this.updateConnectionStats.attempt(),3===this._status?this._status=0:this._status=4,this.relay.off("connect",t),this.relay.off("disconnect",n),this.relay.on("connect",t),this.relay.on("disconnect",n),this.relay.on("auth",r),await runWithTimeout(this.relay.connect,e,"Timed out while connecting")}catch(e){throw this.debug("Failed to connect",e),this._status=3,this.handleReconnection(),e}}disconnect(){this._status=2,this.relay.close()}get status(){return this._status}isAvailable(){return 1===this._status}isFlapping(){const e=this._connectionStats.durations;if(e.length%3!=0)return!1;const t=e.reduce(((e,t)=>e+t),0)/e.length,n=e.map((e=>Math.pow(e-t,2))).reduce(((e,t)=>e+t),0)/e.length;return Math.sqrt(n)<1e3}async handleNotice(e){(e.includes("oo many")||e.includes("aximum"))&&(this.disconnect(),setTimeout((()=>this.connect()),2e3),this.debug(this.relay.url,"Relay complaining?",e)),this.ndkRelay.emit("notice",this.relay,e)}handleReconnection(e=0){if(this.reconnectTimeout)return;if(this.debug("Attempting to reconnect",{attempt:e}),this.isFlapping())return this.ndkRelay.emit("flapping",this,this._connectionStats),void(this._status=5);const t=this.connectedAt?Math.max(0,6e4-(Date.now()-this.connectedAt)):5e3*(this._connectionStats.attempts+1);this.reconnectTimeout=setTimeout((()=>{this.reconnectTimeout=void 0,this._status=4,this.debug(`Reconnection attempt #${e}`),this.connect().then((()=>{this.debug("Reconnected")})).catch((t=>{this.debug("Reconnect failed",t),e<10?setTimeout((()=>{this.handleReconnection(e+1)}),1e3*(e+1)^2):this.debug("Reconnect failed after 10 attempts")}))}),t),this.debug("Reconnecting in",t),this._connectionStats.nextReconnectAt=Date.now()+t}updateConnectionStats={connected:()=>{this._connectionStats.success++,this._connectionStats.connectedAt=Date.now()},disconnected:()=>{this._connectionStats.connectedAt&&(this._connectionStats.durations.push(Date.now()-this._connectionStats.connectedAt),this._connectionStats.durations.length>100&&this._connectionStats.durations.shift()),this._connectionStats.connectedAt=void 0},attempt:()=>{this._connectionStats.attempts++}};get connectionStats(){return this._connectionStats}},NDKRelayPublisher=class{ndkRelay;constructor(e){this.ndkRelay=e}async publish(e,t=2500){const n=()=>new Promise(((n,r)=>{try{this.publishEvent(e,t).then((e=>n(e))).catch((e=>r(e)))}catch(e){r(e)}})),r=new Promise(((e,n)=>{setTimeout((()=>n(new Error("Timeout"))),t)})),o=()=>{n().then((e=>i(e))).catch((e=>s(e)))};let i,s;return 1===this.ndkRelay.status?Promise.race([n(),r]):Promise.race([new Promise(((e,t)=>{i=e,s=t,this.ndkRelay.once("connect",o)})),r]).finally((()=>{this.ndkRelay.removeListener("connect",o)}))}async publishEvent(e,t){const n=await e.toNostrEvent(),r=this.ndkRelay.connectivity.relay.publish(n);let o;const i=new Promise(((t,n)=>{r.then((()=>{clearTimeout(o),this.ndkRelay.emit("published",e),t(!0)})).catch((t=>{clearTimeout(o),this.ndkRelay.debug("Publish failed",t,e.id),this.ndkRelay.emit("publish:failed",e,t),n(t)}))}));if(!t||e.isEphemeral())return i;const s=new Promise(((n,r)=>{o=setTimeout((()=>{this.ndkRelay.debug("Publish timed out",e.rawEvent()),this.ndkRelay.emit("publish:failed",e,"Timeout"),r(new Error("Publish operation timed out"))}),t)}));return Promise.race([i,s])}async auth(e){return this.ndkRelay.connectivity.relay.auth(e.rawEvent())}};function calculateGroupableId(e){const t=[];for(const n of e){if(n.since||n.until)return null;const e=Object.keys(n||{}).sort().join("-");t.push(e)}return t.join("|")}function mergeFilters(e){const t={};return e.forEach((e=>{Object.entries(e).forEach((([e,n])=>{Array.isArray(n)?void 0===t[e]?t[e]=[...n]:t[e]=Array.from(new Set([...t[e],...n])):t[e]=n}))})),t}var MAX_SUBID_LENGTH=20;function compareFilter(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const[n,r]of Object.entries(e)){const e=t[n];if(!e)return!1;if(Array.isArray(r)&&Array.isArray(e)){const t=r;for(const n of e){const e=n;if(!t.includes(e))return!1}}else if(e!==r)return!1}return!0}function generateSubId(e,t){const n=e.map((e=>e.subId)).filter(Boolean),r=[],o=new Set,i=new Set;if(n.length>0)r.push(Array.from(new Set(n)).join(","));else{for(const e of t)for(const t of Object.keys(e))"kinds"===t?e.kinds?.forEach((e=>i.add(e))):o.add(t);i.size>0&&r.push("kinds:"+Array.from(i).join(",")),o.size>0&&r.push(Array.from(o).join(","))}let s=r.join("-");return s.length>MAX_SUBID_LENGTH&&(s=s.substring(0,MAX_SUBID_LENGTH)),1!==n.length&&(s+="-"+Math.floor(999*Math.random()).toString()),s}var NDKGroupedSubscriptions=class extends lib$1.EventEmitter{subscriptions;req;debug;constructor(e,t){super(),this.subscriptions=e,this.debug=t||this.subscriptions[0].subscription.debug.extend("grouped");for(const t of e)this.handleSubscriptionClosure(t)}addSubscription(e){this.subscriptions.push(e),this.handleSubscriptionClosure(e)}eventReceived(e){for(const t of this.subscriptions)t.eventReceived(e)}eoseReceived(e){Array.from(this.subscriptions).forEach((async t=>{t.subscription.eoseReceived(e)}))}handleSubscriptionClosure(e){e.subscription.on("close",(()=>{const t=this.subscriptions.findIndex((t=>t.subscription===e.subscription));this.subscriptions.splice(t,1),this.subscriptions.length<=0&&this.emit("close")}))}map(e){return this.subscriptions.map(e)}[Symbol.iterator](){let e=0;const t=this.subscriptions;return{next:()=>e<t.length?{value:t[e++],done:!1}:{value:null,done:!0}}}},NDKSubscriptionFilters=class{subscription;filters=[];ndkRelay;constructor(e,t,n){this.subscription=e,this.filters=t,this.ndkRelay=n}eventReceived(e){this.eventMatchesLocalFilter(e)&&this.subscription.eventReceived(e,this.ndkRelay,!1)}eventMatchesLocalFilter(e){const t=e.rawEvent();return this.filters.some((e=>matchFilter(e,t)))}};function findMatchingActiveSubscriptions(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length&&compareFilter(e[n],t[n]);n++)return e[n]}var NDKRelaySubscriptions=class{ndkRelay;delayedItems=new Map;delayedTimers=new Map;activeSubscriptions=new Map;activeSubscriptionsByGroupId=new Map;executionTimeoutsByGroupId=new Map;debug;groupingDebug;conn;constructor(e){this.ndkRelay=e,this.conn=e.connectivity,this.debug=e.debug.extend("subscriptions"),this.groupingDebug=e.debug.extend("grouping")}subscribe(e,t){const n=calculateGroupableId(t),r=new NDKSubscriptionFilters(e,t,this.ndkRelay);if(!n||!e.isGroupable())return void this.executeSubscriptions(n,new NDKGroupedSubscriptions([r]),t);const o=this.activeSubscriptionsByGroupId.get(n);if(o){if(findMatchingActiveSubscriptions(o.filters,t)){const n=this.activeSubscriptions.get(o.sub);return void n?.addSubscription(new NDKSubscriptionFilters(e,t,this.ndkRelay))}}let i=this.delayedItems.get(n);i?i.addSubscription(r):(i=new NDKGroupedSubscriptions([r]),this.delayedItems.set(n,i),i.once("close",(()=>{this.delayedItems.get(n)&&this.delayedItems.delete(n)})));let s=this.executionTimeoutsByGroupId.get(n);s&&"at-most"!==e.opts.groupableDelayType||(s=setTimeout((()=>{this.executeGroup(n,e)}),e.opts.groupableDelay),this.executionTimeoutsByGroupId.set(n,s)),this.delayedTimers.has(n)?this.delayedTimers.get(n).push(s):this.delayedTimers.set(n,[s])}executeGroup(e,t){const n=this.delayedItems.get(e);this.delayedItems.delete(e);const r=this.delayedTimers.get(e);if(this.delayedTimers.delete(e),r)for(const e of r)clearTimeout(e);if(n){const t=n.subscriptions[0].filters.length,r=[];for(let e=0;e<t;e++){const t=n.map((t=>t.filters[e]));r.push(mergeFilters(t))}this.executeSubscriptions(e,n,r)}}executeSubscriptionsWhenConnected(e,t,n){const r=()=>{this.debug("new relay coming online for active subscription",{relay:this.ndkRelay.url}),this.executeSubscriptionsConnected(e,t,n)};this.ndkRelay.once("ready",r),t.once("close",(()=>{this.ndkRelay.removeListener("ready",r)}))}executeSubscriptions(e,t,n){this.conn.isAvailable()?this.executeSubscriptionsConnected(e,t,n):this.executeSubscriptionsWhenConnected(e,t,n)}executeSubscriptionsConnected(e,t,n){const r=[];for(const{subscription:e}of t)r.push(e);const o=generateSubId(r,n);t.req=n;const i={id:o};(this.ndkRelay.trusted||r.every((e=>e.opts.skipVerification)))&&(i.skipVerification=!0);const s=this.conn.relay.sub(n,i);return this.activeSubscriptions.set(s,t),e&&this.activeSubscriptionsByGroupId.set(e,{filters:n,sub:s}),s.on("event",(e=>{const t=new NDKEvent(void 0,e);t.relay=this.ndkRelay;const n=this.activeSubscriptions.get(s);n?.eventReceived(t)})),s.on("eose",(()=>{const e=this.activeSubscriptions.get(s);e?.eoseReceived(this.ndkRelay)})),t.once("close",(()=>{s.unsub(),this.activeSubscriptions.delete(s),e&&this.activeSubscriptionsByGroupId.delete(e)})),this.executeSubscriptionsWhenConnected(e,t,n),s}executedFilters(){const e=new Map;for(const[,t]of this.activeSubscriptions)e.set(t.req,t.map((e=>e.subscription)));return e}},NDKRelay=class extends lib$1.EventEmitter{url;scores;connectivity;subs;publisher;authPolicy;trusted=!1;complaining=!1;debug;constructor(e,t){super(),this.url=e,this.scores=new Map,this.debug=debug6(`ndk:relay:${e}`),this.connectivity=new NDKRelayConnectivity(this),this.subs=new NDKRelaySubscriptions(this),this.publisher=new NDKRelayPublisher(this),this.authPolicy=t}get status(){return this.connectivity.status}get connectionStats(){return this.connectivity.connectionStats}async connect(e){return this.connectivity.connect(e)}disconnect(){3!==this.status&&this.connectivity.disconnect()}subscribe(e,t){this.subs.subscribe(e,t)}async publish(e,t=2500){return this.publisher.publish(e,t)}async auth(e){return this.publisher.auth(e)}scoreSlowerEvent(e){}tagReference(e){const t=["r",this.url];return e&&t.push(e),t}referenceTags(){return[["r",this.url]]}activeSubscriptions(){return this.subs.executedFilters()}},PublishError=class extends Error{errors;constructor(e,t){super(e),this.errors=t}get relayErrors(){const e=[];for(const[t,n]of this.errors)e.push(`${t.url}: ${n}`);return e.join("\n")}},NDKRelaySet=class e{relays;debug;ndk;constructor(e,t){this.relays=e,this.ndk=t,this.debug=t.debug.extend("relayset")}addRelay(e){this.relays.add(e)}static fromRelayUrls(t,n){const r=new Set;for(const e of t){const t=n.pool.relays.get(e);if(t)r.add(t);else{const t=new NDKRelay(e);n.pool.useTemporaryRelay(t),r.add(t)}}return new e(new Set(r),n)}async publish(e,t){const n=new Set,r=new Map,o=e.isEphemeral(),i=Array.from(this.relays).map((i=>new Promise((s=>{i.publish(e,t).then((e=>{n.add(i),s()})).catch((e=>{o||(r.set(i,e),this.debug("error publishing to relay",{relay:i.url,err:e})),s()}))}))));if(await Promise.all(i),0===n.size&&!o)throw new PublishError("No relay was able to receive the event",r);return n}get size(){return this.relays.size}};function calculateRelaySetFromEvent(e,t){const n=new Set;return e.pool?.relays.forEach((e=>n.add(e))),new NDKRelaySet(n,e)}function mergeTags(e,t){const n=new Map,r=(e,t)=>e.every(((e,n)=>e===t[n]));return e.concat(t).forEach((e=>{for(let[t,o]of n)if(r(o,e)||r(e,o))return void(e.length>=o.length&&n.set(t,e));n.set((e=>e.join(","))(e),e)})),Array.from(n.values())}async function generateContentTags(e,t=[]){let n=[];const r=e=>{t.find((t=>t[0]===e[0]&&t[1]===e[1]))||t.push(e)};return e=e.replace(/(@|nostr:)(npub|nprofile|note|nevent|naddr)[a-zA-Z0-9]+/g,(e=>{try{const t=e.split(/(@|nostr:)/)[2],{type:o,data:i}=nip19_exports.decode(t);let s;switch(o){case"npub":s=["p",i];break;case"nprofile":s=["p",i.pubkey];break;case"note":n.push(new Promise((async e=>{r(["e",i,await maybeGetEventRelayUrl(t),"mention"]),e()})));break;case"nevent":n.push(new Promise((async e=>{let{id:n,relays:o,author:s}=i;o&&0!==o.length||(o=[await maybeGetEventRelayUrl(t)]),r(["e",n,o[0],"mention"]),s&&r(["p",s]),e()})));break;case"naddr":n.push(new Promise((async e=>{const n=[i.kind,i.pubkey,i.identifier].join(":");let o=i.relays??[];0===o.length&&(o=[await maybeGetEventRelayUrl(t)]),r(["a",n,o[0],"mention"]),r(["p",i.pubkey]),e()})));break;default:return e}return s&&r(s),`nostr:${t}`}catch(t){return e}})),await Promise.all(n),{content:e=e.replace(/#(\w+)/g,((e,n)=>{const r=["t",n];return t.find((e=>e[0]===r[0]&&e[1]===r[1]))||t.push(r),e})),tags:t}}async function maybeGetEventRelayUrl(e){return""}function isReplaceable(){if(void 0===this.kind)throw new Error("Kind not set");return[0,3].includes(this.kind)||this.kind>=1e4&&this.kind<2e4||this.kind>=3e4&&this.kind<4e4}function isEphemeral(){if(void 0===this.kind)throw new Error("Kind not set");return this.kind>=2e4&&this.kind<3e4}function isParamReplaceable(){if(void 0===this.kind)throw new Error("Kind not set");return this.kind>=3e4&&this.kind<4e4}async function encrypt(e,t){if(!this.ndk)throw new Error("No NDK instance found!");if(t||(await this.ndk.assertSigner(),t=this.ndk.signer),!e){const t=this.getMatchingTags("p");if(1!==t.length)throw new Error("No recipient could be determined and no explicit recipient was provided");e=this.ndk.getUser({hexpubkey:t[0][1]})}this.content=await(t?.encrypt(e,this.content))}async function decrypt(e,t){if(!this.ndk)throw new Error("No NDK instance found!");t||(await this.ndk.assertSigner(),t=this.ndk.signer),e||(e=this.author),this.content=await(t?.decrypt(e,this.content))}function encode(){let e=[];return this.onRelays.length>0?e=this.onRelays.map((e=>e.url)):this.relay&&(e=[this.relay.url]),this.isParamReplaceable()?nip19_exports.naddrEncode({kind:this.kind,pubkey:this.pubkey,identifier:this.replaceableDTag(),relays:e}):e.length>0?nip19_exports.neventEncode({id:this.tagId(),relays:e,author:this.pubkey}):nip19_exports.noteEncode(this.tagId())}async function repost(e=!0,t){if(!t&&e){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner(),t=this.ndk.signer}const n=new NDKEvent(this.ndk,{kind:getKind(this),content:""});return n.tag(this),16===n.kind&&n.tags.push(["k",`${this.kind}`]),t&&await n.sign(t),e&&await n.publish(),n}function getKind(e){return 1===e.kind?6:16}function serialize(){return JSON.stringify([0,this.pubkey,this.created_at,this.kind,this.tags,this.content])}var PUBKEY_REGEX=/^[a-f0-9]{64}$/;function validate(){if("number"!=typeof this.kind)return!1;if("string"!=typeof this.content)return!1;if("number"!=typeof this.created_at)return!1;if("string"!=typeof this.pubkey)return!1;if(!this.pubkey.match(PUBKEY_REGEX))return!1;if(!Array.isArray(this.tags))return!1;for(let e=0;e<this.tags.length;e++){const t=this.tags[e];if(!Array.isArray(t))return!1;for(let e=0;e<t.length;e++)if("object"==typeof t[e])return!1}return!0}function verifySignature(e){if("boolean"==typeof this.signatureVerified)return this.signatureVerified;const t=this.getEventHash();if(t!==this.id)return!!e&&(this.signatureVerified=!1);try{return this.signatureVerified=schnorr.verify(this.sig,t,this.pubkey)}catch(e){return this.signatureVerified=!1}}function getEventHash(){return bytesToHex$1(sha256((new TextEncoder).encode(this.serialize())))}var debug2=debug6("ndk:zap"),DEFAULT_RELAYS=["wss://nos.lol","wss://relay.nostr.band","wss://relay.f7z.io","wss://relay.damus.io","wss://nostr.mom","wss://no.str.cr"],NDKZap=class e extends lib$1.EventEmitter{ndk;zappedEvent;zappedUser;fetch=fetch;constructor(e){super(),this.ndk=e.ndk,this.zappedEvent=e.zappedEvent,this.fetch=e._fetch||fetch,this.zappedUser=e.zappedUser||this.ndk.getUser({hexpubkey:this.zappedEvent?.pubkey})}static async getZapperPubkey(t,n){const r=t.getUser({pubkey:n}),o=new e({ndk:t,zappedUser:r}),i=await o.getZapSpec();return i?.nostrPubkey}async getZapSpec(){if(!this.zappedUser)throw new Error("No user to zap was provided");return this.zappedUser.getZapConfiguration(this.ndk)}async getZapSpecWithoutCache(){let e,t,n,r;if(this.zappedUser&&(this.zappedUser.profile||await this.zappedUser.fetchProfile({groupable:!1}),r=this.zappedUser.profile,e=(this.zappedUser.profile||{}).lud06,t=(this.zappedUser.profile||{}).lud16),t&&!t.startsWith("LNURL")){const[e,r]=t.split("@");n=`https://${r}/.well-known/lnurlp/${e}`}else if(e){const{words:t}=bech32.decode(e,1e3),r=bech32.fromWords(t);n=new TextDecoder("utf-8").decode(r)}if(!n)throw debug2("No zap endpoint found",r,{lud06:e,lud16:t}),new Error("No zap endpoint found");try{const e=this.fetch||this.ndk.httpFetch,t=await e(n);if(200!==t.status){const e=await t.text();throw new Error(`Unable to fetch zap endpoint ${n}: ${e}`)}return await t.json()}catch(e){throw new Error(`Unable to fetch zap endpoint ${n}: ${e}`)}}async getZapEndpoint(){const e=await this.getZapSpec();if(!e)return;let t;return e?.allowsNostr&&(e?.nostrPubkey||e?.nostrPubkey)&&(t=e.callback),t}async createZapRequest(e,t,n,r,o){const i=await this.generateZapRequest(e,t,n,r);if(!i)return null;const{event:s,zapEndpoint:a}=i;if(!s)throw new Error("No zap request event found");let c;await s.sign(o);try{debug2(`Getting invoice for zap request: ${a}`),c=await this.getInvoice(s,e,a)}catch(e){throw new Error("Failed to get invoice: "+e)}return c}async getInvoice(e,t,n){debug2(`Fetching invoice from ${n}?`+new URLSearchParams({amount:t.toString(),nostr:encodeURIComponent(JSON.stringify(e.rawEvent()))}));const r=new URL(n);r.searchParams.append("amount",t.toString()),r.searchParams.append("nostr",JSON.stringify(e.rawEvent())),debug2(`Fetching invoice from ${r.toString()}`);const o=await fetch(r.toString());if(debug2(`Got response from zap endpoint: ${n}`,{status:o.status}),200!==o.status){debug2(`Received non-200 status from zap endpoint: ${n}`,{status:o.status,amount:t,nostr:JSON.stringify(e.rawEvent())});const r=await o.text();throw new Error(`Unable to fetch zap endpoint ${n}: ${r}`)}return(await o.json()).pr}async generateZapRequest(e,t,n,r,o){const i=await this.getZapEndpoint();if(!i)throw new Error("No zap endpoint found");if(!this.zappedEvent&&!this.zappedUser)throw new Error("No zapped event or user found");const s=nip57_exports.makeZapRequest({profile:this.zappedUser.pubkey,event:null,amount:e,comment:t||"",relays:r??this.relays()});if(this.zappedEvent){const e=this.zappedEvent.referenceTags().filter((e=>"p"!==e[0]));s.tags.push(...e)}s.tags.push(["lnurl",i]);const a=new NDKEvent(this.ndk,s);return n&&(a.tags=a.tags.concat(n)),{event:a,zapEndpoint:i}}relays(){let e=[];return this.ndk?.pool?.relays&&(e=this.ndk.pool.urls()),e.length||(e=DEFAULT_RELAYS),e}},NDKEvent=class e extends lib$1.EventEmitter{ndk;created_at;content="";tags=[];kind;id="";sig;pubkey="";signatureVerified;_author=void 0;relay;onRelays=[];constructor(e,t){super(),this.ndk=e,this.created_at=t?.created_at,this.content=t?.content||"",this.tags=t?.tags||[],this.id=t?.id||"",this.sig=t?.sig,this.pubkey=t?.pubkey||"",this.kind=t?.kind}rawEvent(){return{created_at:this.created_at,content:this.content,tags:this.tags,kind:this.kind,pubkey:this.pubkey,id:this.id,sig:this.sig}}set author(e){this.pubkey=e.hexpubkey,this._author=void 0}get author(){if(this._author)return this._author;if(!this.ndk)throw new Error("No NDK instance found");const e=this.ndk.getUser({hexpubkey:this.pubkey});return this._author=e,e}tag(t,n,r){let o=[];if(void 0!==t.fetchProfile){const e=["p",t.pubkey];n&&e.push("",n),o.push(e)}else if(t instanceof e){const e=t;r??=e?.pubkey===this.pubkey,o=e.referenceTags(n,r);for(const t of e.getMatchingTags("p"))t[1]!==this.pubkey&&(this.tags.find((e=>"p"===e[0]&&e[1]===t[1]))||this.tags.push(["p",t[1]]))}else{if(!Array.isArray(t))throw new Error("Invalid argument",t);o=[t]}this.tags=mergeTags(this.tags,o)}async toNostrEvent(e){if(!e&&""===this.pubkey){const e=await(this.ndk?.signer?.user());this.pubkey=e?.hexpubkey||""}this.created_at||(this.created_at=Math.floor(Date.now()/1e3));const t=this.rawEvent(),{content:n,tags:r}=await this.generateTags();t.content=n||"",t.tags=r;try{this.id=this.getEventHash()}catch(e){}return this.id&&(t.id=this.id),this.sig&&(t.sig=this.sig),t}serialize=serialize.bind(this);getEventHash=getEventHash.bind(this);validate=validate.bind(this);verifySignature=verifySignature.bind(this);isReplaceable=isReplaceable.bind(this);isEphemeral=isEphemeral.bind(this);isParamReplaceable=isParamReplaceable.bind(this);encode=encode.bind(this);encrypt=encrypt.bind(this);decrypt=decrypt.bind(this);getMatchingTags(e){return this.tags.filter((t=>t[0]===e))}tagValue(e){const t=this.getMatchingTags(e);if(0!==t.length)return t[0][1]}get alt(){return this.tagValue("alt")}set alt(e){this.removeTag("alt"),e&&this.tags.push(["alt",e])}get dTag(){return this.tagValue("d")}set dTag(e){this.removeTag("d"),e&&this.tags.push(["d",e])}removeTag(e){this.tags=this.tags.filter((t=>t[0]!==e))}async sign(e){e?this.author=await e.user():(this.ndk?.assertSigner(),e=this.ndk.signer),await this.generateTags(),this.isReplaceable()&&(this.created_at=Math.floor(Date.now()/1e3));const t=await this.toNostrEvent();return this.sig=await e.sign(t),this.sig}async publish(e,t){if(this.sig||await this.sign(),!this.ndk)throw new Error("NDKEvent must be associated with an NDK instance to publish");e||(e=this.ndk.devWriteRelaySet||calculateRelaySetFromEvent(this.ndk)),this.ndk.debug(`publish to ${e.size} relays`,this.rawEvent()),5===this.kind&&this.ndk.cacheAdapter?.deleteEvent&&this.ndk.cacheAdapter.deleteEvent(this);const n=await e.publish(this,t);return this.onRelays=Array.from(n),n}async generateTags(){let e=[];const t=await generateContentTags(this.content,this.tags),n=t.content;if(e=t.tags,this.kind&&this.isParamReplaceable()){if(!this.getMatchingTags("d")[0]){const t=this.tagValue("title");let n=[...Array(t?6:16)].map((()=>Math.random().toString(36)[2])).join("");t&&t.length>0&&(n=t.replace(/[^a-z0-9]+/gi,"-").replace(/^-|-$/g,"")+"-"+n),e.push(["d",n])}}if((this.ndk?.clientName||this.ndk?.clientNip89)&&!this.tagValue("client")){const t=["client",this.ndk.clientName??""];this.ndk.clientNip89&&t.push(this.ndk.clientNip89),e.push(t)}return{content:n||"",tags:e}}muted(){const e=this.ndk?.mutedIds.get(this.pubkey);if(e&&"p"===e)return"author";const t=this.tagReference(),n=this.ndk?.mutedIds.get(t[1]);return n&&n===t[0]?"event":null}replaceableDTag(){if(this.kind&&this.kind>=3e4&&this.kind<=4e4){const e=this.getMatchingTags("d")[0];return e?e[1]:""}throw new Error("Event is not a parameterized replaceable event")}deduplicationKey(){return 0===this.kind||3===this.kind||this.kind&&this.kind>=1e4&&this.kind<2e4?`${this.kind}:${this.pubkey}`:this.tagId()}tagId(){return this.isParamReplaceable()?this.tagAddress():this.id}tagAddress(){if(!this.isParamReplaceable())throw new Error("This must only be called on replaceable events");const e=this.replaceableDTag();return`${this.kind}:${this.pubkey}:${e}`}tagReference(e){let t;return t=this.isParamReplaceable()?["a",this.tagAddress()]:["e",this.tagId()],this.relay?t.push(this.relay.url):t.push(""),e&&t.push(e),t}referenceTags(e,t){let n=[];return n=this.isParamReplaceable()?[["a",this.tagAddress()],["e",this.id]]:[["e",this.id]],this.relay?.url?n=n.map((e=>(e.push(this.relay?.url),e))):e&&(n=n.map((e=>(e.push(""),e)))),e&&n.forEach((t=>t.push(e))),t||n.push(...this.author.referenceTags()),n}filter(){return this.isParamReplaceable()?{"#a":[this.tagId()]}:{"#e":[this.tagId()]}}async zap(e,t,n,r,o){if(!this.ndk)throw new Error("No NDK instance found");o||this.ndk.assertSigner();const i=new NDKZap({ndk:this.ndk,zappedEvent:this,zappedUser:r}),s=Array.from(this.ndk.pool.relays.keys());return await i.createZapRequest(e,t,n,s,o)}async delete(t,n=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const r=new e(this.ndk,{kind:5,content:t||""});return r.tag(this),n&&await r.publish(),r}repost=repost.bind(this);async react(t,n=!0){if(!this.ndk)throw new Error("No NDK instance found");this.ndk.assertSigner();const r=new e(this.ndk,{kind:7,content:t});return r.tag(this),n?await r.publish():await r.sign(),r}get isValid(){return this.validate()}};async function follows(e,t,n=3){if(!this.ndk)throw new Error("NDK not set");const r=await this.ndk.fetchEvent({kinds:[n],authors:[this.pubkey]},e||{groupable:!1});if(r){const e=new Set;return r.tags.forEach((t=>{"p"===t[0]&&e.add(t[1])})),t&&this.ndk?.outboxTracker?.trackUsers(Array.from(e)),[...e].reduce(((e,t)=>{const n=new NDKUser({pubkey:t});return n.ndk=this.ndk,e.add(n),e}),new Set)}return new Set}function profileFromEvent(e){const t={};let n;try{n=JSON.parse(e.content)}catch(e){throw new Error(`Failed to parse profile event: ${e}`)}return Object.keys(n).forEach((e=>{switch(e){case"name":t.name=n.name;break;case"display_name":t.displayName=n.display_name;break;case"image":case"picture":t.image=n.picture||n.image;break;case"banner":t.banner=n.banner;break;case"bio":t.bio=n.bio;break;case"nip05":t.nip05=n.nip05;break;case"lud06":t.lud06=n.lud06;break;case"lud16":t.lud16=n.lud16;break;case"about":t.about=n.about;break;case"zapService":t.zapService=n.zapService;break;case"website":t.website=n.website;break;default:t[e]=n[e]}})),t}function serializeProfile(e){const t={};for(const[n,r]of Object.entries(e))switch(n){case"username":case"name":t.name=r;break;case"displayName":t.display_name=r;break;case"image":case"picture":t.picture=r;break;case"bio":case"about":t.about=r;break;default:t[n]=r}return JSON.stringify(t)}var NIP05_REGEX=/^(?:([\w.+-]+)@)?([\w.-]+)$/;async function getNip05For(e,t,n=fetch,r={}){return await e.queuesNip05.add({id:t,func:async()=>{if(e.cacheAdapter&&e.cacheAdapter.loadNip05){const n=await e.cacheAdapter.loadNip05(t);if("missing"!==n){if(n){const t=new NDKUser({pubkey:n.pubkey,relayUrls:n.relays,nip46Urls:n.nip46});return t.ndk=e,t}return null}}const o=t.match(NIP05_REGEX);if(!o)return null;const[i,s="_",a]=o;try{const o=await n(`https://${a}/.well-known/nostr.json?name=${s}`,r),{names:i,relays:c,nip46:u}=parseNIP05Result(await o.json()),l=i[s.toLowerCase()];let h=null;return l&&(h={pubkey:l,relays:c?.[l],nip46:u?.[l]}),e?.cacheAdapter&&e.cacheAdapter.saveNip05&&e.cacheAdapter.saveNip05(t,h),h}catch(n){return e?.cacheAdapter&&e.cacheAdapter.saveNip05&&e?.cacheAdapter.saveNip05(t,null),console.error("Failed to fetch NIP05 for",t,n),null}}})}function parseNIP05Result(e){const t={names:{}};for(const[n,r]of Object.entries(e.names))"string"==typeof n&&"string"==typeof r&&(t.names[n.toLowerCase()]=r);if(e.relays){t.relays={};for(const[n,r]of Object.entries(e.relays))"string"==typeof n&&Array.isArray(r)&&(t.relays[n]=r.filter((e=>"string"==typeof e)))}if(e.nip46){t.nip46={};for(const[n,r]of Object.entries(e.nip46))"string"==typeof n&&Array.isArray(r)&&(t.nip46[n]=r.filter((e=>"string"==typeof e)))}return t}var NDKUser=class e{ndk;profile;_npub;_pubkey;relayUrls=[];nip46Urls=[];constructor(e){e.npub&&(this._npub=e.npub),e.hexpubkey&&(this._pubkey=e.hexpubkey),e.pubkey&&(this._pubkey=e.pubkey),e.relayUrls&&(this.relayUrls=e.relayUrls),e.nip46Urls&&(this.nip46Urls=e.nip46Urls)}get npub(){if(!this._npub){if(!this._pubkey)throw new Error("hexpubkey not set");this._npub=nip19_exports.npubEncode(this.pubkey)}return this._npub}set npub(e){this._npub=e}get hexpubkey(){return this.pubkey}set hexpubkey(e){this._pubkey=e}get pubkey(){if(!this._pubkey){if(!this._npub)throw new Error("npub not set");this._pubkey=nip19_exports.decode(this.npub).data}return this._pubkey}set pubkey(e){this._pubkey=e}async getZapConfiguration(e){if(e??=this.ndk,!e)throw new Error("No NDK instance found");return await e.queuesZapConfig.add({id:this.pubkey,func:async()=>{if(this.ndk?.cacheAdapter?.loadUsersLNURLDoc){const e=await this.ndk.cacheAdapter.loadUsersLNURLDoc(this.pubkey);if("missing"!==e){if(null===e)return;if(e)return e}}const t=new NDKZap({ndk:e,zappedUser:this}),n=await t.getZapSpecWithoutCache();if(this.ndk?.cacheAdapter?.saveUsersLNURLDoc&&this.ndk.cacheAdapter.saveUsersLNURLDoc(this.pubkey,n||null),n)return n}})}async getZapperPubkey(){const e=await this.getZapConfiguration();return e?.nostrPubkey}static async fromNip05(t,n,r=!1){if(!n)throw new Error("No NDK instance found");let o={};r&&(o.cache="no-cache");const i=await getNip05For(n,t,n?.httpFetch,o);if(i){const t=new e({pubkey:i.pubkey,relayUrls:i.relays,nip46Urls:i.nip46});return t.ndk=n,t}}async fetchProfile(e){if(!this.ndk)throw new Error("NDK not set");this.profile||(this.profile={});let t=null;if(this.ndk.cacheAdapter&&this.ndk.cacheAdapter.fetchProfile&&"ONLY_RELAY"!==e?.cacheUsage){const e=await this.ndk.cacheAdapter.fetchProfile(this.pubkey);if(e)return this.profile=e,e}!e&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.locking&&(t=await this.ndk.fetchEvents({kinds:[0],authors:[this.pubkey]},{cacheUsage:"ONLY_CACHE",closeOnEose:!0,groupable:!1}),e={cacheUsage:"ONLY_RELAY",closeOnEose:!0,groupable:!0,groupableDelay:250}),t&&0!==t.size||(t=await this.ndk.fetchEvents({kinds:[0],authors:[this.pubkey]},e));const n=Array.from(t).sort(((e,t)=>e.created_at-t.created_at));return 0===n.length?null:(this.profile=profileFromEvent(n[0]),this.profile&&this.ndk.cacheAdapter&&this.ndk.cacheAdapter.saveProfile&&this.ndk.cacheAdapter.saveProfile(this.pubkey,this.profile),this.profile)}follows=follows.bind(this);tagReference(){return["p",this.pubkey]}referenceTags(e){const t=[["p",this.pubkey]];return e?(t[0].push("",e),t):t}async publish(){if(!this.ndk)throw new Error("No NDK instance found");if(!this.profile)throw new Error("No profile available");this.ndk.assertSigner();const e=new NDKEvent(this.ndk,{kind:0,content:serializeProfile(this.profile)});await e.publish()}async follow(e,t,n=3){if(!this.ndk)throw new Error("No NDK instance found");if(this.ndk.assertSigner(),t||(t=await this.follows(void 0,void 0,n)),t.has(e))return!1;t.add(e);const r=new NDKEvent(this.ndk,{kind:n});for(const e of t)r.tag(e);return await r.publish(),!0}async unfollow(e,t,n=3){if(!this.ndk)throw new Error("No NDK instance found");if(this.ndk.assertSigner(),t||(t=await this.follows(void 0,void 0,n)),!t.has(e))return!1;t.delete(e);const r=new NDKEvent(this.ndk,{kind:n});for(const e of t)r.tag(e);return await r.publish(),!0}async validateNip05(e){if(!this.ndk)throw new Error("No NDK instance found");const t=await getNip05For(this.ndk,e);return null===t?null:t.pubkey===this.pubkey}async zap(e,t,n,r){if(!this.ndk)throw new Error("No NDK instance found");r||this.ndk.assertSigner();const o=new NDKZap({ndk:this.ndk,zappedUser:this}),i=Array.from(this.ndk.pool.relays.keys());return await o.createZapRequest(e,t,n,i,r)}},NDKNip07Signer=class{_userPromise;nip04Queue=[];nip04Processing=!1;debug;waitTimeout;constructor(e=1e3){this.debug=debug6("ndk:nip07"),this.waitTimeout=e}async blockUntilReady(){await this.waitForExtension();const e=await window.nostr.getPublicKey();if(!e)throw new Error("User rejected access");return new NDKUser({hexpubkey:e})}async user(){return this._userPromise||(this._userPromise=this.blockUntilReady()),this._userPromise}async sign(e){await this.waitForExtension();return(await window.nostr.signEvent(e)).sig}async relays(){await this.waitForExtension();const e=await(window.nostr.getRelays?.())||{},t=[];for(const n of Object.keys(e))e[n].read&&e[n].write&&t.push(n);return t.map((e=>new NDKRelay(e)))}async encrypt(e,t){await this.waitForExtension();const n=e.hexpubkey;return this.queueNip04("encrypt",n,t)}async decrypt(e,t){await this.waitForExtension();const n=e.hexpubkey;return this.queueNip04("decrypt",n,t)}async queueNip04(e,t,n){return new Promise(((r,o)=>{this.nip04Queue.push({type:e,counterpartyHexpubkey:t,value:n,resolve:r,reject:o}),this.nip04Processing||this.processNip04Queue()}))}async processNip04Queue(e,t=0){if(!e&&0===this.nip04Queue.length)return void(this.nip04Processing=!1);this.nip04Processing=!0;const{type:n,counterpartyHexpubkey:r,value:o,resolve:i,reject:s}=e||this.nip04Queue.shift();this.debug("Processing encryption queue item",{type:n,counterpartyHexpubkey:r,value:o});try{let e;e="encrypt"===n?await window.nostr.nip04.encrypt(r,o):await window.nostr.nip04.decrypt(r,o),i(e)}catch(i){if(i.message&&i.message.includes("call already executing")&&t<5)return this.debug("Retrying encryption queue item",{type:n,counterpartyHexpubkey:r,value:o,retries:t}),void setTimeout((()=>{this.processNip04Queue(e,t+1)}),50*t);s(i)}this.processNip04Queue()}waitForExtension(){return new Promise(((e,t)=>{if(window.nostr)return void e();let n;const r=setInterval((()=>{window.nostr&&(clearTimeout(n),clearInterval(r),e())}),100);n=setTimeout((()=>{clearInterval(r),t(new Error("NIP-07 extension not available"))}),this.waitTimeout)}))}};function create_fragment(e){let t,n,r,o,i,s,a,c,u,l,h,d,f;return{c(){t=element("div"),n=element("img"),o=space(),i=element("p"),i.textContent="Welcome to Zaplan! Your Ultimate nostr based To-Do List App!",s=space(),a=element("p"),a.textContent="Stay organized and boost your productivity with Zaplan.",c=space(),u=element("button"),u.textContent="Login With A Nostr Extension",l=space(),h=element("div"),h.innerHTML='<p>Don&#39;t have a nostr extension?</p> \n        <p>Check out these nostr extension options:</p> \n        <ul><li>Chrome: <a href="https://chromewebstore.google.com/detail/ampjiinddmggbhpebhaegmjkbbeofoaj">Nostr Connect</a></li> \n            <li>FireFox: <a href="https://addons.mozilla.org/en-US/firefox/addon/nostr-connect/?utm_source=addons.mozilla.org&amp;utm_medium=referral&amp;utm_content=search">Nostr Connect</a></li> \n            <li>Safari (iOS): <a href="https://apps.apple.com/us/app/nostore/id1666553677">Nostore__</a></li></ul>',attr(n,"class","logo"),src_url_equal(n.src,r="./css/zaplan_logo.png")||attr(n,"src","./css/zaplan_logo.png"),attr(i,"class","title"),attr(a,"class","description"),attr(u,"class","btn"),attr(h,"class","register-link"),attr(t,"class","wrapper")},m(r,p){insert(r,t,p),append(t,n),append(t,o),append(t,i),append(t,s),append(t,a),append(t,c),append(t,u),append(t,l),append(t,h),d||(f=listen(u,"click",e[0]),d=!0)},p:noop,i:noop,o:noop,d(e){e&&detach(t),d=!1,f()}}}function instance(e){let t=[];const n=["wss://relay.snort.social","wss://relay.primal.net","wss://relay.damus.io"],r=new NDKNip07Signer;let o={};return[async function(){try{o.pubkey&&console.log("Permission granted to read their public key:",o.pubkey),o=await r.user();const e=new SimplePool;e.sub(n,[{kinds:[0],authors:[o.pubkey]}]).on("event",(e=>{t=[...t,e],eventsStore.set(t)})),navigate("/todoPage")}catch(e){console.error("Login failed:",e.message),alert(e.message)}}]}class Login extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,{})}}new App({target:document.body,props:{Login:Login,TodoPage:TodoPage}});
//# sourceMappingURL=bundle.js.map
